/*! @ncctag content */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@platform/api/index"),require("@platform/base/index"),require("react-dom"),require("@platform/template/index"),require("@platform/form/index")):"function"==typeof define&&define.amd?define(["react","@platform/api/index","@platform/base/index","react-dom","@platform/template/index","@platform/form/index"],t):"object"==typeof exports?exports["@platform/tree-table/index"]=t(require("react"),require("@platform/api/index"),require("@platform/base/index"),require("react-dom"),require("@platform/template/index"),require("@platform/form/index")):e["@platform/tree-table/index"]=t(e.React,e["@platform/api/index"],e["@platform/base/index"],e.ReactDOM,e["@platform/template/index"],e["@platform/form/index"])}(window,(function(e,t,r,n,a,o){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../../../../platform/",r(r.s=400)}({0:function(t,r){t.exports=e},1:function(e,r){e.exports=t},11:function(e,t){e.exports=a},3:function(e,t){e.exports=r},359:function(e,t,r){},400:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Oe}));var n=r(0),a=r.n(n),o=r(6),i=r.n(o),c=r(5),l=r.n(c),s=r(3),u=r(1);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=m(e);if(t){var a=m(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(c,e);var t,r,n,o=p(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).handleMouseOver=function(){if(t.cellDom){var e=t.state.tipStatus,r=t.cellDom.parentNode.getAttribute("class").includes("first-col"),n=null,a=t.cellDom.parentNode,o=t.cellDom.querySelector(".cell-context");a&&(n=r?a.parentNode&&a.parentNode.parentNode:a),n&&(o.offsetWidth>n.clientWidth&&!1===e&&t.setState({tipStatus:!0}),o.offsetWidth<=n.clientWidth&&!0===e&&t.setState({tipStatus:!1}))}},t.state={tipStatus:!1},t}return t=c,(r=[{key:"componentWillUnmount",value:function(){this.cellDom=null}},{key:"render",value:function(){var e=this,t=this.props,r=t.item,n=t.fixedStyle,o=t.context,c=t.multipleRowCell,d=t.searchValue,f=t.beforeStr,h=t.index,p=t.afterStr,y=t.record,m=t.onCellMouseDown,v=t.isEllipsis;return a.a.createElement("div",{fieldid:Object(u.getSysFieldid)(r.attrcode),className:l()("dobule-text",{"dobule-text-fixed":!(!r.fixed||"left"!==r.fixed)}),style:n,ref:function(t){e.cellDom=i.a.findDOMNode(t)},onMouseOver:this.handleMouseOver,onMouseDown:function(e){m&&m(y,h,r.attrcode,r,e)}},a.a.createElement(s.Tooltip,{placement:"top",overlay:this.state.tipStatus?o:"",className:"tooltip-word-color",delay:1,inverse:!0},a.a.createElement("div",{className:l()({"single-line-and-ellipsis":!c&&v,"three-line-and-ellipsis":!v})},f||p||d?a.a.createElement("span",{className:"cell-context"},f,-1!==h&&d?a.a.createElement("span",{className:"u-table-searchable-filter"},d):"",p):a.a.createElement("span",{className:"cell-context"}," "),"  ")))}}])&&f(t.prototype,r),n&&f(t,n),c}(n.Component),b={},g=r(11),w=r(42),k=r.n(w),x=function(e){return Object.prototype.toString.call(e).slice(8,-1)};function S(e){return"Array"===x(e)||Array.isArray(e)}function C(e){return void 0===e||void 0===e}function O(e){var t=[];return e.map((function(e){return function e(r){t.push(r),r.children&&r.children.map((function(t,r){e(t)}))}(e)})),t}function j(e){if(e){var t=O(e),r=[];t.map((function(e,t){e.children&&0!=e.children.length||r.push(e)}));var n=[];return r.forEach((function(e){n.push(function(e){var r=0;return function e(n){r++,t.map((function(t){t.key===n.pid&&e(t)}))}(e),r}(e))})),0===n.length?0:Math.max.apply(null,n)}}function E(e,t){if(!1===t)return!0;if(e.target.className.includes("u-table-row-expand-icon"))return!0;if(e.target.className.includes("stop-check-element"))return!0;var r=function(e){for(;e.parentElement;)if("TD"===(e=e.parentElement).tagName)return e;return null}(e.target);if(r){var n=r.querySelector(".".concat("stop-check-operation-element"));if(n&&n.contains(e.target))return r=n=null,!0}return!!document.getSelection().toString()||void 0}function D(e,t){if(null==e||0==e.length)return!1;for(var r=[],n=0;n<e.length;n++){if(e[n].key==t)return e[n].children;Array.isArray(e[n].children)&&e[n].children.length>0&&(r=r.concat(e[n].children))}return D(r,t)}function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,r){return(R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=F(e);if(t){var a=F(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return K(this,r)}}function K(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?I(e):t}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(o,e);var t,r,n,a=P(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).store={formStore:k.a.useForm(),data:[],fullDataObject:{},meta:{},async:!1,rowId:"rowId",isCheckedHasChild:!1,expandedKeys:[],checkedKeys:{},indeterminateKeys:{},currentSelectedRow:null,currentRow:null,modalType:null,isEllipsis:!0,searchValue:""},t.cache={cacheData:[],langJson:{}},t.getMeta=function(){return t.getStore("meta")},t.getHooks=function(){return t.getMeta=t.getMeta.bind(I(t)),t.setMeta=t.setMeta.bind(I(t)),{getStore:t.getStore.bind(I(t)),setStore:t.setStore.bind(I(t)),getMeta:t.getMeta.bind(I(t)),setMeta:t.setMeta.bind(I(t)),getViewMeta:t.getViewMeta.bind(I(t)),getCache:t.getCache.bind(I(t)),setCache:t.setCache.bind(I(t)),setData:t.setData.bind(I(t)),getData:t.getData.bind(I(t)),refresh:t.refresh}},t.name="treeTableStore",t.refresh=t.refresh.bind(I(t)),t.uuid=t.store.uuid="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Object(u.getSafeRandom)()|0;return("x"==e?t:3&t|8).toString(16)})),t}return t=o,(r=[{key:"getStore",value:function(e){return R(F(o.prototype),"get",this).call(this,e)}},{key:"setStore",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,a=R(F(o.prototype),"set",this).call(this,e,t);return r&&this.forceUpdate(n),a}},{key:"setCache",value:function(e,t){if(e){S(e)||(e=[e]);var r=this.cache,n=e.length;e.forEach((function(e,a){r[e]||(r[e]={}),a===n-1?r[e]=t:r=r[e]}))}else console.warn("invalid params <path> to setting")}},{key:"getCache",value:function(e){if(!C(e)){S(e)||(e=[e]);var t=this.cache;return e.some((function(r){if(C(r)||null==t)C(r)&&console.warn("paths has empty item[%s]",e);else{if(t[r])return t=t[r],!0;t=null}})),t}console.warn("invalid params <paths> to setting")}},{key:"setMeta",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getStore("name");t&&this.setStore("name",t||n,!1),this.setStore("meta",e,r);var a=this.getStore("formStore");if(a&&e[t]&&S(e[t].items)){var o=[];e[t].items.map((function(e){if("customer"!==e.itemtype){var t=JSON.parse(JSON.stringify(e||{},(function(e,t){if("render"!=e&&"title"!=e)return t})));delete t.render,delete t.title,o.push(t)}})),console.log(o),a.setMeta(A({},this.uuid,{status:"edit",items:o,moduletype:"form",isunfold:!1}),this.uuid)}}},{key:"_hasMeta",value:function(e){var t,r=this.getStore("meta")||{};return e&&(t=r[e],"Object"===x(t))&&r[e].items?r[e].items:(console.warn("not find meta"),[])}},{key:"getViewMeta",value:function(e){return this._hasMeta(e)}},{key:"setData",value:function(e){var t=e.data,r=void 0===t?[]:t,n=e.shouldForceUpdate,a=void 0===n||n,o=e.callback,i=S(r)?r:this.getData();this.setStore(["data"],i,a,o)}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getStore("data");return(t=t.filter((function(t){return!e.includes(t.status)})))||[]}},{key:"refresh",value:function(e){this.forceUpdate&&this.forceUpdate(e)}}])&&M(t.prototype,r),n&&M(t,n),o}(g.BaseStore),H=Object(g.hookFactory)(_);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=W(e);if(t){var a=W(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return U(this,r)}}function U(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?q(e):t}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(359);var Z=["#111111","#555555","#111","#555"],z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(d,e);var t,r,o,c=L(d);function d(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=c.call(this,e)).setStateEve=function(){t.forceUpdate()},t.checkDataType=function(e){var r=t.props,n=r.store,a=r.id,o=n.getMeta()[a].items.find((function(t){return t.attrcode===e}));if(o)return o.itemtype},t.createNewData=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=e.map((function(e,a){if(e.key=e.rowId,e.rowIndex=a,r[e.key]=r[e.key]||{},e.values.pid&&(e.pid=e.values.pid.value),Array.isArray(e.children)){var o=[];t.createNewData(e.children,r,o),r[e.key].childrenKeys=o}return r[e.key].item=e,n.push(e.key),e}));return a},t.itemCheckBoxChange=function(e,r){var n=t.props,a=n.store,o=n.showContextMenu,i=a.getStore("checkedKeys"),c=a.getStore("indeterminateKeys");i[r]=!i[r];var l=a.getStore("isCheckedHasChild");if(l&&o){var s=D(e,r);console.log("设置children选中:  children",s),function e(t){Array.isArray(t)&&t.forEach((function(t){i[t.key]=i[r],Array.isArray(t.children)&&e(t.children)}))}(s)}if(l){var u=function(e){var t=O(D([d[e].item],e)),r=t.length,n=t.filter((function(e){return i[e.key]})).length;r===n?(i[e]=!0,c[e]=!1):n?(i[e]=!1,c[e]=!0):(i[e]=!1,c[e]=!1)};c[r]=!1;for(var d=a.getStore("fullDataObject")||{},f=d[r]&&d[r].item.pid;f;)d[f]&&d[f].item&&u(f),f=d[f]&&d[f].item&&d[f].item.pid}a.setStore("checkedKeys",i,!1),a.setStore("indeterminateKeys",c,!0)},t.selectAllChange=function(e){},t.checkBoxChange_radio=function(e,r){var n=t.props.store,a=n.getStore("checkedKeys");a=a[r]?{}:function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},r,!0),n.setStore("checkedKeys",a,!1)},t.onCheckboxChangeChild=function(e,r,n,a){var o=t.props,i=o.store,c=o.checkboxChange,l=o.checkedType,s=i.getData();a.stopPropagation(),"radio"===l?t.checkBoxChange_radio(s,r.key):t.itemCheckBoxChange(s,r.key),Object(u.isFunction)(c)&&c(r,n,a),t.forceUpdate()},t.findItem=function(e,t){var r=null;return function e(n){n.map((function(n){return n.rowId===t?(r=n,!0):(!Array.isArray(n.values.children)||!e(n.values.children))&&void 0}))}(e),r},t.createNewCol=function(e,r){var n=t.props,o=n.showCheckBox,i=n.onCellMouseDown,c=n.store,d=n.multipleRowCell,f=t.state.langJson,h=c.getStore("expandedKeys"),p=c.getStore("checkedKeys"),y=c.getStore("indeterminateKeys"),m=c.getStore("searchValue"),b=f&&f["insert-tree-table-009"],g=f&&f["insert-tree-table-010"],w=[];if(!Object(u.isArray)(e)||e.length<1)return[];e.forEach((function(e){if(e.visible){if(e._width=e._width||e.width||120,e.width=e.width||120,e.title=a.a.createElement("span",{fieldid:Object(u.getSysFieldid)(e.attrcode||"opr"),style:{color:Z.includes(e.color)?"":e.color}}," ",e.label," "),e.dataIndex=e.attrcode,"customer"!==e.itemtype&&"numberindex"!==e.itemtype)e.hasOwnProperty("render")||(e.render=function(r,n,c){if(n&&n.values.hasOwnProperty(e.attrcode)){if("switch"===e.itemtype)return a.a.createElement("span",{fieldid:Object(u.getSysFieldid)(e.attrcode),onMouseDown:function(t){i&&i(n,c,e.attrcode,e,t)}},n.values[e.attrcode].value?b:g);var l,s,f="";if("residtxt"===e.itemtype){var h=Object(u.getLangCode)(),p=e.languageMeta.filter((function(e){return e.languageCode==h}));p[0]&&(l="1"==p[0].index?"":p[0].index,s=e.attrcode+l)}switch(f=s&&n.values[s]&&(n.values[s].display||n.values[s].value)?n.values[s].display||n.values[s].value||"":n.values[e.attrcode].display||n.values[e.attrcode].value||"",e.itemtype){case"datetimepicker":case"NCTZDatePickClientTime":f=Object(u.changeTime)(f,"YYYY-MM-DD HH:mm:ss");break;case"NCTZDatePickerStart":case"NCTZDatePickerEnd":case"NCTZDatePickClientHourTime":case"datepicker":f=Object(u.changeTime)(f,"YYYY-MM-DD")}switch(e.itemtype){case"NCTZDatePickerStart":case"NCTZDatePickerEnd":case"NCTZDatePickClientHourTime":case"datePickerNoTimeZone":case"datepicker":f=Object(u.formatDatetime)(f,"date");break;case"timepicker":f=Object(u.formatDatetime)(f,"time");break;case"datetimepicker":case"NCTZDatePickClientTime":f=Object(u.formatDatetime)(f,"datetime")}var y={display:""};e.fixed&&"left"===e.fixed&&e.width&&"120"!=String(e.width).replace("px","")&&o&&(y.width=e.width),"string"!=typeof f&&(f+="");var w=m||"",k=w.toLocaleLowerCase(),x=f.toLocaleLowerCase(),S="",C=f,O=x.indexOf(k);w&&-1!==O&&(S=f.substr(0,O),C=f.substr(O+w.length),w=f.substr(O,w.length));var j=t.props.store.getStore("isEllipsis");return a.a.createElement(v,{item:e,beforeStr:S,afterStr:C,searchValue:w,fixedStyle:y,context:f,isEllipsis:j,multipleRowCell:d,index:O,record:n,onCellMouseDown:i})}return a.a.createElement("span",{style:{width:"100%",height:"100%",display:"inline-block"},onMouseDown:function(t){i&&i(n,c,e.attrcode,e,t)}})});else if("customer"===e.itemtype&&e.hasOwnProperty("render")&&void 0===e.alreadyAssignment){var r=e.render;e.alreadyAssignment=!0,e.render=function(t,n,o){return a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("opr"),className:"stop-check-operation-element",onMouseDown:function(t){i&&i(n,o,e.attrcode,e,t)}},r(t,n,o))}}w.push(e)}}));var k=[{title:a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("firstcol")}),attrcode:"checkbox",dataIndex:"checkbox",itemtype:"customer",width:"100px",_width:"100px",render:function(e,r,n){if(o)return a.a.createElement(s.Checkbox,{onMouseDown:function(e){i&&i(r,n,"checkbox",{attrcode:"checkbox",itemtype:"customer"},e)},className:"table-checkbox",checked:p[r.key],indeterminate:y[r.key],onClick:t.onCheckboxChangeChild.bind(q(t),e,r,n)})}}];w[0].fixed&&"left"==w[0].fixed&&(k[0].fixed="left");var x=o?k.concat(w):w,S=x[0].render;x[0].render=null,x[0].render=function(e,t,r){var n;n="[object Boolean]"==Object.prototype.toString.call(t.isLeaf)&&!t.isLeaf||"[object Boolean]"==Object.prototype.toString.call(t.isleaf)&&!t.isleaf?h.includes(t.key)?a.a.createElement("i",{className:"icon iconfont  icon-wenjianjiadakai tree-wenjian treeTableIcon ".concat("stop-check-element")}):a.a.createElement("i",{className:"icon iconfont  icon-wenjianjia tree-wenjian treeTableIcon ".concat("stop-check-element")}):a.a.createElement("i",{className:"dian",style:{display:"none"}});var c=S(e,t,r);return c&&c.props&&c.props.children&&c.props.children[0]&&c.props.children[0].props&&"expend-switch"===c.props.children[0].props.className?c:c&&c.props&&"table-checkbox"===c.props.className?a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("firstcol"),onMouseDown:function(e){i&&i(t,r,"checkbox",{attrcode:"checkbox",itemtype:"customer"},e)}},a.a.createElement("span",{className:"first-col"},c),a.a.createElement("span",{className:"expend-switch"},n)):a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("firstcol"),onMouseDown:function(e){i&&i(t,r,"checkbox",{attrcode:"checkbox",itemtype:"customer"},e)},className:l()({zaiyihang:o})},a.a.createElement("span",{className:"expend-switch"},n),a.a.createElement("span",{className:"first-col"},c))};var C=x[0]._width;return C&&("string"==typeof C&&(C.includes("px")&&(C=C.replace("px","")),C=Number(C)),C+=16*j(r)),x[0].width=C,x},t.onExpand=function(e,r,n){var a=t.props,o=a.store,i=a.expandEve,c=a.collapandEve,l=o.getStore("isCheckedHasChild");e?i&&"function"==typeof i&&(o.setStore("currentRow",r,!1),i(r,l)):Object(u.isFunction)(c)&&c(r),t.forceUpdate()},t.modalContent=function(){var e=t.props,r=e.store,n=e.onAfterEvent,o=e.onBeforeEvent,i=r.getStore("formStore");return a.a.createElement("div",{className:"addModal"},a.a.createElement(k.a,{name:t.uuid,config:{onAfterEvent:n,onBeforeEvent:o},store:i}))},t.delNodeEve=function(){var e=t.props.delNodeCallBack;Object(u.isFunction)(e)&&e(t.uuid)},t.beSureBtnClick=function(){var e=t.props,r=e.modal,n=e.store,a=e.addNodeCallBack,o=e.editNodeCallBack,i=n.getStore("modalType"),c=n.getStore("currentRow"),l=n.getStore("formStore");if(!l.isCheckNow())return!1;var s={values:JSON.parse(JSON.stringify(l.getAllFormValue()))};"add"===i?(s.status=2,Object(u.isFunction)(a)&&a(s,c)):"edit"===i&&Object(u.isFunction)(o)&&o(s,c),r.close("treeTableManyColModal")},t.onRowDoubleClick=function(e,r,n){var a=t.props.ncOnRowDoubleClick;Object(u.isFunction)(a)&&a(e,r,n)},t.onRowClick=function(e,r,n){var a=t.props,o=a.store,i=a.checkOnRowClick,c=a.showCheckBox,l=a.onRowClickEve;o.setStore("currentSelectedRow",e,!1),n.ctrlKey||n.shiftKey||n.metaKey||c&&E(n,i)||(Object(u.isFunction)(l)&&l(e,r,n),t.onCheckboxChangeChild(null,e,r,n))},t.rowClassName=function(e,r){var n=t.props.store.getStore("currentSelectedRow");return n&&n.key==e.key?"tree-table-col-selected":""},t.createContextMenu=function(){var e=t.props,r=e.store,o=e.closeAllEve,i=e.hideExpandAll,c=e.expandAllEve,d=e.hideIncludeChild,f=e.extendRightMenu,h=t.state.langJson,p=r.getData(),y=r.getStore("isCheckedHasChild");return a.a.createElement(n.Fragment,null,!i&&a.a.createElement("li",{className:l()({"menu expand-all":!0}),onClick:function(){var e=[];!function t(r){r.forEach((function(r){e.push(r.key),Array.isArray(r.children)&&t(r.children)}))}(p),r.setStore("expandedKeys",e),Object(u.isFunction)(c)&&c()}},h["insert-tree-table-0013"]||"全部展开"),a.a.createElement("li",{className:l()({"menu close-all":!0}),onClick:function(){r.setStore("expandedKeys",[]),Object(u.isFunction)(o)&&o()}},h["insert-tree-table-0014"]||"全部收起"),!d&&a.a.createElement("li",{className:l()({"menu include-child":!0}),onClick:function(){r.setStore("isCheckedHasChild",!y)}},a.a.createElement(s.Checkbox,{className:"include-child-checkbox",checked:y,onChange:function(){r.setStore("isCheckedHasChild",!y)}}),a.a.createElement("span",{className:l()({"include-child-selected":y})}," ",h["insert-tree-table-0015"]||"包含下级")),Object(u.isFunction)(f)&&f())},t.getColSetConfig=function(){var e=t.props,r=e.id,n=(0,e.store.getMeta)();return{appcode:n.appcode||n.code||u.pageTo.getAppCode(),pagecode:n.pagecode||u.pageTo.getPageCode(),areaCode:r}},t.state={langJson:{},_:""};var r=e.store,o=e.id,i=e.isCheckedHasChild,f=e.async;r.setStore("name",o,!1),t.uuid=r.getStore("uuid");var h=0,p=window.screen.width;return h=p<=1919>1440?"480px":p>1919?"560px":"400px",r.setStore("tableHeight",h,!1),r.setStore("isCheckedHasChild",i,!1),r.setStore("async",f,!1),t}return t=d,(r=[{key:"componentDidMount",value:function(){}},{key:"UNSAFE_componentWillMount",value:function(){var e=this,t=this.props.store.setCache;Object(u.getMultiLang)({moduleId:"containers_insert_tree_table",callback:function(r){t("langJson",r||{}),e.setState({langJson:r})}})}},{key:"componentWillReceiveProps",value:function(e){var t=e.store,r=e.isCheckedHasChild,n=e.async;Object(u.isUndefined)(r)&&t.setStore("isCheckedHasChild",r,!1),t.setStore("async",n,!1)}},{key:"componentWillUnMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,r=t.modal,n=t.id,o=t.store,c=t.showCheckBox,d=void 0!==c&&c,f=t.checkedType,h=void 0===f?"checkbox":f,p=t.checkboxChange,y=t.scrollConfig,m=t.isDrag,v=void 0===m||m,b=t.adaptionHeight,g=void 0===b||b,w=t.otherAreaHeight,k=t.inModal,x=void 0!==k&&k,S=t.fieldid,C=t.isLazyload,O=void 0===C||C,j=t.addBlankCol,E=void 0===j||j,D=t.showContextMenu,N=void 0!==D&&D,A=t.extendRightMenu,M=t.showWidthAndHeightConfig,R=void 0===M||M,T=this.state.langJson,P=o.getStore,K=o.getViewMeta,I=o.getData,F=o.setStore,_=K(n),H={},B=I();if(!_||0===_.length||!B)return null;var J=this.createNewData(B,H);o.setStore("fullDataObject",H,!1);var V=JSON.parse(JSON.stringify(J)),L=P("expandedKeys"),U=P("tableHeight");return a.a.createElement("div",{id:n,className:"treeTableManyCol",fieldid:Object(u.getSysFieldid)("".concat(S||n,"_table"))},d&&"radio"!==h&&a.a.createElement(s.Selectable,{canvas:"#".concat(n),selector:" tbody tr ",unitKey:"key",disabled:"radio"===h||"slide",userSelect:!0,startItem:"",onSelect:function(e,t,r){var n=r.currentKey;if(Object.keys(e).length>0)if("ctrl"===t)F(["checkedKeys",n],e[n],!0,(function(){var e=H[n].item;console.log(H,n,e,"数据的问题处理"),Object(u.isFunction)(p)&&e&&p(e,e.rowIndex,{})}));else{for(var a in F("checkedKeys",{}),e)e.hasOwnProperty(a)&&F(["checkedKeys",a],e[a],!1);o.refresh((function(){for(var t in e)if(e.hasOwnProperty(t)&&Object(u.isFunction)(p)){var r=H[t];e[t]&&p(r,r.rowIndex,{})}}))}}}),a.a.createElement(s.Table,{lazyload:O,className:l()("tree-table-manyCol-container",{"firstcol-ellipsis":this.props.store.getStore("isEllipsis")}),expandedRowKeys:L,columns:this.createNewCol(_,V),columnKey:"attrcode",data:J,onExpand:this.onExpand,onExpandedRowsChange:function(e){o.setStore("expandedKeys",e)},bodyDisplayInRow:!1,foldingRowChange:function(e){o.setStore("isEllipsis",e)},scroll:y||{y:U},bodyStyle:{minHeight:y&&y.y?y.y:60},onRowDoubleClick:this.onRowDoubleClick,adaptionHeight:g,otherAreaHeight:w,inModal:x,onRowClick:this.onRowClick,isDrag:v,ref:function(t){e.dom=i.a.findDOMNode(t)},rowClassName:this.rowClassName,addBlankCol:E,extendRightMenu:N?this.createContextMenu():Object(u.isFunction)(A)?A():null,cancelCustomRightMenu:!0,colsSettingParam:this.getColSetConfig(),showWidthAndHeightConfig:R}),T?r.createModal("delNode",{title:T["insert-tree-table-001"],content:T["insert-tree-table-002"],beSureBtnClick:this.delNodeEve.bind(this),backdrop:"static"}):null,r.createModal("treeTableManyColModal",{content:this.modalContent.call(this),beSureBtnClick:this.beSureBtnClick.bind(this),cancelBtnClick:function(){r.close("treeTableManyColModal")},size:"lg",userControl:!0,backdrop:"static"}))}}])&&J(t.prototype,r),o&&J(t,o),d}(g.BaseComponent);z.displayName="TreeTable",z.useTreeTable=H;var Y=z;function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){X(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ee(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var te={add:"新增节点",edit:"编辑节点"},re=function(e){var t=this.treeTableDataSource[e];return t||(t=H(),this.treeTableDataSource[e]=t,t.setMeta(this.meta.getMeta()),void console.warn("所操作的表格中无ID为".concat(e,"的数据")))};function ne(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;t=JSON.parse(JSON.stringify(t));for(var i=r.key,c=e.length,l=0;l<c;l++){var s=e[l];if(s.rowId===i)return a&&a.length&&fe(e[l].children,a),e[l].children=t,o&&n[s.rowId]&&de(t,n),!0;if(Array.isArray(s.children)){var u=ne(s.children,t,r,n,a,o);if(u)return!1}}}function ae(e,t,r){return Array.isArray(e)?e.length>0&&!e[0].values[t]?(console.warn("addRowId方法，没有找到参数".concat(t)),!1):void e.forEach((function(e){e.key=e.rowId=e.values[t].value,r&&r.push(e.values[t].value),Array.isArray(e.children)&&ae(e.children,t,r)})):(console.warn("addRowId方法，第一个参数应为数组"),!1)}function oe(e){e.forEach((function(e){e.hasOwnProperty("isleaf")&&!e.isleaf&&(e.children=e.children||[])}))}function ie(e,t){t=JSON.parse(JSON.stringify(t));for(var r=e.length;r--;){var n=e[r];if(n.rowId===t.rowId)return e[r]=Q(Q({},e[r]),t),!0;if(Array.isArray(n.children)&&ie(n.children,t))return!1}}function ce(e,t,r,n){t=JSON.parse(JSON.stringify(t));var a=null;if(r)a=r.key;else{if(!t.values.pid)return console.error("树状表添加子节点的方法没找到pid"),!1;a=t.values.pid.value}for(var o=e.length;o--;){var i=e[o];if(i.rowId===a)return t.values.pid||(t.values.pid={value:a}),e[o]&&n&&(e[o].isleaf=!1),Array.isArray(e[o].children)?e[o].children.push(t):(n&&(e[o].isleaf=!1),e[o].children=[t]),!0;if(Array.isArray(i.children)&&ce(i.children,t,r,n))return!1}}function le(e,t,r){t=JSON.parse(JSON.stringify(t));for(var n=r.key,a=e.length,o=0;o<a;o++){var i=e[o];if(i.rowId===n)return e.splice(o+1,0,t),!0;if(Array.isArray(i.children)&&le(i.children,t,r))return!1}}function se(e,t){for(var r=e.length,n=0;n<r;n++){var a=e[n];if(a.rowId===t)return e.splice(n,1),!0;if(Array.isArray(a.children)&&se(a.children,t))return!1}}function ue(e,t){for(var r=e.length;r--;){var n=e[r];if(n.rowId===t)return Array.isArray(n.children)&&0===n.children.length&&delete n.children,!0;if(Array.isArray(n.children)&&ue(n.children))return!1}}function de(e,t){Array.isArray(e)&&e.forEach((function(e){t[e.key]=!0,Array.isArray(e.children)&&de(e.children)}))}function fe(e,t){Array.isArray(e)&&e.forEach((function(e){var r=t.indexOf(e.key);-1!==r&&t.splice(r,1),Array.isArray(e.children)&&fe(e.children,t)}))}function he(e,t){return D(e,t)}function pe(e){return j(e)}function ye(e,t){return E(e,t)}function me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ve=["#111111","#555555","#111","#555"];r(359);var be=!1,ge=0,we=window.screen.width;ge=we<=1919>1440?"480px":we>1919?"560px":"400px";var ke=null;function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ce={TreeTableManyCol:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.expandEve,c=r.collapandEve,d=r.async,f=r.editNodeCallBack,h=r.addNodeCallBack,p=r.delNodeCallBack,y=r.onAfterEvent,m=r.showCheckBox,g=void 0!==m&&m,w=r.checkedType,k=void 0===w?"checkbox":w,x=r.checkboxChange,S=r.scrollConfig,C=r.ncOnRowDoubleClick,O=r.isDrag,j=void 0===O||O,E=r.multipleRowCell,D=void 0!==E&&E,N=r.adaptionHeight,A=void 0===N||N,M=r.inModal,R=void 0!==M&&M,T=r.checkOnRowClick,P=void 0===T||T,K=r.fieldid,I=r.onRowClickEve,F=r.isLazyload,_=void 0===F||F,H=r.addBlankCol,B=void 0===H||H,J=r.showContextMenu,V=void 0!==J&&J,L=r.expandAllEve,U=r.closeAllEve,q=r.hideExpandAll,W=void 0!==q&&q,Z=r.hideIncludeChild,z=void 0!==Z&&Z,Y=r.onCellMouseDown,G=r.extendRightMenu,Q=r.isCheckedHasChild,X=void 0!==Q&&Q,$=!1,ee=this;this.state.treeTableCol.hasOwnProperty(e)||(this.state.treeTableCol[e]={firstTime:!0,async:d,expandedKeys:[],checkedKeys:{},tableHeight:ge,isEllipsis:!0});var te=this.state.meta[e];if(te&&this.state.treeTableCol[e].data){var re=this.state.treeTableCol[e];void 0===re.isCheckedHasChild&&(re.isCheckedHasChild=X);var ne=re.data,ae=JSON.parse(JSON.stringify(ne)),oe=Object(u.cloneObj)(te),ie=function(e,t,r){be||(re.multilingual=e,b.lang=e,ee.setState({treeTableCol:ee.state.treeTableCol},(function(){be=!0})))};if(Object(u.getMultiLang)({moduleId:"containers_insert_tree_table",callback:ie}),re.firstTime){ke=e+"form";var ce=[];if(!Object(u.isArray)(oe.items))return void console.error("树状表模板中，items应为数组,请参考文档");oe.items.map((function(e){if("customer"!==e.itemtype){var t=JSON.parse(JSON.stringify(e||{},(function(e,t){if("render"!=e&&"title"!=e)return t})));delete t.render,delete t.title,ce.push(t)}})),this.state.meta[ke]={moduletype:"form",items:ce,status:"edit"},this.use.form(ke),this.formDataSource[ke].setMeta(this.state.meta,ke),re.firstTime=!1}var le=function(){t.setState({treeTableCol:t.state.treeTableCol})},se={},ue=function e(t){return t.map((function(t,r){return t.key=t.rowId,t.rowIndex=r,t.values.pid&&(t.pid=t.values.pid.value),Array.isArray(t.children)&&e(t.children),se[t.key]=t,t}))},de=ue(ae),fe=JSON.parse(JSON.stringify(de)),we=function(e,t){if(re.checkedKeys[t]=!re.checkedKeys[t],re.isCheckedHasChild&&V){var r=he(e,t);console.log("设置children选中:  children",r),function e(r){Array.isArray(r)&&r.forEach((function(r){re.checkedKeys[r.key]=re.checkedKeys[t],Array.isArray(r.children)&&e(r.children)}))}(r)}},xe=function(e,t){re.checkedKeys[t]?re.checkedKeys={}:re.checkedKeys=me({},t,!0)},Se=function(e,t,r,n){n.stopPropagation(),"radio"===k?xe(re.data,t.key):we(re.data,t.key),Object(u.isFunction)(x)&&x(t,r,n),le()},Ce=function(e){var r=re.multilingual&&re.multilingual["insert-tree-table-009"],n=re.multilingual&&re.multilingual["insert-tree-table-010"],o=[];e.forEach((function(e){if(e.visible){if(e._width=e._width||e.width||120,e.width=e.width||120,e.title=a.a.createElement("span",{fieldid:Object(u.getSysFieldid)(e.attrcode||"opr"),style:{color:ve.includes(e.color)?"":e.color}}," ",e.label," "),e.dataIndex=e.attrcode,"customer"!==e.itemtype&&"numberindex"!==e.itemtype)e.hasOwnProperty("render")||(e.render=function(t,o,i){if(o&&o.values.hasOwnProperty(e.attrcode)){if("switch"===e.itemtype)return a.a.createElement("span",{fieldid:Object(u.getSysFieldid)(e.attrcode),onMouseDown:function(t){Y&&Y(o,i,e.attrcode,e,t)}},o.values[e.attrcode].value?r:n);var c,l,s="";if("residtxt"===e.itemtype){var d=Object(u.getLangCode)(),f=e.languageMeta.filter((function(e){return e.languageCode==d}));f[0]&&(c="1"==f[0].index?"":f[0].index,l=e.attrcode+c)}s=l&&(o.values[l].display||o.values[l].value)?o.values[l].display||o.values[l].value||"":o.values[e.attrcode].display||o.values[e.attrcode].value||"";var h={display:""};e.fixed&&"left"===e.fixed&&e.width&&"120"!=String(e.width).replace("px","")&&g&&(h.width=e.width),"string"!=typeof s&&(s+="");var p=re.searchValue||"",y=p.toLocaleLowerCase(),m=s.toLocaleLowerCase(),b="",w=s,k=m.indexOf(y);return p&&-1!==k&&(b=s.substr(0,k),w=s.substr(k+p.length),p=s.substr(k,p.length)),a.a.createElement(v,{item:e,beforeStr:b,afterStr:w,searchValue:p,fixedStyle:h,context:s,isEllipsis:re.isEllipsis,multipleRowCell:D,index:k,record:o,onCellMouseDown:Y})}return a.a.createElement("span",{style:{width:"100%",height:"100%",display:"inline-block"},onMouseDown:function(t){Y&&Y(o,i,e.attrcode,e,t)}})});else if("customer"===e.itemtype&&e.hasOwnProperty("render")&&void 0===e.alreadyAssignment){var t=e.render;e.alreadyAssignment=!0,e.render=function(r,n,o){return a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("opr"),className:"stop-check-operation-element",onMouseDown:function(t){Y&&Y(n,o,e.attrcode,e,t)}},t(r,n,o))}}o.push(e)}}));var i=[{title:a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("firstcol")}),attrcode:"checkbox",dataIndex:"checkbox",itemtype:"customer",width:"100px",_width:"100px",render:function(e,r,n){if(g)return a.a.createElement(s.Checkbox,{onMouseDown:function(e){Y&&Y(r,n,"checkbox",{attrcode:"checkbox",itemtype:"customer"},e)},className:"table-checkbox",checked:re.checkedKeys[r.key],onClick:Se.bind(t,e,r,n)})}}];o[0].fixed&&"left"==o[0].fixed&&(i[0].fixed="left");var c=g?i.concat(o):o,d=c[0].render;c[0].render=null,c[0].render=function(e,t,r){var n;n="[object Boolean]"==Object.prototype.toString.call(t.isLeaf)&&!t.isLeaf||"[object Boolean]"==Object.prototype.toString.call(t.isleaf)&&!t.isleaf?re.expandedKeys.includes(t.key)?a.a.createElement("i",{className:"icon iconfont  icon-wenjianjiadakai tree-wenjian treeTableIcon ".concat("stop-check-element")}):a.a.createElement("i",{className:"icon iconfont  icon-wenjianjia tree-wenjian treeTableIcon ".concat("stop-check-element")}):a.a.createElement("i",{className:"dian",style:{display:"none"}});var o=d(e,t,r);return o&&o.props&&o.props.children&&o.props.children[0]&&o.props.children[0].props&&"expend-switch"===o.props.children[0].props.className?o:o&&o.props&&"table-checkbox"===o.props.className?a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("firstcol"),onMouseDown:function(e){Y&&Y(t,r,"checkbox",{attrcode:"checkbox",itemtype:"customer"},e)}},a.a.createElement("span",{className:"first-col"},o),a.a.createElement("span",{className:"expend-switch"},n)):a.a.createElement("span",{fieldid:Object(u.getSysFieldid)("firstcol"),onMouseDown:function(e){Y&&Y(t,r,"checkbox",{attrcode:"checkbox",itemtype:"customer"},e)},className:l()({zaiyihang:g})},a.a.createElement("span",{className:"expend-switch"},n),a.a.createElement("span",{className:"first-col"},o))};var f=c[0]._width;return!$&&f&&("string"==typeof f&&(f.includes("px")&&(f=f.replace("px","")),f=Number(f)),f+=16*pe(fe),$=!0),c[0].width=f,c},Oe=function(e,t,r){e?o&&"function"==typeof o&&(re.currentRow=t,o(t,re.isCheckedHasChild)):Object(u.isFunction)(c)&&c(t),le()},je=function(){return a.a.createElement("div",{className:"addModal"},t.form.createForm(ke,{onAfterEvent:y}))},Ee=function(){Object(u.isFunction)(p)&&p(ke)},De=function(){if(!t.form.isCheckNow(ke))return!1;var e=t.form.getAllFormValue(ke).rows[0];"add"===re.modalType?(e.status=2,Object(u.isFunction)(h)&&h(e,re.currentRow)):"edit"===re.modalType&&Object(u.isFunction)(f)&&f(e,re.currentRow),t.modal.close("treeTableManyColModal")},Ne=function(e,t,r){Object(u.isFunction)(C)&&C(e,t,r)},Ae=function(e,t,r){re.currentSelectedRow=e,r.ctrlKey||r.shiftKey||r.metaKey||g&&ye(r,P)||(Object(u.isFunction)(I)&&I(e,t,r),Se(null,e,t,r))},Me=function(e,t){return re.currentSelectedRow&&re.currentSelectedRow.key==e.key?"tree-table-col-selected":""},Re=function(){var e=re.multilingual||{};return a.a.createElement(n.Fragment,null,!W&&a.a.createElement("li",{className:l()({"menu expand-all":!0}),onClick:function(){var e=[];!function t(r){r.forEach((function(r){e.push(r.key),Array.isArray(r.children)&&t(r.children)}))}(re.data),re.expandedKeys=e,le(),Object(u.isFunction)(L)&&L()}},e["insert-tree-table-0013"]||"全部展开"),a.a.createElement("li",{className:l()({"menu close-all":!0}),onClick:function(){re.expandedKeys=[],le(),Object(u.isFunction)(U)&&U()}},e["insert-tree-table-0014"]||"全部收起"),!z&&a.a.createElement("li",{className:l()({"menu include-child":!0}),onClick:function(){re.isCheckedHasChild=!re.isCheckedHasChild,le()}},a.a.createElement(s.Checkbox,{className:"include-child-checkbox",checked:re.isCheckedHasChild,onChange:function(){re.isCheckedHasChild=!re.isCheckedHasChild,le()}}),a.a.createElement("span",{className:l()({"include-child-selected":re.isCheckedHasChild})}," ",e["insert-tree-table-0015"]||"包含下级")),Object(u.isFunction)(G)&&G())};return a.a.createElement("div",{id:e,className:"treeTableManyCol",fieldid:Object(u.getSysFieldid)("".concat(K||e,"_table"))},g&&"radio"!==k?a.a.createElement(s.Selectable,{canvas:"#".concat(e),selector:" tbody tr ",unitKey:"key",disabled:"radio"===k||"slide",userSelect:!0,startItem:"",onSelect:function(e,r,n){var a=n.currentKey;if(re.data.length>0)if("ctrl"===r)re.checkedKeys[a]=e[a],t.setState({treeTableCol:t.state.treeTableCol},(function(){var e=se[a];Object(u.isFunction)(x)&&e&&x(e,e.rowIndex,{})}));else{for(var o in re.checkedKeys={},e)e.hasOwnProperty(o)&&(re.checkedKeys[o]=e[o]);t.setState({treeTableCol:t.state.treeTableCol},(function(){for(var t in e)if(e.hasOwnProperty(t)&&Object(u.isFunction)(x)){var r=se[t];e[t]&&x(r,r.rowIndex,{})}}))}}}):"",a.a.createElement(s.Table,{lazyload:_,className:"tree-table-manyCol-container",expandedRowKeys:re.expandedKeys,columns:Ce(te.items),columnKey:"attrcode",data:de,onExpand:Oe.bind(this),onExpandedRowsChange:function(e){re.expandedKeys=e,le()},bodyDisplayInRow:!1,foldingRowChange:function(e){re.isEllipsis=e,le()},scroll:S||{x:!0,y:this.state.treeTableCol[e].tableHeight},onRowDoubleClick:Ne,adaptionHeight:A,inModal:R,onRowClick:Ae,isDrag:j,ref:function(e){t.dom=i.a.findDOMNode(e)},rowClassName:Me,addBlankCol:B,extendRightMenu:V?Re():Object(u.isFunction)(G)?G():null,cancelCustomRightMenu:!0}),re.multilingual?this.modal.createModal("delNode",{title:re.multilingual["insert-tree-table-001"],content:re.multilingual["insert-tree-table-002"],beSureBtnClick:Ee.bind(this),backdrop:"static"}):null,this.modal.createModal("treeTableManyColModal",{content:je.call(this),beSureBtnClick:De.bind(this),cancelBtnClick:function(){t.modal.close("treeTableManyColModal")},size:"lg",userControl:!0,backdrop:"static"}))}},treeTableCol:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this,n=r.treeTableDataSource[e];n||(n=H(),r.treeTableDataSource[e]=n,n.setMeta(r.meta.getMeta(),e,!1),console.log(r));var o=t.async,i=ee(t,["async"]);return a.a.createElement(Y,$({async:o,store:n,id:e,modal:this.modal},i))},initTreeTableData:function(e,t,r,n,a){if(void 0===r)return console.warn("树状表addRowId方法，第三个参数需要传表示行rowid 的字段"),!1;var o=re.call(this,e);if(o){var i=o.getStore(),c=i.async,l=i.isCheckedHasChild,s=i.checkedKeys;c&&oe(t);var u,d=[];if(n?(u=ae(t,r,d),l&&s&&t.map((function(e){s[e.key]&&Array.isArray(e.children)&&de(e.children,s)}))):(u=ae(t,r),a&&o.setStore("expandedKeys",a,!1)),!1===u)return console.warn("树状表addRowId方法，没有找到表示rowId的字段，请检查数据中是否存在".concat(r,"字段")),!1;o.setData({data:t,shouldForceUpdate:!1}),o.setStore("rowId",r,!1),l&&o.setStore("checkedKeys",s,!1),n&&o.setStore("expandedKeys",d,!1),o.setCache("cacheData",JSON.parse(JSON.stringify(t))),o.setStore("searchValue",null,!0)}},setChildNode:function(e,t,r,n){if(!e||!t||!r)return console.warn("树状表setChildNode 方法参数不正确"),!1;if(!Array.isArray(t))return console.warn("树状表setChildNode 方法,第二个参数应为数组"),!1;var a=re.call(this,e);if(a){var o=a.getStore("rowId"),i=a.getStore("async"),c=a.getStore("checkedKeys"),l=a.getStore("expandedKeys"),s=a.getData(),u=a.getCache("cacheData");n=n||a.getStore("isCheckedHasChild"),i?(oe(t),ae(t,o),ne(s,t,r,c,l,n),ne(u,t,r,c,l,n),a.setStore("searchValue",null)):console.warn("setChildNode方法只能异步加载时调用")}},editRowEve:function(e,t){var r=re.call(this,e);if(r){var n=r.getStore("rowId"),a=r.getData(),o=r.getCache("cacheData");if(!t.values[n])return console.warn&&console.warn("树状表editRowEve 方法,第二个参数中没有找到表示RowId的字段，请检查数据中是否有".concat(n,"字段")),!1;t.rowId=t.values[n].value,oe([t]),ie(a,t),ie(o,t),r.setStore("searchValue",null)}},addChildRowEve:function(e,t){var r=re.call(this,e);if(r){var n=r.getStore("rowId"),a=r.getStore("currentRow"),o=r.getData(),i=r.getCache("cacheData");console.log(t,a,o,i);var c=function(e){var t=e.values[n];e.values[n]=t&&void 0!==t.value&&null!==t.value?t:{value:Object(u.getSafeRandom)()},e.key=e.rowId=e.values[n].value,oe([e]),ce(o,e,a,!0),ce(i,e,a,!0),r.setStore("searchValue",null,!1)};Array.isArray(t)?t.forEach((function(e){c(e)})):c(t),r.refresh()}},addBrotherRow:function(e,t){var r=re.call(this,e);if(r){var n=r.getStore("rowId"),a=r.getStore("currentRow"),o=r.getData(),i=r.getCache("cacheData");if(!t.values[n])return console.warn("树状表addBrotherRow 方法,第二个参数中没有找到表示RowId的字段，请检查数据中是否有".concat(n,"字段")),!1;t.rowId=t.values[n].value,oe([t]),le(o,t,a),le(i,t,a),r.setStore("searchValue",null)}},delRowByPk:function(e,t){var r=re.call(this,e);if(r){var n=r.getData(),a=r.getCache("cacheData"),o=t.key;se(n,o),se(a,o),t.pid&&(ue(n,t.pid),ue(a,t.pid)),r.setData({data:n,shouldForceUpdate:!1}),r.setCache("cacheData",a),r.setStore("searchValue",null)}},createNewData:function(e){if(!Array.isArray(e))return console.warn("createTreeData方法，参数应该为数组"),!1;var t=new Map;e.forEach((function(e){e.values.pid&&e.values.pid.value||(e.values.pid={value:"root"}),t.get(e.values.pid.value)?t.get(e.values.pid.value).push(e):t.set(e.values.pid.value,[e])}));var r=function e(r){return t.get(r)?t.get(r).map((function(t){return t.children=e(t.values.refpk.value),t})):null}("root")||[];return function e(t){t.forEach((function(t){t.checked?t.checked=!0:t.checked=!1,Array.isArray(t.children)?(t.isleaf=!1,e(t.children)):t.isleaf=!0}))}(r),r},getAllValue:function(e){var t=re.call(this,e);if(t)return t.getData()},getValueByRowId:function(e,t){var r=re.call(this,e);if(r)return function e(t,r){for(var n=t.length;n--;){var a=t[n];if(a.rowId===r)return a;if(Array.isArray(a.children)){var o=e(a.children,r);if(o)return o}}}(r.getData(),t)},getExpandedRowKeys:function(e){var t=re.call(this,e);if(t)return t.getStore("expandedKeys")},showModal:function(e,t,r){var n=re.call(this,e);if(n){var a=n.getCache("langJson"),o=n.getStore("formStore");n.getStore("uuid");te.add=a["insert-tree-table-012"],te.edit=a["insert-tree-table-011"],n.setStore("currentRow",t,!1);var i=JSON.parse(JSON.stringify("edit"===r?t.values:{}));console.log(i,o),o.emptyAllFormValue(),o.setAllFormValue(i),n.setStore("modalType",r,!0),this.modal.show("treeTableManyColModal",{title:"".concat(te[r])})}},emptyAllData:function(e){var t=re.call(this,e);t&&(t.setData({data:[],shouldForceUpdate:!1}),t.setCache("cacheData",[]),t.setStore("searchValue",null))},openRow:function(e,t){var r=re.call(this,e);if(r){var n=r.getStore("expandedKeys");!n.find((function(e){return e===t}))&&n.push(t),r.refresh()}},closeRow:function(e,t){var r=re.call(this,e);if(r){var n=r.getStore("expandedKeys"),a=n.findIndex((function(e){return e===t}));n.splice(a,1),r.refresh()}},getSelectedRow:function(e){var t=re.call(this,e);if(t){var r=t.getData(),n=t.getStore("expandedKeys"),a=t.getStore("isCheckedHasChild"),o=function(e,t){var r=t.getStore("checkedKeys"),n=[];return function e(t){t.map((function(t){r[t.key]&&n.push(t),Array.isArray(t.children)&&e(t.children)}))}(e),n}(r,t),i=JSON.parse(JSON.stringify(o));return i=i.map((function(e){var t=e.children,r=ee(e,["children"]);return n.includes(e.key)||t&&(!Array.isArray(t)||0!==t.length)||!1!==e.isleaf&&a&&(r.isCheckHasChild=!0),r}))}},searchTreeTable:function(e){var t=e.moduleId,r=e.searchValue,n=e.filters,a=void 0===n?[]:n,o=e.expanded,i=void 0===o||o,c=e.defaultExpandAllRows,l=void 0!==c&&c,s=re.call(this,t);if(s){"[object Array]"!==Object.prototype.toString.call(a)&&(a=[String(a)]);var u=s.getCache("cacheData")||s.getData(),d=[];s.setStore("expandedKeys",[],!1);var f=function e(t){var r=t.data,n=t.expandedKeys,a=t.searchValue,o=t.filters,i=t.expanded,c=t.defaultExpandAllRows,l=t.expectData,s=void 0===l?[]:l;if(!a||0===r.length)return r||[];var u=!1,d=o.length;return a=a.toLocaleLowerCase(),r.map((function(t){var r,l=!1,f=t.values,h=JSON.parse(JSON.stringify(t,(function(e,t){return"children"===e&&"[object Array]"===Object.prototype.toString.call(t)?null:t})));for(var p in f)if(u=0===d||-1!==o.indexOf(p),r=String(f[p].display||f[p].value).toLocaleLowerCase(),u&&r&&-1!==r.indexOf(a)){l=!0;break}Array.isArray(t.children)&&(h.children=e({data:t.children,expandedKeys:n,searchValue:a,filters:o,expanded:i,defaultExpandAllRows:c,expectData:[]}),0===h.children.length&&(h.children=null)),(l||h.children&&h.children.length>0)&&s.push(h),(l||h.children&&h.children.length>0)&&(i||c)&&n.push(t.key||t.rowId)})),s}({data:u,searchValue:r,filters:a,expandedKeys:d,expanded:i,defaultExpandAllRows:l,expectData:[]});s.setData({data:f,shouldForceUpdate:!1}),console.log(u),s.setStore("searchValue",r,!1),s.setStore("expandedKeys",d,!1),s.refresh((function(){}))}},updataDataSource:function(e,t){var r=re.call(this,e);if(r){var n=r.getData();if(t){var a=t(JSON.parse(JSON.stringify(n)));Array.isArray(a)&&(r.setCache("cacheData",a),r.setData({data:a}))}else console.warn("请传回调参数，并且返回新的数据源")}},setCheckedKeys:function(e,t,r){var n=re.call(this,e);if(n){var a=n.getStore("checkedKeys");t=r?Object.assign(a,t):Object.assign({},t),n.setStore("checkedKeys",t)}},setSelectedRow:function(e,t){var r=re.call(this,e);r&&r.setStore("currentSelectedRow",t)},updateChildRow:function(e,t,r){var n=re.call(this,e);if(n){var a=n.getStore("rowId"),o=n.getStore("currentRow"),i=n.getData(),c=[],l="root";o&&(l=o.key),r&&(l=r.key);!function e(t,r){t.length&&t.map((function(t){var n=t.values[a];t.values[a]=n&&void 0!==n.value?n:{value:Object(u.getSafeRandom)()},t.key=t.rowId=t.values[a].value,t.values.pid||(t.values.pid={value:r}),t.hasOwnProperty("isleaf")&&!t.isleaf&&(t.children=t.children||[],e(t.children,t.key))}))}(c=Array.isArray(t)?t:[c],l),function e(t,r){for(var n=t.length;n--;){var a=t[n];if(a.rowId===r)return t[n].children=c,t[n].isleaf=!1,!0;if(Array.isArray(a.children)&&e(a.children,r))return!0}}(i,l)||(i=c),n.setStore("searchValue",null)}}};function Oe(){return this.register("treeTable",H),function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){Se(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},je.call(this,Ce))}function je(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t[a]=e[a].bind(this)}return t}Oe.component=Y,Oe.displayName="TreeTable",Oe.unfinished=["treeTableUnFinishedApi"]},42:function(e,t){e.exports=o},5:function(e,t,r){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)&&n.length){var i=a.apply(null,n);i&&e.push(i)}else if("object"===o)for(var c in n)r.call(n,c)&&n[c]&&e.push(c)}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},6:function(e,t){e.exports=n}})}));
//# sourceMappingURL=index.js.map