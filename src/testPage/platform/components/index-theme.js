(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("react"), require("@platform/api/index"), require("@platform/base/index"), require("react-dom"), require("@platform/table-core/index"), require("@platform/template/index"), require("@platform/form/index"), require("axios"));
	else if(typeof define === 'function' && define.amd)
		define(["react", "@platform/api/index", "@platform/base/index", "react-dom", "@platform/table-core/index", "@platform/template/index", "@platform/form/index", "axios"], factory);
	else if(typeof exports === 'object')
		exports["@platform/components/index"] = factory(require("react"), require("@platform/api/index"), require("@platform/base/index"), require("react-dom"), require("@platform/table-core/index"), require("@platform/template/index"), require("@platform/form/index"), require("axios"));
	else
		root["@platform/components/index"] = factory(root["React"], root["@platform/api/index"], root["@platform/base/index"], root["ReactDOM"], root["@platform/table-core/index"], root["@platform/template/index"], root["@platform/form/index"], root["axios"]);
})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__3__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__7__, __WEBPACK_EXTERNAL_MODULE__12__, __WEBPACK_EXTERNAL_MODULE__24__, __WEBPACK_EXTERNAL_MODULE__62__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "../../../../platform/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1914);
/******/ })
/************************************************************************/
/******/ ({

/***/ 0:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__0__;

/***/ }),

/***/ 1:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__1__;

/***/ }),

/***/ 107:
/***/ (function(module, exports, __webpack_require__) {

var Symbol = __webpack_require__(93),
    getRawTag = __webpack_require__(328),
    objectToString = __webpack_require__(329);

/** `Object#toString` result references. */
var nullTag = '[object Null]',
    undefinedTag = '[object Undefined]';

/** Built-in value references. */
var symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  if (value == null) {
    return value === undefined ? undefinedTag : nullTag;
  }
  return (symToStringTag && symToStringTag in Object(value))
    ? getRawTag(value)
    : objectToString(value);
}

module.exports = baseGetTag;


/***/ }),

/***/ 110:
/***/ (function(module, exports) {

/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */
function eq(value, other) {
  return value === other || (value !== value && other !== other);
}

module.exports = eq;


/***/ }),

/***/ 115:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 117:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HotKeys", function() { return HotKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "withHotKeys", function() { return withHotKeys; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FocusTrap", function() { return FocusTrap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HotKeyMapMixin", function() { return HotKeyMapMixin; });
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var lodash_isequal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(23);
/* harmony import */ var lodash_isequal__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_isequal__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(6);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var lodash_isboolean__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(69);
/* harmony import */ var lodash_isboolean__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_isboolean__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var lodash_isobject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(70);
/* harmony import */ var lodash_isobject__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(lodash_isobject__WEBPACK_IMPORTED_MODULE_5__);
/**
 * ISC License
 *
 * Copyright (c) 2018, Aleck Greenham
 *
 * Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

var classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},objectWithoutProperties=function(e,t){var o={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},FocusTrap=function(e){function t(){return classCallCheck(this,t),possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return inherits(t,react__WEBPACK_IMPORTED_MODULE_1__["Component"]),createClass(t,[{key:"render",value:function(){var e=this.props,t=e.component,o=e.children,n=objectWithoutProperties(e,["component","children"]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(t,_extends({tabIndex:"-1"},n),o)}}]),t}();function sequencesFromKeyMap(e,t){var o=e[t];return o?Array.isArray(o)?o:[o]:[t]}function hasChanged(e,t){return!lodash_isequal__WEBPACK_IMPORTED_MODULE_2___default()(e,t)}FocusTrap.propTypes={onFocus:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.func,onBlur:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.func,component:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.func,prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.string]),children:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.node},FocusTrap.defaultProps={component:"div"};var HotKeys=function(e){function t(e,o){classCallCheck(this,t);var n=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o));return n.onFocus=n.onFocus.bind(n),n.onBlur=n.onBlur.bind(n),n}return inherits(t,react__WEBPACK_IMPORTED_MODULE_1__["Component"]),createClass(t,[{key:"getChildContext",value:function(){return{hotKeyParent:this,hotKeyMap:this.__hotKeyMap__}}},{key:"componentWillMount",value:function(){this.updateMap()}},{key:"updateMap",value:function(){var e=this.buildMap();return!lodash_isequal__WEBPACK_IMPORTED_MODULE_2___default()(e,this.__hotKeyMap__)&&(this.__hotKeyMap__=e,!0)}},{key:"buildMap",value:function(){var e=this.context.hotKeyMap||{},t=this.props.keyMap||{};return _extends({},e,t)}},{key:"getMap",value:function(){return this.__hotKeyMap__}},{key:"componentDidMount",value:function(){var e=__webpack_require__(118);this.__mousetrap__=new e(this.props.attach||react_dom__WEBPACK_IMPORTED_MODULE_3___default.a.findDOMNode(this)),this.updateHotKeys(!0)}},{key:"componentDidUpdate",value:function(e){this.updateHotKeys(!1,e)}},{key:"componentWillUnmount",value:function(){this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(null),this.__mousetrap__&&this.__mousetrap__.reset()}},{key:"updateHotKeys",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.props.handlers,n=void 0===o?{}:o,r=t.handlers,s=void 0===r?n:r,a=this.updateMap();(e||a||hasChanged(n,s))&&(this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(null),this.syncHandlersToMousetrap())}},{key:"syncHandlersToMousetrap",value:function(){var e=this,t=this.props.handlers,o=void 0===t?{}:t,n=this.getMap(),r=[],s=this.__mousetrap__;Object.keys(o).forEach(function(t){var s=o[t];sequencesFromKeyMap(n,t).forEach(function(t){var o=void 0;lodash_isobject__WEBPACK_IMPORTED_MODULE_5___default()(t)&&(o=t.action,t=t.sequence),r.push({callback:function(t,o){if((lodash_isboolean__WEBPACK_IMPORTED_MODULE_4___default()(e.props.focused)?e.props.focused:e.__isFocused__)&&o!==e.__lastChildSequence__)return e.context.hotKeyParent&&e.context.hotKeyParent.childHandledSequence(o),s(t,o)},action:o,sequence:t})})}),s.reset(),r.forEach(function(e){var t=e.sequence,o=e.callback,n=e.action;return s.bind(t,o,n)})}},{key:"childHandledSequence",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.__lastChildSequence__=e,this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(e)}},{key:"render",value:function(){var e=this.props,t=(e.keyMap,e.handlers,e.focused,e.attach,e.children),o=objectWithoutProperties(e,["keyMap","handlers","focused","attach","children"]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(FocusTrap,_extends({},o,{onFocus:this.onFocus,onBlur:this.onBlur}),t)}},{key:"onFocus",value:function(){var e;(this.__isFocused__=!0,this.props.onFocus)&&(e=this.props).onFocus.apply(e,arguments)}},{key:"onBlur",value:function(){var e;(this.__isFocused__=!1,this.props.onBlur)&&(e=this.props).onBlur.apply(e,arguments);this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(null)}}]),t}();HotKeys.propTypes={keyMap:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object,handlers:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object,focused:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.bool,attach:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.any,children:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.node,onFocus:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.func,onBlur:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.func},HotKeys.childContextTypes={hotKeyParent:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.any,hotKeyMap:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object},HotKeys.contextTypes={hotKeyParent:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.any,hotKeyMap:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object};var withHotKeys=function(e){return function(t){return function(o){function n(e){classCallCheck(this,n);var t=possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t._setRef=t._setRef.bind(t),t.state={handlers:{}},t}return inherits(n,react__WEBPACK_IMPORTED_MODULE_1__["PureComponent"]),createClass(n,[{key:"componentDidMount",value:function(){this.setState({handlers:this._ref.hotKeyHandlers})}},{key:"_setRef",value:function(e){this._ref=e}},{key:"render",value:function(){var o=this.state.handlers;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(HotKeys,{component:"document-fragment",keyMap:e,handlers:o},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(t,_extends({ref:this._setRef},this.props)))}}]),n}()}};function HotKeyMapMixin(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{contextTypes:{hotKeyMap:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object},childContextTypes:{hotKeyMap:prop_types__WEBPACK_IMPORTED_MODULE_0___default.a.object},getChildContext:function(){return{hotKeyMap:this.__hotKeyMap__}},componentWillMount:function(){this.updateMap()},updateMap:function(){var e=this.buildMap();return!lodash_isequal__WEBPACK_IMPORTED_MODULE_2___default()(e,this.__hotKeyMap__)&&(this.__hotKeyMap__=e,!0)},buildMap:function(){var t=this.context.hotKeyMap||{},o=this.props.keyMap||{};return _extends({},t,e,o)},getMap:function(){return this.__hotKeyMap__}}}


/***/ }),

/***/ 118:
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_RESULT__;/*global define:false */
/**
 * Copyright 2012-2017 Craig Campbell
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Mousetrap is a simple keyboard shortcut library for Javascript with
 * no external dependencies
 *
 * @version 1.6.5
 * @url craig.is/killing/mice
 */
(function(window, document, undefined) {

    // Check if mousetrap is used inside browser, if not, return
    if (!window) {
        return;
    }

    /**
     * mapping of special keycodes to their corresponding keys
     *
     * everything in this dictionary cannot use keypress events
     * so it has to be here to map to the correct keycodes for
     * keyup/keydown events
     *
     * @type {Object}
     */
    var _MAP = {
        8: 'backspace',
        9: 'tab',
        13: 'enter',
        16: 'shift',
        17: 'ctrl',
        18: 'alt',
        20: 'capslock',
        27: 'esc',
        32: 'space',
        33: 'pageup',
        34: 'pagedown',
        35: 'end',
        36: 'home',
        37: 'left',
        38: 'up',
        39: 'right',
        40: 'down',
        45: 'ins',
        46: 'del',
        91: 'meta',
        93: 'meta',
        224: 'meta'
    };

    /**
     * mapping for special characters so they can support
     *
     * this dictionary is only used incase you want to bind a
     * keyup or keydown event to one of these keys
     *
     * @type {Object}
     */
    var _KEYCODE_MAP = {
        106: '*',
        107: '+',
        109: '-',
        110: '.',
        111 : '/',
        186: ';',
        187: '=',
        188: ',',
        189: '-',
        190: '.',
        191: '/',
        192: '`',
        219: '[',
        220: '\\',
        221: ']',
        222: '\''
    };

    /**
     * this is a mapping of keys that require shift on a US keypad
     * back to the non shift equivelents
     *
     * this is so you can use keyup events with these keys
     *
     * note that this will only work reliably on US keyboards
     *
     * @type {Object}
     */
    var _SHIFT_MAP = {
        '~': '`',
        '!': '1',
        '@': '2',
        '#': '3',
        '$': '4',
        '%': '5',
        '^': '6',
        '&': '7',
        '*': '8',
        '(': '9',
        ')': '0',
        '_': '-',
        '+': '=',
        ':': ';',
        '\"': '\'',
        '<': ',',
        '>': '.',
        '?': '/',
        '|': '\\'
    };

    /**
     * this is a list of special strings you can use to map
     * to modifier keys when you specify your keyboard shortcuts
     *
     * @type {Object}
     */
    var _SPECIAL_ALIASES = {
        'option': 'alt',
        'command': 'meta',
        'return': 'enter',
        'escape': 'esc',
        'plus': '+',
        'mod': /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? 'meta' : 'ctrl'
    };

    /**
     * variable to store the flipped version of _MAP from above
     * needed to check if we should use keypress or not when no action
     * is specified
     *
     * @type {Object|undefined}
     */
    var _REVERSE_MAP;

    /**
     * loop through the f keys, f1 to f19 and add them to the map
     * programatically
     */
    for (var i = 1; i < 20; ++i) {
        _MAP[111 + i] = 'f' + i;
    }

    /**
     * loop through to map numbers on the numeric keypad
     */
    for (i = 0; i <= 9; ++i) {

        // This needs to use a string cause otherwise since 0 is falsey
        // mousetrap will never fire for numpad 0 pressed as part of a keydown
        // event.
        //
        // @see https://github.com/ccampbell/mousetrap/pull/258
        _MAP[i + 96] = i.toString();
    }

    /**
     * cross browser add event method
     *
     * @param {Element|HTMLDocument} object
     * @param {string} type
     * @param {Function} callback
     * @returns void
     */
    function _addEvent(object, type, callback) {
        if (object.addEventListener) {
            object.addEventListener(type, callback, false);
            return;
        }

        object.attachEvent('on' + type, callback);
    }

    /**
     * takes the event and returns the key character
     *
     * @param {Event} e
     * @return {string}
     */
    function _characterFromEvent(e) {

        // for keypress events we should return the character as is
        if (e.type == 'keypress') {
            var character = String.fromCharCode(e.which);

            // if the shift key is not pressed then it is safe to assume
            // that we want the character to be lowercase.  this means if
            // you accidentally have caps lock on then your key bindings
            // will continue to work
            //
            // the only side effect that might not be desired is if you
            // bind something like 'A' cause you want to trigger an
            // event when capital A is pressed caps lock will no longer
            // trigger the event.  shift+a will though.
            if (!e.shiftKey) {
                character = character.toLowerCase();
            }

            return character;
        }

        // for non keypress events the special maps are needed
        if (_MAP[e.which]) {
            return _MAP[e.which];
        }

        if (_KEYCODE_MAP[e.which]) {
            return _KEYCODE_MAP[e.which];
        }

        // if it is not in the special map

        // with keydown and keyup events the character seems to always
        // come in as an uppercase character whether you are pressing shift
        // or not.  we should make sure it is always lowercase for comparisons
        return String.fromCharCode(e.which).toLowerCase();
    }

    /**
     * checks if two arrays are equal
     *
     * @param {Array} modifiers1
     * @param {Array} modifiers2
     * @returns {boolean}
     */
    function _modifiersMatch(modifiers1, modifiers2) {
        return modifiers1.sort().join(',') === modifiers2.sort().join(',');
    }

    /**
     * takes a key event and figures out what the modifiers are
     *
     * @param {Event} e
     * @returns {Array}
     */
    function _eventModifiers(e) {
        var modifiers = [];

        if (e.shiftKey) {
            modifiers.push('shift');
        }

        if (e.altKey) {
            modifiers.push('alt');
        }

        if (e.ctrlKey) {
            modifiers.push('ctrl');
        }

        if (e.metaKey) {
            modifiers.push('meta');
        }

        return modifiers;
    }

    /**
     * prevents default for this event
     *
     * @param {Event} e
     * @returns void
     */
    function _preventDefault(e) {
        if (e.preventDefault) {
            e.preventDefault();
            return;
        }

        e.returnValue = false;
    }

    /**
     * stops propogation for this event
     *
     * @param {Event} e
     * @returns void
     */
    function _stopPropagation(e) {
        if (e.stopPropagation) {
            e.stopPropagation();
            return;
        }

        e.cancelBubble = true;
    }

    /**
     * determines if the keycode specified is a modifier key or not
     *
     * @param {string} key
     * @returns {boolean}
     */
    function _isModifier(key) {
        return key == 'shift' || key == 'ctrl' || key == 'alt' || key == 'meta';
    }

    /**
     * reverses the map lookup so that we can look for specific keys
     * to see what can and can't use keypress
     *
     * @return {Object}
     */
    function _getReverseMap() {
        if (!_REVERSE_MAP) {
            _REVERSE_MAP = {};
            for (var key in _MAP) {

                // pull out the numeric keypad from here cause keypress should
                // be able to detect the keys from the character
                if (key > 95 && key < 112) {
                    continue;
                }

                if (_MAP.hasOwnProperty(key)) {
                    _REVERSE_MAP[_MAP[key]] = key;
                }
            }
        }
        return _REVERSE_MAP;
    }

    /**
     * picks the best action based on the key combination
     *
     * @param {string} key - character for key
     * @param {Array} modifiers
     * @param {string=} action passed in
     */
    function _pickBestAction(key, modifiers, action) {

        // if no action was picked in we should try to pick the one
        // that we think would work best for this key
        if (!action) {
            action = _getReverseMap()[key] ? 'keydown' : 'keypress';
        }

        // modifier keys don't work as expected with keypress,
        // switch to keydown
        if (action == 'keypress' && modifiers.length) {
            action = 'keydown';
        }

        return action;
    }

    /**
     * Converts from a string key combination to an array
     *
     * @param  {string} combination like "command+shift+l"
     * @return {Array}
     */
    function _keysFromString(combination) {
        if (combination === '+') {
            return ['+'];
        }

        combination = combination.replace(/\+{2}/g, '+plus');
        return combination.split('+');
    }

    /**
     * Gets info for a specific key combination
     *
     * @param  {string} combination key combination ("command+s" or "a" or "*")
     * @param  {string=} action
     * @returns {Object}
     */
    function _getKeyInfo(combination, action) {
        var keys;
        var key;
        var i;
        var modifiers = [];

        // take the keys from this pattern and figure out what the actual
        // pattern is all about
        keys = _keysFromString(combination);

        for (i = 0; i < keys.length; ++i) {
            key = keys[i];

            // normalize key names
            if (_SPECIAL_ALIASES[key]) {
                key = _SPECIAL_ALIASES[key];
            }

            // if this is not a keypress event then we should
            // be smart about using shift keys
            // this will only work for US keyboards however
            if (action && action != 'keypress' && _SHIFT_MAP[key]) {
                key = _SHIFT_MAP[key];
                modifiers.push('shift');
            }

            // if this key is a modifier then add it to the list of modifiers
            if (_isModifier(key)) {
                modifiers.push(key);
            }
        }

        // depending on what the key combination is
        // we will try to pick the best event for it
        action = _pickBestAction(key, modifiers, action);

        return {
            key: key,
            modifiers: modifiers,
            action: action
        };
    }

    function _belongsTo(element, ancestor) {
        if (element === null || element === document) {
            return false;
        }

        if (element === ancestor) {
            return true;
        }

        return _belongsTo(element.parentNode, ancestor);
    }

    function Mousetrap(targetElement) {
        var self = this;

        targetElement = targetElement || document;

        if (!(self instanceof Mousetrap)) {
            return new Mousetrap(targetElement);
        }

        /**
         * element to attach key events to
         *
         * @type {Element}
         */
        self.target = targetElement;

        /**
         * a list of all the callbacks setup via Mousetrap.bind()
         *
         * @type {Object}
         */
        self._callbacks = {};

        /**
         * direct map of string combinations to callbacks used for trigger()
         *
         * @type {Object}
         */
        self._directMap = {};

        /**
         * keeps track of what level each sequence is at since multiple
         * sequences can start out with the same sequence
         *
         * @type {Object}
         */
        var _sequenceLevels = {};

        /**
         * variable to store the setTimeout call
         *
         * @type {null|number}
         */
        var _resetTimer;

        /**
         * temporary state where we will ignore the next keyup
         *
         * @type {boolean|string}
         */
        var _ignoreNextKeyup = false;

        /**
         * temporary state where we will ignore the next keypress
         *
         * @type {boolean}
         */
        var _ignoreNextKeypress = false;

        /**
         * are we currently inside of a sequence?
         * type of action ("keyup" or "keydown" or "keypress") or false
         *
         * @type {boolean|string}
         */
        var _nextExpectedAction = false;

        /**
         * resets all sequence counters except for the ones passed in
         *
         * @param {Object} doNotReset
         * @returns void
         */
        function _resetSequences(doNotReset) {
            doNotReset = doNotReset || {};

            var activeSequences = false,
                key;

            for (key in _sequenceLevels) {
                if (doNotReset[key]) {
                    activeSequences = true;
                    continue;
                }
                _sequenceLevels[key] = 0;
            }

            if (!activeSequences) {
                _nextExpectedAction = false;
            }
        }

        /**
         * finds all callbacks that match based on the keycode, modifiers,
         * and action
         *
         * @param {string} character
         * @param {Array} modifiers
         * @param {Event|Object} e
         * @param {string=} sequenceName - name of the sequence we are looking for
         * @param {string=} combination
         * @param {number=} level
         * @returns {Array}
         */
        function _getMatches(character, modifiers, e, sequenceName, combination, level) {
            var i;
            var callback;
            var matches = [];
            var action = e.type;

            // if there are no events related to this keycode
            if (!self._callbacks[character]) {
                return [];
            }

            // if a modifier key is coming up on its own we should allow it
            if (action == 'keyup' && _isModifier(character)) {
                modifiers = [character];
            }

            // loop through all callbacks for the key that was pressed
            // and see if any of them match
            for (i = 0; i < self._callbacks[character].length; ++i) {
                callback = self._callbacks[character][i];

                // if a sequence name is not specified, but this is a sequence at
                // the wrong level then move onto the next match
                if (!sequenceName && callback.seq && _sequenceLevels[callback.seq] != callback.level) {
                    continue;
                }

                // if the action we are looking for doesn't match the action we got
                // then we should keep going
                if (action != callback.action) {
                    continue;
                }

                // if this is a keypress event and the meta key and control key
                // are not pressed that means that we need to only look at the
                // character, otherwise check the modifiers as well
                //
                // chrome will not fire a keypress if meta or control is down
                // safari will fire a keypress if meta or meta+shift is down
                // firefox will fire a keypress if meta or control is down
                if ((action == 'keypress' && !e.metaKey && !e.ctrlKey) || _modifiersMatch(modifiers, callback.modifiers)) {

                    // when you bind a combination or sequence a second time it
                    // should overwrite the first one.  if a sequenceName or
                    // combination is specified in this call it does just that
                    //
                    // @todo make deleting its own method?
                    var deleteCombo = !sequenceName && callback.combo == combination;
                    var deleteSequence = sequenceName && callback.seq == sequenceName && callback.level == level;
                    if (deleteCombo || deleteSequence) {
                        self._callbacks[character].splice(i, 1);
                    }

                    matches.push(callback);
                }
            }

            return matches;
        }

        /**
         * actually calls the callback function
         *
         * if your callback function returns false this will use the jquery
         * convention - prevent default and stop propogation on the event
         *
         * @param {Function} callback
         * @param {Event} e
         * @returns void
         */
        function _fireCallback(callback, e, combo, sequence) {

            // if this event should not happen stop here
            if (self.stopCallback(e, e.target || e.srcElement, combo, sequence)) {
                return;
            }

            if (callback(e, combo) === false) {
                _preventDefault(e);
                _stopPropagation(e);
            }
        }

        /**
         * handles a character key event
         *
         * @param {string} character
         * @param {Array} modifiers
         * @param {Event} e
         * @returns void
         */
        self._handleKey = function(character, modifiers, e) {
            var callbacks = _getMatches(character, modifiers, e);
            var i;
            var doNotReset = {};
            var maxLevel = 0;
            var processedSequenceCallback = false;

            // Calculate the maxLevel for sequences so we can only execute the longest callback sequence
            for (i = 0; i < callbacks.length; ++i) {
                if (callbacks[i].seq) {
                    maxLevel = Math.max(maxLevel, callbacks[i].level);
                }
            }

            // loop through matching callbacks for this key event
            for (i = 0; i < callbacks.length; ++i) {

                // fire for all sequence callbacks
                // this is because if for example you have multiple sequences
                // bound such as "g i" and "g t" they both need to fire the
                // callback for matching g cause otherwise you can only ever
                // match the first one
                if (callbacks[i].seq) {

                    // only fire callbacks for the maxLevel to prevent
                    // subsequences from also firing
                    //
                    // for example 'a option b' should not cause 'option b' to fire
                    // even though 'option b' is part of the other sequence
                    //
                    // any sequences that do not match here will be discarded
                    // below by the _resetSequences call
                    if (callbacks[i].level != maxLevel) {
                        continue;
                    }

                    processedSequenceCallback = true;

                    // keep a list of which sequences were matches for later
                    doNotReset[callbacks[i].seq] = 1;
                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo, callbacks[i].seq);
                    continue;
                }

                // if there were no sequence matches but we are still here
                // that means this is a regular match so we should fire that
                if (!processedSequenceCallback) {
                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo);
                }
            }

            // if the key you pressed matches the type of sequence without
            // being a modifier (ie "keyup" or "keypress") then we should
            // reset all sequences that were not matched by this event
            //
            // this is so, for example, if you have the sequence "h a t" and you
            // type "h e a r t" it does not match.  in this case the "e" will
            // cause the sequence to reset
            //
            // modifier keys are ignored because you can have a sequence
            // that contains modifiers such as "enter ctrl+space" and in most
            // cases the modifier key will be pressed before the next key
            //
            // also if you have a sequence such as "ctrl+b a" then pressing the
            // "b" key will trigger a "keypress" and a "keydown"
            //
            // the "keydown" is expected when there is a modifier, but the
            // "keypress" ends up matching the _nextExpectedAction since it occurs
            // after and that causes the sequence to reset
            //
            // we ignore keypresses in a sequence that directly follow a keydown
            // for the same character
            var ignoreThisKeypress = e.type == 'keypress' && _ignoreNextKeypress;
            if (e.type == _nextExpectedAction && !_isModifier(character) && !ignoreThisKeypress) {
                _resetSequences(doNotReset);
            }

            _ignoreNextKeypress = processedSequenceCallback && e.type == 'keydown';
        };

        /**
         * handles a keydown event
         *
         * @param {Event} e
         * @returns void
         */
        function _handleKeyEvent(e) {

            // normalize e.which for key events
            // @see http://stackoverflow.com/questions/4285627/javascript-keycode-vs-charcode-utter-confusion
            if (typeof e.which !== 'number') {
                e.which = e.keyCode;
            }

            var character = _characterFromEvent(e);

            // no character found then stop
            if (!character) {
                return;
            }

            // need to use === for the character check because the character can be 0
            if (e.type == 'keyup' && _ignoreNextKeyup === character) {
                _ignoreNextKeyup = false;
                return;
            }

            self.handleKey(character, _eventModifiers(e), e);
        }

        /**
         * called to set a 1 second timeout on the specified sequence
         *
         * this is so after each key press in the sequence you have 1 second
         * to press the next key before you have to start over
         *
         * @returns void
         */
        function _resetSequenceTimer() {
            clearTimeout(_resetTimer);
            _resetTimer = setTimeout(_resetSequences, 1000);
        }

        /**
         * binds a key sequence to an event
         *
         * @param {string} combo - combo specified in bind call
         * @param {Array} keys
         * @param {Function} callback
         * @param {string=} action
         * @returns void
         */
        function _bindSequence(combo, keys, callback, action) {

            // start off by adding a sequence level record for this combination
            // and setting the level to 0
            _sequenceLevels[combo] = 0;

            /**
             * callback to increase the sequence level for this sequence and reset
             * all other sequences that were active
             *
             * @param {string} nextAction
             * @returns {Function}
             */
            function _increaseSequence(nextAction) {
                return function() {
                    _nextExpectedAction = nextAction;
                    ++_sequenceLevels[combo];
                    _resetSequenceTimer();
                };
            }

            /**
             * wraps the specified callback inside of another function in order
             * to reset all sequence counters as soon as this sequence is done
             *
             * @param {Event} e
             * @returns void
             */
            function _callbackAndReset(e) {
                _fireCallback(callback, e, combo);

                // we should ignore the next key up if the action is key down
                // or keypress.  this is so if you finish a sequence and
                // release the key the final key will not trigger a keyup
                if (action !== 'keyup') {
                    _ignoreNextKeyup = _characterFromEvent(e);
                }

                // weird race condition if a sequence ends with the key
                // another sequence begins with
                setTimeout(_resetSequences, 10);
            }

            // loop through keys one at a time and bind the appropriate callback
            // function.  for any key leading up to the final one it should
            // increase the sequence. after the final, it should reset all sequences
            //
            // if an action is specified in the original bind call then that will
            // be used throughout.  otherwise we will pass the action that the
            // next key in the sequence should match.  this allows a sequence
            // to mix and match keypress and keydown events depending on which
            // ones are better suited to the key provided
            for (var i = 0; i < keys.length; ++i) {
                var isFinal = i + 1 === keys.length;
                var wrappedCallback = isFinal ? _callbackAndReset : _increaseSequence(action || _getKeyInfo(keys[i + 1]).action);
                _bindSingle(keys[i], wrappedCallback, action, combo, i);
            }
        }

        /**
         * binds a single keyboard combination
         *
         * @param {string} combination
         * @param {Function} callback
         * @param {string=} action
         * @param {string=} sequenceName - name of sequence if part of sequence
         * @param {number=} level - what part of the sequence the command is
         * @returns void
         */
        function _bindSingle(combination, callback, action, sequenceName, level) {

            // store a direct mapped reference for use with Mousetrap.trigger
            self._directMap[combination + ':' + action] = callback;

            // make sure multiple spaces in a row become a single space
            combination = combination.replace(/\s+/g, ' ');

            var sequence = combination.split(' ');
            var info;

            // if this pattern is a sequence of keys then run through this method
            // to reprocess each pattern one key at a time
            if (sequence.length > 1) {
                _bindSequence(combination, sequence, callback, action);
                return;
            }

            info = _getKeyInfo(combination, action);

            // make sure to initialize array if this is the first time
            // a callback is added for this key
            self._callbacks[info.key] = self._callbacks[info.key] || [];

            // remove an existing match if there is one
            _getMatches(info.key, info.modifiers, {type: info.action}, sequenceName, combination, level);

            // add this call back to the array
            // if it is a sequence put it at the beginning
            // if not put it at the end
            //
            // this is important because the way these are processed expects
            // the sequence ones to come first
            self._callbacks[info.key][sequenceName ? 'unshift' : 'push']({
                callback: callback,
                modifiers: info.modifiers,
                action: info.action,
                seq: sequenceName,
                level: level,
                combo: combination
            });
        }

        /**
         * binds multiple combinations to the same callback
         *
         * @param {Array} combinations
         * @param {Function} callback
         * @param {string|undefined} action
         * @returns void
         */
        self._bindMultiple = function(combinations, callback, action) {
            for (var i = 0; i < combinations.length; ++i) {
                _bindSingle(combinations[i], callback, action);
            }
        };

        // start!
        _addEvent(targetElement, 'keypress', _handleKeyEvent);
        _addEvent(targetElement, 'keydown', _handleKeyEvent);
        _addEvent(targetElement, 'keyup', _handleKeyEvent);
    }

    /**
     * binds an event to mousetrap
     *
     * can be a single key, a combination of keys separated with +,
     * an array of keys, or a sequence of keys separated by spaces
     *
     * be sure to list the modifier keys first to make sure that the
     * correct key ends up getting bound (the last key in the pattern)
     *
     * @param {string|Array} keys
     * @param {Function} callback
     * @param {string=} action - 'keypress', 'keydown', or 'keyup'
     * @returns void
     */
    Mousetrap.prototype.bind = function(keys, callback, action) {
        var self = this;
        keys = keys instanceof Array ? keys : [keys];
        self._bindMultiple.call(self, keys, callback, action);
        return self;
    };

    /**
     * unbinds an event to mousetrap
     *
     * the unbinding sets the callback function of the specified key combo
     * to an empty function and deletes the corresponding key in the
     * _directMap dict.
     *
     * TODO: actually remove this from the _callbacks dictionary instead
     * of binding an empty function
     *
     * the keycombo+action has to be exactly the same as
     * it was defined in the bind method
     *
     * @param {string|Array} keys
     * @param {string} action
     * @returns void
     */
    Mousetrap.prototype.unbind = function(keys, action) {
        var self = this;
        return self.bind.call(self, keys, function() {}, action);
    };

    /**
     * triggers an event that has already been bound
     *
     * @param {string} keys
     * @param {string=} action
     * @returns void
     */
    Mousetrap.prototype.trigger = function(keys, action) {
        var self = this;
        if (self._directMap[keys + ':' + action]) {
            self._directMap[keys + ':' + action]({}, keys);
        }
        return self;
    };

    /**
     * resets the library back to its initial state.  this is useful
     * if you want to clear out the current keyboard shortcuts and bind
     * new ones - for example if you switch to another page
     *
     * @returns void
     */
    Mousetrap.prototype.reset = function() {
        var self = this;
        self._callbacks = {};
        self._directMap = {};
        return self;
    };

    /**
     * should we stop this event before firing off callbacks
     *
     * @param {Event} e
     * @param {Element} element
     * @return {boolean}
     */
    Mousetrap.prototype.stopCallback = function(e, element) {
        var self = this;

        // if the element has the class "mousetrap" then no need to stop
        if ((' ' + element.className + ' ').indexOf(' mousetrap ') > -1) {
            return false;
        }

        if (_belongsTo(element, self.target)) {
            return false;
        }

        // Events originating from a shadow DOM are re-targetted and `e.target` is the shadow host,
        // not the initial event target in the shadow tree. Note that not all events cross the
        // shadow boundary.
        // For shadow trees with `mode: 'open'`, the initial event target is the first element in
        // the event’s composed path. For shadow trees with `mode: 'closed'`, the initial event
        // target cannot be obtained.
        if ('composedPath' in e && typeof e.composedPath === 'function') {
            // For open shadow trees, update `element` so that the following check works.
            var initialEventTarget = e.composedPath()[0];
            if (initialEventTarget !== e.target) {
                element = initialEventTarget;
            }
        }

        // stop for input, select, and textarea
        return element.tagName == 'INPUT' || element.tagName == 'SELECT' || element.tagName == 'TEXTAREA' || element.isContentEditable;
    };

    /**
     * exposes _handleKey publicly so it can be overwritten by extensions
     */
    Mousetrap.prototype.handleKey = function() {
        var self = this;
        return self._handleKey.apply(self, arguments);
    };

    /**
     * allow custom key mappings
     */
    Mousetrap.addKeycodes = function(object) {
        for (var key in object) {
            if (object.hasOwnProperty(key)) {
                _MAP[key] = object[key];
            }
        }
        _REVERSE_MAP = null;
    };

    /**
     * Init the global mousetrap functions
     *
     * This method is needed to allow the global mousetrap functions to work
     * now that mousetrap is a constructor function.
     */
    Mousetrap.init = function() {
        var documentMousetrap = Mousetrap(document);
        for (var method in documentMousetrap) {
            if (method.charAt(0) !== '_') {
                Mousetrap[method] = (function(method) {
                    return function() {
                        return documentMousetrap[method].apply(documentMousetrap, arguments);
                    };
                } (method));
            }
        }
    };

    Mousetrap.init();

    // expose mousetrap to the global object
    window.Mousetrap = Mousetrap;

    // expose as a common js module
    if ( true && module.exports) {
        module.exports = Mousetrap;
    }

    // expose mousetrap as an AMD module
    if (true) {
        !(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {
            return Mousetrap;
        }).call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
    }
}) (typeof window !== 'undefined' ? window : null, typeof  window !== 'undefined' ? document : null);


/***/ }),

/***/ 12:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__12__;

/***/ }),

/***/ 13:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return feConfigName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return getCheckedMethod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return getCheckedExtendMethod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return beforeAndAfter; });
/* harmony import */ var _const__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(19);
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }


var feConfigName = _const__WEBPACK_IMPORTED_MODULE_0__["name"];
var getCheckedMethod = function getCheckedMethod(obj, name, defaultf) {
  return obj && typeof obj[name] === 'function' ? obj[name] : defaultf || _const__WEBPACK_IMPORTED_MODULE_0__["emptyf"];
};
var getCheckedExtendMethod = function getCheckedExtendMethod(obj, name, defaultf) {
  // console.log('二开相关回调方法', config, name);
  if (name === 'templateAlreadyLoaded') {
    console.log('二开相关回调方法', _const__WEBPACK_IMPORTED_MODULE_0__, name);
  } // 有些特殊情况 取不到this对象上的方法


  if (obj && (!obj[_const__WEBPACK_IMPORTED_MODULE_0__["name"]] || JSON.stringify(obj[_const__WEBPACK_IMPORTED_MODULE_0__["name"]]) === '{}')) {
    obj = window;
  }

  return obj && obj[_const__WEBPACK_IMPORTED_MODULE_0__["name"]] ? getCheckedMethod(obj[_const__WEBPACK_IMPORTED_MODULE_0__["name"]], name, defaultf) : defaultf || _const__WEBPACK_IMPORTED_MODULE_0__["emptyf"];
}; // export const decoratorZ = function (target, name, descriptor) {
// 	var oldValue = descriptor.value;
// 	descriptor.value = function () {
// 		console.log(`before ${name}`, this);
// 		let res = oldValue.apply(this, arguments);
// 		console.log(`after ${name}`);
// 		return res;
// 	};
// 	return descriptor;
// };

var defaultFxConfig = {
  onAfterEvent: 'after',
  // after before replace remian
  onBeforeEvent: 'before',
  onEditTableAfterEvent: 'after',
  // after before replace remian
  onEditTableBeforeEvent: 'before',
  onFormAfterEvent: 'after',
  // after before replace remian
  onFormBeforeEvent: 'before',
  onCardTableAfterEvent: 'after',
  // after before replace remian
  onCardTableBeforeEvent: 'before'
};

function testType(origin) {
  return Object.prototype.toString.call(origin).slice(8, -1);
}

var beforeAndAfter = function beforeAndAfter(pageScope) {
  var info = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var fy = arguments.length > 2 ? arguments[2] : undefined;
  var fx = arguments.length > 3 ? arguments[3] : undefined;

  //有些特殊情况 取不到this对象上的方法
  if (JSON.stringify(pageScope[_const__WEBPACK_IMPORTED_MODULE_0__["name"]]) === '{}') {
    pageScope = window;
  } // console.log('二开相关回调方法', info);


  if (!pageScope[_const__WEBPACK_IMPORTED_MODULE_0__["name"]] || !info || !info['attrcode'] || !info['fxType']) {
    return fy();
  }

  var attrcode = info.attrcode,
      _info$moduleId = info.moduleId,
      moduleId = _info$moduleId === void 0 ? '' : _info$moduleId,
      _info$fxType = info.fxType,
      fxType = _info$fxType === void 0 ? 'onAfterEvent' : _info$fxType,
      _info$fxParams = info.fxParams,
      fxParams = _info$fxParams === void 0 ? {} : _info$fxParams,
      fe = pageScope[_const__WEBPACK_IMPORTED_MODULE_0__["name"]],
      fxConfig = _objectSpread(_objectSpread(_objectSpread({}, defaultFxConfig), fe['defaultFxConfig'] || {}), fe[moduleId + '-' + attrcode] || {}); // 获取对应的回调方法


  fx = fx || getCheckedExtendMethod(pageScope, fxType); // console.log(fxConfig, info, fe['defaultFxConfig']);

  if (fxConfig[fxType] === 'mixin') {
    return fx(fxParams, fy);
  } else if (fxConfig[fxType] === 'replace') {
    return fx(fxParams);
  } else if (fxConfig[fxType] === 'before') {
    var orderResult = fx(fxParams); // 可以考虑添加异步处理

    if (testType(orderResult) === 'AsyncFunction') {
      return new Promise(function (resolve) {
        orderResult().then(function (data) {
          fy();
          resolve(data);
        });
      });
    } else if (testType(orderResult) === 'Promise') {
      return new Promise(function (resolve) {
        orderResult.then(function (data) {
          fy(); // 这里也可能是异步关系

          resolve(data);
        });
      });
    } else {
      return fy();
    }
  } else {
    var _orderResult = fy(); // 可以考虑添加异步处理


    if (testType(_orderResult) === 'AsyncFunction') {
      return new Promise(function (resolve) {
        _orderResult().then(function (data) {
          fx(fxParams);
          resolve(data);
        });
      });
    } else if (testType(_orderResult) === 'Promise') {
      return new Promise(function (resolve) {
        _orderResult.then(function (data) {
          fx(fxParams); // 这里也可能是异步关系

          resolve(data);
        });
      });
    } else {
      return fx(fxParams);
    }
  }
};
/* unused harmony default export */ var _unused_webpack_default_export = ({
  getCheckedExtendMethod: getCheckedExtendMethod,
  getCheckedMethod: getCheckedMethod,
  beforeAndAfter: beforeAndAfter,
  feConfigName: feConfigName
});

/***/ }),

/***/ 146:
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(107),
    isObject = __webpack_require__(87);

/** `Object#toString` result references. */
var asyncTag = '[object AsyncFunction]',
    funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    proxyTag = '[object Proxy]';

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  if (!isObject(value)) {
    return false;
  }
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 9 which returns 'object' for typed arrays and other constructors.
  var tag = baseGetTag(value);
  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
}

module.exports = isFunction;


/***/ }),

/***/ 147:
/***/ (function(module, exports) {

/**
 * A specialized version of `_.map` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 */
function arrayMap(array, iteratee) {
  var index = -1,
      length = array == null ? 0 : array.length,
      result = Array(length);

  while (++index < length) {
    result[index] = iteratee(array[index], index, array);
  }
  return result;
}

module.exports = arrayMap;


/***/ }),

/***/ 15:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MODULE_TYPE; });
var MODULE_TYPE = {
  form: 'form',
  cardTable: 'cardTable',
  editTable: 'editTable'
};


/***/ }),

/***/ 154:
/***/ (function(module, exports, __webpack_require__) {

var identity = __webpack_require__(372),
    overRest = __webpack_require__(729),
    setToString = __webpack_require__(731);

/**
 * The base implementation of `_.rest` which doesn't validate or coerce arguments.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @returns {Function} Returns the new function.
 */
function baseRest(func, start) {
  return setToString(overRest(func, start, identity), func + '');
}

module.exports = baseRest;


/***/ }),

/***/ 170:
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;

module.exports = freeGlobal;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(36)))

/***/ }),

/***/ 171:
/***/ (function(module, exports, __webpack_require__) {

var mapCacheClear = __webpack_require__(330),
    mapCacheDelete = __webpack_require__(349),
    mapCacheGet = __webpack_require__(351),
    mapCacheHas = __webpack_require__(352),
    mapCacheSet = __webpack_require__(353);

/**
 * Creates a map cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function MapCache(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

// Add methods to `MapCache`.
MapCache.prototype.clear = mapCacheClear;
MapCache.prototype['delete'] = mapCacheDelete;
MapCache.prototype.get = mapCacheGet;
MapCache.prototype.has = mapCacheHas;
MapCache.prototype.set = mapCacheSet;

module.exports = MapCache;


/***/ }),

/***/ 178:
/***/ (function(module, exports, __webpack_require__) {

var isArrayLike = __webpack_require__(373),
    isObjectLike = __webpack_require__(94);

/**
 * This method is like `_.isArrayLike` except that it also checks if `value`
 * is an object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array-like object,
 *  else `false`.
 * @example
 *
 * _.isArrayLikeObject([1, 2, 3]);
 * // => true
 *
 * _.isArrayLikeObject(document.body.children);
 * // => true
 *
 * _.isArrayLikeObject('abc');
 * // => false
 *
 * _.isArrayLikeObject(_.noop);
 * // => false
 */
function isArrayLikeObject(value) {
  return isObjectLike(value) && isArrayLike(value);
}

module.exports = isArrayLikeObject;


/***/ }),

/***/ 18:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return getCellIdentity; });
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_0__);

/**
 * @desc 获得单元格的唯一Id
 * @param td {dom}
 */

function getCellIdentity(td) {
  var div = td.querySelector('div');

  if (div && div.attributes) {
    var attributesArray = Object.values(div.attributes);
    var cellIdentity = attributesArray.find(function (item) {
      if (item && item.value.startsWith(_platform_api__WEBPACK_IMPORTED_MODULE_0__["config"].hotKeyModuleIdPrefix)) {
        return item;
      }
    });
    return cellIdentity && cellIdentity.value;
  }
}

/***/ }),

/***/ 1892:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1893:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1894:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1895:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1896:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1897:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1898:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1899:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 19:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "name", function() { return name; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "emptyf", function() { return emptyf; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "enable", function() { return enable; });
var name = 'NCCExtend';
var emptyf = function emptyf() {};
var enable = window.NCCExtendEable || true;
/* harmony default export */ __webpack_exports__["default"] = ({
  name: name,
  emptyf: emptyf,
  enable: enable
});

/***/ }),

/***/ 1900:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1901:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1902:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1903:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1904:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1905:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1906:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1907:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1908:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1909:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1910:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1911:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 1914:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, "BillHeadInfo", function() { return /* reexport */ BillHeadInfo; });
__webpack_require__.d(__webpack_exports__, "Button", function() { return /* reexport */ Button; });
__webpack_require__.d(__webpack_exports__, "ButtonApp", function() { return /* reexport */ components_ButtonApp; });
__webpack_require__.d(__webpack_exports__, "CardPagination", function() { return /* reexport */ components_CardPagination; });
__webpack_require__.d(__webpack_exports__, "CreateModal", function() { return /* reexport */ CreateModal_namespaceObject; });
__webpack_require__.d(__webpack_exports__, "CreateSearch", function() { return /* reexport */ CreateSearch; });
__webpack_require__.d(__webpack_exports__, "CreateNCModal", function() { return /* reexport */ CreateNCModal_namespaceObject; });
__webpack_require__.d(__webpack_exports__, "CreateUploader", function() { return /* reexport */ CreateUploader_namespaceObject; });
__webpack_require__.d(__webpack_exports__, "CrossServiceBtns", function() { return /* reexport */ CrossServiceBtns; });
__webpack_require__.d(__webpack_exports__, "ConnectSocket", function() { return /* reexport */ connect_SocketConnect; });
__webpack_require__.d(__webpack_exports__, "DragWidthCom", function() { return /* reexport */ DragWidthCom["a" /* default */]; });
__webpack_require__.d(__webpack_exports__, "HotkeyHelper", function() { return /* reexport */ components_HotkeyHelper; });
__webpack_require__.d(__webpack_exports__, "InsertTable", function() { return /* reexport */ InsertTable; });
__webpack_require__.d(__webpack_exports__, "PrintOutput", function() { return /* reexport */ PrintOutput_PrintOutput; });
__webpack_require__.d(__webpack_exports__, "PrintOutputModal", function() { return /* reexport */ PrintOutputModal_PrintOutputModal; });
__webpack_require__.d(__webpack_exports__, "output", function() { return /* reexport */ PrintOutputModal_output; });
__webpack_require__.d(__webpack_exports__, "PrintTemplate", function() { return /* reexport */ PrintTemplate_PrintTemplate; });
__webpack_require__.d(__webpack_exports__, "print", function() { return /* reexport */ print; });
__webpack_require__.d(__webpack_exports__, "printer", function() { return /* reexport */ printer; });
__webpack_require__.d(__webpack_exports__, "PromptBox", function() { return /* reexport */ PromptBox_PromptBox; });
__webpack_require__.d(__webpack_exports__, "promptBox", function() { return /* reexport */ PromptBox_promptBox; });
__webpack_require__.d(__webpack_exports__, "Socket", function() { return /* reexport */ components_Socket; });
__webpack_require__.d(__webpack_exports__, "AsyncTree", function() { return /* reexport */ AsyncTree_output; });
__webpack_require__.d(__webpack_exports__, "SyncTree", function() { return /* reexport */ SyncTree_output; });
__webpack_require__.d(__webpack_exports__, "Transfer", function() { return /* reexport */ Transfer_Transfer; });
__webpack_require__.d(__webpack_exports__, "TreeTableManyCol", function() { return /* reexport */ TreeTable["default"]; });
__webpack_require__.d(__webpack_exports__, "WithAutoFocus", function() { return /* reexport */ components_WithAutoFocus; });
__webpack_require__.d(__webpack_exports__, "WithKeyboardChange", function() { return /* reexport */ WithKeyboardChange; });
__webpack_require__.d(__webpack_exports__, "mutiInit", function() { return /* reexport */ MutiInit_namespaceObject; });
__webpack_require__.d(__webpack_exports__, "FormulaEditor", function() { return /* reexport */ FormulaEditor_FormulaEditor; });

// NAMESPACE OBJECT: ./src/platform/components/CreateModal/index.js
var CreateModal_namespaceObject = {};
__webpack_require__.r(CreateModal_namespaceObject);
__webpack_require__.d(CreateModal_namespaceObject, "createModal", function() { return createModal; });
__webpack_require__.d(CreateModal_namespaceObject, "show", function() { return methods_show; });
__webpack_require__.d(CreateModal_namespaceObject, "close", function() { return methods_close; });

// NAMESPACE OBJECT: ./src/platform/components/CreateNCModal/index.js
var CreateNCModal_namespaceObject = {};
__webpack_require__.r(CreateNCModal_namespaceObject);
__webpack_require__.d(CreateNCModal_namespaceObject, "createModal", function() { return createModal_createModal; });
__webpack_require__.d(CreateNCModal_namespaceObject, "show", function() { return CreateNCModal_methods_show; });
__webpack_require__.d(CreateNCModal_namespaceObject, "close", function() { return CreateNCModal_methods_close; });

// NAMESPACE OBJECT: ./src/platform/components/CreateUploader/index.js
var CreateUploader_namespaceObject = {};
__webpack_require__.r(CreateUploader_namespaceObject);
__webpack_require__.d(CreateUploader_namespaceObject, "createUploader", function() { return createUploader; });
__webpack_require__.d(CreateUploader_namespaceObject, "show", function() { return CreateUploader_methods_show; });
__webpack_require__.d(CreateUploader_namespaceObject, "close", function() { return CreateUploader_methods_close; });

// NAMESPACE OBJECT: ./src/platform/components/Tree/AsyncTree/compatible.js
var compatible_namespaceObject = {};
__webpack_require__.r(compatible_namespaceObject);
__webpack_require__.d(compatible_namespaceObject, "createAsyncTree", function() { return createAsyncTree; });
__webpack_require__.d(compatible_namespaceObject, "createTreeData", function() { return compatible_createTreeData; });
__webpack_require__.d(compatible_namespaceObject, "setTreeData", function() { return setTreeData; });
__webpack_require__.d(compatible_namespaceObject, "setNodeChecked", function() { return setNodeChecked; });
__webpack_require__.d(compatible_namespaceObject, "addTreeData", function() { return addTreeData; });
__webpack_require__.d(compatible_namespaceObject, "getAsyncTreeValue", function() { return getAsyncTreeValue; });
__webpack_require__.d(compatible_namespaceObject, "delTreeData", function() { return delTreeData; });
__webpack_require__.d(compatible_namespaceObject, "editTreeData", function() { return editTreeData; });
__webpack_require__.d(compatible_namespaceObject, "setAsyncNodeDisable", function() { return setAsyncNodeDisable; });
__webpack_require__.d(compatible_namespaceObject, "setTreeEdit", function() { return setTreeEdit; });
__webpack_require__.d(compatible_namespaceObject, "getSelectNodeAsync", function() { return getSelectNodeAsync; });
__webpack_require__.d(compatible_namespaceObject, "openNodeByPkAsync", function() { return openNodeByPkAsync; });
__webpack_require__.d(compatible_namespaceObject, "closeNodeByPkAsync", function() { return closeNodeByPkAsync; });
__webpack_require__.d(compatible_namespaceObject, "hideIconAsync", function() { return hideIconAsync; });
__webpack_require__.d(compatible_namespaceObject, "addBrotherNodeAsync", function() { return addBrotherNodeAsync; });
__webpack_require__.d(compatible_namespaceObject, "setNodeSelectedAsync", function() { return setNodeSelectedAsync; });
__webpack_require__.d(compatible_namespaceObject, "cancelSelectedNodeAsync", function() { return cancelSelectedNodeAsync; });

// NAMESPACE OBJECT: ./src/platform/components/Tree/SyncTree/compatible.js
var SyncTree_compatible_namespaceObject = {};
__webpack_require__.r(SyncTree_compatible_namespaceObject);
__webpack_require__.d(SyncTree_compatible_namespaceObject, "createSyncTree", function() { return createSyncTree; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setSyncTreeData", function() { return setSyncTreeData; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "editNodeSuccess", function() { return editNodeSuccess; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "handleEidAddDisbale", function() { return handleEidAddDisbale; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "handleEidAddNoDisbale", function() { return handleEidAddNoDisbale; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "addNodeSuccess", function() { return addNodeSuccess; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "delNodeSuceess", function() { return delNodeSuceess; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getSyncTreeValue", function() { return getSyncTreeValue; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setNodeDisable", function() { return setNodeDisable; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setTreeEdit", function() { return compatible_setTreeEdit; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getSelectNode", function() { return getSelectNode; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "openNodeByPk", function() { return openNodeByPk; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "closeNodeByPk", function() { return closeNodeByPk; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "createTreeData", function() { return SyncTree_compatible_createTreeData; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getTreeData", function() { return getTreeData; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "hideIcon", function() { return hideIcon; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setIconVisible", function() { return setIconVisible; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "addBrotherNode", function() { return addBrotherNode; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setNodeSelected", function() { return setNodeSelected; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setNodeChecked", function() { return compatible_setNodeChecked; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getCheckedKeys", function() { return getCheckedKeys; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "cancelSelectedNode", function() { return cancelSelectedNode; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setLeafNodeEdit", function() { return setLeafNodeEdit; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "moveNode", function() { return moveNode; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getMoveNodeKey", function() { return getMoveNodeKey; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getHoverNodeKey", function() { return getHoverNodeKey; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getSearchChangeEven", function() { return getSearchChangeEven; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "setTreeItemIcons", function() { return setTreeItemIcons; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "getItem", function() { return compatible_getItem; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "showAddTreeItemModal", function() { return showAddTreeItemModal; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "showEditTreeItemModal", function() { return showEditTreeItemModal; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "showDeleteTreeItemModal", function() { return showDeleteTreeItemModal; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "updataDataSource", function() { return updataDataSource; });
__webpack_require__.d(SyncTree_compatible_namespaceObject, "updataTreeNode", function() { return updataTreeNode; });

// NAMESPACE OBJECT: ./src/platform/components/MutiInit/index.js
var MutiInit_namespaceObject = {};
__webpack_require__.r(MutiInit_namespaceObject);
__webpack_require__.d(MutiInit_namespaceObject, "init", function() { return MutiInit_init; });
__webpack_require__.d(MutiInit_namespaceObject, "getIntl", function() { return getIntl; });

// EXTERNAL MODULE: external {"root":"React","var":"React","commonjs":"react","commonjs2":"react","amd":"react"}
var external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_ = __webpack_require__(0);
var external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default = /*#__PURE__*/__webpack_require__.n(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_);

// EXTERNAL MODULE: external "@platform/api/index"
var index_ = __webpack_require__(1);

// EXTERNAL MODULE: external "@platform/base/index"
var base_index_ = __webpack_require__(3);

// CONCATENATED MODULE: ./src/platform/components/BillHeadInfo/BillInfo.js
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-04 11:11:55
 * @Description: file content
 */



__webpack_require__(1892);



var BillInfo_BillInfo = /*#__PURE__*/function (_Component) {
  _inherits(BillInfo, _Component);

  var _super = _createSuper(BillInfo);

  function BillInfo(props) {
    var _this;

    _classCallCheck(this, BillInfo);

    _this = _super.call(this, props);

    _this.props.getThis(_assertThisInitialized(_this));

    _this.state = {
      showBackBtn: true,
      showBillCode: true,
      billCode: _this.props.events.billCode,
      title: _this.props.events.title
    };
    return _this;
  }

  _createClass(BillInfo, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      if (nextProps.events.title !== this.props.events.title) {
        this.setState({
          title: nextProps.events.title
        });
      }
    }
  }, {
    key: "render",
    value: function render() {
      var events = this.props.events;
      var _this$state = this.state,
          showBackBtn = _this$state.showBackBtn,
          showBillCode = _this$state.showBillCode,
          billCode = _this$state.billCode,
          _this$state$title = _this$state.title,
          title = _this$state$title === void 0 ? '' : _this$state$title;
      var _events$initShowBackB = events.initShowBackBtn,
          initShowBackBtn = _events$initShowBackB === void 0 ? true : _events$initShowBackB,
          backBtnClick = events.backBtnClick,
          titleClick = events.titleClick; // let pageIcon = !showBackBtn && (typeof createPageIcon === 'function') ? createPageIcon() : null;

      var pageIcon = typeof index_["createPageIcon"] === 'function' ? Object(index_["createPageIcon"])() : null;
      var fontClass = window.nccFontSize || window.top.nccFontSize || Object(index_["getGlobalStorage"])('localStorage', 'nccFontSize') || '';
      var titleFontSize = '';

      if (fontClass) {
        switch (fontClass) {
          case 'large':
            titleFontSize = 'title-font-size-large';
            break;

          case 'medium':
            titleFontSize = 'title-font-size-medium';
            break;

          default:
            break;
        }
      }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "BillHeadInfoWrap ".concat(showBackBtn && initShowBackBtn ? 'BillHeadInfoWrap-showBackBtn' : '')
      }, showBackBtn && initShowBackBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["BackBtn"], {
        onClick: backBtnClick && backBtnClick
      }), pageIcon, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "bill-info-title ".concat(titleFontSize),
        fieldid: Object(index_["getSysFieldid"])("".concat(title, "_title")),
        onClick: function onClick() {
          if (typeof titleClick === "function") {
            titleClick();
          }
        }
      }, title), showBillCode && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "bill-info-code"
      }, billCode && "\uFF1A".concat(billCode)));
    }
  }]);

  return BillInfo;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/BillHeadInfo/create.js
 //创建单据号

/**
 * 
 * @param {*} events : {showBackBtn:true,billCodeText:''}
 */

function createBillHeadInfo(events) {
  var _this2 = this;

  return /*#__PURE__*/React.createElement(BillInfo_BillInfo, {
    getThis: function getThis(_this) {
      _this2.myBillInfo = _this;
    },
    events: events,
    output: this.output,
    rootprops: this.props
  });
}
// CONCATENATED MODULE: ./src/platform/components/BillHeadInfo/methods.js
function setBillHeadInfoVisible(data) {
  if (this.myBillInfo && this.myBillInfo.state && data) {
    //控制返回按钮
    if (data.hasOwnProperty('showBackBtn')) {
      if (data.showBackBtn != this.myBillInfo.state.showBackBtn) {
        this.myBillInfo.state.showBackBtn = data.showBackBtn;
      }
    } //控制单据编号


    if (data.hasOwnProperty('showBillCode')) {
      if (data.showBillCode != this.myBillInfo.state.showBillCode) {
        this.myBillInfo.state.showBillCode = data.showBillCode;
      }
    } //修改单据编号


    if (data.hasOwnProperty('billCode')) {
      if (data.billCode != this.myBillInfo.state.billCode) {
        this.myBillInfo.state.billCode = data.billCode;
      }
    } //修改标题


    if (data.hasOwnProperty('title')) {
      if (data.title != this.myBillInfo.state.title) {
        this.myBillInfo.state.title = data.title;
      }
    }

    this.myBillInfo.setState(this.myBillInfo.state);
  }
}
// CONCATENATED MODULE: ./src/platform/components/BillHeadInfo/index.js


/* harmony default export */ var BillHeadInfo = ({
  createBillHeadInfo: createBillHeadInfo,
  setBillHeadInfoVisible: setBillHeadInfoVisible
});
// CONCATENATED MODULE: ./src/platform/components/Button/create.js
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-04 14:24:29
 * @Description: file content
 */

 // require('./index.less');

function create_createButton(id) {
  var _this = this;

  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  // console.log('页面调用了createButton方法，请使用createButtonApp方法重新创建按钮，后续createButton将删除');
  var _config$disabled = config.disabled,
      disabled = _config$disabled === void 0 ? false : _config$disabled,
      _config$name = config.name,
      name = _config$name === void 0 ? '' : _config$name,
      onButtonClick = config.onButtonClick,
      _config$buttonColor = config.buttonColor,
      buttonColor = _config$buttonColor === void 0 ? '' : _config$buttonColor,
      others = _objectWithoutProperties(config, ["disabled", "name", "onButtonClick", "buttonColor"]);

  if (!this.state.button.hasOwnProperty(id)) {
    //初始化
    this.state.button[id] = {
      disabled: disabled
    };
    this.state.button[id] = Object.assign(this.state.button[id], config);
  }

  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], _extends({
    disabled: this.state.button[id].disabled,
    onClick: function onClick() {
      if (window.top.proxyAction) {
        window.top.proxyAction(onButtonClick, _this, name)(_objectSpread(_objectSpread({}, _this.props), _this.output), id);
      } else if (typeof onButtonClick === 'function') {
        onButtonClick.call(_this, _objectSpread(_objectSpread({}, _this.props), _this.output), id); //$PE.proxy(onButtonClick, this, name)({ ...this.props, ...this.output }, id);
      }
    }
  }, others, {
    color: buttonColor,
    id: id,
    className: "".concat(!this.state.button[id].hasOwnProperty('visible') || this.state.button[id].visible ? 'show' : 'hide', "  button-component ").concat(buttonColor)
  }), name);
}
// CONCATENATED MODULE: ./src/platform/components/Button/methods.js
function methods_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

 // 根据 key(id) 从树形嵌套结构中获取按钮

var findItemsByKey = function findItemsByKey(key, data) {
  var items = [];

  var process = function process(tree) {
    return tree.forEach(function (item) {
      if (item.key == key) {
        items.push(item);
      } else if (item.children) {
        process(item.children);
      }
    });
  };

  process(data);
  return items;
}; // 将按钮的自定义属性(visible，disabled，popContent，主要次要按钮)存储在this.myState.btnInfo中，作用是可以在按钮数据请求回来前就可以设置按钮自定义属性


function addCustomAttribute(key, attr, value) {
  var btnInfo = this.myState.btnInfo;
  btnInfo[key] = btnInfo[key] || {};
  btnInfo[key][attr] = value;
} // 将编码为buttonID的按钮的attr属性的值设为value


function setButtonAttribute(buttonId, attr, value) {
  var _this = this;

  if (typeof buttonId == 'string') {
    // 把按钮的自定义信息存到btnInfo里
    addCustomAttribute.call(this, buttonId, attr, value); // 已经有按钮数据，将自定义数据合并到原有的按钮数据中

    var items = findItemsByKey(buttonId, this.myState.buttons);
    items.forEach(function (item) {
      item[attr] = value;

      if (attr === 'disabled') {
        if (item.type === 'divider') {
          item['disabled'] = value;
        } else {
          item['isenable'] = !value;
        }
      } // 把子按钮的visible设为true时,要把子按钮所在的父级同时设为true


      if (attr === 'visible' && item.parentCode) {
        if (value) {
          setButtonAttribute.call(_this, item.parentCode, 'visible', true);
        }
      }
    });
  } else if (buttonId instanceof Array) {
    buttonId.forEach(function (item) {
      addCustomAttribute.call(_this, item, attr, value);
    });

    for (var i = 0; i < buttonId.length; i++) {
      var _items = findItemsByKey(buttonId[i], this.myState.buttons);

      _items.forEach(function (item) {
        item[attr] = value;

        if (attr === 'disabled') {
          if (item.type === 'divider') {
            item['disabled'] = value;
          } else {
            item['isenable'] = !value;
          }
        }

        if (attr === 'visible' && item.parentCode) {
          if (value) {
            setButtonAttribute.call(_this, item.parentCode, 'visible', true);
          }
        }
      });
    }
  } else if (Object(index_["isObj"])(buttonId)) {
    var _loop = function _loop() {
      var key = _Object$keys[_i];
      addCustomAttribute.call(_this, key, attr, buttonId[key]);
      var items = findItemsByKey(key, _this.myState.buttons);
      items.forEach(function (item) {
        item[attr] = buttonId[key];

        if (attr === 'disabled') {
          if (item.type === 'divider') {
            item['disabled'] = buttonId[key];
          } else {
            item['isenable'] = !buttonId[key];
          }
        }

        if (attr === 'visible' && item.parentCode) {
          if (buttonId[key]) {
            setButtonAttribute.call(_this, item.parentCode, 'visible', true);
          }
        }
      });
    };

    for (var _i = 0, _Object$keys = Object.keys(buttonId); _i < _Object$keys.length; _i++) {
      _loop();
    }
  }
} //获取按钮的数据


function getButtons() {
  return this.myState.buttons;
}

function setButtonState(buttonId, callback) {
  // let buttons = this.myState.buttons;
  var buttonsEntrys = this.myState.buttonsEntrys;
  var buttonsComponent = this.myState.buttonsComponent;
  var stopOprationBtnsRenderAreas = this.myState.stopOprationBtnsRenderAreas;
  var refName = [];
  var stopBtnRenderAreas = [];

  for (var _i2 = 0, _Object$keys2 = Object.keys(stopOprationBtnsRenderAreas); _i2 < _Object$keys2.length; _i2++) {
    var item = _Object$keys2[_i2];
    stopOprationBtnsRenderAreas.hasOwnProperty(item) && !stopOprationBtnsRenderAreas[item] && stopBtnRenderAreas.push(item);
  }

  if (Array.isArray(buttonId)) {
    var _iterator = _createForOfIteratorHelper(buttonId),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var ids = _step.value;

        if (buttonsEntrys[ids]) {
          var _iterator2 = _createForOfIteratorHelper(buttonsEntrys[ids]),
              _step2;

          try {
            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
              var id = _step2.value;

              if (!refName.includes(id)) {
                refName.push(id);
              }
            }
          } catch (err) {
            _iterator2.e(err);
          } finally {
            _iterator2.f();
          }
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  }

  refName = refName.filter(function (item) {
    return !stopBtnRenderAreas.includes(item);
  });

  if (callback) {
    var len = refName.length;

    var _iterator3 = _createForOfIteratorHelper(refName),
        _step3;

    try {
      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
        var _item = _step3.value;
        len = len - 1;

        if (buttonsComponent[_item]) {
          if (buttonsComponent[_item]._isOperateButton) {
            for (var uuid in buttonsComponent[_item]) {
              buttonsComponent[_item][uuid] && buttonsComponent[_item][uuid].setState && buttonsComponent[_item][uuid].setState({
                json: []
              }, function () {});
            }
          } else {
            buttonsComponent[_item].setState({
              json: []
            }, function () {});
          }
        }
      }
    } catch (err) {
      _iterator3.e(err);
    } finally {
      _iterator3.f();
    }

    if (typeof callback === 'function' && !len) {
      callback && callback();
    }
  } else {
    var _iterator4 = _createForOfIteratorHelper(refName),
        _step4;

    try {
      for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {
        var _item2 = _step4.value;

        if (buttonsComponent[_item2]) {
          if (buttonsComponent[_item2]._isOperateButton) {
            for (var _uuid in buttonsComponent[_item2]) {
              buttonsComponent[_item2][_uuid] && buttonsComponent[_item2][_uuid].setState && buttonsComponent[_item2][_uuid].setState({
                json: []
              }, function () {});
            }
          } else {
            buttonsComponent[_item2].setState({
              json: []
            }, function () {});
          }
        }
      }
    } catch (err) {
      _iterator4.e(err);
    } finally {
      _iterator4.f();
    }
  }
}

function buttonIdToArr(buttonId) {
  var buttonIds = [];

  if (typeof buttonId == 'string') {
    buttonIds = [buttonId];
  } else if (Array.isArray(buttonId)) {
    var _iterator5 = _createForOfIteratorHelper(buttonId),
        _step5;

    try {
      for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {
        var it = _step5.value;
        !buttonIds.includes(it) && buttonIds.push(it);
      }
    } catch (err) {
      _iterator5.e(err);
    } finally {
      _iterator5.f();
    }
  } else if (Object(index_["isObj"])(buttonId)) {
    for (var _i3 = 0, _Object$keys3 = Object.keys(buttonId); _i3 < _Object$keys3.length; _i3++) {
      var _it = _Object$keys3[_i3];
      !buttonIds.includes(_it) && buttonIds.push(_it);
    }
  }

  return buttonIds;
}

function areaToArr(areaStr) {
  var areaArr = [];

  if (areaStr.indexOf(',') !== -1) {
    areaArr = areaStr.split(',').map(function (item) {
      return item.trim();
    });
  } else {
    areaArr = [areaStr];
  }

  return areaArr;
} //隐藏所传区域的所有按钮


function hideButtonsByAreas(areas) {
  // 先合并btnInfo中已有的自定义属性，再setState
  if (typeof areas === 'string') {
    this.myState.hideButtonMenu = [areas];
  } else {
    this.myState.hideButtonMenu = areas;
  }
} //设置按钮的数据

function setButtons(buttons, callback) {
  // 先合并btnInfo中已有的自定义属性，再setState
  var _this$myState = this.myState,
      btnInfo = _this$myState.btnInfo,
      hideButtonMenu = _this$myState.hideButtonMenu;
  var btnKeys = Object.keys(btnInfo);
  btnKeys.forEach(function (key) {
    var items = findItemsByKey(key, buttons);
    items.forEach(function (item) {
      if (item.type === 'divider') {
        if (btnInfo[key]) {
          for (var _i4 = 0, _Object$keys4 = Object.keys(btnInfo[key]); _i4 < _Object$keys4.length; _i4++) {
            var it = _Object$keys4[_i4];

            if (it === 'type') {
              Object.assign(item, {
                dividerType: btnInfo[key].type === 'button_main',
                dropdownType: btnInfo[key].type === 'button_main'
              });
            } else {
              Object.assign(item, methods_defineProperty({}, it, btnInfo[key][it]));
            }
          }
        } else {
          Object.assign(item, btnInfo[key]);
        }
      } else {
        Object.assign(item, btnInfo[key]);
      }
    });
  });
  this.myState.buttons = buttons;

  if (hideButtonMenu) {
    var _iterator6 = _createForOfIteratorHelper(this.myState.buttons),
        _step6;

    try {
      for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {
        var item = _step6.value;

        if (hideButtonMenu.includes(item.area)) {
          item.visible = false;
        }
      }
    } catch (err) {
      _iterator6.e(err);
    } finally {
      _iterator6.f();
    }
  }

  var keys = [];
  var areas = [];
  var keysOAreas = {};

  if (this.myState.buttons) {
    var _iterator7 = _createForOfIteratorHelper(this.myState.buttons),
        _step7;

    try {
      for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {
        var items = _step7.value;

        if (items.key) {
          !keys.includes(items.key) && keys.push(items.key);

          if (!keysOAreas.hasOwnProperty(items.key)) {
            keysOAreas[items.key] = items.area ? [items.area] : [];
          } else {
            if (!keysOAreas[items.key].includes(items.area)) {
              keysOAreas[items.key].push(items.area);
            }
          }
        }

        var areaArr = areaToArr(items.area);

        var _iterator8 = _createForOfIteratorHelper(areaArr),
            _step8;

        try {
          for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {
            var _i5 = _step8.value;
            !areas.includes(_i5) && areas.push(_i5);
          }
        } catch (err) {
          _iterator8.e(err);
        } finally {
          _iterator8.f();
        }

        if (items.children) {
          if (items.children && items.children.length) {
            var _iterator9 = _createForOfIteratorHelper(items.children),
                _step9;

            try {
              for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {
                var _item3 = _step9.value;

                if (_item3.key) {
                  !keys.includes(_item3.key) && keys.push(_item3.key);

                  if (!keysOAreas.hasOwnProperty(_item3.key)) {
                    keysOAreas[_item3.key] = _item3.area ? [_item3.area] : [];
                  } else {
                    if (!keysOAreas[_item3.key].includes(_item3.area)) {
                      keysOAreas[_item3.key].push(_item3.area);
                    }
                  }
                }

                if (_item3.children && _item3.children.length) {
                  var _iterator10 = _createForOfIteratorHelper(_item3.children),
                      _step10;

                  try {
                    for (_iterator10.s(); !(_step10 = _iterator10.n()).done;) {
                      var it = _step10.value;

                      if (it.key) {
                        !keys.includes(it.key) && keys.push(it.key);

                        if (!keysOAreas.hasOwnProperty(it.key)) {
                          keysOAreas[it.key] = items.area ? [it.area] : [];
                        } else {
                          if (!keysOAreas[it.key].includes(it.area)) {
                            keysOAreas[it.key].push(it.area);
                          }
                        }
                      }

                      if (it.children && it.children.length) {
                        var _iterator11 = _createForOfIteratorHelper(it.children),
                            _step11;

                        try {
                          for (_iterator11.s(); !(_step11 = _iterator11.n()).done;) {
                            var i = _step11.value;

                            if (i.key) {
                              !keys.includes(i.key) && keys.push(i.key);

                              if (!keysOAreas.hasOwnProperty(i.key)) {
                                keysOAreas[i.key] = items.area ? [i.area] : [];
                              } else {
                                if (!keysOAreas[i.key].includes(i.area)) {
                                  keysOAreas[i.key].push(i.area);
                                }
                              }
                            }
                          }
                        } catch (err) {
                          _iterator11.e(err);
                        } finally {
                          _iterator11.f();
                        }
                      }
                    }
                  } catch (err) {
                    _iterator10.e(err);
                  } finally {
                    _iterator10.f();
                  }
                }
              }
            } catch (err) {
              _iterator9.e(err);
            } finally {
              _iterator9.f();
            }
          }
        }
      }
    } catch (err) {
      _iterator7.e(err);
    } finally {
      _iterator7.f();
    }
  }

  this.myState.buttonsEntrys = keysOAreas;
  setButtonState.call(this, keys, callback, areas);
} //更新某些区域的按钮

function updateButtons(buttonsAreas) {
  var buttonsComponent = this.myState.buttonsComponent;

  var _iterator12 = _createForOfIteratorHelper(buttonsAreas),
      _step12;

  try {
    for (_iterator12.s(); !(_step12 = _iterator12.n()).done;) {
      var item = _step12.value;

      if (buttonsComponent[item]) {
        if (buttonsComponent[item]._isOperateButton) {
          for (var uuid in buttonsComponent[item]) {
            buttonsComponent[item][uuid] && buttonsComponent[item][uuid].setState && buttonsComponent[item][uuid].setState({
              json: []
            }, function () {
              console.log('update成功');
            });
          }
        } else {
          buttonsComponent[item].setState({
            json: []
          }, function () {
            console.log('update成功');
          });
        }
      }
    }
  } catch (err) {
    _iterator12.e(err);
  } finally {
    _iterator12.f();
  }
} // 获取按钮可用性

function getButtonDisabled(id) {
  var items = findItemsByKey(id, this.myState.buttons);

  if (items.length === 0) {
    console.error("\u627E\u4E0D\u5230\u7F16\u7801\u4E3A ".concat(id, " \u7684\u6309\u94AE"));
  } else {
    // 相同的 id 的按钮的禁用状态是一致的
    return !!items[0].disabled;
  }
} // 获取按钮可见性

function getButtonVisible(id) {
  var items = findItemsByKey(id, this.myState.buttons);

  if (items.length === 0) {
    console.error("\u627E\u4E0D\u5230\u7F16\u7801\u4E3A ".concat(id, " \u7684\u6309\u94AE"));
  } else {
    // 相同的 id 的按钮的禁用状态是一致的
    return !!items[0].visible || !!items[0].enabled;
  }
} // 设置按钮可用性

function setButtonDisabled(buttonId, flag, area) {
  // 参数格式 1. ({buttonid:true/false}) 2.('buttonid':true/false) 3.(['buttonid1','buttonid2'],true/false)
  if (area) {
    setButtonAttributeByArea.call(this, area, buttonId, 'disabled', flag);
    setButtonStateByArea.call(this, area, buttonIdToArr(buttonId));
  } else {
    setButtonAttribute.call(this, buttonId, 'disabled', flag);

    if (getButtons.call(this).length) {
      setButtonState.call(this, buttonIdToArr(buttonId));
    }
  }
} // 设置按钮的显隐性

function setButtonVisible(buttonId, flag) {
  var _this2 = this;

  setButtonAttribute.call(this, buttonId, 'visible', flag);

  if (flag) {
    var items = findItemsByKey(buttonId[0], this.myState.buttons);
    items.forEach(function (item) {
      if (item.parentCode) {
        // debugger;
        setButtonAttribute.call(_this2, item.parentCode, 'visible', true);
      }
    });
  }

  if (getButtons.call(this).length) {
    setButtonState.call(this, buttonIdToArr(buttonId));
  }
} // 设置按钮的中文名

function setButtonTitle(buttonId, flag) {
  setButtonAttribute.call(this, buttonId, 'title', flag);

  if (getButtons.call(this).length) {
    setButtonState.call(this, buttonIdToArr(buttonId));
  }
} // 由于之前有个方法名称是setButtonsVisible, 现已把该方法的功能合并到了上一个方法setButtonVisible中, 但为了兼容业务组以前的代码, 这里保留该方法名

var setButtonsVisible = setButtonVisible; // 设置主要按钮和次要按钮 用来改变按钮的颜色

function setMainButton(buttonId, flag) {
  var MAIN = 'button_main',
      SECONDARY = 'button_secondary';

  if (Object(index_["isObj"])(buttonId)) {
    for (var _i6 = 0, _Object$keys5 = Object.keys(buttonId); _i6 < _Object$keys5.length; _i6++) {
      var key = _Object$keys5[_i6];
      // 传进来的buttonId[key]值为true或false,转成主要和次要按钮对应的class名
      buttonId[key] = buttonId[key] ? MAIN : SECONDARY;
    }
  }

  var value = flag ? MAIN : SECONDARY;
  setButtonAttribute.call(this, buttonId, 'btncolor', value);

  if (getButtons.call(this).length) {
    setButtonState.call(this, buttonIdToArr(buttonId));
  }
} // 设置操作行确认提示内容框，只对表格操作列中的按钮有效， 当content为空字符串的时候 不提示

function setPopContent(buttonId, content) {
  setButtonAttribute.call(this, buttonId, 'popContent', content);

  if (getButtons.call(this).length) {
    setButtonState.call(this, buttonIdToArr(buttonId));
  }
} // 设置按钮为上传按钮

function setUploadConfig(buttonId, config) {
  setButtonAttribute.call(this, buttonId, 'uploadConfig', config);

  if (getButtons.call(this).length) {
    setButtonState.call(this, buttonIdToArr(buttonId));
  }
} // 设置上传按钮附件数量

function setUploadDocAmount(buttonId, amount) {
  setButtonAttribute.call(this, buttonId, 'docAmount', amount);

  if (getButtons.call(this).length) {
    setButtonState.call(this, buttonIdToArr(buttonId));
  }
} // 设置操作行区域是否刷新

function setOprationBtnsRenderStatus(areas, flag) {
  var _iterator13 = _createForOfIteratorHelper(areas),
      _step13;

  try {
    for (_iterator13.s(); !(_step13 = _iterator13.n()).done;) {
      var item = _step13.value;
      this.myState.stopOprationBtnsRenderAreas[item] = flag;
    }
  } catch (err) {
    _iterator13.e(err);
  } finally {
    _iterator13.f();
  }
} //setButtonDisabled 给业务组提供了两个名字一个是setButtonDisabled 另一个是 setDisabled

var setDisabled = setButtonDisabled;

function setButtonAttributeByArea(area, buttonId, attr, value) {
  var _this3 = this;

  if (typeof buttonId == 'string') {
    // 已经有按钮数据，将自定义数据合并到原有的按钮数据中
    var items = findItemsByKey(buttonId, this.myState.buttons).filter(function (item) {
      return area === item.area;
    });
    items.forEach(function (item) {
      item[attr] = value;

      if (attr === 'disabled') {
        if (item.type === 'divider') {
          item['disabled'] = value;
        } else {
          item['isenable'] = !value;
        }
      } // 把子按钮的visible设为true时,要把子按钮所在的父级同时设为true


      if (attr === 'visible' && item.parentCode) {
        if (value) {
          setButtonAttributeByArea.call(_this3, area, item.parentCode, 'visible', true);
        }
      }
    });
  } else if (buttonId instanceof Array) {
    for (var i = 0; i < buttonId.length; i++) {
      var _items2 = findItemsByKey(buttonId[i], this.myState.buttons).filter(function (item) {
        return area === item.area;
      });

      _items2.forEach(function (item) {
        item[attr] = value;

        if (attr === 'disabled') {
          if (item.type === 'divider') {
            item['disabled'] = value;
          } else {
            item['isenable'] = !value;
          }
        }

        if (attr === 'visible' && item.parentCode) {
          if (value) {
            setButtonAttributeByArea.call(_this3, area, item.parentCode, 'visible', true, area);
          }
        }
      });
    }
  } else if (Object(index_["isObj"])(buttonId)) {
    var _loop2 = function _loop2() {
      var key = _Object$keys6[_i7];
      var items = findItemsByKey(key, _this3.myState.buttons).filter(function (item) {
        return area === item.area;
      });
      items.forEach(function (item) {
        item[attr] = buttonId[key];

        if (attr === 'disabled') {
          if (item.type === 'divider') {
            item['disabled'] = buttonId[key];
          } else {
            item['isenable'] = !buttonId[key];
          }
        }

        if (attr === 'visible' && item.parentCode) {
          if (buttonId[key]) {
            setButtonAttributeByArea.call(_this3, area, item.parentCode, 'visible', true);
          }
        }
      });
    };

    for (var _i7 = 0, _Object$keys6 = Object.keys(buttonId); _i7 < _Object$keys6.length; _i7++) {
      _loop2();
    }
  }
}

function setButtonStateByArea(area, callback) {
  var buttonsComponent = this.myState.buttonsComponent;
  var stopOprationBtnsRenderAreas = this.myState.stopOprationBtnsRenderAreas;
  var stopBtnRenderAreas = [];

  for (var _i8 = 0, _Object$keys7 = Object.keys(stopOprationBtnsRenderAreas); _i8 < _Object$keys7.length; _i8++) {
    var item = _Object$keys7[_i8];
    stopOprationBtnsRenderAreas.hasOwnProperty(item) && !stopOprationBtnsRenderAreas[item] && stopBtnRenderAreas.push(item);
  }

  if (!stopBtnRenderAreas.includes(area)) {
    if (buttonsComponent[area]) {
      if (buttonsComponent[area]._isOperateButton) {
        for (var uuid in buttonsComponent[area]) {
          buttonsComponent[area][uuid] && buttonsComponent[area][uuid].setState && buttonsComponent[area][uuid].setState({
            json: []
          }, function () {});
        }
      } else {
        buttonsComponent[area].setState({
          json: []
        }, function () {});
      }

      if (typeof callback === 'function') {
        callback && callback();
      }
    }
  }
}
// CONCATENATED MODULE: ./src/platform/components/Button/index.js


/* harmony default export */ var Button = ({
  createButton: create_createButton,
  setButtonDisabled: setButtonDisabled,
  getButtonDisabled: getButtonDisabled,
  setButtonVisible: setButtonVisible,
  setButtonsVisible: setButtonsVisible,
  setButtonTitle: setButtonTitle,
  hideButtonsByAreas: hideButtonsByAreas,
  // 隐藏所传区域的按钮
  getButtons: getButtons,
  setButtons: setButtons,
  getButtonVisible: getButtonVisible,
  updateButtons: updateButtons,
  setMainButton: setMainButton,
  setPopContent: setPopContent,
  setUploadDocAmount: setUploadDocAmount,
  setOprationBtnsRenderStatus: setOprationBtnsRenderStatus,
  setUploadConfig: setUploadConfig,
  //兼容旧代码
  setDisabled: setDisabled
});
// EXTERNAL MODULE: external {"root":"ReactDOM","var":"ReactDOM","commonjs":"react-dom","commonjs2":"react-dom","amd":"react-dom"}
var external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_ = __webpack_require__(6);
var external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default = /*#__PURE__*/__webpack_require__.n(external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_);

// EXTERNAL MODULE: ./node_modules/classnames/index.js
var classnames = __webpack_require__(5);
var classnames_default = /*#__PURE__*/__webpack_require__.n(classnames);

// EXTERNAL MODULE: ./src/platform/FastExtend/utils.js
var utils = __webpack_require__(13);

// CONCATENATED MODULE: ./src/platform/components/ButtonApp/BtnItemTip.js
function BtnItemTip_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { BtnItemTip_typeof = function _typeof(obj) { return typeof obj; }; } else { BtnItemTip_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return BtnItemTip_typeof(obj); }

function BtnItemTip_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function BtnItemTip_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function BtnItemTip_createClass(Constructor, protoProps, staticProps) { if (protoProps) BtnItemTip_defineProperties(Constructor.prototype, protoProps); if (staticProps) BtnItemTip_defineProperties(Constructor, staticProps); return Constructor; }

function BtnItemTip_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) BtnItemTip_setPrototypeOf(subClass, superClass); }

function BtnItemTip_setPrototypeOf(o, p) { BtnItemTip_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return BtnItemTip_setPrototypeOf(o, p); }

function BtnItemTip_createSuper(Derived) { var hasNativeReflectConstruct = BtnItemTip_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = BtnItemTip_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = BtnItemTip_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return BtnItemTip_possibleConstructorReturn(this, result); }; }

function BtnItemTip_possibleConstructorReturn(self, call) { if (call && (BtnItemTip_typeof(call) === "object" || typeof call === "function")) { return call; } return BtnItemTip_assertThisInitialized(self); }

function BtnItemTip_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function BtnItemTip_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function BtnItemTip_getPrototypeOf(o) { BtnItemTip_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return BtnItemTip_getPrototypeOf(o); }

/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-04 14:17:53
 * @Description: file content
 */



var BtnItemTip_BtnItemTip = /*#__PURE__*/function (_Component) {
  BtnItemTip_inherits(BtnItemTip, _Component);

  var _super = BtnItemTip_createSuper(BtnItemTip);

  function BtnItemTip(props) {
    var _this;

    BtnItemTip_classCallCheck(this, BtnItemTip);

    _this = _super.call(this, props);
    _this.state = {
      tipStatus: false
    };
    _this.tipConfirm = false;
    _this.dom = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createRef();
    return _this;
  }

  BtnItemTip_createClass(BtnItemTip, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      //this.itemDom.clientWidth<this.itemDom.scrollWidth
      // 初始化是否显示tip
      if (this.dom) {
        var tipItem = this.dom.querySelector('.btn-item-left');

        if (tipItem && tipItem.clientWidth < tipItem.scrollWidth) {
          this.tipConfirm = true;
          this.setState({
            tipStatus: true
          });
        }
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      if (this.dom && !this.tipConfirm) {
        var tipItem = this.dom.querySelector('.btn-item-left');

        if (tipItem && tipItem.clientWidth < tipItem.scrollWidth) {
          this.tipConfirm = true;
          this.setState({
            tipStatus: true
          });
        }
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        overlay: this.state.tipStatus ? this.props.overlay : '',
        inverse: true,
        delayShow: 500,
        delay: 1
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        ref: function ref(dom) {
          _this2.dom = dom;
        }
      }, this.props.children));
    }
  }]);

  return BtnItemTip;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/ButtonApp/MenuUtil.js
function MenuUtil_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { MenuUtil_typeof = function _typeof(obj) { return typeof obj; }; } else { MenuUtil_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return MenuUtil_typeof(obj); }

function MenuUtil_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function MenuUtil_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function MenuUtil_createClass(Constructor, protoProps, staticProps) { if (protoProps) MenuUtil_defineProperties(Constructor.prototype, protoProps); if (staticProps) MenuUtil_defineProperties(Constructor, staticProps); return Constructor; }

function MenuUtil_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) MenuUtil_setPrototypeOf(subClass, superClass); }

function MenuUtil_setPrototypeOf(o, p) { MenuUtil_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return MenuUtil_setPrototypeOf(o, p); }

function MenuUtil_createSuper(Derived) { var hasNativeReflectConstruct = MenuUtil_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = MenuUtil_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = MenuUtil_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return MenuUtil_possibleConstructorReturn(this, result); }; }

function MenuUtil_possibleConstructorReturn(self, call) { if (call && (MenuUtil_typeof(call) === "object" || typeof call === "function")) { return call; } return MenuUtil_assertThisInitialized(self); }

function MenuUtil_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function MenuUtil_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function MenuUtil_getPrototypeOf(o) { MenuUtil_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return MenuUtil_getPrototypeOf(o); }

function MenuUtil_extends() { MenuUtil_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return MenuUtil_extends.apply(this, arguments); }

// 渲染下拉菜单和更多下拉里面的Menu列表




var MenuUtil_Item = base_index_["Menu"].Item,
    Divider = base_index_["Menu"].Divider,
    ItemGroup = base_index_["Menu"].ItemGroup; // querySelector  不能識別數字開頭 不能識別特殊字符 ·/·

var replaceSpecialStr = function replaceSpecialStr(str) {
  return str.replace(/\/|\\|,/g, '') || str;
};

function strlen(str) {
  var len = 0;

  for (var i = 0; i < str.length; i++) {
    var c = str.charCodeAt(i); //单字节加1

    if (c >= 0x0001 && c <= 0x007e || c >= 0xff60 && c <= 0xff9f) {
      len++;
    } else {
      len += 2;
    }
  }

  return len;
}
/**
 * 展示帮助
 */


var SHOW_HELPER = true;
/**
 * 首字母大写  add by bbqin 暂时不考虑多键的情况
 * @param {*} str
 */

function firstToUpperCase(str) {
  // 把加号前后的字符全转译
  return str.toLowerCase().replace(/( |^)[a-z]|\+[a-z]/g, function (L) {
    return L.toUpperCase();
  });
} // const IS_TEST_ENV = NODE_ENV === 'test';


var MenuUtil_renderMenuItem = function renderMenuItem(data, specialDisabled) {
  var _this = this;

  // more 更多操作 下拉下面的禁用要加删除线，通过传specialDisabled 来区分
  data = data.filter(function (it) {
    return it.visible || !it.hasOwnProperty('visible');
  });
  return data.map(function (item, index) {
    if (item.visible !== false) {
      return item.title ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ItemGroup, {
        title: item.title
      }, item.children.map(function (_ref) {
        var key = _ref.key,
            title = _ref.title,
            disabled = _ref.disabled,
            visible = _ref.visible,
            uploadConfig = _ref.uploadConfig,
            keyboard = _ref.keyboard,
            area = _ref.area,
            parentCode = _ref.parentCode;
        return visible !== false && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MenuUtil_Item, {
          key: key,
          fieldid: key,
          "btn-code": key,
          disabled: disabled,
          className: "dropdown-btn-item"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(BtnItemTip_BtnItemTip, {
          overlay: title
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "dropdown-btn-item-box"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          ref: function ref(dom) {
            _this.itemDom = dom;
          },
          "btn-code": key,
          className: classnames_default()(replaceSpecialStr(" nc-".concat(area, "-btn-").concat(parentCode, "-").concat(key, "  ")), 'btn-item-left')
        }, specialDisabled && disabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "main-title",
          style: {
            cursor: 'default'
          }
        }, title) : uploadConfig && !disabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], MenuUtil_extends({
          showUploadList: false
        }, uploadConfig), title) : title), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "btn-item-right",
          onClick: function onClick(e) {
            if (!e.target || specialDisabled && disabled || !uploadConfig || disabled) {
              return false;
            }

            var prevUpload = e.target.previousElementSibling.querySelector('input');
            prevUpload && prevUpload.click();
          }
        }, keyboard && SHOW_HELPER ? "".concat(firstToUpperCase(keyboard)) : ''))));
      })) : [item.children.map(function (_ref2) {
        var key = _ref2.key,
            title = _ref2.title,
            disabled = _ref2.disabled,
            visible = _ref2.visible,
            uploadConfig = _ref2.uploadConfig,
            keyboard = _ref2.keyboard,
            area = _ref2.area,
            parentCode = _ref2.parentCode;
        return visible !== false && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MenuUtil_Item, {
          key: key,
          fieldid: key,
          "btn-code": key,
          disabled: disabled,
          className: "dropdown-btn-item" // onClick={this.onClick} // bbqin  由于 item上的click事件和当前事件重复触发 去除该事件

        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(BtnItemTip_BtnItemTip, {
          overlay: title
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "dropdown-btn-item-box"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "btn-item-left",
          "btn-code": key
        }, specialDisabled && disabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "main-title",
          style: {
            cursor: 'default'
          }
        }, title) : uploadConfig && !disabled ? !disabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], MenuUtil_extends({
          showUploadList: false
        }, uploadConfig, {
          className: classnames_default()(replaceSpecialStr(" nc-".concat(area, "-btn-").concat(parentCode, "-").concat(key, "  ")))
        }), title) : title : title), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "btn-item-right",
          onClick: function onClick(e) {
            if (!e.target || specialDisabled && disabled || !uploadConfig || disabled) {
              return false;
            }

            var prevUpload = e.target.previousElementSibling.querySelector('input');
            prevUpload && prevUpload.click();
          }
        }, keyboard && SHOW_HELPER ? "".concat(firstToUpperCase(keyboard)) : ''))));
      }), data[index + 1] && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Divider, null)];
    }
  });
};
var MenuUtil_renderMenu = function renderMenu(data, specialDisabled) {
  var _this2 = this;

  var tabindex = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
  var maxHeight = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 500;
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    style: {
      overflow: 'auto',
      maxHeight: maxHeight
    }
  }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Menu"], {
    className: "button-app-dropdown-menu-wrapper",
    onClick: function onClick(info) {
      _this2.onClick(info);

      _this2.onVisibleChange ? _this2.onVisibleChange() : null;
    },
    tabIndex: tabindex
  }, MenuUtil_renderMenuItem.call(this, data, specialDisabled)));
};
var MenuUtil_RenderMenu = /*#__PURE__*/function (_Component) {
  MenuUtil_inherits(RenderMenu, _Component);

  var _super = MenuUtil_createSuper(RenderMenu);

  function RenderMenu() {
    var _this3;

    MenuUtil_classCallCheck(this, RenderMenu);

    _this3 = _super.call(this);

    _this3.setMaxHeight = function () {
      var clientHeight = document.body.clientHeight; //浏览器可视区域高度

      var buttonApp = document.querySelector('.button-app-wrapper');
      var dropdownWrapper = buttonApp && buttonApp.querySelector('.button-app-dropdown-menu-wrapper');
      var dropdownClient = dropdownWrapper && dropdownWrapper.getBoundingClientRect();
      var top = dropdownClient && dropdownClient.top; //console.log("获取距离视口顶层高度", top)

      var maxHeight = top && clientHeight - top - 50;

      if (maxHeight && maxHeight > 0) {
        _this3.setState({
          maxHeight: maxHeight
        });
      }
    };

    _this3.state = {
      maxHeight: 500 // 下拉菜单是否显示

    };
    return _this3;
  }

  MenuUtil_createClass(RenderMenu, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      this.setMaxHeight();
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps() {
      this.setMaxHeight();
    }
  }, {
    key: "render",
    value: function render() {
      var maxHeight = this.state.maxHeight;
      var _this$props = this.props,
          data = _this$props.data,
          specialDisabled = _this$props.specialDisabled,
          _this$props$tabindex = _this$props.tabindex,
          tabindex = _this$props$tabindex === void 0 ? 0 : _this$props$tabindex,
          _onClick = _this$props.onClick,
          onVisibleChange = _this$props.onVisibleChange;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Menu"], {
        className: "button-app-dropdown-menu-wrapper",
        style: {
          overflow: 'auto',
          maxHeight: maxHeight
        },
        onClick: function onClick(info) {
          _onClick(info);

          onVisibleChange ? onVisibleChange() : null;
        },
        tabIndex: tabindex
      }, MenuUtil_renderMenuItem.call(this, data, specialDisabled));
    }
  }]);

  return RenderMenu;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/Mores/index.js
function Mores_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { Mores_typeof = function _typeof(obj) { return typeof obj; }; } else { Mores_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return Mores_typeof(obj); }

function Mores_createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = Mores_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function Mores_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return Mores_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Mores_arrayLikeToArray(o, minLen); }

function Mores_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function Mores_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function Mores_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function Mores_createClass(Constructor, protoProps, staticProps) { if (protoProps) Mores_defineProperties(Constructor.prototype, protoProps); if (staticProps) Mores_defineProperties(Constructor, staticProps); return Constructor; }

function Mores_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) Mores_setPrototypeOf(subClass, superClass); }

function Mores_setPrototypeOf(o, p) { Mores_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return Mores_setPrototypeOf(o, p); }

function Mores_createSuper(Derived) { var hasNativeReflectConstruct = Mores_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = Mores_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = Mores_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return Mores_possibleConstructorReturn(this, result); }; }

function Mores_possibleConstructorReturn(self, call) { if (call && (Mores_typeof(call) === "object" || typeof call === "function")) { return call; } return Mores_assertThisInitialized(self); }

function Mores_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function Mores_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function Mores_getPrototypeOf(o) { Mores_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return Mores_getPrototypeOf(o); }







__webpack_require__(1898); // querySelector  不能識別數字開頭 不能識別特殊字符 ·/·


var Mores_replaceSpecialStr = function replaceSpecialStr(str) {
  return str.replace(/\/|\\|,/g, '') || str;
};

var Mores_More = /*#__PURE__*/function (_Component) {
  Mores_inherits(More, _Component);

  var _super = Mores_createSuper(More);

  function More() {
    var _this;

    Mores_classCallCheck(this, More);

    _this = _super.call(this);

    _this.onClick = function (info) {
      // 在Popover的content中的Menu中调用该事件 由于call绑定了this，Menu和MenuItem中的this都指向More组件
      var key = info.key;
      var title = info.item.props.children;

      _this.props.onClick({
        key: key,
        title: title
      });

      _this.setState({
        show: false
      });
    };

    _this.state = {
      show: false
    };
    _this.timer = null;
    _this.timerIndex = true;
    return _this;
  }

  Mores_createClass(More, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          list = _this$props.list,
          title = _this$props.title,
          btncolor = _this$props.btncolor,
          disabled = _this$props.disabled,
          json = _this$props.json,
          _this$props$tabindex = _this$props.tabindex,
          tabindex = _this$props$tabindex === void 0 ? 0 : _this$props$tabindex,
          clskey = _this$props.clskey,
          area = _this$props.area;
      var show = this.state.show;
      var length = list.length;

      var _iterator = Mores_createForOfIteratorHelper(list),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var items = _step.value;
          var len = items['children'].length;

          if (len > 1) {
            if (items.hasOwnProperty('visible') && items.visible === false) {
              length -= 1;
            } else {
              var _iterator2 = Mores_createForOfIteratorHelper(items['children']),
                  _step2;

              try {
                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
                  var item = _step2.value;
                  // 添加一个topParentCode 解决找不到上传class的问题 bbqin
                  item.topParentCode = items.parentCode || item.parentCode; // console.log(item.hasOwnProperty('visible'), item)

                  if (item.hasOwnProperty('visible') && item.visible === false) {
                    len -= 1;
                  } else {
                    len = len;
                  } // console.log(len, '-len')

                }
              } catch (err) {
                _iterator2.e(err);
              } finally {
                _iterator2.f();
              }

              if (len === 0) {
                items.visible = false;
                length -= 1;
              }
            }
          }
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "mores-wrapper",
        onMouseLeave: function onMouseLeave() {
          _this2.timerIndex = true;
          _this2.timer = setTimeout(function () {
            if (_this2.timerIndex) {
              _this2.setState({
                show: false
              });
            }
          }, 300);
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "mores-in-wrapper",
        onMouseEnter: function onMouseEnter() {
          _this2.timerIndex = false;
          clearTimeout(_this2.timer);
        },
        fieldid: Object(index_["getSysFieldid"])("".concat(clskey, "_btn")),
        "btn-code": clskey
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        disabled: disabled,
        className: classnames_default()(Mores_replaceSpecialStr(" nc-".concat(area, "-").concat(clskey, "-icon ")), 'moreButton-component', {
          'button-primary': btncolor == 'button_main'
        }),
        onClick: function onClick() {
          return !disabled && _this2.setState({
            show: !show
          });
        },
        tabindex: tabindex,
        fieldid: clskey,
        "btn-code": clskey
      }, title || json['page-button-0004'], /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "arrow icon iconfont ".concat(btncolor == 'button_main' ? 'button-primary' : '', " ").concat(show ? 'icon-hangcaozuoxiangshang1' : 'icon-hangcaozuoxiala1')
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: classnames_default()({
          'mores-sanjiao': show,
          'mores-sanjiao mores-sanjiao-hide': !show
        })
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        fieldid: Object(index_["getSysFieldid"])("".concat(clskey, "_btn_list")),
        className: show ? 'mores-list-wrapper' : 'mores-list-wrapper mores-list-hide-wrapper' // onMouseLeave={() => {
        //     this.setState({show: false})
        // }}
        ,
        style: {
          // width: `${length * 140 + 30}px`,
          maxWidth: '1024px',
          whiteSpace: 'nowrap'
        },
        "btn-code": clskey
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MenuUtil_RenderMenu, {
        data: list,
        specialDisabled: true,
        tabindex: tabindex,
        onClick: this.onClick
      }))));
    }
  }]);

  return More;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


Mores_More.defaultProps = {
  list: [],
  popPlacement: 'bottomRight' // 弹窗窗口的位置

};
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/MyDropDown/index.js
function MyDropDown_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { MyDropDown_typeof = function _typeof(obj) { return typeof obj; }; } else { MyDropDown_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return MyDropDown_typeof(obj); }

function MyDropDown_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function MyDropDown_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function MyDropDown_createClass(Constructor, protoProps, staticProps) { if (protoProps) MyDropDown_defineProperties(Constructor.prototype, protoProps); if (staticProps) MyDropDown_defineProperties(Constructor, staticProps); return Constructor; }

function MyDropDown_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) MyDropDown_setPrototypeOf(subClass, superClass); }

function MyDropDown_setPrototypeOf(o, p) { MyDropDown_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return MyDropDown_setPrototypeOf(o, p); }

function MyDropDown_createSuper(Derived) { var hasNativeReflectConstruct = MyDropDown_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = MyDropDown_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = MyDropDown_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return MyDropDown_possibleConstructorReturn(this, result); }; }

function MyDropDown_possibleConstructorReturn(self, call) { if (call && (MyDropDown_typeof(call) === "object" || typeof call === "function")) { return call; } return MyDropDown_assertThisInitialized(self); }

function MyDropDown_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function MyDropDown_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function MyDropDown_getPrototypeOf(o) { MyDropDown_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return MyDropDown_getPrototypeOf(o); }






__webpack_require__(1895); // querySelector  不能識別數字開頭 不能識別特殊字符 ·/·


var MyDropDown_replaceSpecialStr = function replaceSpecialStr(str) {
  return str.replace(/\/|\\|,/g, '') || str;
};

var MyDropDown_MyDropdown = /*#__PURE__*/function (_Component) {
  MyDropDown_inherits(MyDropdown, _Component);

  var _super = MyDropDown_createSuper(MyDropdown);

  function MyDropdown() {
    var _this;

    MyDropDown_classCallCheck(this, MyDropdown);

    _this = _super.call(this);

    _this.onClick = function (info) {
      var dividerBtn = _this.props.dividerBtn;
      var key = info.key;
      var title = info.item.props.children;

      _this.props.onClick({
        key: key,
        title: title
      });

      _this.setState({
        visible: false
      }, function () {
        //点击下拉中的按钮，使分割按钮聚焦,解决物料集团节点，点击分割按钮弹出modal，关闭modal之后滚动到最上方问题
        if (dividerBtn) {
          var btnRight = dividerBtn.querySelector('.btn-right');
          btnRight.focus();
        }
      });
    };

    _this.onVisibleChange = function (visible) {
      var onVisibleChange = _this.props.onVisibleChange;

      _this.setState({
        visible: visible
      });

      onVisibleChange && onVisibleChange(visible);
    };

    _this.state = {
      visible: false // 下拉菜单是否显示

    };
    return _this;
  }

  MyDropDown_createClass(MyDropdown, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          list = _this$props.list,
          title = _this$props.title,
          disabled = _this$props.disabled,
          btncolor = _this$props.btncolor,
          popContainer = _this$props.popContainer,
          area = _this$props.area,
          dropdownType = _this$props.dropdownType,
          _this$props$tabindex = _this$props.tabindex,
          tabindex = _this$props$tabindex === void 0 ? 0 : _this$props$tabindex,
          clskey = _this$props.clskey; // 整个下拉的可见性取决于:1.是否曾手动将下拉list的visible设为false,2.list下的分组是否都隐藏
      // 分组的可见性取决于:1.是否曾手动将分组的visible设为false,2.分组里面的按钮是否都隐藏

      list.forEach(function (item) {
        // 分组的可见性
        if (item.visible !== false) {
          var visible_group = !item.children.every(function (ele) {
            return ele.visible === false;
          });

          if (item.children.length == 0) {
            visible_group = false;
          }

          item.visible = visible_group;
        } // 添加一个topParentCode 解决找不到上传class的问题 bbqin


        item.children.forEach(function (el) {
          el.topParentCode = item.parentCode || el.parentCode;
        });
      }); // 整个下拉的可见性

      var visible_list = list.visible;

      if (visible_list !== false) {
        visible_list = !list.every(function (item) {
          return item.visible === false;
        });
      } // 当下拉中的按钮都隐藏时或者下拉中本来就没有按钮时,整个下拉按钮也隐藏掉


      if (list.length === 0) {
        visible_list = false;
      }

      var dropdownBtn = function dropdownBtn() {
        if (_this2.props.children) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, _this2.props.children);
        } else {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
            fieldid: clskey,
            "btn-code": clskey,
            disabled: disabled,
            className: classnames_default()({
              'dropdown-component': title,
              'dropdown-arrow': !title,
              'my-dropdown-buttons-main-wrapper': dropdownType,
              'button-primary': btncolor == 'button_main'
            }),
            tabindex: tabindex
          }, title, _this2.state.visible ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('arrow iconfont icon-hangcaozuoxiangshang1', MyDropDown_replaceSpecialStr(" nc-".concat(area, "-").concat(clskey, "-icon ")), {
              'button-primary': btncolor == 'button_main'
            })
          }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('arrow iconfont icon-hangcaozuoxiala1', MyDropDown_replaceSpecialStr(" nc-".concat(area, "-").concat(clskey, "-icon ")), {
              'button-primary': btncolor == 'button_main'
            })
          }));
        }
      };

      return visible_list !== false ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Dropdown"], {
        trigger: ['click'] // overlay={renderMenu.call(this, list, undefined, tabindex)}
        ,
        overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MenuUtil_RenderMenu, {
          data: list,
          tabindex: tabindex,
          onClick: this.onClick,
          onVisibleChange: this.onVisibleChange
        }),
        animation: "slide-up",
        onVisibleChange: this.onVisibleChange,
        overlayClassName: classnames_default()('dropdown-component-list-wrapper', this.props.className),
        getPopupContainer: function getPopupContainer() {
          // let doc = document.querySelector(`.${area}-button-app-wrapper`)
          // return popContainer?popContainer:doc? doc: document.body
          return popContainer || document.body;
        }
      }, dropdownBtn()) : null;
    }
  }]);

  return MyDropdown;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/ButtonApp/constants.js
var CARD_ROW_SELECTED_CLASSNAME = 'cardTable-selected-row';
var EDIT_ROW_SELECTED_CLASSNAME = 'editTable-selected-row';
var SIMPLE_ROW_SELECTED_CLASSNAME = 'simpleTable-selected-row';
var _ROW_SELECTED_CLASSNAME = 'nctable-selected-row';
var OPERATION_UPLOAD_CLASSNAME = 'js-upload';
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/util.js
/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-03 14:25:43
 * @Description: file content
 */





/**
 * 首字母大写  add by bbqin 暂时不考虑多键的情况
 * @param {*} str
 */

function util_firstToUpperCase(str) {
  // 把加号前后的字符全转译
  var strTransform = str.split(',');
  var proccessedStr = strTransform.map(function (str) {
    return str.toLowerCase().replace(/ /g, '').replace(/( |^)[a-z]|\+[a-z]/g, function (L) {
      return L.toUpperCase();
    });
  }).join(',');
  return proccessedStr;
}
/**
 * @desc: 现在表格的快捷键是selected-row样式加事件源去判断是否触发快捷键事件的，导致页面存在多个表格且每个表格都有选中状态的时候总会触发第一个表格的快捷键事件。
 * @resolve: 点击某个表格的时候把清除其他表格row的选中状态
 * @param pageScope {object} 页面级数据；
 * @param moduleId {string} 区域id
 */

function clearOtherTableRowSelectedStatus(_ref) {
  var pageScope = _ref.pageScope,
      moduleId = _ref.moduleId;
  var orderOfHotKey = pageScope.orderOfHotKey;
  orderOfHotKey.forEach(function (item) {
    if (item !== moduleId) {
      var dom = document.querySelector("#".concat(index_["config"].hotKeyModuleIdPrefix, "-").concat(item));
      var selectedRows = dom && dom.querySelectorAll(".".concat(CARD_ROW_SELECTED_CLASSNAME, ",.").concat(EDIT_ROW_SELECTED_CLASSNAME, ",.").concat(SIMPLE_ROW_SELECTED_CLASSNAME, ",.").concat(_ROW_SELECTED_CLASSNAME));

      if (selectedRows && selectedRows.length) {
        pageScope.myTable[item].state.table.currentIndex = -1;
        pageScope.myTable[item].setState({
          table: pageScope.myTable[item].state.table
        });
      }
    }
  });
}
/**
 * @desc 在表格处于编辑状态下触发保存，暂存等快捷键的时候由于没有触发表格的编辑后(onblur)导致输入的值没有更新到states上
 * @resolve 在触发快捷键按钮的时候默认让body获取焦点
 * @param callBack {function} 回调函数
 * @param buttonInfo {object} 按钮信息
 * @param e {object}
 * @param keyMapItem {object}
 */

function triggerOnClickWithBlurAction(_ref2) {
  var callBack = _ref2.callBack,
      buttonInfo = _ref2.buttonInfo,
      e = _ref2.e,
      keyMapItem = _ref2.keyMapItem;
  // 如果页面超出一屏时按快捷键会导致页面滚动
  // document.body.focus();
  document.activeElement && document.activeElement.blur(); // let $target = window.event && window.event.target;

  var timer = setTimeout(function () {
    // 采购发票维护 附件按钮点击报错  业务使用了window 上的event对象
    // window.event = {//修复ie按钮不可用bug
    //     target: $target,
    // };
    keyMapItem ? callBack(buttonInfo.key, e, keyMapItem) : callBack(buttonInfo.key);
    clearTimeout(timer);
  }, 50); // 设置一个时长 避免编辑事件的setTimeout后执行
}
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/HelperTip.js
function HelperTip_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { HelperTip_typeof = function _typeof(obj) { return typeof obj; }; } else { HelperTip_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return HelperTip_typeof(obj); }

function HelperTip_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function HelperTip_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function HelperTip_createClass(Constructor, protoProps, staticProps) { if (protoProps) HelperTip_defineProperties(Constructor.prototype, protoProps); if (staticProps) HelperTip_defineProperties(Constructor, staticProps); return Constructor; }

function HelperTip_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) HelperTip_setPrototypeOf(subClass, superClass); }

function HelperTip_setPrototypeOf(o, p) { HelperTip_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return HelperTip_setPrototypeOf(o, p); }

function HelperTip_createSuper(Derived) { var hasNativeReflectConstruct = HelperTip_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = HelperTip_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = HelperTip_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return HelperTip_possibleConstructorReturn(this, result); }; }

function HelperTip_possibleConstructorReturn(self, call) { if (call && (HelperTip_typeof(call) === "object" || typeof call === "function")) { return call; } return HelperTip_assertThisInitialized(self); }

function HelperTip_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function HelperTip_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function HelperTip_getPrototypeOf(o) { HelperTip_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return HelperTip_getPrototypeOf(o); }

/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: bbq
 * @LastEditTime: 2020-12-07 10:31:26
 * @Description: file content
 */




var HelperTip_HelperTip = /*#__PURE__*/function (_Component) {
  HelperTip_inherits(HelperTip, _Component);

  var _super = HelperTip_createSuper(HelperTip);

  function HelperTip() {
    HelperTip_classCallCheck(this, HelperTip);

    return _super.apply(this, arguments);
  }

  HelperTip_createClass(HelperTip, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          keyboard = _this$props.keyboard,
          title = _this$props.title,
          children = _this$props.children,
          disabled = _this$props.disabled,
          delayShow = _this$props.delayShow; // let processedKeyboard = keyboard && keyboard.replace(/(\+|,|，|\s)/g, '_');

      return keyboard && disabled !== true ?
      /*#__PURE__*/
      // eslint-disable-next-line jsx-a11y/mouse-events-have-key-events
      external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        key: "ss",
        placement: "top",
        inverse: true,
        overlay: "".concat(title || '', "  (").concat(util_firstToUpperCase(keyboard), ")"),
        trigger: ['hover'] // 去除  , "focus"
        ,
        className: "btn-helper-overlay",
        onMouseOver: function onMouseOver(e) {
          if (e.target.className && e.target.className.includes('u-loading-backdrop')) {
            e.stopPropagation(); // 单词写错啦

            e.preventDefault();
          }
        },
        onMouseOut: function onMouseOut() {
          var dom = document.querySelector('.btn-helper-overlay');

          if (dom) {
            dom.style.display = 'none';
          }
        },
        delayShow: delayShow
      }, children) : children;
    }
  }]);

  return HelperTip;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/ButtonApp/MyDividerButtons/index.js
function MyDividerButtons_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { MyDividerButtons_typeof = function _typeof(obj) { return typeof obj; }; } else { MyDividerButtons_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return MyDividerButtons_typeof(obj); }

function MyDividerButtons_extends() { MyDividerButtons_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return MyDividerButtons_extends.apply(this, arguments); }

function MyDividerButtons_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function MyDividerButtons_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function MyDividerButtons_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function MyDividerButtons_createClass(Constructor, protoProps, staticProps) { if (protoProps) MyDividerButtons_defineProperties(Constructor.prototype, protoProps); if (staticProps) MyDividerButtons_defineProperties(Constructor, staticProps); return Constructor; }

function MyDividerButtons_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) MyDividerButtons_setPrototypeOf(subClass, superClass); }

function MyDividerButtons_setPrototypeOf(o, p) { MyDividerButtons_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return MyDividerButtons_setPrototypeOf(o, p); }

function MyDividerButtons_createSuper(Derived) { var hasNativeReflectConstruct = MyDividerButtons_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = MyDividerButtons_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = MyDividerButtons_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return MyDividerButtons_possibleConstructorReturn(this, result); }; }

function MyDividerButtons_possibleConstructorReturn(self, call) { if (call && (MyDividerButtons_typeof(call) === "object" || typeof call === "function")) { return call; } return MyDividerButtons_assertThisInitialized(self); }

function MyDividerButtons_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function MyDividerButtons_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function MyDividerButtons_getPrototypeOf(o) { MyDividerButtons_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return MyDividerButtons_getPrototypeOf(o); }









__webpack_require__(1897); // querySelector  不能識別數字開頭 不能識別特殊字符 ·/·


var MyDividerButtons_replaceSpecialStr = function replaceSpecialStr(str) {
  return str.replace(/\/|\\|,/g, '') || str;
};

var MyDividerButtons_MyDividerButton = /*#__PURE__*/function (_Component) {
  MyDividerButtons_inherits(MyDividerButton, _Component);

  var _super = MyDividerButtons_createSuper(MyDividerButton);

  function MyDividerButton(props) {
    var _this;

    MyDividerButtons_classCallCheck(this, MyDividerButton);

    _this = _super.call(this, props);

    _this.onSwitchMenu = function (visible) {
      _this.setState({
        visible: visible
      });
    };

    _this.state = {
      showMenu: false,
      // 正常批复弹框显示状态
      visible: false // 正常批复弹框显示状态

    };
    return _this;
  }

  MyDividerButtons_createClass(MyDividerButton, [{
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          _key = _this$props._key,
          title = _this$props.title,
          list = _this$props.list,
          btncolor = _this$props.btncolor,
          disabled = _this$props.disabled,
          area = _this$props.area,
          isenable = _this$props.isenable,
          uploadConfig = _this$props.uploadConfig,
          visible = _this$props.visible,
          dividerType = _this$props.dividerType,
          _this$props$tabindex = _this$props.tabindex,
          tabindex = _this$props$tabindex === void 0 ? 0 : _this$props$tabindex,
          keyboard = _this$props.keyboard; // 整个下拉的可见性取决于:1.是否曾手动将下拉list的visible设为false,2.list下的分组是否都隐藏
      // 分组的可见性取决于:1.是否曾手动将分组的visible设为false,2.分组里面的按钮是否都隐藏

      list.forEach(function (item) {
        // 分组的可见性
        if (item.visible !== false) {
          var visible_group = !item.children.every(function (ele) {
            return ele.visible === false;
          });

          if (item.children.length == 0) {
            visible_group = false;
          }

          item.visible = visible_group;
        }
      }); // 整个下拉的可见性

      var visible_list = list.visible;

      if (visible_list !== false) {
        visible_list = !list.every(function (item) {
          return item.visible === false;
        });
      } // 当下拉中的按钮都隐藏时或者下拉中本来就没有按钮时,整个下拉按钮也隐藏掉


      if (list.length === 0) {
        visible_list = false;
      }

      var btnCls = classnames_default()(MyDividerButtons_replaceSpecialStr(" nc-".concat(area, "-btn-").concat(_key, " ")));
      var vlBtnCls = classnames_default()({
        ' empty btn-left ': !visible_list,
        ' btn-left divider-main-button ': visible_list
      });
      var mainBtnCls = classnames_default()({
        ' my-divider-buttons-main-wrapper ': dividerType || btncolor == 'button_main'
      });
      var uploadBtnCls = classnames_default()(MyDividerButtons_defineProperty({}, " upload-btn-".concat(_key, " "), Object(index_["isObj"])(uploadConfig)));
      var Btn = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        fieldid: _key,
        "btn-code": _key,
        disabled: !isenable || disabled // 分割按钮要根据请求回来的权限和手动设置的disabled值来设置可用性
        ,
        className: classnames_default()(btnCls, vlBtnCls, mainBtnCls, uploadBtnCls) // 下拉中没有按钮不显示下拉,父按钮四个角都圆角
        ,
        onClick: function onClick() {
          // e.stopPropagation()
          _this2.props.onClick({
            key: _key,
            title: title
          });
        },
        tabindex: tabindex
      }, title);

      var bb = function bb(dividerBtn) {
        if (visible && visible_list) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "sawadika"
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "hover-divider-btn-left-wrapper"
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "my-divider-icon-main-wrapper"
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
            title: title,
            keyboard: keyboard,
            disabled: !isenable || disabled,
            delayShow: 500
          }, Object(index_["isObj"])(uploadConfig) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: classnames_default()(vlBtnCls) // 下拉中没有按钮不显示下拉,父按钮四个角都圆角
            ,
            onClick: function onClick(e) {
              _this2.setState({
                visible: false
              });

              e.stopPropagation();
            }
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], MyDividerButtons_extends({
            showUploadList: false
          }, uploadConfig), Btn)) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
            fieldid: _key,
            "btn-code": _key,
            disabled: !isenable || disabled // 分割按钮要根据请求回来的权限和手动设置的disabled值来设置可用性
            ,
            className: classnames_default()(btnCls, vlBtnCls, mainBtnCls) // 下拉中没有按钮不显示下拉,父按钮四个角都圆角
            ,
            onClick: function onClick() {
              _this2.setState({
                visible: false
              });

              if (isenable || !disabled) {
                _this2.props.onClick({
                  key: _key,
                  title: title
                });
              }
            },
            tabindex: tabindex
          }, title)))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MyDropDown_MyDropdown, {
            list: list,
            area: area,
            btncolor: btncolor,
            popContainer: _this2.props.popContainer,
            onVisibleChange: _this2.onSwitchMenu,
            onClick: _this2.props.onClick,
            tabindex: tabindex,
            className: classnames_default()(" ".concat(area, "-").concat(_key, "-panel fieldid_").concat(_key, "_btn_list")),
            dividerBtn: dividerBtn
          }, Object(index_["isObj"])(uploadConfig) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: classnames_default()(vlBtnCls) // 下拉中没有按钮不显示下拉,父按钮四个角都圆角
            ,
            onClick: function onClick(e) {
              e.stopPropagation();
            }
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], MyDividerButtons_extends({
            showUploadList: false
          }, uploadConfig), Btn)) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
            fieldid: _key,
            "btn-code": _key,
            disabled: !isenable || disabled // 分割按钮要根据请求回来的权限和手动设置的disabled值来设置可用性
            ,
            className: classnames_default()(vlBtnCls, mainBtnCls) // 下拉中没有按钮不显示下拉,父按钮四个角都圆角
            ,
            onClick: function onClick(e) {
              e.stopPropagation();

              if (isenable || !disabled) {
                _this2.props.onClick({
                  key: _key,
                  title: title
                });
              }
            }
          }, title), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
            fieldid: "".concat(_key, "-arrow"),
            className: classnames_default()('btn-right', {
              'my-divider-buttons-main-wrapper': dividerType || btncolor == 'button_main'
            }),
            style: {
              borderRadius: '0px 3px 3px 0px'
            },
            onClick: _this2.onSwitchMenu,
            tabindex: tabindex
          }, !_this2.state.visible ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('arrow iconfont icon-hangcaozuoxiala1', MyDividerButtons_replaceSpecialStr(" nc-".concat(area, "-").concat(_key, "-icon ")), {
              'my-divider-buttons-main-wrapper': btncolor == 'button_main'
            })
          }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('arrow iconfont icon-hangcaozuoxiangshang1', MyDividerButtons_replaceSpecialStr(" nc-".concat(area, "-").concat(_key, "-icon ")), {
              'my-divider-buttons-main-wrapper': btncolor == 'button_main'
            })
          }))));
        } else if (visible && !visible_list) {
          return Object(index_["isObj"])(uploadConfig) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], MyDividerButtons_extends({
            showUploadList: false
          }, uploadConfig), Btn) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
            title: title,
            keyboard: keyboard,
            disabled: !isenable || disabled,
            delayShow: 500
          }, Btn);
        } else {
          return '';
        }
      };

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "divider-button-wrapper",
        ref: function ref(dom) {
          _this2.dividerBtn = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(dom);
        }
      }, bb(this.dividerBtn));
    }
  }]);

  return MyDividerButton;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


MyDividerButtons_MyDividerButton.defaultProps = {
  title: '分割线按钮',
  visible: true,
  list: []
};
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/MyButtonGroup/index.js
function MyButtonGroup_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { MyButtonGroup_typeof = function _typeof(obj) { return typeof obj; }; } else { MyButtonGroup_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return MyButtonGroup_typeof(obj); }

function MyButtonGroup_createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = MyButtonGroup_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function MyButtonGroup_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return MyButtonGroup_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return MyButtonGroup_arrayLikeToArray(o, minLen); }

function MyButtonGroup_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function MyButtonGroup_extends() { MyButtonGroup_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return MyButtonGroup_extends.apply(this, arguments); }

function MyButtonGroup_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function MyButtonGroup_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function MyButtonGroup_createClass(Constructor, protoProps, staticProps) { if (protoProps) MyButtonGroup_defineProperties(Constructor.prototype, protoProps); if (staticProps) MyButtonGroup_defineProperties(Constructor, staticProps); return Constructor; }

function MyButtonGroup_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) MyButtonGroup_setPrototypeOf(subClass, superClass); }

function MyButtonGroup_setPrototypeOf(o, p) { MyButtonGroup_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return MyButtonGroup_setPrototypeOf(o, p); }

function MyButtonGroup_createSuper(Derived) { var hasNativeReflectConstruct = MyButtonGroup_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = MyButtonGroup_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = MyButtonGroup_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return MyButtonGroup_possibleConstructorReturn(this, result); }; }

function MyButtonGroup_possibleConstructorReturn(self, call) { if (call && (MyButtonGroup_typeof(call) === "object" || typeof call === "function")) { return call; } return MyButtonGroup_assertThisInitialized(self); }

function MyButtonGroup_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function MyButtonGroup_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function MyButtonGroup_getPrototypeOf(o) { MyButtonGroup_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return MyButtonGroup_getPrototypeOf(o); }







__webpack_require__(1896); // const IS_TEST_ENV = NODE_ENV === 'test' ? false : true;
// querySelector  不能識別數字開頭 不能識別特殊字符 ·/·


var MyButtonGroup_replaceSpecialStr = function replaceSpecialStr(str) {
  return str.replace(/\/|\\|,/g, '') || str;
};

var MyButtonGroup_MyButtonGroup = /*#__PURE__*/function (_Component) {
  MyButtonGroup_inherits(MyButtonGroup, _Component);

  var _super = MyButtonGroup_createSuper(MyButtonGroup);

  function MyButtonGroup() {
    var _this;

    MyButtonGroup_classCallCheck(this, MyButtonGroup);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));

    _this.getTipKeybodard = function (item) {
      var tipKeybodard = _this.props.tipKeybodard;

      if (tipKeybodard === 'underline' && item.keyboard && item.disabled !== true) {
        // 现在只针对单键 以后可能会变成多键
        var kbs = item.keyboard.split('+');
        return [item.title, '(', /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "text-decoration-underline"
        }, kbs ? kbs[kbs.length - 1].toUpperCase() : item.keyboard), ')'];
      } else {
        return item.title;
      }
    };

    _this.renderButtonGroup = function (data) {
      var _this$props = _this.props,
          area = _this$props.area,
          _this$props$tabindex = _this$props.tabindex,
          tabindex = _this$props$tabindex === void 0 ? -1 : _this$props$tabindex;
      var visibleData = data.filter(function (item) {
        return item.visible !== false;
      });
      return visibleData.map(function (item) {
        switch (item.type) {
          case 'general_btn':
            var className = item.btncolor == 'button_main' ? 'button-primary' : null;
            var Btn = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
              title: item.title,
              keyboard: item.keyboard,
              disabled: item.disabled,
              delayShow: 500
            }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
              key: item.key,
              disabled: item.disabled,
              className: className,
              onClick: function onClick() {
                return _this.props.onClick({
                  key: item.key,
                  title: item.title
                });
              },
              tabindex: tabindex,
              fieldid: item.key,
              "btn-code": item.key
            }, _this.getTipKeybodard(item)));
            return item.uploadConfig ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], MyButtonGroup_extends({
              showUploadList: false
            }, item.uploadConfig, {
              className: MyButtonGroup_replaceSpecialStr(item.parentCode ? " nc-".concat(item.area, "-btn-").concat(item.parentCode, "-").concat(item.key, " ") : " nc-".concat(item.area, "-btn-").concat(item.key, " "))
            }), Btn) : Btn;

          case 'dropdown':
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MyDropDown_MyDropdown, {
              list: item.children,
              title: item.title,
              area: area,
              btncolor: item.btncolor,
              disabled: item.disabled,
              dropdownType: item.dropdownType,
              popContainer: _this.props.popContainer,
              onClick: _this.props.onClick,
              tabindex: tabindex,
              clskey: item.key,
              className: classnames_default()(" nc-".concat(item.area, "-").concat(item.key, "-panel fieldid_").concat(item.key, "_btn_list"))
            });
        }
      });
    };

    _this.getButtonStatus = function (list) {
      var bool = [];

      if (list && list.length) {
        var _iterator = MyButtonGroup_createForOfIteratorHelper(list),
            _step;

        try {
          for (_iterator.s(); !(_step = _iterator.n()).done;) {
            var item = _step.value;

            if (item.visible === false) {
              bool.push(item);
            }
          }
        } catch (err) {
          _iterator.e(err);
        } finally {
          _iterator.f();
        }
      }

      return bool.length === list.length;
    };

    return _this;
  }

  MyButtonGroup_createClass(MyButtonGroup, [{
    key: "render",
    value: function render() {
      var bool = this.getButtonStatus(this.props.list);
      var data = this.props.list;
      var visibleData = data.filter(function (item) {
        return item.visible !== false;
      });
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        //className='buttonGroup-component '
        className: classnames_default()({
          'buttonGroup-component': true,
          'singleGroup': visibleData && visibleData.length && visibleData.length === 1
        }),
        style: {
          marginLeft: bool ? 0 : '6px'
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["ButtonGroup"], {
        popContainer: this.props.popContainer
      }, this.renderButtonGroup(data, this.props.buttonLimit)));
    }
  }]);

  return MyButtonGroup;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/PromptBox/index.js
function PromptBox_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { PromptBox_typeof = function _typeof(obj) { return typeof obj; }; } else { PromptBox_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return PromptBox_typeof(obj); }

function PromptBox_extends() { PromptBox_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return PromptBox_extends.apply(this, arguments); }

function PromptBox_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = PromptBox_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function PromptBox_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function PromptBox_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function PromptBox_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function PromptBox_createClass(Constructor, protoProps, staticProps) { if (protoProps) PromptBox_defineProperties(Constructor.prototype, protoProps); if (staticProps) PromptBox_defineProperties(Constructor, staticProps); return Constructor; }

function PromptBox_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) PromptBox_setPrototypeOf(subClass, superClass); }

function PromptBox_setPrototypeOf(o, p) { PromptBox_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return PromptBox_setPrototypeOf(o, p); }

function PromptBox_createSuper(Derived) { var hasNativeReflectConstruct = PromptBox_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = PromptBox_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = PromptBox_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return PromptBox_possibleConstructorReturn(this, result); }; }

function PromptBox_possibleConstructorReturn(self, call) { if (call && (PromptBox_typeof(call) === "object" || typeof call === "function")) { return call; } return PromptBox_assertThisInitialized(self); }

function PromptBox_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function PromptBox_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function PromptBox_getPrototypeOf(o) { PromptBox_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return PromptBox_getPrototypeOf(o); }




__webpack_require__(1894);



var Header = base_index_["Modal"].Header,
    Title = base_index_["Modal"].Title,
    Body = base_index_["Modal"].Body,
    Footer = base_index_["Modal"].Footer;
/**
 * 备注：在业务组传的确认取消回调报错的情况下，当前的PromptBox的确定和取消事件里的close不走，会导致n递增，走的回调取到的有误。
 */

var PromptBox_n = -1;
var PromptBox_PromptBox = /*#__PURE__*/function (_Component) {
  PromptBox_inherits(PromptBox, _Component);

  var _super = PromptBox_createSuper(PromptBox);

  function PromptBox(props) {
    var _this;

    PromptBox_classCallCheck(this, PromptBox);

    _this = _super.call(this, props);

    _this.callBackErrorHandle = function (func, msg) {
      try {
        func();
      } catch (err) {
        _this.close();

        console.error("".concat(msg, ":").concat(err));
      }
    };

    _this.cancelClick = function () {
      PromptBox_n++;
      var bcFn = _this.props.bcFn;

      if (bcFn[PromptBox_n] && typeof bcFn[PromptBox_n] === "function") {
        // this.props.cancelBtnClick();
        // bcFn[n]();
        _this.callBackErrorHandle(bcFn[PromptBox_n], "PromptBox的取消回调报错");

        _this.clear();
      }

      _this.close();
    };

    _this.beSureClick = function () {
      PromptBox_n++;
      var bsFn = _this.props.bsFn;

      if (bsFn[PromptBox_n] && typeof bsFn[PromptBox_n] === "function") {
        // this.props.beSureBtnClick();
        // bsFn[n]();
        _this.callBackErrorHandle(bsFn[PromptBox_n], "PromptBox的确认回调报错");

        _this.clear();
      }

      _this.close();
    };

    _this.close = function () {
      _this.setState({
        showModal: false
      });
    };

    _this.onExited = function () {
      var element = document.getElementsByClassName('prompt-box-project')[0];

      if (element) {
        external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.unmountComponentAtNode(element);
        clearTimeout(_this.closeTimer);
        _this.closeTimer = null; // element 都不在app上，会报错的，这种内部组件，不要这样写
        // document.getElementById("app").removeChild(element);

        var $parentElement = element && element.parentElement;
        $parentElement && $parentElement.removeChild(element);
      }
    };

    _this.closeBtnClick = function () {
      PromptBox_n++;
      var bCloseFn = _this.props.bCloseFn;

      if (bCloseFn[PromptBox_n] && typeof bCloseFn[PromptBox_n] === "function") {
        bCloseFn[PromptBox_n]();

        _this.clear();
      }

      _this.close();
    };

    _this.clear = function () {
      var _this$props = _this.props,
          bsFn = _this$props.bsFn,
          bcFn = _this$props.bcFn,
          bCloseFn = _this$props.bCloseFn;
      bsFn[PromptBox_n] = null;
      bcFn[PromptBox_n] = null;
      bCloseFn[PromptBox_n] = null;
    };

    _this.state = {
      showModal: _this.props.show || true,
      json: {}
    };
    return _this;
  }

  PromptBox_createClass(PromptBox, [{
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      var _this2 = this;

      var callback = function callback(json, bool) {
        if (bool) {
          _this2.setState({
            json: json
          }, function () {//console.log('多语加载完成')
          });
        }
      };

      Object(index_["getMultiLang"])({
        moduleId: "container_toast",
        callback: callback
      });
    }
  }, {
    key: "UNSAFE_componentWillReceiveProps",
    value: function UNSAFE_componentWillReceiveProps(nextProps) {
      this.setState({
        showModal: nextProps.show || this.props.show || false
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var json = this.state.json;

      var _this$props2 = this.props,
          content = _this$props2.content,
          title = _this$props2.title,
          _this$props2$color = _this$props2.color,
          color = _this$props2$color === void 0 ? "success" : _this$props2$color,
          _this$props2$noFooter = _this$props2.noFooter,
          noFooter = _this$props2$noFooter === void 0 ? false : _this$props2$noFooter,
          _this$props2$closeByC = _this$props2.closeByClickBackDrop,
          closeByClickBackDrop = _this$props2$closeByC === void 0 ? false : _this$props2$closeByC,
          _this$props2$noCancel = _this$props2.noCancelBtn,
          noCancelBtn = _this$props2$noCancel === void 0 ? false : _this$props2$noCancel,
          _this$props2$hasClose = _this$props2.hasCloseBtn,
          hasCloseBtn = _this$props2$hasClose === void 0 ? false : _this$props2$hasClose,
          _this$props2$beSureBt = _this$props2.beSureBtnName,
          beSureBtnName = _this$props2$beSureBt === void 0 ? json["0005"] : _this$props2$beSureBt,
          _this$props2$cancelBt = _this$props2.cancelBtnName,
          cancelBtnName = _this$props2$cancelBt === void 0 ? json["0006"] : _this$props2$cancelBt,
          _this$props2$zIndex = _this$props2.zIndex,
          zIndex = _this$props2$zIndex === void 0 ? 200 : _this$props2$zIndex,
          _this$props2$hotKeybo = _this$props2.hotKeyboard,
          hotKeyboard = _this$props2$hotKeybo === void 0 ? true : _this$props2$hotKeybo,
          other = PromptBox_objectWithoutProperties(_this$props2, ["content", "title", "color", "noFooter", "closeByClickBackDrop", "noCancelBtn", "hasCloseBtn", "beSureBtnName", "cancelBtnName", "zIndex", "hotKeyboard"]);

      if (!title) {
        if (color === "success") {
          title = json["0001"];
        } else if (color === "info") {
          title = json["0002"];
        } else if (color === "warning") {
          title = json["0003"];
        } else if (color === "danger") {
          title = json["0004"];
        }
      }

      var toastIcon = function toastIcon(color) {
        var iconName = "icon-wancheng";

        if (color === "danger") {
          iconName = "icon-shibai";
        } else if (color === "warning") {
          iconName = "icon-zhuyi1";
        } else if (color === "info") {
          iconName = "icon-tixing";
        }

        var name = "iconfont ".concat(iconName, " ").concat(color);
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: name
        });
      };

      var id = Date.now() + Object(index_["getSafeRandom"])();
      var indexInfo = {
        id: id,
        zIndex: zIndex
      };
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], PromptBox_extends({
        show: this.state.showModal,
        onHide: this.closeBtnClick.bind(this),
        className: "prompt-box ".concat(id),
        backdrop: closeByClickBackDrop ? true : "static",
        indexInfo: indexInfo,
        ref: function ref(Modal) {
          return _this3.Modal = Modal;
        },
        onExited: this.onExited
      }, other, {
        fieldid: this.props.fieldid ? this.props.fieldid : "simpleConfirm"
      }), hotKeyboard && !noFooter && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          sureBtnHandler: [base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM[0], 'enter'],
          cancelBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL
        },
        handlers: {
          sureBtnHandler: function sureBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              console.log("promptbox sureBtnHandler 事件回调");

              _this3.beSureClick();
            }
          },
          cancelBtnHandler: function cancelBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              console.log("promptbox cancelBtnHandler 事件回调");

              _this3.cancelClick();
            }
          }
        },
        className: "promptbox-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Header, {
        closeButton: hasCloseBtn ? true : false
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        fieldid: Object(index_["getSysFieldid"])("".concat(json["0007"], "_title"))
      }, json["0007"])), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Title, {
        className: "prompt-box-body-title"
      }, toastIcon(color), " ", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: 'title-text'
      }, title)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "prompt-box-body-content"
      }, content)), !noFooter && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Footer, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(beSureBtnName, "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM, ")"),
        trigger: ["hover", "focus"],
        className: "model-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.beSureClick,
        colors: "primary",
        fieldid: "confirm"
      }, beSureBtnName, "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "Y"), ")")), !noCancelBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(cancelBtnName, "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL, ")"),
        trigger: ["focus", "hover"],
        className: "model-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.cancelClick,
        shape: "border",
        fieldid: "cancel"
      }, cancelBtnName, "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "N"), ")"))));
    }
  }]);

  return PromptBox;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);
var beSureArr = [];
var cancelArr = [];
var closeArr = [];
var PromptBox_promptBox = function promptBox(props) {
  props = props || {}; //let app = document.getElementById('app');

  var container;

  if (props.container) {
    if (props.container.body) {
      container = props.container.body;
    }
  } else {
    container = document.body;
  }

  var div = document.createElement('section');
  div.className = 'prompt-box-project'; // div.style.position='absolute';
  // div.style.top='0';
  // div.style.right='0';

  beSureArr.push(props.beSureBtnClick);
  cancelArr.push(props.cancelBtnClick);
  closeArr.push(props.closeBtnClick); // container.style.position = 'absolute';
  // container.style.top='0';
  // container.style.right='0';

  container.appendChild(div);
  external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.render( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PromptBox_PromptBox, PromptBox_extends({}, props, {
    bsFn: beSureArr,
    bcFn: cancelArr,
    bCloseFn: closeArr,
    container: div
  })), div);
};
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/SignIn.js
function SignIn_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { SignIn_typeof = function _typeof(obj) { return typeof obj; }; } else { SignIn_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return SignIn_typeof(obj); }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function SignIn_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function SignIn_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function SignIn_createClass(Constructor, protoProps, staticProps) { if (protoProps) SignIn_defineProperties(Constructor.prototype, protoProps); if (staticProps) SignIn_defineProperties(Constructor, staticProps); return Constructor; }

function SignIn_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) SignIn_setPrototypeOf(subClass, superClass); }

function SignIn_setPrototypeOf(o, p) { SignIn_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return SignIn_setPrototypeOf(o, p); }

function SignIn_createSuper(Derived) { var hasNativeReflectConstruct = SignIn_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = SignIn_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = SignIn_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return SignIn_possibleConstructorReturn(this, result); }; }

function SignIn_possibleConstructorReturn(self, call) { if (call && (SignIn_typeof(call) === "object" || typeof call === "function")) { return call; } return SignIn_assertThisInitialized(self); }

function SignIn_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function SignIn_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function SignIn_getPrototypeOf(o) { SignIn_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return SignIn_getPrototypeOf(o); }

/**
 * 按钮权限,关键功能定义, 用户名密码登录组件
 */




var SignIn_SignIn = /*#__PURE__*/function (_Component) {
  SignIn_inherits(SignIn, _Component);

  var _super = SignIn_createSuper(SignIn);

  function SignIn(props) {
    var _this;

    SignIn_classCallCheck(this, SignIn);

    _this = _super.call(this, props);

    _this.handlePassWordChange = function (val) {
      _this.setState({
        passWord: val
      });
    };

    _this.handleSignIn = /*#__PURE__*/function () {
      var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(userCode, passWord) {
        var _this$props, resolve, lang, _yield$Promise, exponent, modulus, key, result;

        return regeneratorRuntime.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _this$props = _this.props, resolve = _this$props.resolve, lang = _this$props.lang;
                /**
                * 获取加密所需的公钥
                */

                _context.next = 3;
                return new Promise(function (resolve) {
                  Object(index_["ajax"])({
                    url: '/nccloud/baseapp/ncckeyfunc/getpubkey.do',
                    loading: false,
                    success: function success(res) {
                      var data = res.data;
                      resolve(data);
                    },
                    error: function error(res) {
                      console.log('后端报错', res);
                    }
                  });
                });

              case 3:
                _yield$Promise = _context.sent;
                exponent = _yield$Promise.exponent;
                modulus = _yield$Promise.modulus;

                /**
                * 密码加密
                */
                key = index_["RSAUtils"].getKeyPair(exponent, '', modulus);
                passWord = index_["RSAUtils"].encryptedString(key, passWord);
                /**
                * 用户名和密码后台校验
                */

                _context.next = 10;
                return new Promise(function (resolve) {
                  Object(index_["ajax"])({
                    url: '/nccloud/baseapp/ncckeyfunc/pwdverify.do',
                    loading: false,
                    data: {
                      encodePwd: passWord,
                      usercode: userCode
                    },
                    success: function success(res) {
                      var data = res.data;
                      resolve(data);
                    },
                    error: function error(res) {
                      console.log('后端报错', res);
                    }
                  });
                });

              case 10:
                result = _context.sent;

                if (!result) {
                  Object(index_["toast"])({
                    content: '',
                    color: 'danger',
                    groupOperation: true,
                    isNode: true,
                    // '展开', '收起', '关闭'
                    TextArr: [lang['page-button-0010'], lang['page-button-0011'], lang['page-button-0012']],
                    // 密码不正确
                    groupOperationMsg: [lang['page-button-0013']]
                  });
                }

                resolve(result);

              case 13:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      }));

      return function (_x, _x2) {
        return _ref.apply(this, arguments);
      };
    }();

    _this.state = {
      /**
      * 密码
      */
      passWord: ''
    };
    return _this;
  }
  /**
   * @param val 变化的值
   * 密码变化回调
   */


  SignIn_createClass(SignIn, [{
    key: "render",
    value: function render() {
      var passWord = this.state.passWord;
      var lang = this.props.lang;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        style: {
          display: 'flex',
          alignItems: 'center'
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        style: {
          width: '52px'
        }
      }, "".concat(lang['page-button-0006'], ":")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        style: {
          width: '200px'
        },
        value: passWord,
        onChange: this.handlePassWordChange // 请输入密码
        ,
        placeholder: lang['page-button-0007'],
        type: "password"
      })));
    }
  }]);

  return SignIn;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

/* harmony default export */ var ButtonApp_SignIn = (SignIn_SignIn);
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/create.js
function create_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { create_typeof = function _typeof(obj) { return typeof obj; }; } else { create_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return create_typeof(obj); }

function create_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function create_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { create_ownKeys(Object(source), true).forEach(function (key) { create_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { create_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function create_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function create_extends() { create_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return create_extends.apply(this, arguments); }

function create_createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = create_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function create_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return create_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return create_arrayLikeToArray(o, minLen); }

function create_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function create_asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function create_asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { create_asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { create_asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function create_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function create_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function create_createClass(Constructor, protoProps, staticProps) { if (protoProps) create_defineProperties(Constructor.prototype, protoProps); if (staticProps) create_defineProperties(Constructor, staticProps); return Constructor; }

function create_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) create_setPrototypeOf(subClass, superClass); }

function create_setPrototypeOf(o, p) { create_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return create_setPrototypeOf(o, p); }

function create_createSuper(Derived) { var hasNativeReflectConstruct = create_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = create_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = create_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return create_possibleConstructorReturn(this, result); }; }

function create_possibleConstructorReturn(self, call) { if (call && (create_typeof(call) === "object" || typeof call === "function")) { return call; } return create_assertThisInitialized(self); }

function create_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function create_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function create_getPrototypeOf(o) { create_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return create_getPrototypeOf(o); }



















__webpack_require__(1893);

var create_Item = base_index_["Menu"].Item;
var getGlobalStorage = index_["ViewModel"].getGlobalStorage; // const IS_TEST_ENV = NODE_ENV === 'test';

/**
 * 展示帮助
 */
// const SHOW_HELPER = false;
// get nearest parent element matching selector   origin from stackoverflow  add by bbqin

var Closest = function Closest(el, selector) {
  if (!el) {
    return null;
  }

  var matchesSelector = el.matches || el.webkitMatchesSelector || el.mozMatchesSelector || el.msMatchesSelector;

  while (el) {
    if (matchesSelector.call(el, selector)) {
      break;
    }

    el = el.parentElement;
  }

  return el;
}; // querySelector  不能識別數字開頭 不能識別特殊字符 ·/·


var create_replaceSpecialStr = function replaceSpecialStr(str) {
  return str.replace(/\/|\\|,/g, '') || str;
};

var create_recurToKeyboardMap = function recurToKeyboardMap(tree, parentVisible) {
  var obj = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
  tree.forEach(function (item) {
    if (item.key && item.keyboard) {
      var kb = util_firstToUpperCase(item.keyboard);
      obj[kb] = obj[kb] ? obj[kb] + 1 : 1;
    }

    if (item.children) {
      recurToKeyboardMap(item.children, item.visible !== false && parentVisible, obj);
    }
  });
  return obj;
};

var create_ButtonApp = /*#__PURE__*/function (_Component) {
  create_inherits(ButtonApp, _Component);

  var _super = create_createSuper(ButtonApp);

  function ButtonApp(props) {
    var _this2;

    create_classCallCheck(this, ButtonApp);

    _this2 = _super.call(this, props);

    _this2.getCurrentBtnIsKeyFunc = function (_ref) {
      var items = _ref.items,
          currentKey = _ref.currentKey;
      items.forEach(function (item) {
        var children = item.children,
            key = item.key,
            iskeyfunc = item.iskeyfunc;

        if (!Object(index_["isUndefined"])(children) && children.length) {
          if (currentKey === key) {
            _this2.iskeyfuncFlag = iskeyfunc;
          }

          _this2.getCurrentBtnIsKeyFunc({
            items: children,
            currentKey: currentKey
          });
        } else {
          if (currentKey === key) {
            _this2.iskeyfuncFlag = iskeyfunc;
          }
        }
      });
    };

    _this2.onClick = /*#__PURE__*/function () {
      var _ref2 = create_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(buttonInfo) {
        var lang, _this2$props, _this, _this2$props$_this$bi, billinfo, modalRelation, onClick, notInterruptCode, withAutoFocus, currentKey, item, iskeyfunc, appcode, _JSON$parse, userCode, checkMode, focusedDom, modalDom;

        return regeneratorRuntime.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                // 多语
                lang = _this2.state.lang;
                _this2$props = _this2.props, _this = _this2$props._this, _this2$props$_this$bi = _this2$props._this.billinfo, billinfo = _this2$props$_this$bi === void 0 ? {} : _this2$props$_this$bi, modalRelation = _this2$props.modalRelation, onClick = _this2$props.onClick, notInterruptCode = _this2$props.notInterruptCode, withAutoFocus = _this2$props.withAutoFocus;
                currentKey = buttonInfo.key, item = buttonInfo.item;

                _this2.getCurrentBtnIsKeyFunc({
                  items: [item],
                  currentKey: currentKey
                });

                iskeyfunc = _this2.iskeyfuncFlag;
                console.log('ca认证', iskeyfunc);
                /**
                * 关键功能定义
                * 当模版上设置了按钮权限字段iskeyfunc为true后才走关键功能定义逻辑
                * 对按钮的权限进行校验
                */

                if (!iskeyfunc) {
                  _context.next = 15;
                  break;
                }

                _this2.iskeyfuncFlag = null; //标志还原

                /**
                * 按钮权限校验
                * 根据应用编码和按钮编码返回该按钮在关键功能定义中的认证类型
                * 需要的参数为应用编码和按钮编码，分别为：appcode,appbtncode
                */

                /**
                * 获取应用编码
                */

                appcode = billinfo.appcode || index_["pageTo"].getAppCode();
                /**
                * 获取用户编码
                */

                _JSON$parse = JSON.parse(getGlobalStorage('localStorage', 'STOREFORINFODATA')), userCode = _JSON$parse.userCode;
                _context.next = 12;
                return new Promise(function (resolve) {
                  Object(index_["ajax"])({
                    url: '/nccloud/baseapp/ncckeyfunc/authentype.do',
                    loading: false,
                    data: {
                      // 应用编码
                      appcode: appcode,
                      // 按钮编码,就是key
                      appbtncode: currentKey
                    },
                    success: function success(res) {
                      var data = res.data;

                      switch (data) {
                        case '0':
                          //用户密码校验
                          PromptBox_promptBox({
                            color: 'info',
                            hotKeyboard: true,
                            // 关键功能验证
                            title: lang['page-button-0014'],
                            content: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ButtonApp_SignIn, {
                              ref: function ref(self) {
                                return _this2.signInSelf = self;
                              },
                              lang: lang,
                              resolve: resolve
                            }),
                            noFooter: false,
                            noCancelBtn: false,
                            // 确定
                            beSureBtnName: lang['page-button-0008'],
                            // 取消
                            cancelBtnName: lang['page-button-0009'],
                            beSureBtnClick: function beSureBtnClick() {
                              // 进行登录校验
                              var _this2$signInSelf = _this2.signInSelf,
                                  handleSignIn = _this2$signInSelf.handleSignIn,
                                  passWord = _this2$signInSelf.state.passWord;
                              handleSignIn(userCode, passWord);
                            },
                            cancelBtnClick: function cancelBtnClick() {
                              console.log('Cancel');
                            }
                          });
                          return;

                        case '1':
                          /**强制ca校验 **/
                          if (Object(index_["isFunction"])(window.superSign)) {
                            var _window$superSign = window.superSign(String(Object(index_["getSafeRandom"])() * 1000 + Object(index_["getSafeRandom"])()), userCode, true, true),
                                status = _window$superSign.status,
                                msg = _window$superSign.msg;

                            switch (status) {
                              // 返回0表示通过
                              case 0:
                                resolve(true);
                                break;
                              // 返回1 表示不通过

                              case 1:
                                Object(index_["toast"])({
                                  content: '',
                                  color: 'danger',
                                  groupOperation: true,
                                  isNode: true,
                                  // '展开', '收起', '关闭'
                                  TextArr: [lang['page-button-0010'], lang['page-button-0011'], lang['page-button-0012']],
                                  // ca检验不成功的提示信息
                                  groupOperationMsg: [msg]
                                });
                                resolve(false);
                                break;
                            }
                          }

                          return;

                        case '2':
                          //不进行校验
                          resolve(true);
                          return;
                      }
                    },
                    error: function error(res) {
                      console.log('后端报错', res);
                    }
                  });
                });

              case 12:
                checkMode = _context.sent;

                if (checkMode) {
                  _context.next = 15;
                  break;
                }

                return _context.abrupt("return");

              case 15:
                if (!(Object(utils["c" /* getCheckedExtendMethod */])(_this, 'beforeBtnClick')(buttonInfo.key, {
                  output: _this.output
                }) === false)) {
                  _context.next = 17;
                  break;
                }

                return _context.abrupt("return", false);

              case 17:
                if (modalRelation) {
                  // 焦點回執
                  modalDom = document.querySelector(".".concat(modalRelation));
                  focusedDom = modalDom.querySelector('.u-modal-body') || modalDom.querySelector('.u-modal-content');
                }

                modalRelation && focusedDom && focusedDom.focus();
                notInterruptCode.includes(buttonInfo.key) ? onClick(buttonInfo.key) : triggerOnClickWithBlurAction({
                  callBack: onClick,
                  buttonInfo: buttonInfo,
                  params: create_assertThisInitialized(_this2),
                  withAutoFocus: withAutoFocus
                });
                setTimeout(function () {
                  modalRelation && focusedDom && focusedDom.focus();
                }, 300); //二开按钮点击后回调

                Object(utils["c" /* getCheckedExtendMethod */])(_this, 'afterBtnClick')(buttonInfo.key, {
                  output: _this.output
                });

              case 22:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      }));

      return function (_x) {
        return _ref2.apply(this, arguments);
      };
    }();

    _this2.keyboardHandle = /*#__PURE__*/function () {
      var _ref3 = create_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(buttonInfo, hotkey) {
        var lang, _this2$props2, _this, _this2$props2$_this$b, billinfo, modalRelation, onClick, notInterruptCode, withAutoFocus, currentKey, item, iskeyfunc, appcode, _JSON$parse2, userCode, checkMode;

        return regeneratorRuntime.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                // 多语
                lang = _this2.state.lang;
                _this2$props2 = _this2.props, _this = _this2$props2._this, _this2$props2$_this$b = _this2$props2._this.billinfo, billinfo = _this2$props2$_this$b === void 0 ? {} : _this2$props2$_this$b, modalRelation = _this2$props2.modalRelation, onClick = _this2$props2.onClick, notInterruptCode = _this2$props2.notInterruptCode, withAutoFocus = _this2$props2.withAutoFocus;
                currentKey = buttonInfo.key, item = buttonInfo.item;

                _this2.getCurrentBtnIsKeyFunc({
                  items: [item],
                  currentKey: currentKey
                });

                iskeyfunc = _this2.iskeyfuncFlag;
                console.log('ca认证', iskeyfunc);
                /**
                * 关键功能定义
                * 当模版上设置了按钮权限字段iskeyfunc为true后才走关键功能定义逻辑
                * 对按钮的权限进行校验
                */

                if (!iskeyfunc) {
                  _context2.next = 15;
                  break;
                }

                _this2.iskeyfuncFlag = null; //标志还原

                /**
                * 按钮权限校验
                * 根据应用编码和按钮编码返回该按钮在关键功能定义中的认证类型
                * 需要的参数为应用编码和按钮编码，分别为：appcode,appbtncode
                */

                /**
                * 获取应用编码
                */

                appcode = billinfo.appcode || index_["pageTo"].getAppCode();
                /**
                * 获取用户编码
                */

                _JSON$parse2 = JSON.parse(getGlobalStorage('localStorage', 'STOREFORINFODATA')), userCode = _JSON$parse2.userCode;
                _context2.next = 12;
                return new Promise(function (resolve) {
                  Object(index_["ajax"])({
                    url: '/nccloud/baseapp/ncckeyfunc/authentype.do',
                    loading: false,
                    data: {
                      // 应用编码
                      appcode: appcode,
                      // 按钮编码,就是key
                      appbtncode: currentKey
                    },
                    success: function success(res) {
                      var data = res.data;

                      switch (data) {
                        case '0':
                          //用户密码校验
                          PromptBox_promptBox({
                            color: 'info',
                            hotKeyboard: true,
                            // 关键功能验证
                            title: lang['page-button-0014'],
                            content: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ButtonApp_SignIn, {
                              ref: function ref(self) {
                                return _this2.signInSelf = self;
                              },
                              lang: lang,
                              resolve: resolve
                            }),
                            noFooter: false,
                            noCancelBtn: false,
                            // 确定
                            beSureBtnName: lang['page-button-0008'],
                            // 取消
                            cancelBtnName: lang['page-button-0009'],
                            beSureBtnClick: function beSureBtnClick() {
                              // 进行登录校验
                              var _this2$signInSelf2 = _this2.signInSelf,
                                  handleSignIn = _this2$signInSelf2.handleSignIn,
                                  passWord = _this2$signInSelf2.state.passWord;
                              handleSignIn(userCode, passWord);
                            },
                            cancelBtnClick: function cancelBtnClick() {
                              console.log('Cancel');
                            }
                          });
                          return;

                        case '1':
                          /**强制ca校验 **/
                          if (Object(index_["isFunction"])(window.superSign)) {
                            var _window$superSign2 = window.superSign(String(Object(index_["getSafeRandom"])() * 1000 + Object(index_["getSafeRandom"])()), userCode, true, true),
                                status = _window$superSign2.status,
                                msg = _window$superSign2.msg;

                            switch (status) {
                              // 返回0表示通过
                              case 0:
                                resolve(true);
                                break;
                              // 返回1 表示不通过

                              case 1:
                                Object(index_["toast"])({
                                  content: '',
                                  color: 'danger',
                                  groupOperation: true,
                                  isNode: true,
                                  // '展开', '收起', '关闭'
                                  TextArr: [lang['page-button-0010'], lang['page-button-0011'], lang['page-button-0012']],
                                  // ca检验不成功的提示信息
                                  groupOperationMsg: [msg]
                                });
                                resolve(false);
                                break;
                            }
                          }

                          return;

                        case '2':
                          //不进行校验
                          resolve(true);
                          return;
                      }
                    },
                    error: function error(res) {
                      console.log('后端报错', res);
                    }
                  });
                });

              case 12:
                checkMode = _context2.sent;

                if (checkMode) {
                  _context2.next = 15;
                  break;
                }

                return _context2.abrupt("return");

              case 15:
                if (!(Object(utils["c" /* getCheckedExtendMethod */])(_this, 'beforeBtnClick')(buttonInfo.key, {
                  output: _this.output
                }) === false)) {
                  _context2.next = 17;
                  break;
                }

                return _context2.abrupt("return", false);

              case 17:
                // 先去除一下hotkey 变量  主要是业务组自己添加了变量
                index_["ViewModel"].btnHotKey = hotkey;
                notInterruptCode.includes(buttonInfo.key) ? onClick(buttonInfo.key) : triggerOnClickWithBlurAction({
                  callBack: onClick,
                  buttonInfo: buttonInfo,
                  params: create_assertThisInitialized(_this2),
                  withAutoFocus: withAutoFocus
                });
                index_["ViewModel"].btnHotKey = ''; //二开按钮点击后回调

                Object(utils["c" /* getCheckedExtendMethod */])(_this, 'afterBtnClick')(buttonInfo.key, {
                  output: _this.output
                });

              case 21:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2);
      }));

      return function (_x2, _x3) {
        return _ref3.apply(this, arguments);
      };
    }();

    _this2.getKeyMapsAndHandlers = function (data) {
      var keyMap = {},
          handlers = {},
          _this2$props3 = _this2.props,
          hotKeysMap = _this2$props3.hotKeysMap,
          enabled = _this2$props3.hotKeysEnabled,
          modalRelation = _this2$props3.modalRelation,
          page = _this2$props3._this,
          _this2$props3$ignoreH = _this2$props3.ignoreHotkeyCode,
          ignoreHotkeyCode = _this2$props3$ignoreH === void 0 ? [] : _this2$props3$ignoreH; // console.log(page);
      // 用於去重

      var keyboardMap = create_recurToKeyboardMap(data); // console.log(keyboardMap);
      // 树深度遍历

      var process = function process(tree, parentVisible) {
        return tree.forEach(function (item) {
          var info = hotKeysMap[item.key];

          if (item.children) {
            process(item.children, item.visible !== false && parentVisible);
          } // 同组内注册两个相同快捷键的按钮 隐藏的 禁用的 就不绑定快捷键了


          if (item.keyboard && keyboardMap[util_firstToUpperCase(item.keyboard)] > 1 && (item.visible === false || item.disabled === true || item.isenable === false || parentVisible === false)) {
            return false;
          }

          if (ignoreHotkeyCode.indexOf(item.key) !== -1) {
            // 忽略的 移除 keyboard
            delete item.keyboard;
          }

          if (ignoreHotkeyCode.indexOf(item.key) == -1 && (info || item.keyboard)) {
            var keyMapItem = item.keyboard || info.key;
            var multipleKeyboardKey = keyMapItem.split(',').length > 1;
            keyMap[item.key] = multipleKeyboardKey ? keyMapItem.split(',') : keyMapItem; // keyMap[item.key] = { sequence: keyMapItem, action: "keypress" }

            handlers[item.key] = function () {
              // 同组内多个按钮重复的问题处理  肩部和表体行
              var pageareacode = page && page.output && page.output.findFocusModuleId(); // 针对多区域按钮相同的处理‘

              if (pageareacode && item.pageareacode && pageareacode !== item.pageareacode || item.pageareacode && pageareacode == null) {
                return false;
              } // 弹窗背景里的按钮禁用


              var disabledBgBtn = document.querySelector('.disabled-bg-btn') || top.document.querySelector('.disabled-bg-btn');

              if (disabledBgBtn && !modalRelation) {
                return false;
              } // 弹窗弹出中的按钮  判断当前弹窗是不是被聚焦了


              if (modalRelation) {
                var modal = document.querySelector(".".concat(modalRelation));
                var active = modal && modal.contains(document.activeElement) && modal !== document.activeElement; // 弹窗不存在  或者弹窗未激活

                if (!modal || !(modal.contains(document.activeElement) && active)) {
                  return false;
                }
              } // 解决  如果click回调中是ajax多次调用的问题  方案是通过平台内的ajax都有mask处理
              // 上传按钮 以及按钮的显示隐藏特性


              if (!document.querySelector('.u-loading-backdrop.full-screen') && !_this2.handleSpecialBtn(item) && item.visible !== false && item.disabled !== true && item.isenable !== false && parentVisible !== false) {
                _this2.keyboardHandle({
                  key: item.key,
                  title: item.title,
                  item: item
                }, keyMapItem);
              } // TODO 可以考虑做 promise 的判断

            };
          } //

        });
      };

      enabled && process(data, true);
      return {
        keyMap: keyMap,
        handlers: handlers
      };
    };

    _this2.getTipKeybodard = function (item) {
      var tipKeybodard = _this2.props.tipKeybodard;

      if (tipKeybodard === 'underline' && item.keyboard && item.disabled !== true) {
        // 现在只针对单键 以后可能会变成多键
        var kbs = item.keyboard.split('+');
        return [item.title, '(', /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "text-decoration-underline"
        }, kbs ? kbs[kbs.length - 1].toUpperCase() : item.keyboard), ')'];
      } else {
        return item.title;
      }
    };

    _this2.renderButtons = function () {
      // pageareacode
      // this=>ButtonApp 组件
      var _this2$props4 = _this2.props,
          area = _this2$props4.area,
          _this = _this2$props4._this,
          hotKeysEnabled = _this2$props4.hotKeysEnabled,
          tipKeybodard = _this2$props4.tipKeybodard;
      var lang = _this2.state.lang;
      var allButtons = _this.myState.buttons || [];
      var json = [];

      var _iterator = create_createForOfIteratorHelper(allButtons),
          _step;

      try {
        var _loop = function _loop() {
          var item = _step.value;

          if (item.area) {
            var arr = item.area.split(',');
            arr.map(function (elem) {
              elem = elem.trim();

              if (elem === area) {
                json.push(item);
              }

              return elem;
            });
          }
        };

        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          _loop();
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      json.sort(function (a, b) {
        return Number(a.order) - Number(b.order);
      });
      _this.myState.appButtons[area] = json; // 获取hotkeys  bbqin

      var keyHandlers = _this2.getKeyMapsAndHandlers(json, area);

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "button-app-wrapper ".concat(area ? area + '-button-app-wrapper' : '')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        display: "inline-block",
        keyMap: keyHandlers.keyMap,
        handlers: keyHandlers.handlers,
        enabled: hotKeysEnabled,
        focused: true
      }, json.map(function (item) {
        if (item.visible !== false) {
          switch (item.type) {
            // 因为需求 type将主要次要按钮分离出去 用btncolor表示 之前的单个按钮按general_btn表示
            // case "button_main":
            case 'general_btn':
              var Btn = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
                title: item.title,
                keyboard: item.keyboard,
                disabled: item.disabled,
                delayShow: 500
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
                disabled: item.disabled,
                className: item.btncolor == 'button_main' ? 'button-primary' : '',
                onClick: function onClick() {
                  return _this2.onClick({
                    key: item.key,
                    title: item.title,
                    item: item
                  });
                },
                tabindex: _this2.props.tabindex,
                fieldid: item.key,
                "btn-code": item.key
              }, _this2.getTipKeybodard(item)));
              var RefshBtn = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
                title: item.title,
                keyboard: item.keyboard,
                delayShow: 500
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
                disabled: item.disabled,
                className: item.btncolor == 'button_main' ? 'button-primary refresh-component' : 'refresh-component',
                onClick: function onClick() {
                  return _this2.onClick({
                    key: item.key,
                    title: item.title,
                    item: item
                  });
                },
                tabindex: _this2.props.tabindex,
                fieldid: item.key,
                "btn-code": item.key
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
                className: "iconfont icon-shuaxin1"
              }))); // 没有title渲染成刷新按钮,有uploadConfig给按钮增加上传功能,没有uploadConfig渲染普通按钮

              return !item.title && !item.parentCode ? RefshBtn : Object(index_["isObj"])(item.uploadConfig) && !item.disabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], create_extends({
                showUploadList: false
              }, item.uploadConfig), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
                title: item.title,
                keyboard: item.keyboard,
                delayShow: 500
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
                disabled: item.disabled,
                className: classnames_default()(create_replaceSpecialStr(" nc-".concat(item.area, "-btn-").concat(item.key, " ")), {
                  'button-primary upload-btn-wrapper': item.btncolor == 'button_main',
                  'upload-btn-wrapper': item.btncolor != 'button_main'
                }),
                onClick: function onClick() {
                  return _this2.onClick({
                    key: item.key,
                    title: item.title,
                    item: item
                  });
                },
                tabindex: _this2.props.tabindex,
                fieldid: item.key,
                "btn-code": item.key
              }, item.title, item.docAmount ? "(".concat(item.docAmount, ")") : ''))) : !item.title && item.parentCode ? '' : Btn;

            case 'dropdown':
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MyDropDown_MyDropdown, {
                list: item.children,
                title: item.title,
                disabled: item.disabled,
                btncolor: item.btncolor,
                area: area,
                dropdownType: item.dropdownType,
                popContainer: _this2.props.popContainer,
                keyboard: item.keyboard,
                clskey: item.key,
                onClick: function onClick(buttonInfo) {
                  return _this2.onClick(create_objectSpread(create_objectSpread({}, buttonInfo), {}, {
                    item: item
                  }));
                },
                tabindex: _this2.props.tabindex,
                className: "".concat(area, "-").concat(item.key, "-panel fieldid_").concat(item.key, "_btn_list"),
                delayShow: 500
              });

            case 'buttongroup':
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MyButtonGroup_MyButtonGroup, {
                fieldid: item.key,
                "btn-code": item.key,
                list: item.children,
                area: area,
                _this: _this,
                disabled: item.disabled,
                visible: item.visible !== false,
                buttonLimit: _this2.props.buttonLimit,
                popContainer: _this2.props.popContainer,
                tipKeybodard: tipKeybodard,
                clskey: item.key,
                onClick: function onClick(buttonInfo) {
                  return _this2.onClick(create_objectSpread(create_objectSpread({}, buttonInfo), {}, {
                    item: item
                  }));
                },
                tabindex: _this2.props.tabindex
              });

            case 'divider':
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(MyDividerButtons_MyDividerButton, {
                list: item.children,
                dividerType: item.dividerType,
                _key: item.key,
                area: area,
                btncolor: item.btncolor,
                isenable: item.isenable // 分割按钮的权限要特殊处理
                ,
                title: item.title,
                onClick: function onClick(buttonInfo) {
                  return _this2.onClick(create_objectSpread(create_objectSpread({}, buttonInfo), {}, {
                    item: item
                  }));
                },
                disabled: item.disabled,
                uploadConfig: item.uploadConfig,
                popContainer: _this2.props.popContainer,
                tabindex: _this2.props.tabindex,
                keyboard: item.keyboard
              });

            case 'more':
              //子级按钮没有，则不限显示父级
              var moreBtnlist = item.children;
              var renderMoreBtn = [];
              moreBtnlist.map(function (item) {
                if (item.children && item.children.length) {
                  renderMoreBtn.push(item);
                }
              }); //所有子级按钮没有则不显示更多按钮

              if (!renderMoreBtn.length) {
                return null;
              }

              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Mores_More, {
                list: renderMoreBtn,
                title: item.title,
                json: lang,
                btncolor: item.btncolor,
                disabled: item.disabled,
                popContainer: _this2.props.popContainer,
                onClick: function onClick(buttonInfo) {
                  return _this2.onClick(create_objectSpread(create_objectSpread({}, buttonInfo), {}, {
                    item: item
                  }));
                },
                className: "moreButton-component",
                tabindex: _this2.props.tabindex,
                clskey: item.key,
                area: item.area
              });

            default:
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(HelperTip_HelperTip, {
                title: item.title,
                keyboard: item.keyboard,
                delayShow: 500
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
                btncolor: item.btncolor,
                disabled: item.disabled,
                onClick: function onClick() {
                  return _this2.onClick({
                    key: item.key,
                    title: item.title,
                    item: item
                  });
                },
                tabindex: _this2.props.tabindex,
                fieldid: item.key,
                "btn-code": item.key
              }, item.title));
          }
        }
      })));
    };

    _this2.state = {
      json: [],
      lang: {},
      intl: null
    };
    _this2.bindWebsocket = false;
    _this2.iskeyfuncFlag = null;
    return _this2;
  }

  create_createClass(ButtonApp, [{
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      var _this3 = this;

      var _this$props = this.props,
          area = _this$props.area,
          _this = _this$props._this;
      var buttonsLangJson = _this.myState.buttonsLangJson;
      _this.myState.buttonsComponent[area] = this;

      if (buttonsLangJson.lang) {
        this.setState({
          json: this.props.json || [],
          lang: buttonsLangJson.lang,
          intl: buttonsLangJson.intl
        });
      } else {
        var callback = function callback(lang, bool, intl) {
          _this.myState.buttonsLangJson = {
            lang: lang,
            intl: intl
          };

          _this3.setState({
            json: _this3.props.json || [],
            lang: lang,
            intl: intl
          });
        };

        Object(index_["getMultiLang"])({
          moduleId: 'page-button',
          callback: callback
        });
      }
    }
  }, {
    key: "UNSAFE_componentWillReceiveProps",
    value: function UNSAFE_componentWillReceiveProps() {
      var _this$props2 = this.props,
          area = _this$props2.area,
          _this = _this$props2._this;
      this.setState({
        json: this.props.json || []
      });

      if (!_this.myState.buttonsComponent[area]) {
        _this.myState.buttonsComponent[area] = this;
      }
    }
    /**
     * 获取当前点击的按钮的iskeyfunc属性
     * iskeyfunc属性表示按钮是否需要进行关键功能定义的校验
    */

  }, {
    key: "handleSpecialBtn",

    /**
     * 处理特殊按钮
     */
    value: function handleSpecialBtn(item) {
      if (!item || !Object(index_["isObj"])(item.uploadConfig)) {
        return false;
      }

      var wrapper = Object(external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_["findDOMNode"])(this);

      if (!wrapper) {
        return false;
      } // 如果有父级元素  就需要先展开父级  否则取不到dom


      if (item.parentCode) {
        // 弹窗容器位置
        var popContainer = this.props.popContainer || document,
            cls = create_replaceSpecialStr(".nc-".concat(item.area, "-btn-").concat(item.parentCode, "-").concat(item.key)); // 目标元素

        var target = popContainer.querySelector(cls); // 第一次的时候弹出下元素

        var icon = wrapper.querySelector(create_replaceSpecialStr(".nc-".concat(item.area, "-").concat(item.topParentCode || item.parentCode, "-icon")));
        icon && !target && icon.click(); // 调用目标元素的click事件

        setTimeout(function () {
          target = popContainer.querySelector(cls);
          var uploadDom = target && target.parentElement.querySelector('input');
          uploadDom && uploadDom.click();
        }, 0);
      } else {
        var _target = wrapper.querySelector(create_replaceSpecialStr(".nc-".concat(item.area, "-btn-").concat(item.key)));

        var uploadDom = _target && _target.parentElement.querySelector('input');

        uploadDom && uploadDom.click();
      }
    }
    /**
     * 获取事件信息  bbqin
     */

  }, {
    key: "render",
    value: function render() {
      return this.renderButtons();
    }
  }]);

  return ButtonApp;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

function uuidv4() {
  return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    var r = Object(index_["getSafeRandom"])() * 16 | 0,
        v = c == 'x' ? r : r & 0x3 | 0x8;
    return v.toString(16);
  });
}

var create_OprationButton = /*#__PURE__*/function (_Component2) {
  create_inherits(OprationButton, _Component2);

  var _super2 = create_createSuper(OprationButton);

  function OprationButton(props) {
    var _this4;

    create_classCallCheck(this, OprationButton);

    _this4 = _super2.call(this, props);

    _this4.onVisibleChange = function () {
      // let { _this } = this.props;
      // _this.myState.oprationBtnListVisible = !this.state.visible
      _this4.setState({
        visible: !_this4.state.visible
      });
    };

    _this4.popContentItem = function (item) {
      var onClick = _this4.props.onClick;
      var popContent = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "iconfont icon-tixing"
      }), " \xA0", item.popContent);
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Popconfirm"], {
        trigger: "click",
        placement: "top",
        content: popContent,
        onClose: function onClose() {
          onClick(item.key);

          _this4.setState({
            visible: false
          });
        },
        onCancel: function onCancel() {
          _this4.setState({
            visible: false
          });
        },
        rootClose: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("a", {
        className: 'u-menu-item-title-wrapper row-btn-' + create_replaceSpecialStr(item.key) // className="row-edit-option"
        ,
        onClick: function onClick(e) {
          e.stopPropagation();
        },
        key: item.key,
        fieldid: Object(index_["getSysFieldid"])("".concat(item.key, "_btn")),
        "btn-code": item.key
      }, item.title));
    };

    _this4.popContentItem1 = function (item, list) {
      return item.popContent ? _this4.popContentItem(item, list) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "u-menu-item-title-wrapper",
        "btn-code": item.key,
        onClick: function onClick(e) {
          _this4.onClick({
            key: item.key,
            e: e,
            item: item
          });

          _this4.setState({
            visible: false
          });
        } //fieldid={`${item.key}_btn`}

      }, item.title);
    };

    _this4.renderMenu = function (list) {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Menu"], null, list.map(function (item) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(create_Item, {
          key: item.key,
          disabled: item.disabled
        }, item.uploadConfig ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          onClick: function onClick(e) {
            e.stopPropagation();
          }
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], create_extends({
          showUploadList: false
        }, item.uploadConfig), item.title)) : _this4.popContentItem1(item, 'list'));
      }));
    };

    _this4.renderMoreList = function (list, rowIndex) {
      var popContainer = _this4.props.popContainer;
      var lang = _this4.state.lang;

      if (list.length) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Dropdown"], {
          trigger: ['click'],
          visible: _this4.state.visible,
          onVisibleChange: _this4.onVisibleChange,
          overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Menu"], null, list.map(function (item) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(create_Item, {
              fieldid: item.key,
              "btn-code": item.key,
              className: 'opration-more-list-item-wrapper row-btn-' + create_replaceSpecialStr(item.key),
              key: item.key
            }, item.uploadConfig ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
              "btn-code": item.key,
              onClick: function onClick(e) {
                e.stopPropagation();
              },
              className: "".concat(OPERATION_UPLOAD_CLASSNAME, "-").concat(rowIndex)
            }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], create_extends({
              showUploadList: false
            }, item.uploadConfig), item.title)) : _this4.popContentItem1(item, 'list'));
          })),
          animation: "slide-up",
          overlayClassName: "dropdown-component-list fieldid_more_btn_list",
          getPopupContainer: function getPopupContainer() {
            return popContainer || document.body;
          }
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("a", {
          fieldid: Object(index_["getSysFieldid"])('more_btn'),
          className: 'row-more ' + list.reduce(function (accumulator, curent) {
            accumulator = accumulator + ' row-btn-' + create_replaceSpecialStr(curent.key);
            return accumulator;
          }, ''),
          onClick: _this4.onVisibleChange
        }, lang['page-button-0002'] || '更多'));
      } else {
        return '';
      }
    };

    _this4.renderLanglist = function (list, rowIndex) {
      var popContainer = _this4.props.popContainer;

      if (list.length) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          trigger: "click",
          placement: "leftTop",
          visible: _this4.state.visible,
          rootClose: true,
          className: "dropdown-component-list fieldid_more_btn_list opration-tooltip-button",
          container: function container() {
            return popContainer || document.body;
          },
          overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", null, list.map(function (item) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
              fieldid: Object(index_["getSysFieldid"])(item.key),
              "btn-code": item.key,
              className: 'opration-more-list-item-wrapper row-btn-' + create_replaceSpecialStr(item.key),
              key: item.key
            }, item.uploadConfig ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
              "btn-code": item.key,
              onClick: function onClick(e) {
                e.stopPropagation();
              },
              className: "".concat(OPERATION_UPLOAD_CLASSNAME, "-").concat(rowIndex)
            }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Upload"], create_extends({
              showUploadList: false
            }, item.uploadConfig), item.title)) : _this4.popContentItem1(item, 'list'));
          })) //   animation="slide-up"
          //   overlayClassName="dropdown-component-list fieldid_more_btn_list"
          //   getPopupContainer={() => popContainer || document.body}

        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("a", {
          fieldid: Object(index_["getSysFieldid"])('more_btn'),
          className: 'row-more ' + list.reduce(function (accumulator, curent) {
            accumulator = accumulator + ' row-btn-' + create_replaceSpecialStr(curent.key);
            return accumulator;
          }, '') + ' icon-gengduo1 iconfont',
          onClick: _this4.onVisibleChange
        }));
      } else {
        return '';
      }
    };

    _this4.getHotkeyTriggerFlag = function (key) {
      // console.time("getHotkeyTriggerFlag");
      var selectedRow = null; // 获取当前按钮的组容器

      var wrapper = Object(external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_["findDOMNode"])(create_assertThisInitialized(_this4));

      if (!wrapper) {
        return false;
      } // ajax请求中  存在的dom


      var loading = document.querySelector('.u-loading-backdrop.full-screen');

      if (loading) {
        return false;
      } // 获取指定目标的按钮


      var target = wrapper.querySelector('.row-btn-' + create_replaceSpecialStr(key));

      if (!target) {
        return false;
      } // 获取当前的固定列


      var parentContainer = Closest(wrapper, '.u-table-fixed-right'); // 选中行的selector选择器

      var selector = '.tree-table-col-selected,.table-row-selected,.editTable-selected-row,.cardTable-selected-row,.simpleTable-selected-row,.nctable-selected-row'; // 判断是否带有固定列的情况

      if (parentContainer) {
        // 获取目标选中行
        selectedRow = parentContainer.querySelector(selector);
      } else {
        var isFixed = Closest(target, '.u-table-row-fixed-columns-in-body'); // 获取当前选中行

        if (!isFixed) {
          selectedRow = Closest(wrapper, selector);
        }
      }

      if (!selectedRow) {
        return false;
      } // 目标按钮是否是可见的  这句可能判断不出来显示和隐藏


      var targetVisble = getComputedStyle(target).visibility !== 'hidden'; // 目标可见  并且是当前选中行

      var flag = selectedRow.contains(target) && targetVisble; // console.timeEnd("getHotkeyTriggerFlag");

      return flag ? target : false;
    };

    _this4.getKeyMapsAndHandlers = function (_ref4) {
      var data = _ref4.data,
          rowIndex = _ref4.rowIndex;
      var keyMap = {},
          handlers = {},
          _this4$props = _this4.props,
          hotKeysMap = _this4$props.hotKeysMap,
          enabled = _this4$props.hotKeysEnabled,
          modalRelation = _this4$props.modalRelation,
          onClick = _this4$props.onClick,
          page = _this4$props._this,
          _this4$props$ignoreHo = _this4$props.ignoreHotkeyCode,
          ignoreHotkeyCode = _this4$props$ignoreHo === void 0 ? [] : _this4$props$ignoreHo,
          notInterruptCode = _this4$props.notInterruptCode,
          withAutoFocus = _this4$props.withAutoFocus; // 树深度遍历

      var process = function process(tree) {
        return tree.forEach(function (item) {
          var info = hotKeysMap[item.key];

          if (ignoreHotkeyCode.indexOf(item.key) == -1 && (info || item.keyboard) // &&
          // item.visible !== false &&
          // item.disabled !== true &&
          // item.isenable !== false
          ) {
              var keyMapItem = item.keyboard || info.key;
              var multipleKeyboardKey = keyMapItem.split(',').length > 1;
              keyMap[item.key] = multipleKeyboardKey ? keyMapItem.split(',') : keyMapItem;

              handlers[item.key] = function (e) {
                var target = _this4.getHotkeyTriggerFlag(item.key); // 针对多区域按钮相同的处理‘


                var pageareacode = page && page.output && page.output.findFocusModuleId();

                if (pageareacode && item.pageareacode && pageareacode !== item.pageareacode || item.pageareacode && pageareacode == null) {
                  return false;
                } // 弹窗背景里的按钮禁用


                var disabledBgBtn = document.querySelector('.disabled-bg-btn') || top.document.querySelector('.disabled-bg-btn');

                if (disabledBgBtn && !modalRelation) {
                  return false;
                } // 弹窗里弹出的情况 判断


                if (modalRelation) {
                  var modal = document.querySelector(".".concat(modalRelation));
                  var active = modal && modal.contains(document.activeElement) && modal !== document.activeElement; // 弹窗不存在  或者弹窗未激活

                  if (!modal || !(modal.contains(document.activeElement) && active)) {
                    return false;
                  }
                }

                if (target && item.visible !== false // &&
                // item.disabled !== true &&
                // item.isenable !== false
                ) {
                    if (item.popContent) {
                      // 有弹窗的情况
                      target.click();
                    } else if (target.className.includes('row-more')) {
                      if (item.uploadConfig) {
                        var uniqueClassName = "".concat(OPERATION_UPLOAD_CLASSNAME, "-").concat(rowIndex);
                        var uploadDom = document.querySelector(".".concat(uniqueClassName, " input"));

                        if (uploadDom) {
                          uploadDom && uploadDom.click();
                        } else {
                          target.click();
                          setTimeout(function () {
                            uploadDom = document.querySelector(".".concat(uniqueClassName, " input"));
                            uploadDom && uploadDom.click();
                            target.click();
                          });
                        }
                      }

                      notInterruptCode.includes(item.key) ? onClick(item.key, e, keyMapItem) : triggerOnClickWithBlurAction({
                        callBack: onClick,
                        buttonInfo: item,
                        e: e,
                        keyMapItem: keyMapItem,
                        withAutoFocus: withAutoFocus
                      });
                    } else {
                      notInterruptCode.includes(item.key) ? onClick(item.key, e, keyMapItem) : triggerOnClickWithBlurAction({
                        callBack: onClick,
                        buttonInfo: item,
                        e: e,
                        keyMapItem: keyMapItem,
                        withAutoFocus: withAutoFocus
                      });
                    }
                  }
              };
            }

          if (item.children) {
            process(item.children);
          }
        });
      };

      enabled && process(data);
      return {
        keyMap: keyMap,
        handlers: handlers
      };
    };

    _this4.onClick = /*#__PURE__*/function () {
      var _ref5 = create_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(buttonInfo) {
        var lang, _this4$props2, _this4$props2$_this$b, billinfo, onClick, currentKey, e, _buttonInfo$item, item, appcode, _JSON$parse3, userCode, checkMode;

        return regeneratorRuntime.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                lang = _this4.state.lang;
                _this4$props2 = _this4.props, _this4$props2$_this$b = _this4$props2._this.billinfo, billinfo = _this4$props2$_this$b === void 0 ? {} : _this4$props2$_this$b, onClick = _this4$props2.onClick;
                currentKey = buttonInfo.key, e = buttonInfo.e, _buttonInfo$item = buttonInfo.item, item = _buttonInfo$item === void 0 ? {} : _buttonInfo$item;

                if (!item.iskeyfunc) {
                  _context3.next = 11;
                  break;
                }

                /**
                * 按钮权限校验
                * 根据应用编码和按钮编码返回该按钮在关键功能定义中的认证类型
                * 需要的参数为应用编码和按钮编码，分别为：appcode,appbtncode
                */

                /**
                * 获取应用编码
                */
                appcode = billinfo.appcode || index_["pageTo"].getAppCode();
                /**
                * 获取用户编码
                */

                _JSON$parse3 = JSON.parse(getGlobalStorage('localStorage', 'STOREFORINFODATA')), userCode = _JSON$parse3.userCode;
                _context3.next = 8;
                return new Promise(function (resolve) {
                  Object(index_["ajax"])({
                    url: '/nccloud/baseapp/ncckeyfunc/authentype.do',
                    loading: false,
                    data: {
                      // 应用编码
                      appcode: appcode,
                      // 按钮编码,就是key
                      appbtncode: currentKey
                    },
                    success: function success(res) {
                      var data = res.data;

                      switch (data) {
                        case '0':
                          /** 用户密码校验 */
                          PromptBox_promptBox({
                            color: 'info',
                            hotKeyboard: true,
                            // 关键功能验证
                            title: lang['page-button-0014'],
                            content: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ButtonApp_SignIn, {
                              ref: function ref(self) {
                                return _this4.signInSelf = self;
                              },
                              lang: lang,
                              resolve: resolve
                            }),
                            noFooter: false,
                            noCancelBtn: false,
                            // 确定
                            beSureBtnName: lang['page-button-0008'],
                            // 取消
                            cancelBtnName: lang['page-button-0009'],
                            beSureBtnClick: function beSureBtnClick() {
                              // 进行登录校验
                              var _this4$signInSelf = _this4.signInSelf,
                                  handleSignIn = _this4$signInSelf.handleSignIn,
                                  passWord = _this4$signInSelf.state.passWord;
                              handleSignIn(userCode, passWord);
                            },
                            cancelBtnClick: function cancelBtnClick() {
                              console.log('Cancel');
                            }
                          });
                          return;

                        case '1':
                          /**强制ca校验 **/
                          if (Object(index_["isFunction"])(window.superSign)) {
                            var _window$superSign3 = window.superSign(String(Object(index_["getSafeRandom"])() * 1000 + Object(index_["getSafeRandom"])()), userCode, true, true),
                                status = _window$superSign3.status,
                                msg = _window$superSign3.msg;

                            switch (status) {
                              // 返回0表示通过
                              case 0:
                                resolve(true);
                                break;
                              // 返回1 表示不通过

                              case 1:
                                Object(index_["toast"])({
                                  content: '',
                                  color: 'danger',
                                  groupOperation: true,
                                  isNode: true,
                                  // '展开', '收起', '关闭'
                                  TextArr: [lang['page-button-0010'], lang['page-button-0011'], lang['page-button-0012']],
                                  // ca检验不成功的提示信息
                                  groupOperationMsg: [msg]
                                });
                                resolve(false);
                                break;
                            }
                          }

                          return;

                        case '2':
                          //不进行校验
                          resolve(true);
                          return;
                      }
                    },
                    error: function error(res) {
                      console.log('后端报错', res);
                    }
                  });
                });

              case 8:
                checkMode = _context3.sent;

                if (checkMode) {
                  _context3.next = 11;
                  break;
                }

                return _context3.abrupt("return");

              case 11:
                onClick(currentKey, e);

              case 12:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3);
      }));

      return function (_x4) {
        return _ref5.apply(this, arguments);
      };
    }();

    _this4.state = {
      visible: false,
      index: 0,
      lang: {},
      intl: null,
      json: []
    };
    _this4.bindWebsocket = false;
    _this4.uuid = uuidv4();
    return _this4;
  }

  create_createClass(OprationButton, [{
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      var _this5 = this;

      var _this$props3 = this.props,
          oprationIndex = _this$props3.oprationIndex,
          _this = _this$props3._this,
          area = _this$props3.area;
      var buttonsLangJson = _this.myState.buttonsLangJson; // 记录列表页面的组件

      _this.myState.buttonsComponent[area] = _this.myState.buttonsComponent[area] || {};
      _this.myState.buttonsComponent[area]._isOperateButton = true;
      _this.myState.buttonsComponent[area][this.uuid] = this;
      _this.myState.oprationIndexCopy = oprationIndex;

      if (buttonsLangJson.lang) {
        this.setState({
          json: this.props.json || [],
          index: oprationIndex,
          lang: buttonsLangJson.lang,
          intl: buttonsLangJson.intl
        });
      } else {
        var callback = function callback(lang, bool, intl) {
          _this.myState.buttonsLangJson = {
            lang: lang,
            intl: intl
          };

          _this5.setState({
            json: _this5.props.json || [],
            index: oprationIndex,
            lang: lang,
            intl: intl
          });
        };

        Object(index_["getMultiLang"])({
          moduleId: 'page-button',
          callback: callback
        });
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      var _this$props4 = this.props,
          _this = _this$props4._this,
          area = _this$props4.area;

      if (_this.myState.buttonsComponent[area] && _this.myState.buttonsComponent[area][this.uuid]) {
        delete _this.myState.buttonsComponent[area][this.uuid];
      }
    }
  }, {
    key: "UNSAFE_componentWillReceiveProps",
    value: function UNSAFE_componentWillReceiveProps(nextProps) {
      // let { _this } = nextProps;
      // console.log(_this)
      this.setState({
        json: nextProps.json || []
      }, function () {// _this.forceUpdate()
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this6 = this;

      var _this$props5 = this.props,
          buttonLimit = _this$props5.buttonLimit,
          area = _this$props5.area,
          _this = _this$props5._this,
          _this$props5$wantedBu = _this$props5.wantedButtons,
          wantedButtons = _this$props5$wantedBu === void 0 ? [] : _this$props5$wantedBu,
          stopPropagation = _this$props5.stopPropagation,
          hotKeysEnabled = _this$props5.hotKeysEnabled,
          rowIndex = _this$props5.rowIndex,
          templateOrder = _this$props5.templateOrder;
      var json = _this.myState.buttons || [];
      var needRenderButtons = [];
      var needCopyButtonsJson = [];

      if (Array.isArray(wantedButtons)) {
        var _iterator2 = create_createForOfIteratorHelper(wantedButtons),
            _step2;

        try {
          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
            var item = _step2.value;

            var _iterator3 = create_createForOfIteratorHelper(json),
                _step3;

            try {
              for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
                var ite = _step3.value;

                if (ite.visible === true || ite.hasOwnProperty('visible') === false) {
                  if (ite.area.indexOf(',') !== -1) {
                    var arr = ite.area.split(',');
                    var areaArr = arr.map(function (i) {
                      return i.trim();
                    });

                    if (item === ite.key && areaArr.includes(area)) {
                      needRenderButtons.push(create_objectSpread(create_objectSpread({}, ite), {}, {
                        isOprationBtn: true
                      }));
                    }
                  } else {
                    if (item === ite.key && ite.area === area) {
                      needRenderButtons.push(create_objectSpread(create_objectSpread({}, ite), {}, {
                        isOprationBtn: true
                      }));
                    }
                  }
                }

                if (ite.area.indexOf(',') !== -1) {
                  var _arr = ite.area.split(',');

                  var _areaArr = _arr.map(function (i) {
                    return i.trim();
                  });

                  if (item === ite.key && _areaArr.includes(area)) {
                    needCopyButtonsJson.push(create_objectSpread(create_objectSpread({}, ite), {}, {
                      isOprationBtn: true
                    }));
                  }
                } else {
                  if (item === ite.key && ite.area === area) {
                    needCopyButtonsJson.push(create_objectSpread(create_objectSpread({}, ite), {}, {
                      isOprationBtn: true
                    }));
                  }
                }
              }
            } catch (err) {
              _iterator3.e(err);
            } finally {
              _iterator3.f();
            }
          }
        } catch (err) {
          _iterator2.e(err);
        } finally {
          _iterator2.f();
        }
      }

      needCopyButtonsJson.length && needCopyButtonsJson.sort(function (a, b) {
        return Number(a.order) - Number(b.order);
      });

      if (templateOrder) {
        needRenderButtons.length && needRenderButtons.sort(function (a, b) {
          //以前操作列按钮没有排序，注释掉，如果有人提顺序问题看NCC-40383
          return Number(a.order) - Number(b.order);
        });
      }

      _this.myState.oprationButtons[area] = needCopyButtonsJson;
      var list = [];
      var keyHandlers = needRenderButtons.length ? this.getKeyMapsAndHandlers({
        data: needRenderButtons,
        area: area,
        rowIndex: rowIndex
      }) : {};
      var LangCode = Object(index_["getLangCode"])();
      var showflag = LangCode === 'tradchn' || LangCode === 'simpchn'; // let showflag = false;

      if (showflag) {
        if (needRenderButtons.length && needRenderButtons.length > buttonLimit) {
          list = needRenderButtons.slice(buttonLimit - 1, needRenderButtons.length);
          needRenderButtons = needRenderButtons.slice(0, buttonLimit - 1);
        }
      } else {
        list = needRenderButtons;
      }

      return needRenderButtons.length ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "opration-wrapper",
        onClick: function onClick(e) {
          stopPropagation && e.stopPropagation();
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        display: "inline-block",
        className: "opration-btns-hotkey-wrapper",
        keyMap: keyHandlers.keyMap,
        handlers: keyHandlers.handlers,
        enabled: hotKeysEnabled,
        focused: true
      }, showflag && needRenderButtons.map(function (item) {
        if (item.popContent) {
          return _this6.popContentItem(item);
        } else {
          return (
            /*#__PURE__*/
            // 不需要弹窗
            external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("a", {
              fieldid: Object(index_["getSysFieldid"])("".concat(item.key, "_btn")),
              "btn-code": item.key,
              className: 'row-edit-option row-btn-' + create_replaceSpecialStr(item.key),
              key: item.key,
              onClick: function onClick(e) {
                return _this6.onClick({
                  key: item.key,
                  e: e,
                  item: item
                });
              }
            }, item.title)
          );
        }
      }), showflag ? this.renderMoreList(list, this.props.rowIndex) : this.renderLanglist(list, this.props.rowIndex))) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "opration-wrapper",
        onClick: function onClick(e) {
          stopPropagation && e.stopPropagation();
        }
      });
    }
  }]);

  return OprationButton;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

function createButtonApp() {
  var _this7 = this;

  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  // this=>Page 组件
  var area = config.area,
      onButtonClick = config.onButtonClick,
      buttonLimit = config.buttonLimit,
      popContainer = config.popContainer,
      _config$tabindex = config.tabindex,
      tabindex = _config$tabindex === void 0 ? -1 : _config$tabindex,
      _config$hotKeysMap = config.hotKeysMap,
      hotKeysMap = _config$hotKeysMap === void 0 ? {} : _config$hotKeysMap,
      _config$hotKeysEnable = config.hotKeysEnabled,
      hotKeysEnabled = _config$hotKeysEnable === void 0 ? true : _config$hotKeysEnable,
      modalRelation = config.modalRelation,
      _config$ignoreHotkeyC = config.ignoreHotkeyCode,
      ignoreHotkeyCode = _config$ignoreHotkeyC === void 0 ? [] : _config$ignoreHotkeyC,
      _config$tipKeybodard = config.tipKeybodard,
      tipKeybodard = _config$tipKeybodard === void 0 ? 'none' : _config$tipKeybodard,
      _config$notInterruptC = config.notInterruptCode,
      notInterruptCode = _config$notInterruptC === void 0 ? [] : _config$notInterruptC,
      _config$withAutoFocus = config.withAutoFocus,
      withAutoFocus = _config$withAutoFocus === void 0 ? true : _config$withAutoFocus;
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(create_ButtonApp // ref={`${area}ButtonAreaRefName`}
  , {
    ref: function ref(dom) {
      _this7.myState["".concat(area, "ButtonAreaRefName")] = dom;
    },
    _this: this // json={areaButtons}
    ,
    area: area,
    onClick: function onClick(id, hotkey) {
      onButtonClick(create_objectSpread(create_objectSpread({}, _this7.props), _this7.output), id, hotkey);
    },
    key: area,
    buttonLimit: buttonLimit,
    popContainer: popContainer,
    tabindex: tabindex,
    hotKeysMap: hotKeysMap,
    hotKeysEnabled: hotKeysEnabled,
    modalRelation: modalRelation,
    ignoreHotkeyCode: ignoreHotkeyCode,
    tipKeybodard: tipKeybodard,
    notInterruptCode: notInterruptCode,
    withAutoFocus: withAutoFocus
  });
}
function createOprationButton() {
  var _this8 = this;

  var wantedButtons = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  // this=>Page 组件
  // 后台查回来的按钮和页面传过来的按钮数组进行交集，是页面最终显示的按钮
  var area = config.area,
      onButtonClick = config.onButtonClick,
      buttonLimit = config.buttonLimit,
      popContainer = config.popContainer,
      _config$stopPropagati = config.stopPropagation,
      stopPropagation = _config$stopPropagati === void 0 ? true : _config$stopPropagati,
      _config$hotKeysMap2 = config.hotKeysMap,
      hotKeysMap = _config$hotKeysMap2 === void 0 ? {} : _config$hotKeysMap2,
      _config$hotKeysEnable2 = config.hotKeysEnabled,
      hotKeysEnabled = _config$hotKeysEnable2 === void 0 ? true : _config$hotKeysEnable2,
      modalRelation = config.modalRelation,
      _config$ignoreHotkeyC2 = config.ignoreHotkeyCode,
      ignoreHotkeyCode = _config$ignoreHotkeyC2 === void 0 ? [] : _config$ignoreHotkeyC2,
      _config$notInterruptC2 = config.notInterruptCode,
      notInterruptCode = _config$notInterruptC2 === void 0 ? [] : _config$notInterruptC2,
      _config$withAutoFocus2 = config.withAutoFocus,
      withAutoFocus = _config$withAutoFocus2 === void 0 ? true : _config$withAutoFocus2,
      _config$templateOrder = config.templateOrder,
      templateOrder = _config$templateOrder === void 0 ? false : _config$templateOrder;
  this.myState.oprationIndex += 1; // let index = this.myState.oprationIndexCopy || 0;

  buttonLimit = buttonLimit || 3;
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(create_OprationButton, {
    ref: function ref(dom) {
      // this.myState[`${area}${this.myState.oprationIndex}ButtonAreaRefName`] = dom;
      // this.myState[`${area}${index}ButtonAreaRefName`] = dom;
      _this8.myState["".concat(area, "ButtonAreaRefName")] = dom;
    } // json={finalButtons}
    ,
    onClick: function onClick(id, e, hotkey) {
      onButtonClick(create_objectSpread(create_objectSpread({}, _this8.props), _this8.output), id, e, hotkey);
    },
    _this: this,
    area: area,
    buttonLimit: buttonLimit,
    stopPropagation: stopPropagation,
    oprationIndex: this.myState.oprationIndex,
    wantedButtons: wantedButtons,
    popContainer: popContainer,
    hotKeysMap: hotKeysMap,
    hotKeysEnabled: hotKeysEnabled,
    modalRelation: modalRelation,
    ignoreHotkeyCode: ignoreHotkeyCode,
    rowIndex: config.rowIndex,
    notInterruptCode: notInterruptCode,
    withAutoFocus: withAutoFocus,
    templateOrder: templateOrder
  });
}
// CONCATENATED MODULE: ./src/platform/components/ButtonApp/index.js

/* harmony default export */ var components_ButtonApp = ({
  createButtonApp: createButtonApp,
  createOprationButton: createOprationButton
});
// CONCATENATED MODULE: ./src/platform/components/CardPagination/CardPag_test.js
function CardPag_test_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { CardPag_test_typeof = function _typeof(obj) { return typeof obj; }; } else { CardPag_test_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return CardPag_test_typeof(obj); }

function CardPag_test_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function CardPag_test_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { CardPag_test_ownKeys(Object(source), true).forEach(function (key) { CardPag_test_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { CardPag_test_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function CardPag_test_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function CardPag_test_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function CardPag_test_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function CardPag_test_createClass(Constructor, protoProps, staticProps) { if (protoProps) CardPag_test_defineProperties(Constructor.prototype, protoProps); if (staticProps) CardPag_test_defineProperties(Constructor, staticProps); return Constructor; }

function CardPag_test_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) CardPag_test_setPrototypeOf(subClass, superClass); }

function CardPag_test_setPrototypeOf(o, p) { CardPag_test_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return CardPag_test_setPrototypeOf(o, p); }

function CardPag_test_createSuper(Derived) { var hasNativeReflectConstruct = CardPag_test_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = CardPag_test_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = CardPag_test_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return CardPag_test_possibleConstructorReturn(this, result); }; }

function CardPag_test_possibleConstructorReturn(self, call) { if (call && (CardPag_test_typeof(call) === "object" || typeof call === "function")) { return call; } return CardPag_test_assertThisInitialized(self); }

function CardPag_test_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function CardPag_test_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function CardPag_test_getPrototypeOf(o) { CardPag_test_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return CardPag_test_getPrototypeOf(o); }






__webpack_require__(927);

var CardPag_test_CardPagination = /*#__PURE__*/function (_Component) {
  CardPag_test_inherits(CardPagination, _Component);

  var _super = CardPag_test_createSuper(CardPagination);

  function CardPagination(props) {
    var _this;

    CardPag_test_classCallCheck(this, CardPagination);

    _this = _super.call(this, props); //传出this

    _this.getAllpks = function (init) {
      var events = _this.props.events;
      var allpks = [];

      if (events && events.dataSource) {
        var cacheData = index_["ViewModel"].getData(events.dataSource);

        if (cacheData && cacheData.simpleTable && cacheData.simpleTable.allpks) {
          allpks = cacheData.simpleTable.allpks;
        }
      } else {
        //init时，在CacheTools中取，否则，在组件内部维护的state中获取
        if (init) {
          allpks = index_["cacheTools"].get('allpks');
        } else {
          allpks = _this.state.allpks;
        }
      }

      return Array.isArray(allpks) ? allpks : [];
    };

    _this.getClickItemId = function (type) {
      var events = _this.props.events;
      var activeId = _this.state.activeId;

      if (!activeId) {
        if (events && events.dataSource) {
          var cacheData = index_["ViewModel"].getData(events.dataSource);

          if (cacheData && cacheData.currentId) {
            activeId = cacheData.currentId;
          }
        }
      }

      var allpks = _this.getAllpks(); //删除的场景


      if (!allpks.includes(activeId)) {
        if (events && events.dataSource) {
          var _cacheData = index_["ViewModel"].getData(events.dataSource);

          if (_cacheData && _cacheData.currentId) {
            activeId = _cacheData.currentId;
          }
        }
      }

      var currentId = activeId;

      if (Array.isArray(allpks) && allpks.length) {
        var id;
        var index;

        switch (type) {
          case 'firstItem':
            id = allpks[0];
            break;

          case 'prevItem':
            index = allpks.indexOf(currentId);

            if (index != -1 && index > 0) {
              id = allpks[index - 1];
            }

            break;

          case 'nextItem':
            index = allpks.indexOf(currentId);

            if (index != -1 && index < allpks.length - 1) {
              id = allpks[index + 1];
            }

            break;

          case 'finalItem':
            id = allpks[allpks.length - 1];
            break;
        }

        if (id) {
          _this.setState({
            activeId: id
          });
        }

        return id;
      }
    };

    _this.pageIndexChange = function (val) {
      var _this$props = _this.props,
          events = _this$props.events,
          output = _this$props.output,
          rootprops = _this$props.rootprops;

      if (events && events.handlePageInfoChange) {
        // 清除特殊弹出提示 by bbqin
        Object(index_["clearToast"])('socketErrorToast');
        events.handlePageInfoChange(CardPag_test_objectSpread(CardPag_test_objectSpread({}, rootprops), output), //其他
        _this.getClickItemId(val));
      }
    };

    _this.getBtnStatus = function () {
      var events = _this.props.events;
      var activeId = _this.state.activeId;

      if (!activeId) {
        if (events && events.dataSource) {
          var cacheData = index_["ViewModel"].getData(events.dataSource);

          if (cacheData && cacheData.currentId) {
            activeId = cacheData.currentId;
          }
        }
      }

      var allpks = _this.getAllpks(); //删除的场景


      if (!allpks.includes(activeId)) {
        if (events && events.dataSource) {
          var _cacheData2 = index_["ViewModel"].getData(events.dataSource);

          if (_cacheData2 && _cacheData2.currentId) {
            activeId = _cacheData2.currentId;
          }
        }
      }

      var currentId = activeId; //currentId存在时

      var currentIndex, endDisabled, firstDisabled;
      currentIndex = allpks.indexOf(currentId);

      if (currentIndex == -1) {
        //allpks里不存在currentId
        endDisabled = true;
        firstDisabled = true;
      } else {
        if (!allpks.length) {
          //没有allpks
          endDisabled = true;
          firstDisabled = true;
        } else if (allpks.length === 1) {
          //只有一个pk
          endDisabled = true;
          firstDisabled = true;
        } else {
          //多个pk
          if (currentIndex === 0) {
            //第一个
            endDisabled = false;
            firstDisabled = true;
          } else if (currentIndex === allpks.length - 1) {
            endDisabled = true;
            firstDisabled = false;
          } else {
            endDisabled = false;
            firstDisabled = false;
          }
        }
      }

      return {
        isFirst: firstDisabled,
        isEnd: endDisabled
      };
    };

    _this.props.getThis(CardPag_test_assertThisInitialized(_this));

    _this.pkname = 'id';

    if (_this.props.events && _this.props.events.urlPkname) {
      _this.pkname = _this.props.events.urlPkname;
    } //初始化state


    _this.state = {
      allpks: _this.getAllpks(true),
      visible: true,
      //分页组件的显示隐藏
      activeId: _this.props.getUrlParam(_this.pkname),
      langJson: {}
    };
    return _this;
  }

  CardPag_test_createClass(CardPagination, [{
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      var _this2 = this;

      var callback = function callback(langJson) {
        _this2.setState({
          langJson: langJson
        });
      }; // moduleId为所需加载langJson文件夹名称前缀


      Object(index_["getMultiLang"])({
        moduleId: 'common_icon_title',
        callback: callback
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var langJson = this.state.langJson;

      var _this$getBtnStatus = this.getBtnStatus(),
          isFirst = _this$getBtnStatus.isFirst,
          isEnd = _this$getBtnStatus.isEnd;

      var _this$props2 = this.props,
          _this$props2$hotKeybo = _this$props2.hotKeyboard,
          hotKeyboard = _this$props2$hotKeybo === void 0 ? true : _this$props2$hotKeybo,
          _this$props2$tooltips = _this$props2.tooltips,
          tooltips = _this$props2$tooltips === void 0 ? [langJson['icon-page-first'], langJson["icon-page-prev"], langJson["icon-page-next"], langJson["icon-page-end"]] : _this$props2$tooltips;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "".concat(this.state.visible ? 'show' : 'hide', "  cardPagination-lightapp-component")
      }, hotKeyboard && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          endBtnHandler: base_index_["HotKeys"].USUAL_KEYS.CARDPAGE_END,
          upBtnHandler: base_index_["HotKeys"].USUAL_KEYS.CARDPAGE_UP,
          downBtnHandler: base_index_["HotKeys"].USUAL_KEYS.CARDPAGE_DOWN,
          homeBtnHandler: base_index_["HotKeys"].USUAL_KEYS.CARDPAGE_HOME
        },
        handlers: {
          endBtnHandler: function endBtnHandler() {
            _this3.pageIndexChange.bind(_this3, 'finalItem')();
          },
          upBtnHandler: function upBtnHandler() {
            if (isFirst) {
              return false;
            }

            _this3.pageIndexChange.bind(_this3, 'prevItem')();
          },
          downBtnHandler: function downBtnHandler() {
            if (isEnd) {
              return false;
            }

            _this3.pageIndexChange.bind(_this3, 'nextItem')();
          },
          homeBtnHandler: function homeBtnHandler() {
            _this3.pageIndexChange.bind(_this3, 'firstItem')();
          }
        },
        className: "cardPage-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline-block"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "cardPagination-lightapp-component-wrap"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: tooltips[0],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        disabled: isFirst ? true : false,
        className: "".concat(isFirst ? 'disable' : '', " first-item cardPaginationBtn"),
        onClick: function onClick() {
          if (isFirst) {
            return false;
          }

          _this3.pageIndexChange.call(_this3, 'firstItem');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "icon iconfont icon-shangyiye"
      }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: tooltips[1],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        disabled: isFirst ? true : false,
        className: "".concat(isFirst ? 'disable' : '', " item second-item cardPaginationBtn"),
        onClick: function onClick() {
          if (isFirst) {
            return false;
          }

          _this3.pageIndexChange.call(_this3, 'prevItem');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "icon iconfont icon-jiantouzuo"
      }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: tooltips[2],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        disabled: isEnd ? true : false,
        className: "".concat(isEnd ? 'disable' : '', " item third-item cardPaginationBtn"),
        onClick: function onClick() {
          if (isEnd) {
            return false;
          }

          _this3.pageIndexChange.call(_this3, 'nextItem');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "icon iconfont icon-jiantouyou"
      }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: tooltips[3],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        disabled: isEnd ? true : false,
        className: "".concat(isEnd ? 'disable' : '', " last-item cardPaginationBtn"),
        onClick: function onClick() {
          if (isEnd) {
            return false;
          }

          _this3.pageIndexChange.call(_this3, 'finalItem');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "icon iconfont icon-xiayiye"
      })))));
    }
  }]);

  return CardPagination;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/CardPagination/create_test.js
/*
 * @Author: liyxt
 * @Date: 2019-10-21 14:15:59
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-04 11:03:43
 * @Description: file content
 */


__webpack_require__(927);

 //创建卡片分页组件

function createCardPagination(events) {
  var _this2 = this;

  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(CardPag_test_CardPagination, {
    getThis: function getThis(_this) {
      _this2.myCardPagination = _this;
    },
    events: events,
    output: this.output,
    rootprops: this.props,
    getUrlParam: this.getUrlParam
  });
}
// CONCATENATED MODULE: ./src/platform/components/CardPagination/methods_test.js
// import { isObj, warningOnce } from '@platform/api';
// import { ViewModel } from '@platform/api'
// 设置显隐性
function setCardPaginationVisible(cardPaginationBtn, flag) {
  if (this.myCardPagination && this.myCardPagination.state) {
    //if (flag != this.myCardPagination.state.visible) {
    this.myCardPagination.setState({
      visible: flag
    }); //}
  }
} //设置当前 id 
// status:2  新增
// status:1  修改

function setCardPaginationId() {
  var idObj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

  if (this.myCardPagination && this.myCardPagination.state && idObj && idObj.id) {
    if (!idObj.status) {
      idObj.status = 1;
    }

    if (idObj.status == 1) {
      //修改
      this.myCardPagination.setState({
        activeId: idObj.id
      });
    }

    if (idObj.status == 2) {
      //新增
      this.myCardPagination.state.allpks.push(idObj.id);
      this.myCardPagination.setState({
        activeId: idObj.id,
        allpks: this.myCardPagination.state.allpks
      });
    }

    if (idObj.status == 3) {
      //删除
      var index = this.myCardPagination.state.allpks.indexOf(idObj.id);

      if (index != -1) {
        this.myCardPagination.state.allpks.splice(index, 1);
        this.myCardPagination.setState({
          allpks: this.myCardPagination.state.allpks
        });
      }
    }
  }
} //获取删除后下一条卡片页面数据的id

function getNextCardPaginationId(idObj) {
  if (this.myCardPagination && this.myCardPagination.state) {
    if (idObj && idObj.id) {
      var allpks = this.myCardPagination.state.allpks;

      if (allpks.length > 1) {
        var index = allpks.indexOf(idObj.id);

        if (index == allpks.length - 1) {
          //是最后一条
          return allpks[allpks.length - 2];
        } else {
          //不是最后一条
          return allpks[index + 1];
        }
      }
    }
  }
} //设置组件allpks

function setCardPaginationAllpks(allpks, success) {
  if (this.myCardPagination && this.myCardPagination.state && Array.isArray(allpks)) {
    this.myCardPagination.setState({
      allpks: allpks
    }, function () {
      typeof success === 'function' && success();
    });
  }
}
// CONCATENATED MODULE: ./src/platform/components/CardPagination/index.js


/* harmony default export */ var components_CardPagination = ({
  createCardPagination: createCardPagination,
  setCardPaginationVisible: setCardPaginationVisible,
  setCardPaginationId: setCardPaginationId,
  getNextCardPaginationId: getNextCardPaginationId,
  setCardPaginationAllpks: setCardPaginationAllpks
});
// CONCATENATED MODULE: ./src/platform/components/CreateModal/createModal.js
function createModal_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { createModal_typeof = function _typeof(obj) { return typeof obj; }; } else { createModal_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return createModal_typeof(obj); }

function createModal_extends() { createModal_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return createModal_extends.apply(this, arguments); }

function createModal_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = createModal_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function createModal_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function createModal_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function createModal_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function createModal_createClass(Constructor, protoProps, staticProps) { if (protoProps) createModal_defineProperties(Constructor.prototype, protoProps); if (staticProps) createModal_defineProperties(Constructor, staticProps); return Constructor; }

function createModal_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) createModal_setPrototypeOf(subClass, superClass); }

function createModal_setPrototypeOf(o, p) { createModal_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return createModal_setPrototypeOf(o, p); }

function createModal_createSuper(Derived) { var hasNativeReflectConstruct = createModal_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = createModal_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = createModal_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return createModal_possibleConstructorReturn(this, result); }; }

function createModal_possibleConstructorReturn(self, call) { if (call && (createModal_typeof(call) === "object" || typeof call === "function")) { return call; } return createModal_assertThisInitialized(self); }

function createModal_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function createModal_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function createModal_getPrototypeOf(o) { createModal_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return createModal_getPrototypeOf(o); }

/**
 * Created by wangshhj on 2018/3/13.
 */




__webpack_require__(1899);

var createModal_Modal2 = /*#__PURE__*/function (_Component) {
  createModal_inherits(Modal2, _Component);

  var _super = createModal_createSuper(Modal2);

  function Modal2(props) {
    var _this;

    createModal_classCallCheck(this, Modal2);

    _this = _super.call(this, props);
    _this.state = {
      data: {},
      json: {}
    };
    return _this;
  }

  createModal_createClass(Modal2, [{
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      var _this2 = this;

      var callback = function callback(json, bool) {
        if (bool) {
          _this2.setState({
            json: json
          });
        }
      };

      Object(index_["getMultiLang"])({
        moduleId: 'container_toast',
        callback: callback
      });
    }
  }, {
    key: "UNSAFE_componentWillReceiveProps",
    value: function UNSAFE_componentWillReceiveProps(nextProps) {
      var modalData = nextProps.modalData,
          argusObj = nextProps.argusObj;
      var nowData = {};

      for (var attr in modalData) {
        for (var attr1 in argusObj) {
          if (attr === attr1) {
            if (modalData[attr] && argusObj[attr1]) {
              nowData[attr] = modalData[attr];
            } else {
              if (modalData[attr]) {
                nowData[attr] = modalData[attr];
              } else {
                nowData[attr] = argusObj[attr1];
              }
            }
          }
        }
      }

      this.setState({
        data: nowData
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var json = this.state.json;
      var _this$state$data = this.state.data,
          id = _this$state$data.id,
          size = _this$state$data.size,
          className = _this$state$data.className,
          backdropClassName = _this$state$data.backdropClassName,
          title = _this$state$data.title,
          content = _this$state$data.content,
          noFooter = _this$state$data.noFooter,
          _this$state$data$left = _this$state$data.leftBtnName,
          leftBtnName = _this$state$data$left === void 0 ? json['0005'] : _this$state$data$left,
          _this$state$data$righ = _this$state$data.rightBtnName,
          rightBtnName = _this$state$data$righ === void 0 ? json['0006'] : _this$state$data$righ,
          showCustomBtns = _this$state$data.showCustomBtns,
          customBtns = _this$state$data.customBtns,
          hideRightBtn = _this$state$data.hideRightBtn,
          hideLeftBtn = _this$state$data.hideLeftBtn,
          container = _this$state$data.container;

      var _this$props = this.props,
          onHide = _this$props.onHide,
          backdrop = _this$props.backdrop,
          indexInfo = _this$props.indexInfo,
          beSureClick = _this$props.beSureClick,
          cancelClick = _this$props.cancelClick,
          show = _this$props.show,
          propSize = _this$props.size,
          _this$props$hotKeyboa = _this$props.hotKeyboard,
          hotKeyboard = _this$props$hotKeyboa === void 0 ? true : _this$props$hotKeyboa,
          onEscapeKeyUp = _this$props.onEscapeKeyUp,
          draggable = _this$props.draggable,
          resizable = _this$props.resizable,
          others = createModal_objectWithoutProperties(_this$props, ["onHide", "backdrop", "indexInfo", "beSureClick", "cancelClick", "show", "size", "hotKeyboard", "onEscapeKeyUp", "draggable", "resizable"]);

      var mSize = size || propSize || '';
      var maxModalCls = mSize === 'max' ? 'nc-modal-max' : '';
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], createModal_extends({
        fieldid: id,
        show: show,
        onHide: onHide.bind(this),
        size: mSize,
        backdrop: backdrop,
        indexInfo: indexInfo,
        className: "".concat(className, " simpleModal ").concat(maxModalCls),
        backdropClassName: backdropClassName,
        container: container,
        ref: function ref(Modal) {
          return _this3.Modal = Modal;
        },
        onEscapeKeyUp: onEscapeKeyUp,
        draggable: draggable,
        resizable: resizable,
        id: id
      }, others), !showCustomBtns && hotKeyboard && !noFooter && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          sureBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM,
          cancelBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL
        },
        handlers: {
          sureBtnHandler: function sureBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发 by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              console.log('createModal  sureBtnHandler 事件回调', _this3.Modal.isTopModal());
              beSureClick.bind(_this3)();
            }
          },
          cancelBtnHandler: function cancelBtnHandler() {
            // 取消按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              console.log('createModal cancelBtnHandler 事件回调');
              cancelClick.bind(_this3)();
            }
          }
        },
        className: "simpleModal-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, {
        fieldid: "header-area",
        closeButton: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Title, {
        fieldid: title
      }, title)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, {
        className: noFooter ? 'has-resize-icon' : ''
      }, content), !noFooter ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, !showCustomBtns && hideLeftBtn === false && leftBtnName && (hotKeyboard ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(leftBtnName, "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM, ")"),
        trigger: ['hover', 'focus'],
        className: "model-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: beSureClick.bind(this),
        colors: "primary",
        tabIndex: "0",
        fieldid: "confirm"
      }, leftBtnName, "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "Y"), ")")) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: beSureClick.bind(this),
        colors: "primary",
        tabIndex: "0",
        fieldid: "confirm"
      }, leftBtnName)), !showCustomBtns && hideRightBtn === false && rightBtnName && (hotKeyboard ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(rightBtnName, "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL, ")"),
        trigger: ['focus', 'hover'],
        className: "model-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: cancelClick.bind(this),
        shape: "border",
        tabIndex: "0",
        fieldid: "cancel"
      }, rightBtnName, "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "N"), ")")) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: cancelClick.bind(this),
        shape: "border",
        tabIndex: "0",
        fieldid: "cancel"
      }, rightBtnName)), showCustomBtns && customBtns ? customBtns : null) : null);
    }
  }]);

  return Modal2;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

function createModal(id) {
  var _this4 = this;

  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      title = _ref.title,
      content = _ref.content,
      beSureBtnClick = _ref.beSureBtnClick,
      cancelBtnClick = _ref.cancelBtnClick,
      closeModalEve = _ref.closeModalEve,
      rightBtnName = _ref.rightBtnName,
      leftBtnName = _ref.leftBtnName,
      _ref$noFooter = _ref.noFooter,
      noFooter = _ref$noFooter === void 0 ? false : _ref$noFooter,
      _ref$size = _ref.size,
      size = _ref$size === void 0 ? 'lg' : _ref$size,
      _ref$userControl = _ref.userControl,
      userControl = _ref$userControl === void 0 ? false : _ref$userControl,
      _ref$className = _ref.className,
      className = _ref$className === void 0 ? '' : _ref$className,
      _ref$backdropClassNam = _ref.backdropClassName,
      backdropClassName = _ref$backdropClassNam === void 0 ? '' : _ref$backdropClassNam,
      _ref$zIndex = _ref.zIndex,
      zIndex = _ref$zIndex === void 0 ? 200 : _ref$zIndex,
      _ref$hasBackDrop = _ref.hasBackDrop,
      hasBackDrop = _ref$hasBackDrop === void 0 ? true : _ref$hasBackDrop,
      _ref$closeByClickBack = _ref.closeByClickBackDrop,
      closeByClickBackDrop = _ref$closeByClickBack === void 0 ? false : _ref$closeByClickBack,
      _ref$showCustomBtns = _ref.showCustomBtns,
      showCustomBtns = _ref$showCustomBtns === void 0 ? false : _ref$showCustomBtns,
      customBtns = _ref.customBtns,
      _ref$validateCloseBtn = _ref.validateCloseBtn,
      validateCloseBtn = _ref$validateCloseBtn === void 0 ? false : _ref$validateCloseBtn,
      _ref$hotKeyboard = _ref.hotKeyboard,
      hotKeyboard = _ref$hotKeyboard === void 0 ? true : _ref$hotKeyboard,
      _ref$hideRightBtn = _ref.hideRightBtn,
      hideRightBtn = _ref$hideRightBtn === void 0 ? false : _ref$hideRightBtn,
      _ref$hideLeftBtn = _ref.hideLeftBtn,
      hideLeftBtn = _ref$hideLeftBtn === void 0 ? false : _ref$hideLeftBtn,
      _ref$container = _ref.container,
      container = _ref$container === void 0 ? document.body : _ref$container,
      onEscapeKeyUp = _ref.onEscapeKeyUp,
      _ref$draggable = _ref.draggable,
      draggable = _ref$draggable === void 0 ? true : _ref$draggable,
      _ref$resizable = _ref.resizable,
      resizable = _ref$resizable === void 0 ? true : _ref$resizable,
      others = createModal_objectWithoutProperties(_ref, ["title", "content", "beSureBtnClick", "cancelBtnClick", "closeModalEve", "rightBtnName", "leftBtnName", "noFooter", "size", "userControl", "className", "backdropClassName", "zIndex", "hasBackDrop", "closeByClickBackDrop", "showCustomBtns", "customBtns", "validateCloseBtn", "hotKeyboard", "hideRightBtn", "hideLeftBtn", "container", "onEscapeKeyUp", "draggable", "resizable"]);

  var custom = className.indexOf('junior') !== -1 || className.indexOf('senior') !== -1 || className.indexOf('combine') !== -1;
  var mSize = "".concat(custom ? '' : size);
  var argusObj = {
    id: id,
    title: title,
    content: content,
    beSureBtnClick: beSureBtnClick,
    cancelBtnClick: cancelBtnClick,
    closeModalEve: closeModalEve,
    rightBtnName: rightBtnName,
    leftBtnName: leftBtnName,
    noFooter: noFooter,
    size: mSize,
    //传定制大小的类名的时候，size不配置生效，解决配置拖拽的时候的问题
    userControl: userControl,
    className: className,
    backdropClassName: backdropClassName,
    zIndex: zIndex,
    hasBackDrop: hasBackDrop,
    closeByClickBackDrop: closeByClickBackDrop,
    showCustomBtns: showCustomBtns,
    customBtns: customBtns,
    validateCloseBtn: validateCloseBtn,
    hideRightBtn: hideRightBtn,
    hideLeftBtn: hideLeftBtn,
    container: container,
    onEscapeKeyUp: onEscapeKeyUp
  };

  if (!this.state.modal.hasOwnProperty(id)) {
    this.state.modal[id] = argusObj;
  }

  var modalData = this.state.modal[id] || {};

  if (!modalData.update) {
    modalData.content = content;
    modalData.customBtns = customBtns;
  } //关闭模态框


  var close = function close() {
    modalData.showModal = false;

    _this4.setState({
      modal: _this4.state.modal
    });
  };
  /* 点击关闭按钮 */


  var onHide = function onHide() {
    if (!modalData.validateCloseBtn) {
      close();
    }

    if (typeof modalData.closeModalEve === 'function') {
      modalData.closeModalEve();
    }
  };
  /* 取消按钮事件 */


  var cancelClick = function cancelClick() {
    if (!modalData.userControl) {
      close();
    }

    if (typeof modalData.cancelBtnClick === 'function') {
      modalData.cancelBtnClick();
    }
  }; //确认按钮事件


  var beSureClick = function beSureClick() {
    if (!modalData.userControl) {
      close();
    }

    if (typeof modalData.beSureBtnClick === 'function') {
      modalData.beSureBtnClick();
    }
  };

  var backdrop;

  if (hasBackDrop) {
    if (closeByClickBackDrop) {
      backdrop = closeByClickBackDrop;
    } else {
      backdrop = 'static';
    }
  } else {
    backdrop = hasBackDrop;
  }

  var finalIndex = modalData.zIndex || zIndex || 200;
  var indexInfo = {
    id: id,
    zIndex: finalIndex
  };
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(createModal_Modal2, createModal_extends({}, others, {
    onHide: onHide,
    backdrop: backdrop,
    indexInfo: indexInfo,
    beSureClick: beSureClick,
    cancelClick: cancelClick,
    modalData: modalData,
    show: modalData.showModal,
    argusObj: argusObj,
    hotKeyboard: hotKeyboard,
    custom: custom,
    onEscapeKeyUp: onEscapeKeyUp,
    draggable: draggable,
    resizable: resizable,
    size: mSize
  }));
}
// CONCATENATED MODULE: ./src/platform/components/CreateModal/methods.js
/**
 * Created by wangshhj on 2018/3/13.
 */
function methods_show(id) {
  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var showCallback = arguments.length > 2 ? arguments[2] : undefined;

  if (!this.state.modal.hasOwnProperty(id)) {
    console.error('需要先初始化createModal');
    return false;
  }

  var modalData = this.state.modal[id];
  modalData = Object.assign(modalData, config);
  modalData.showModal = true;

  if (config.hasOwnProperty('content') || config.hasOwnProperty('customBtns')) {
    modalData.update = true;
  }

  this.setState({
    modal: this.state.modal
  }, function () {
    if (showCallback && typeof showCallback === 'function') showCallback();
  });
}
function methods_close(id) {
  this.state.modal[id].showModal = false; // this.state.modal[id].userControl = false;

  this.setState({
    modal: this.state.modal
  });
}
// CONCATENATED MODULE: ./src/platform/components/CreateModal/index.js
/**
 * Created by wangshhj on 2018/3/13.
 */



// CONCATENATED MODULE: ./src/platform/components/CreateSearch/_methods.js
function _methods_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _methods_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { _methods_ownKeys(Object(source), true).forEach(function (key) { _methods_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { _methods_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _methods_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }


 // import { isFunction, isArray, isEmpty, isObj } from '../../public';
// import { localeLang } from '../../public/currentLocale';
// import ViewModel from '../../shell/viewmodel/viewmodel';

 // import toast from '../../api/toast';
// import { DongbaToLocalTime, LocalToDongbaTime } from '../../public/timer';

var removeGlobalStorage = index_["ViewModel"].removeGlobalStorage; // =========以下为平台内部使用的方法========================

var OperationOptions = [];
function setOperationOptionsMultiLang(_multiLang) {
  var multiLang = _multiLang;

  if (Object(index_["isEmpty"])(OperationOptions)) {
    OperationOptions = [{
      display: multiLang['page-search-0047'],
      value: '='
    }, {
      display: multiLang['page-search-0047'],
      value: '=='
    }, {
      display: multiLang['page-search-0048'],
      value: '>'
    }, {
      display: multiLang['page-search-0049'],
      value: '<'
    }, {
      display: multiLang['page-search-0050'],
      value: 'between'
    }, {
      display: multiLang['page-search-0051'],
      value: '>='
    }, {
      display: multiLang['page-search-0052'],
      value: '<='
    }, {
      display: multiLang['page-search-0053'],
      value: '<>'
    }, {
      display: multiLang['page-search-0054'],
      value: 'like'
    }, {
      display: multiLang['page-search-0055'],
      value: 'left like'
    }, {
      display: multiLang['page-search-0056'],
      value: 'right like'
    }, {
      display: multiLang['page-search-0057'],
      value: 'is null'
    }, {
      display: multiLang['page-search-0084'],
      value: 'not like'
    }, {
      display: multiLang['page-search-0085'],
      value: 'is not null'
    }];
  }
} //处理自然时间转多时区和起终点 time 是时间 flage：start 当天0点，end当天24点 假就是不处理

function naturalTimeHandler(time, flag) {
  var format = '';

  switch (flag) {
    case 'start':
      format = 'YYYY-MM-DD HH:mm:ss';
      break;

    case 'end':
      format = 'YYYY-MM-DD HH:mm:ss';
      break;
  }

  var loc = Object(index_["DongbaToLocalTime"])(Object(index_["moment"])(time)).format(format);
  var dong8 = Object(index_["LocalToDongbaTime"])(Object(index_["moment"])(loc)).format('YYYY-MM-DD HH:mm:ss');
  return dong8;
}
/* 处理运算符 */

function _methods_createOperation(data) {
  data = data || '';
  data = data.replace(/^@+|@$/g, '');
  var o = data.split('@');
  var newArr = [];
  o.forEach(function (item) {
    for (var i = 0; i < OperationOptions.length; i++) {
      if (item === OperationOptions[i].value) {
        newArr.push(OperationOptions[i]);
        break;
      }
    }
  });
  return newArr;
}
function _clone(obj) {
  return JSON.parse(JSON.stringify(obj === undefined ? '' : obj));
}
function getTimezoneOffset() {
  return -1 * new Date().getTimezoneOffset() / 60;
} //从缓存中获取函数翻译值

function getFunctionValueFromViewModal(VALUE) {
  var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  var reslut = _clone(VALUE);

  var obj = {
    '#mainorg#': {
      // 默认主组织
      display: context.org_Name || '',
      value: context.pk_org || ''
    },
    '#DefaultCostRegion#': {
      // 默认财务成本域
      display: context.defaultCostRegionName || '',
      value: context.defaultCostRegionPk || ''
    },
    '#DefaultCreditCtlRegion#': {
      //默认信用域
      display: context.defaultCreditCtlRegionName || '',
      value: context.defaultCreditCtlRegionPk || ''
    },
    '#accountingbook#': {
      //默认账簿
      display: context.defaultAccbookName || '',
      value: context.defaultAccbookPk || ''
    },
    '#operator#': {
      //当前操作员
      display: context.userName || '',
      value: context.userId || ''
    },
    '#currentgroup#': {
      //当前集团
      display: context.groupName || '',
      value: context.groupId || ''
    },
    '#DefaultLiactCostrgFunction#': {
      //默认利润中心成本域
      display: context.defaultCenterContentName || '',
      value: context.defaultCenterContentPK || ''
    },
    "#DefaultCostrgOrLiactCostrgFunc#": {
      //默认成本域
      display: context.defaultCostRegionName || context.defaultCenterContentName || '',
      value: context.defaultCostRegionPk || context.defaultCenterContentPK || ''
    },
    "#busioperator#": {
      //当前人员
      display: context.defaultPsndocName || '',
      value: context.defaultPsndocPK || ''
    },
    "#rbacdept#": {
      //当前人员所属部门  数组
      display: Array.isArray(context.defaultDeptName) ? context.defaultDeptName.join(',') : '',
      value: Array.isArray(context.defaultDeptPK) ? context.defaultDeptPK.join(',') : ''
    }
  };

  if (Array.isArray(reslut)) {
    reslut.map(function (item) {
      if (item.value && item.value.indexOf('#') !== -1) {
        item = obj[item.value] || item;
      }

      return item;
    });
  } else {
    if (reslut.value && reslut.value.indexOf('#') !== -1) {
      reslut = obj[reslut.value] || reslut;
    }
  }

  return reslut;
} // 为提供默认的 条件组的初始值

function initDefaultSnapshot(items, context, isTemplateOrder) {
  var _this = this;

  function getValue(item) {
    var initialvalue = {
      display: '',
      value: ''
    };

    if (item.itemtype === 'checkbox_switch') {
      initialvalue.value = false;
    } else if (item.itemtype === 'refer' && item.initialvalue) {
      var refervalue = getFunctionValueFromViewModal(item.initialvalue, context);
      item.initialvalue.display = refervalue.display || item.initialvalue.display;
    } else if (item.itemtype === 'residtxt') {
      var _item$languageMeta$fi;

      var index = ((_item$languageMeta$fi = item.languageMeta.filter(function (val) {
        return val.languageCode == index_["localeLang"];
      })[0]) === null || _item$languageMeta$fi === void 0 ? void 0 : _item$languageMeta$fi.index) || 1;
      initialvalue.index = index;

      if (item.initialvalue && !item.initialvalue.hasOwnProperty('index')) {
        item.initialvalue.index = index;
      }
    }

    return item.initialvalue && (!Object(index_["isEmpty"])(item.initialvalue.value) || item.initialvalue.index) ? item.initialvalue : initialvalue;
  }

  var result = [];

  if (Object(index_["isArray"])(items)) {
    var snapshotList = items.filter(function (item) {
      return (item.visible || item.isfixedcondition) && item.isdrag;
    });
    var requireList = [];
    var fiexedList = [];
    var otherList = [];
    snapshotList.forEach(function (item, index) {
      if (!(Number(item.visibleposition) > 0)) {
        item.visibleposition = 99999 + index;
      }

      if (item.isfixedcondition) {
        fiexedList.push(item);
      } else if (item.required) {
        requireList.push(item);
      } else {
        otherList.push(item);
      }
    });
    /**
       * 预置方案排序规则：查询模板中字段的排序分为“默认显示字段排序”、查询区域字段顺序、必填项顺序、固定条件顺序
    排序规则：固定条件顺序>必填项顺序>默认显示字段排序中设置的顺序>查询区域字段顺序
    举例：1.当一个字段设置了“默认显示字段排序”为10，在查询区域中字段显示在第12个，则在查询模板中此字段显示在第10的位置；
       2.当一个字段设置了“默认显示字段排序”为10，在查询区域中字段显示在第8个，又设置了固定条件，则此字段在查询模板中显示在第1位；
     */

    fiexedList.sort(function (v1, v2) {
      return Number(v1.visibleposition) - Number(v2.visibleposition);
    });

    if (isTemplateOrder) {
      var notFixed = requireList.concat(otherList).sort(function (v1, v2) {
        return Number(v1.visibleposition) - Number(v2.visibleposition);
      });
      snapshotList = fiexedList.concat(notFixed);
    } else {
      requireList.sort(function (v1, v2) {
        return Number(v1.visibleposition) - Number(v2.visibleposition);
      });
      otherList.sort(function (v1, v2) {
        return Number(v1.visibleposition) - Number(v2.visibleposition);
      });
      snapshotList = fiexedList.concat(requireList).concat(otherList);
    } // snapshotList.sort((v1, v2) => Number(v1.visibleposition) - Number(v2.visibleposition));


    snapshotList.forEach(function (item, index) {
      var value = getValue.call(_this, item);
      var obj = {
        attrcode: item.attrcode,
        initialvalue: value,
        operationSign: item.queryOperateType ? item.queryOperateType.split('@')[0] : '',
        operationOptions: _methods_createOperation(item.queryOperateType),
        remove: item.required != true && item.isfixedcondition != true,
        // label 查询区收起时需要 add by wanglongx
        label: item.label,
        isfixedcondition: !!item.isfixedcondition,
        isExtend: !!item.isfixedcondition,
        visible: true
      };

      if (item.itemtype === 'residtxt' && value.value) {
        obj.valueMap = {};
        obj.valueMap[item.attrcode + value.index] = {
          value: value.value
        };
      }

      result.push(obj);
    });
  }

  return result;
} //方案平铺

function planExtend(searchInfo, items, context) {
  var result = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
  var level = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;

  if (Array.isArray(items)) {
    items.forEach(function (item) {
      if (item.children) {
        planExtend(searchInfo, item.children, context, result, ++level);
      } else {
        var initialvalue = {
          display: '',
          value: ''
        };
        item.initialvalue = item.initialvalue || item.value;
        var tempItem = searchInfo.itemsMap[item.attrcode];

        if (tempItem) {
          if (tempItem.itemtype === 'checkbox_switch') {
            initialvalue.value = false;
          } else if (tempItem.itemtype === 'refer' && item.initialvalue) {
            var refervalue = getFunctionValueFromViewModal.call(item.initialvalue, context);
            item.initialvalue.display = refervalue.display || item.initialvalue.display;
          } else if (tempItem.itemtype === 'residtxt') {
            var _tempItem$languageMet;

            var index = ((_tempItem$languageMet = tempItem.languageMeta.filter(function (val) {
              return val.languageCode == index_["localeLang"];
            })[0]) === null || _tempItem$languageMet === void 0 ? void 0 : _tempItem$languageMet.index) || 1;
            initialvalue.index = index;

            if (item.initialvalue && !item.initialvalue.hasOwnProperty('index')) {
              item.initialvalue.index = index;
            }
          }

          var obj = {
            attrcode: item.attrcode,
            refpk: item.attrcode,
            initialvalue: item.initialvalue && (item.initialvalue.value || item.initialvalue.value === false || item.initialvalue.display || item.initialvalue.index) ? item.initialvalue : initialvalue,
            //此处initialvalue判空可能有问题，调试的时候再改 xuyang
            operationSign: item.operationSign || item.queryOperateType.split('@')[0] || '',
            remove: item.hasOwnProperty('remove') ? item.remove : tempItem.required != true && tempItem.isfixedcondition != true,
            visible: true
          };

          if (tempItem.itemtype === 'refer') {
            obj.runWithChildren = !!item.runWithChildren;
            obj.refurl = item.refurl || '';
          } else if (tempItem.itemtype === 'residtxt') {
            obj.valueMap = {};

            if (!item.hasOwnProperty('valueMap') && obj.initialvalue.value) {
              obj.valueMap[item.attrcode + obj.initialvalue.index] = {
                value: obj.initialvalue.value
              };
            } else if (item.hasOwnProperty('valueMap')) {
              obj.valueMap = item.valueMap;
            }
          }

          if (tempItem.isfixedcondition && level < 2) {
            obj.visible = false;
          }

          result.push(obj);
        }
      }
    });
  }

  return result;
} // 将查询方案转换成 snapshot

function plan2snapshotTranslate(searchInfo, items, context, createOperation) {
  var level = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;

  if (Array.isArray(items)) {
    items.forEach(function (item) {
      if (item.children) {
        plan2snapshotTranslate(searchInfo, item.children, context, createOperation, ++level);
      } else {
        var initialvalue = {
          display: '',
          value: ''
        };
        item.initialvalue = item.initialvalue || item.value;
        var tempItem = searchInfo.itemsMap[item.attrcode];

        if (tempItem) {
          if (tempItem.itemtype === 'checkbox_switch') {
            initialvalue.value = false;
          } else if (item.itemtype === 'refer' && item.initialvalue) {
            var refervalue = getFunctionValueFromViewModal.call(item.initialvalue, context);
            item.initialvalue.display = refervalue.display || item.initialvalue.display;
          } else if (item.itemtype === 'residtxt') {
            var _item$languageMeta$fi2;

            var index = ((_item$languageMeta$fi2 = item.languageMeta.filter(function (val) {
              return val.languageCode == index_["localeLang"];
            })[0]) === null || _item$languageMeta$fi2 === void 0 ? void 0 : _item$languageMeta$fi2.index) || 1;
            initialvalue.index = index;

            if (item.initialvalue && !item.initialvalue.hasOwnProperty('index')) {
              item.initialvalue.index = index;
            }
          }

          item.refpk = item.attrcode;
          item.initialvalue = item.initialvalue && (item.initialvalue.value || item.initialvalue.value === false || item.initialvalue.display || item.initialvalue.index) ? item.initialvalue : initialvalue; //此处initialvalue判空可能有问题，调试的时候再改 xuyang

          item.operationSign = item.operationSign || item.queryOperateType.split('@')[0] || '';
          item.operationOptions = createOperation(tempItem.queryOperateType);
          item.remove = item.hasOwnProperty('remove') ? item.remove : tempItem.required != true && tempItem.isfixedcondition != true;

          if (tempItem.itemtype === 'residtxt' && !item.hasOwnProperty('valueMap') && item.initialvalue.value) {
            item.valueMap = {};
            item.valueMap[item.attrcode + item.initialvalue.index] = {
              value: item.initialvalue.value
            };
          } //需要注释掉
          // item.visible = !(!item.isfixedcondition && tempItem.isfixedcondition && level < 2);

        }
      }
    });
  }

  return items;
} //根据快照 过滤模板

function templateFilter(itemsMap, snapshot) {
  var result = [];

  if (Object(index_["isArray"])(snapshot)) {
    snapshot.forEach(function (item) {
      if (itemsMap.hasOwnProperty(item.attrcode)) {
        result.push(itemsMap[item.attrcode]);
      }
    });
  }

  return result;
} // 根据模板重新修改 snapshot

function snapshotChangeByTemplate(snapshot, items, context) {
  var newSnapshot = initDefaultSnapshot(items, context);
  newSnapshot.forEach(function (newItem) {
    snapshot.forEach(function (oldItem) {
      if (newItem.attrcode === oldItem.attrcode) {
        //此处判断有问题，如果是多个相同的条件的时候 会出现赋值混乱。
        newItem.initialvalue = oldItem.initialvalue;
        newItem.operationSign = oldItem.operationSign;
      }
    });
  });
  return newSnapshot;
} // 获得有数据的snapshot

function snapshotFilter(snapshot, itemsMap) {
  if (Array.isArray(snapshot)) {
    return snapshot.filter(function (item) {
      return !Object(index_["isEmpty"])(item.initialvalue.value);
    });
  } else {
    return [];
  }
} //查询条件所有值都添加了

function allItemsFillComplete(snapshot, searchInfo, context) {
  var result = true;

  if (snapshot[0] && snapshot[0].attrcode == 'root') {
    snapshot = planExtend(searchInfo, snapshot, context);
  }

  snapshot.forEach(function (item) {
    // 必填项无值 不执行查询 其他情况执行查询
    if (searchInfo.itemsMap[item.attrcode]['itemtype'] === 'refer') item.initialvalue = getFunctionValueFromViewModal(item.initialvalue, context);

    if (searchInfo.itemsMap[item.attrcode]['required'] && Object(index_["isEmpty"])(item.initialvalue.value)) {
      result = false;
    }
  });
  return result;
} //树结构转数组

function tree2Array(data) {
  var reuslt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  if (Array.isArray(data)) {
    data.forEach(function (item) {
      if (item) {
        if (item.children) {
          tree2Array(item.children, reuslt);
        } else {
          reuslt.push(item);
        }
      }
    });
  }

  return reuslt;
} //时间比较函数

function CompareDate(d1, d2) {
  // console.log(d1, d2);
  return new Date(d1.replace(/-/g, '/')) > new Date(d2.replace(/-/g, '/'));
}
function isDateFunction(value) {
  value = String(value);
  return value.indexOf('#') !== -1;
}

function addMark(data) {
  data.map(function (item) {
    if (item.initialvalue && (item.initialvalue.value === '' || item.initialvalue.value === null || Object(index_["isArray"])(item.initialvalue.value) && !item.initialvalue.value.length || Object(index_["isArray"])(item.initialvalue.value) && item.initialvalue.value[0] === null)) {
      item.isEmpty = true;
    } else {
      item.isEmpty = false;
    }

    if (Array.isArray(item.children)) {
      addMark(item.children);
    }
  });
}
/**
 * @description: 后台交互AJAX
 * @param {flag} String 交互类型 (edit编辑方案名称, save保存方案, add新增方案)
 * @param {type} Boolean 是否外层调用  
 * @param {currentPlanName} String 外层使用时传入的方案名称  
 * @return: 
 */


function _methods_beSureBtnClick(flag, type, currentPlanName) {
  var _this2 = this;

  /* 此处ajax */
  // enter 键触发时  存在参数错误的情况 type = enter 
  currentPlanName = currentPlanName ? typeof currentPlanName == 'string' ? currentPlanName : undefined : undefined;

  if (typeof type == 'boolean') {
    this.props = this;
    this.multiLang = this.state.json;
  } else {
    if (flag == 'save' && this.state.currentPlan.name === this.multiLang['page-search-0018']) {
      {
        Object(index_["toast"])({
          content: this.multiLang['page-search-0016'],
          color: 'warning'
        });
      }
      return;
    } else if (this.state.searchPlanName.replace(/\s+/g, '') === '') {
      {
        Object(index_["toast"])({
          content: this.multiLang['page-search-0032'],
          color: 'warning'
        });
      } // 模态框不隐藏

      if (flag === 'add') {
        this.props.modal.show('addSearchPlan@' + this.props.moduleId);
      } else if (flag === 'edit') {
        this.props.modal.show('editSearchPlanName@' + this.props.moduleId);
      }

      return;
    } else if (flag !== 'save') {
      if (!Object(index_["isEmpty"])(this.state.searchPlan)) {
        if (flag === 'edit' && this.state.currentPlan.name === this.state.searchPlanName) {
          this.props.modal.close('editSearchPlanName@' + this.props.moduleId);
          return;
        }

        var currentPlan = this.state.searchPlan.find(function (item) {
          return item.name === _this2.state.searchPlanName;
        });

        if (currentPlan) {
          {
            Object(index_["toast"])({
              content: this.multiLang['page-search-0083'],
              color: 'warning'
            });
          } // 模态框不隐藏

          if (flag === 'add') {
            this.props.modal.show('addSearchPlan@' + this.props.moduleId);
          } else if (flag === 'edit') {
            this.props.modal.show('editSearchPlanName@' + this.props.moduleId);
          }

          return;
        }
      }
    }
  }

  var that = this;
  var data = {
    "public": null,
    // 公共区域查询条件
    nonpublic: null // 非公共区域查询条件

  };
  var state = null;
  /*
  *    如果业务组自定义查询条件，保存方案时，需要业务组返回其自定义的查询条件
  *    状态：
  *    1、业务组只添加部分自定义查询条件，此时分两部分：公共查询区、自定义查询区
  *    2、业务组替换整个右侧body区，只有自定义查询区
  *    3、只有公共查询区
  * */
  // 获取公共查询区域查询条件及state

  var runThis = function runThis() {
    var searchInfo = _this2.state.searchInfo;
    data["public"] = _getAllSearchData.call(_this2, _this2.props.moduleId, _this2.state.searchInfo, false);
    state = searchInfo.snapshotMap[searchInfo.status].filter(function (item) {
      return item.isExtend !== true;
    }); //这块有问题xuyangt

    addMark(state);
  };

  if (this.state.userControlAll) {
    // 业务组替换整个查询区
    data.nonpublic = this.props.saveSearchPlan();
  } else {
    data.nonpublic = typeof this.props.saveSearchPlan === 'function' ? this.props.saveSearchPlan() : null;
    runThis();
  }

  var pk = this.state.currentPlan ? this.state.currentPlan.pk_ncc_queryscheme : null;
  if (typeof type == 'boolean') pk = this.state.searchInfo.searchPlanCache.find(function (item) {
    return item.name == currentPlanName;
  }).pk_ncc_queryscheme;

  if (!this.props.hasOwnProperty('oid')) {// console.error(this.multiLang['page-search-0041']);
  }

  var saveSearchPlanData = {
    name: this.state.searchPlanName,
    conditionobj4web: data,
    //查询条件
    renderobj4web: state,
    // 查询条件前台数据结构，用于渲染查询区
    areaid: this.props.oid || this.props.meta.oid,
    //这块是一个暂时的处理，因为有些场景this.props.oid ==undefined 原因还没查出来
    isprepared: false,
    //预制方案
    isquickqs: false //默认方案 ,只能修改，不能删除

  };

  if (pk) {
    saveSearchPlanData.pk_ncc_queryscheme = pk;
  }

  if (this.state.currentPlan) {
    saveSearchPlanData.isprepared = this.state.currentPlan.isprepared;
    saveSearchPlanData.isquickqs = this.state.currentPlan.isquickqs;
  } // editAjax 修改方案名称


  var editAjax = function editAjax() {
    var newdate = _this2.state.searchInfo.searchPlanCache.find(function (item) {
      return (currentPlanName || _this2.state.currentPlan.name) == item.name;
    });

    saveSearchPlanData.renderobj4web = newdate.renderobj4web;
    saveSearchPlanData.name = _this2.state.searchPlanName;
    saveAjax();
  }; // saveAjax 修改方案保存


  var saveAjax = function saveAjax() {
    Object(index_["ajax"])({
      url: '/nccloud/riart/queryscheme/updateQS.do',
      data: saveSearchPlanData,
      success: function success(res) {
        if (res.success) {
          {
            Object(index_["toast"])({
              content: _this2.multiLang['page-search-0033'],
              color: 'success'
            });
          } // 修改成功后，更新state数据

          if (typeof type == 'boolean') {
            // 外部修改 
            var _i = that.state.searchInfo.searchPlanCache.findIndex(function (e) {
              return e.pk_ncc_queryscheme === saveSearchPlanData.pk_ncc_queryscheme;
            });

            if (_i !== -1) {
              saveSearchPlanData.pk_ncc_queryscheme = res.data;
              that.state.searchInfo.searchPlanCache[_i] = _clone(_methods_objectSpread(_methods_objectSpread({}, that.state.searchInfo.searchPlanCache[_i]), saveSearchPlanData)); // that.state.searchInfo.currentPlan = saveSearchPlanData;
              // setSearchPlanName.call(that._this._this, that.id, saveSearchPlanData.name); 修复部分节点 不存在快速方案 只有预制方案

              if (currentPlanName == (that.state.searchInfo.currentPlan && that.state.searchInfo.currentPlan.name)) {
                that.state.searchInfo.currentPlan = saveSearchPlanData;
              }

              that.setState({
                searchInfo: that.state.searchInfo
              });
              var _keySessionS = _this2._this.myState.search.keySessionS;

              if (!Object(index_["isEmpty"])(_keySessionS)) {
                _keySessionS.forEach(function (item) {
                  return removeGlobalStorage('localStorage', item);
                });
              }
            }

            return;
          } // enter 键 关闭modal 


          if (typeof type == 'string' && type == 'enter') {
            _this2.props.modal.close('editSearchPlanName@' + _this2.props.moduleId);
          } // 内部修改


          var i = that.state.searchPlan.findIndex(function (e) {
            return e.pk_ncc_queryscheme === saveSearchPlanData.pk_ncc_queryscheme;
          });

          if (i !== -1) {
            saveSearchPlanData.pk_ncc_queryscheme = res.data;
            that.state.searchPlan[i] = _clone(_methods_objectSpread(_methods_objectSpread({}, that.state.searchPlan[i]), saveSearchPlanData));
            that.props.searchPlanCacheChange(that.state.searchPlan);
          }

          _this2.state.currentPlan = saveSearchPlanData; // 更新查询方案名称

          if (!_this2.state.userControlAll) {
            setSearchPlanName.call(that.props._this._this, that.props.id, saveSearchPlanData.name); // saveSearchPlanData.isquickqs &&
            // 	this.props.afterEditSearchPlan(saveSearchPlanData.renderobj4web);
          } // 当外层方案不是预置方案时 更新界面方案 当前保存的方案是 界面上展示的方案


          if (that.state.searchInfo.currentPlan != undefined) {
            if (_this2.state.currentPlan.pk_ncc_queryscheme == that.state.searchInfo.currentPlan.pk_ncc_queryscheme) {
              var a = _clone(_this2.state.currentPlan);

              that.props.upDateSearchPlan(a);
            }
          }

          var keySessionS = _this2.props._this._this.myState.search.keySessionS;

          if (!Object(index_["isEmpty"])(keySessionS)) {
            keySessionS.forEach(function (item) {
              return removeGlobalStorage('localStorage', item);
            });
          }
        }
      }
    });
  };

  var addAjax = function addAjax() {
    /* 避免新增方案时有pk */
    if (saveSearchPlanData.hasOwnProperty('pk_ncc_queryscheme')) {
      delete saveSearchPlanData.pk_ncc_queryscheme;
    }

    saveSearchPlanData.isquickqs = false;
    saveSearchPlanData.sequenc = (Array.isArray(_this2.props.searchPlanCache) && _this2.props.searchPlanCache.length || 0) + 1;
    Object(index_["ajax"])({
      url: '/nccloud/riart/queryscheme/addQS.do',
      data: saveSearchPlanData,
      success: function success(res) {
        if (res.success) {
          {
            Object(index_["toast"])({
              content: _this2.multiLang['page-search-0034'],
              color: 'success'
            });
          } // enter 键 关闭modal 

          if (typeof type == 'string' && type == 'enter') {
            _this2.props.modal.close('addSearchPlan@' + _this2.props.moduleId);
          }

          saveSearchPlanData.pk_ncc_queryscheme = res.data;

          _this2.state.searchPlan.push(_clone(saveSearchPlanData));

          _this2.props.searchPlanCacheChange(_this2.state.searchPlan);

          _this2.setState({
            searchPlan: _this2.state.searchPlan
          });

          _this2.state.currentPlan = saveSearchPlanData;

          if (!_this2.state.userControlAll) {
            setSearchPlanName.call(that.props._this._this, that.props.id, saveSearchPlanData.name);
          }

          var keySessionS = _this2.props._this._this.myState.search.keySessionS;

          if (!Object(index_["isEmpty"])(keySessionS)) {
            keySessionS.forEach(function (item) {
              return removeGlobalStorage('localStorage', item);
            });
          }
        }
      }
    });
  };

  if (flag === 'edit') {
    // 修改时，先校验方案名称是否重复 ，重复时，提示。不重复，覆盖 old 
    // 修改方案名称 取state 之前的数据 只修改 方案名称
    editAjax();
  } else if (flag === 'save') {
    // 新增时，校验方案名称是否重复 ，重复时，提示。不重复，新增 old 
    // 直接保存 
    var _currentPlan = this.state.searchPlan.find(function (item) {
      return item.name === _this2.state.searchPlanName;
    });

    saveSearchPlanData.pk_ncc_queryscheme = _currentPlan.pk_ncc_queryscheme;
    saveSearchPlanData.isdefault = _currentPlan.isdefault;
    saveSearchPlanData.isquickqs = _currentPlan.isquickqs;
    saveSearchPlanData.isprepared = _currentPlan.isprepared;
    saveSearchPlanData.isdelete = _currentPlan.isdelete;
    saveAjax(); // checkRepeat();
  } else if (flag === 'add') {
    // 新增 方案 
    addAjax();
  }
}
/* 删除查询方案确定按钮 */

function beSureBtnClick_Del(type, pk_ncc_queryscheme, callback) {
  var _this3 = this;

  var pk = null;
  var that = this;

  if (typeof type == 'boolean') {
    this.props = this;
    this.multiLang = this.state.json;
    pk = pk_ncc_queryscheme;
  } else {
    pk = this.state.currentPlan.pk_ncc_queryscheme;
  }

  Object(index_["ajax"])({
    url: '/nccloud/riart/queryscheme/deleteQS.do',
    data: {
      pk_ncc_queryscheme: pk
    },
    success: function success(res) {
      if (res.success) {
        {
          Object(index_["toast"])({
            content: _this3.multiLang['page-search-0038'],
            color: 'success'
          });
        } // 外部修改

        if (type) {
          // let currentMap = this.state.searchInfo.searchPlanCache ;
          // let currentPlan = currentMap.find(item => item.pk_ncc_queryscheme == pk_ncc_queryscheme);
          // let i = currentMap.length;
          // while (i--) {
          // 	let item = currentMap[i];
          // 	if (item.pk_ncc_queryscheme === currentPlan.pk_ncc_queryscheme) {
          // 		currentMap.splice(i, 1);
          // 		this.props.searchPlanCacheChange(currentMap);
          // 		break;
          // 	}
          // }
          _this3.state.searchInfo.searchPlanCache = _this3.state.searchInfo.searchPlanCache.filter(function (item) {
            return item.pk_ncc_queryscheme != pk_ncc_queryscheme;
          }); // 删除时当前方案时  当前置为预制方案

          _this3.meta.queryschemes = _this3.state.searchInfo.searchPlanCache.filter(function (item) {
            return item.pk_ncc_queryscheme != '001';
          });

          if ((_this3.state.searchInfo.currentPlan && _this3.state.searchInfo.currentPlan.pk_ncc_queryscheme) == pk_ncc_queryscheme) {
            var quickqs = _this3.state.searchInfo.searchPlanCache.find(function (item) {
              return item.isquickqs;
            });

            if (quickqs) {
              _this3.state.searchInfo.snapshotMap['simple'] = quickqs.renderobj4web; // 快速方案添加到 当前方案

              _this3.state.searchInfo.currentPlan = quickqs;
            } else {
              _this3.state.searchInfo.snapshotMap['simple'] = _this3.state.searchInfo.defaultPlan.renderobj4web;
              _this3.state.searchInfo.currentPlan = _this3.state.searchInfo.defaultPlan;
            }
          }

          var _keySessionS2 = _this3._this.myState.search.keySessionS;

          if (!Object(index_["isEmpty"])(_keySessionS2)) {
            _keySessionS2.forEach(function (item) {
              return removeGlobalStorage('localStorage', item);
            });
          }

          _this3.setState({
            searchInfo: _this3.state.searchInfo
          });

          callback();
          return;
        }

        var i = _this3.state.searchPlan.length;

        while (i--) {
          var item = _this3.state.searchPlan[i];

          if (item.pk_ncc_queryscheme === _this3.state.currentPlan.pk_ncc_queryscheme) {
            _this3.state.searchPlan.splice(i, 1);

            _this3.props.searchPlanCacheChange(_this3.state.searchPlan);

            break;
          }
        } // 删除外部方案


        if (_this3.state.currentPlan.pk_ncc_queryscheme == (_this3.state.searchInfo.currentPlan && _this3.state.searchInfo.currentPlan.pk_ncc_queryscheme)) {
          var _quickqs = _this3.state.searchInfo.searchPlanCache.find(function (item) {
            return item.isquickqs;
          });

          if (_quickqs) {
            that.props.upDateSearchPlan(_quickqs);
          } else {
            that.props.upDateSearchPlan(_this3.state.searchInfo.defaultPlan);
          }
        }

        var keySessionS = _this3.props._this._this.myState.search.keySessionS;

        if (!Object(index_["isEmpty"])(keySessionS)) {
          keySessionS.forEach(function (item) {
            return removeGlobalStorage('localStorage', item);
          });
        }

        _this3.setState({
          searchPlan: _this3.state.searchPlan
        });
      }
    }
  });
}
// CONCATENATED MODULE: ./src/platform/components/CreateSearch/methods.js
function methods_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { methods_typeof = function _typeof(obj) { return typeof obj; }; } else { methods_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return methods_typeof(obj); }



 // import { timeFunctionTranslater, DongbaToLocalTime, LocalToDongbaTime } from '../../public/timer';

 // import { _addData } from '../CreateAdvSearch/methods';
// import toast from '../../api/toast';

var methods_multiLang = {};
var methods_OperationOptions = [];
/* 检测组件id是否存在 */

function checkModuleId(id) {
  if (!this.state.meta.hasOwnProperty(id)) {
    Object(index_["toast"])({
      color: 'danger',
      content: methods_multiLang['page-search-0043']
    });
    return false;
  }

  return true;
}

function checkSearchAreaRenderComplete(id) {
  if (!this.state.meta[id].isCompleted) {
    Object(index_["toast"])({
      color: 'danger',
      content: '请先初始化查询区,再调用查询区方法'
    });
    return false;
  }

  return true;
}
/* 获取具体某个field的值 */


function getValueByField(searchId, field, status) {
  var searchInfo = this.state.searchInfo;
  var id = this.props.id;
  var snapshot = searchInfo.snapshotMap[status || searchInfo.status];
  var data = getAllSearchDataEve.call(this, id, snapshot, false);

  if (!data) {
    return {
      value: {
        firstvalue: '',
        secondvalue: ''
      },
      display: '',
      oprtype: ''
    };
  } // 下面这段不走吧。。


  var len = data.conditions.length;

  if (len <= 0) {
    // {
    // 	toast({ content: `当前查询区没有查询条件`, color: 'warning' });
    // }
    return {
      value: {
        firstvalue: '',
        secondvalue: ''
      },
      display: '',
      oprtype: ''
    };
  } // ——————


  var res = {
    value: {
      firstvalue: '',
      secondvalue: ''
    },
    display: '',
    oprtype: ''
  };

  function getvalue(list, field) {
    list.forEach(function (item) {
      if (item.conditions) {
        getvalue(item.conditions, field);
      } else {
        if (item.field === field) {
          res.value = item.value;
          res.display = item.display;
          res.oprtype = item.oprtype;
        }
      }
    });
  }

  getvalue(data.conditions, field);
  return res;
} // loop set value 


function setValue(list, field, data) {
  list.forEach(function (val) {
    if (val.children && Array.isArray(val.children)) {
      setValue(val.children);
    } else if (val.attrcode === field) {
      val.initialvalue = data;
    }
  });
}
/* 设值查询区某个字段的值 */


function setSearchValByFieldEve(searchId, field, data, status) {
  // // 新查询用方案区分 status 其实没有用了 simple narmal super 都处理了
  // let arr =['simple', 'normal', 'super'];
  // if (this.state.searchInfo) {
  // 	let searchInfo = this.state.searchInfo;
  // 	// let snapshot = searchInfo.snapshotMap[status || searchInfo.status];
  // 	let searchPlanList = searchInfo.searchPlanCache;
  // 	let currentPk = searchInfo.currentPlan ? searchInfo.currentPlan.pk_ncc_queryscheme : searchInfo.defaultPlan.pk_ncc_queryscheme;
  // 	let currentPlan = searchPlanList.find(item => item.pk_ncc_queryscheme == currentPk)['renderobj4web']
  // 	if (!data) {
  // 		data = {
  // 			value: '',
  // 			display: ''
  // 		};
  // 	}
  // 	arr.map(item => {
  // 		let current = searchInfo.snapshotMap[item]
  // 		if (isEmpty(current)) {
  // 			searchInfo.snapshotCache[item || searchInfo.status][field] = data;
  // 		} else {
  // 			setValue(current, field, data);
  // 		}
  // 	})
  // 	// if (isEmpty(snapshot)) {
  // 	// 	searchInfo.snapshotCache[status || searchInfo.status][field] = data;
  // 	// } else {
  // 	// 	setValue(snapshot, field, data);
  // 	// }
  // 	// 放到当前方案的 cach 当中
  // 	if (!isEmpty(currentPlan)) {
  // 		setValue(currentPlan, field, data);
  // 	}
  // 	this.setState({
  // 		searchInfo: searchInfo
  // 	});
  // } else {
  // 	console.error('setSearchValByField方法没有找到searchId');
  // 	return false;
  // }
  if (this.state.searchInfo) {
    var _searchInfo$currentPl;

    var searchInfo = this.state.searchInfo;
    var snapshot = (searchInfo === null || searchInfo === void 0 ? void 0 : (_searchInfo$currentPl = searchInfo.currentPlan) === null || _searchInfo$currentPl === void 0 ? void 0 : _searchInfo$currentPl.renderobj4web_snap) || searchInfo.snapshotMap[status || searchInfo.status];

    if (!data) {
      data = {
        value: '',
        display: ''
      };
    } //将业务组赋值全部存起来，by xiquanquan
    // searchInfo.snapshotCache[status || searchInfo.status][field] = data;


    if (Object(index_["isEmpty"])(snapshot)) {
      searchInfo.snapshotCache[status || searchInfo.status][field] = data;
    } else {
      var _setValue = function _setValue(list) {
        list.forEach(function (val) {
          if (val.children && Array.isArray(val.children)) {
            _setValue(val.children);
          } else if (val.attrcode === field) {
            val.initialvalue = data;
          }
        });
      };

      _setValue(snapshot);

      this.setState({
        searchInfo: searchInfo
      });
    }
  } else {
    console.error('setSearchValByField方法没有找到searchId');
    return false;
  }
}

function ArrayHas2Value(value) {
  var result = true;
  if (!Array.isArray(value) || value.length != 2 || Object(index_["isEmpty"])(value[0]) || Object(index_["isEmpty"])(value[1])) result = false;
  return result;
}

function setMultiLang(_multiLang) {
  methods_multiLang = _multiLang;
}
function setMultiLangHigh(_multiLang) {
  methods_multiLang = _multiLang;

  if (Object(index_["isEmpty"])(methods_OperationOptions)) {
    methods_OperationOptions = [{
      display: methods_multiLang['page-search-0047'],
      value: '='
    }, {
      display: methods_multiLang['page-search-0047'],
      value: '=='
    }, {
      display: methods_multiLang['page-search-0048'],
      value: '>'
    }, {
      display: methods_multiLang['page-search-0049'],
      value: '<'
    }, {
      display: methods_multiLang['page-search-0050'],
      value: 'between'
    }, {
      display: methods_multiLang['page-search-0051'],
      value: '>='
    }, {
      display: methods_multiLang['page-search-0052'],
      value: '<='
    }, {
      display: methods_multiLang['page-search-0053'],
      value: '<>'
    }, {
      display: methods_multiLang['page-search-0054'],
      value: 'like'
    }, {
      display: methods_multiLang['page-search-0055'],
      value: 'left like'
    }, {
      display: methods_multiLang['page-search-0056'],
      value: 'right like'
    }, {
      display: methods_multiLang['page-search-0057'],
      value: 'is null'
    }, {
      display: methods_multiLang['page-search-0084'],
      value: 'not like'
    }, {
      display: methods_multiLang['page-search-0085'],
      value: 'is not null'
    }];
  }
}
/* 获取查询区 所有数据 */

function getAllSearchDataEve(id, snapshot, flag) {
  var _this2 = this;

  var logic = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'and';
  var callBackMeta = [];
  var searchInfo = this.state.searchInfo; // 必填校验时 把所有必填校验未通过都标红 	

  var requiredArr = []; // 这个for 循环的逻辑太复杂了 没办法 必须把 校验逻辑抽出来

  var _loop = function _loop(i) {
    if (snapshot[i].children && Array.isArray(snapshot[i].children)) {
      if (i == 0 && snapshot[i].attrcode == 'root') {
        return {
          v: getAllSearchDataEve.call(_this2, id, snapshot[i].children, flag, snapshot[i].operationSign)
        };
      } else {
        callBackMeta.push(getAllSearchDataEve.call(_this2, id, snapshot[i].children, flag, snapshot[i].operationSign));
        return "continue";
      }
    }

    var attrcode = snapshot[i].attrcode;
    var val = searchInfo.itemsMap[attrcode];
    var VALUE = snapshot[i].initialvalue;
    var displayVal = VALUE.display || '';
    var optSign = snapshot[i].operationSign;
    var isIncludeSub = snapshot[i].runWithChildren || false;
    var refurl = snapshot[i].refurl || '';
    var timeFunction = '';

    if (displayVal && snapshot[i].runWithChildren) {
      displayVal = displayVal + methods_multiLang['page-search-0044'];
    }

    var data = {
      firstvalue: '',
      secondvalue: ''
    };

    if (val.required && flag && snapshot[i].visible) {
      var isKong = false;

      if (Object(index_["isEmpty"])(VALUE.value) || Array.isArray(VALUE.value) && !ArrayHas2Value(VALUE.value)) {
        if (optSign != 'is null' && optSign != 'is not null') {
          isKong = true;
        }
      }

      if (isKong) {
        callBackMeta = [];
        requiredArr.push(val.attrcode);
      }
    }

    if ((val.itemtype === 'rangepicker' || (val.itemtype === 'datepicker' || val.itemtype === 'NCTZDatePickerEnd' || val.itemtype === 'NCTZDatePickerStart' || val.itemtype === 'datetimepicker') && optSign === 'between') && VALUE) {
      var vals = VALUE.value;

      if (vals && !Object(index_["isArray"])(vals)) {
        vals = vals.split(',');
      } //给报表平台加的逻辑，如果是函数，则将函数直接传给后台


      if (isDateFunction(vals[0])) {
        timeFunction = vals.join(',');
      }

      if (vals && Object(index_["isArray"])(vals)) {
        if (vals.length > 0 && vals[0] && vals[0].format) {
          // 多时区转化
          var start = vals[0].format('YYYY-MM-DD');
          var end = vals[1].format('YYYY-MM-DD'); // 1 开始时间

          var currentZoneStartTime = Object(index_["moment"])(start).startOf('day').toDate();
          var currentZoneStartHours = currentZoneStartTime.getHours();
          var offsetZone = currentZoneStartTime.getTimezoneOffset() / 60; // 2 结束时间

          var currentZoneEndTime = Object(index_["moment"])(end).endOf('day').toDate();
          var currentZoneEndHours = currentZoneEndTime.getHours(); // 当地时间转换为东八区时间

          offsetZone = offsetZone + 8;
          currentZoneStartTime.setHours(currentZoneStartHours + offsetZone);
          currentZoneEndTime.setHours(currentZoneEndHours + offsetZone); //   newData.firstvalue = moment(currentZoneStartTime).format('YYYY-MM-DD HH:mm:ss');
          //   newData.secondvalue = moment(currentZoneEndTime).format('YYYY-MM-DD HH:mm:ss');

          data.firstvalue = Object(index_["moment"])(currentZoneStartTime).format('YYYY-MM-DD HH:mm:ss');
          data.secondvalue = Object(index_["moment"])(currentZoneEndTime).format('YYYY-MM-DD HH:mm:ss'); // newVal.push(value.format('YYYY-MM-DD'));
        } else if (vals.length > 0 && vals[0] && !vals[0].format) {
          data.firstvalue = vals[0];
          data.secondvalue = vals[1];
        } else if (vals.length === 0) {
          data.firstvalue = '';
          data.secondvalue = '';
        }
      }
    } else if (val.itemtype === 'refer') {
      VALUE = getFunctionValueFromViewModal(VALUE, _this2.props.context); //参照函数翻译完成之后 有可能 出现翻译不出来的情况 ，翻译不出来 再次做一次必填校验吧

      if (val.required && flag && snapshot[i].visible) {
        if (!VALUE.value && VALUE.value !== 0) {
          callBackMeta = [];
          if (!requiredArr.includes(val.attrcode)) requiredArr.push(val.attrcode);
        }
      }

      if (optSign === 'between') {
        data.firstvalue = (VALUE.value || [])[0] || '';
        data.secondvalue = (VALUE.value || [])[1] || '';
        displayVal = (VALUE.display || []).join(',');
      } else {
        displayVal = VALUE.display;
        data.firstvalue = VALUE.value;
      }
    } else if ((val.itemtype === 'select' || val.itemtype === 'number' || val.itemtype === 'datetimepicker' || val.itemtype === 'NCTZDatePickerEnd' || val.itemtype === 'NCTZDatePickerStart') && optSign === 'between') {
      data.firstvalue = (VALUE.value || [])[0];
      data.secondvalue = (VALUE.value || [])[1];
      displayVal = (VALUE.display || [])[0] + '~' + (VALUE.display || [])[1];
    } else {
      data.firstvalue = VALUE.value;
    }

    var timeItemList = ['datepicker', 'datetimepicker', 'rangepicker', 'NCTZDatePickerStart', 'NCTZDatePickerEnd', 'NCTZDatePickClientTime', 'NCTZDatePickClientHourTime', 'NCTZDatePickerRangeDay', 'datePickerNoTimeZone']; // 需要从东八区时间处理当地时间，然后计算0点和24点，按照当地时间得0点和24点分别转为东八区时间

    var localToEast = ['datepicker', 'datetimepicker', 'NCTZDatePickClientTime', 'NCTZDatePickClientHourTime']; // 开始 和结束时间是时间戳概念  操作符为 = 时不需要进行扩充为日期范围

    var timeStampType = ['NCTZDatePickerStart', 'NCTZDatePickerEnd', 'datetimepicker'];

    if (timeItemList.some(function (item) {
      return item === val.itemtype;
    }) && !Object(index_["isEmpty"])(VALUE.value)) {
      //xuyangt 需要优化此处逻辑 很混乱
      var firstvalue = '',
          secondvalue = '';

      if (isDateFunction(data.firstvalue) && !data.secondvalue) {
        timeFunction = data.firstvalue;
      }

      if (isDateFunction(data.firstvalue) || isDateFunction(data.secondvalue)) {
        if (optSign == '=' || optSign == '<>') {
          // start 取开始时间戳 end时 取结束时间戳
          if (timeStampType.includes(val.itemtype)) {
            if (val.itemtype === 'NCTZDatePickerEnd') {
              firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue, {
                flag: false
              });
            } else {
              firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
            }
          } else {
            firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
            secondvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue, {
              flag: false
            });
          }
        } else if (optSign == '<' || optSign == '>=') {
          firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
        } else if (optSign == '>' || optSign == '<=') {
          firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue, {
            flag: false
          });
        } else if (optSign == 'between') {
          if (!Object(index_["isEmpty"])(data.firstvalue)) {
            firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
          }

          if (!Object(index_["isEmpty"])(data.secondvalue)) {
            secondvalue = Object(index_["timeFunctionTranslater"])(data.secondvalue, {
              flag: false
            });
          }
        }
      } else {
        if (optSign == '=' || optSign == '<>') {
          if (!timeStampType.includes(val.itemtype)) {
            // datepicker datepicker 需要处理时区从东八区时间转换为当地时间 计算当天时间[00:00:00, 23:59:59]在转换为东八区时间
            if (localToEast.includes(val.itemtype) && !isDateFunction(data.firstvalue)) {
              firstvalue = Object(index_["DongbaToLocalTime"])(Object(index_["moment"])(data.firstvalue)).format('YYYY-MM-DD 00:00:00');
              secondvalue = Object(index_["moment"])(firstvalue).format('YYYY-MM-DD 23:59:59'); // 转为东八区时间 

              firstvalue = Object(index_["LocalToDongbaTime"])(Object(index_["moment"])(firstvalue)).format('YYYY-MM-DD HH:mm:ss');
              secondvalue = Object(index_["LocalToDongbaTime"])(Object(index_["moment"])(secondvalue)).format('YYYY-MM-DD HH:mm:ss');
            } else {
              // start end 类型暂未处理
              firstvalue = Object(index_["moment"])(data.firstvalue).format('YYYY-MM-DD 00:00:00');
              secondvalue = Object(index_["timeFunctionTranslater"])(Object(index_["moment"])(data.firstvalue).format('YYYY-MM-DD 23:59:59'));
            }
          } else {
            firstvalue = data.firstvalue;
            secondvalue = firstvalue;
          }
        } else if (optSign == '<' || optSign == '>=') {
          firstvalue = naturalTimeHandler(data.firstvalue, 'start');
        } else if (optSign == '>' || optSign == '<=') {
          firstvalue = naturalTimeHandler(data.firstvalue, 'end');
        } else if (optSign == 'between') {
          if (!Object(index_["isEmpty"])(data.firstvalue)) {
            firstvalue = naturalTimeHandler(data.firstvalue, 'start');
          }

          if (!Object(index_["isEmpty"])(data.secondvalue)) {
            secondvalue = naturalTimeHandler(data.secondvalue, 'end');
          }
        } //如果存在两个值，做一下端点值大小的判断和调整


        if (firstvalue && secondvalue && CompareDate(firstvalue, secondvalue)) {
          firstvalue = Object(index_["timeFunctionTranslater"])(secondvalue);
          secondvalue = Object(index_["timeFunctionTranslater"])(firstvalue, {
            flag: false
          });
        }
      }

      if (optSign == '=') {
        optSign = 'between';
      }

      data.firstvalue = firstvalue;
      data.secondvalue = secondvalue;
    }

    if (!val.hasOwnProperty('queryOperateType')) {
      val.queryOperateType = '';
      console.error("\u67E5\u8BE2\u6A21\u677F\u4E2D\u5FC5\u987B\u8981\u6709queryOperateType\u5B57\u6BB5\uFF0C\u8BF7\u68C0\u67E5\u6A21\u677F\u4E2D".concat(val.attrcode, "\u5B57\u6BB5"));
    } //增加去除前后空格的逻辑 目前 ‘ ’作为例外情况处理


    if (data.firstvalue && typeof data.firstvalue === 'string' && data.firstvalue !== ' ') {
      data.firstvalue = data.firstvalue.trim();
    }

    if (data.secondvalue && typeof data.firstvalue === 'string' && data.secondvalue !== ' ') {
      data.secondvalue = data.secondvalue.trim();
    }

    var Obj = {
      field: attrcode,
      value: data,
      oprtype: optSign,
      display: String(displayVal || '').replace(/~/, ','),
      isIncludeSub: isIncludeSub,
      refurl: refurl,
      datatype: val.datatype || '',
      timeFunction: timeFunction,
      def5: val.label
    };

    if (val.itemtype === 'residtxt') {
      Obj.langSeq = VALUE.index;
    }

    if (!Object(index_["isEmpty"])(Obj.value.firstvalue) || !Object(index_["isEmpty"])(Obj.value.secondvalue) || optSign == 'is null' || optSign == 'is not null') {
      snapshot[i].visible && callBackMeta.push(Obj);
    }
  };

  for (var i = 0; i < snapshot.length; i++) {
    var _ret = _loop(i);

    if (_ret === "continue") continue;
    if (methods_typeof(_ret) === "object") return _ret.v;
  }

  if (requiredArr.length !== 0) {
    {
      Object(index_["toast"])({
        content: methods_multiLang['page-search-0045'],
        color: 'warning'
      });
    }
    index_["PubSub"].publish('searchRequired', requiredArr);
    return false;
  }

  return {
    logic: logic,
    conditions: callBackMeta
  };
}
/*设置查询区数据*/

function setSearchValueEve(id, data, cb) {
  var _searchInfo$currentPl2, _searchInfo$currentPl3;

  var searchInfo = this.state.searchInfo; // let snapshot = searchInfo.snapshotMap[searchInfo.status];

  var snapshot = (searchInfo === null || searchInfo === void 0 ? void 0 : (_searchInfo$currentPl2 = searchInfo.currentPlan) === null || _searchInfo$currentPl2 === void 0 ? void 0 : _searchInfo$currentPl2.renderobj4web_snap) || searchInfo.snapshotMap[searchInfo.status];
  var items = snapshot;
  var datas = data;

  if (datas.conditions) {
    datas = datas.conditions;
  }

  if (!Object(index_["isArray"])(datas)) {
    console.error('setSearchValue方法第二个参数不正确');
    return false;
  }

  var findItem = function findItem(item) {
    var len = items.length;

    while (len--) {
      if (items[len].attrcode === item.field) {
        items[len].initialvalue = items[len].initialvalue || {};

        if (item.oprtype === 'between') {
          items[len].initialvalue.value = [item.value.firstvalue, item.value.secondvalue]; //items[len].initialvalue.display = [item.value.firstvalue, item.value.secondvalue];
        } else {
          items[len].initialvalue.value = item.value.firstvalue;
          items[len].initialvalue.display = item.display;
        } //下面的逻辑是为了处理 反写日期函数时转为具体时间的bug


        if (item.timeFunction) {
          if (item.timeFunction.includes(',')) {
            items[len].initialvalue.value = item.timeFunction.split(',');
          } else {
            items[len].initialvalue.value = item.timeFunction;
            items[len].initialvalue.display = '';
          }
        }

        items[len].operationSign = item.oprtype;
        items[len].runWithChildren = item.isIncludeSub || false;
        items[len].refurl = item.refurl || '';
        break;
      }
    }
  };

  datas.map(function (item) {
    findItem(item);
  });

  if (searchInfo !== null && searchInfo !== void 0 && (_searchInfo$currentPl3 = searchInfo.currentPlan) !== null && _searchInfo$currentPl3 !== void 0 && _searchInfo$currentPl3.renderobj4web_snap) {
    searchInfo.snapshotMap[searchInfo.status] = searchInfo.currentPlan.renderobj4web_snap;
  }

  this.setState({
    searchInfo: searchInfo
  }, function () {
    typeof cb === 'function' && cb();
  });
}
/* 清空查询区 */


function clearSearchAreaEve(moduleId) {
  var searchInfo = this.state.searchInfo;
  var data = searchInfo.snapshotMap[searchInfo.status];
  var len = data.length;

  while (len--) {
    if (data[len].initialvalue.index !== undefined) {
      data[len].initialvalue = {
        value: '',
        display: '',
        index: data[len].initialvalue.index
      };
      var valMap = data[len].valueMap;

      if (valMap) {
        for (var key in valMap) {
          var current = valMap.current;
          var index = valMap.index;
          valMap[key] = {
            current: current,
            index: index,
            value: ''
          };
        }
      }
    } else {
      data[len].initialvalue = {
        value: '',
        display: ''
      };
    }
  }

  this.setState({
    searchInfo: searchInfo
  });
}
/* 设置某个字段是否可用 */


function setDisabledByFieldEve(moduleId, field, status) {
  var meta = this._this.meta.getMeta() || {};
  var data = meta[moduleId].items;
  var len = data.length;

  while (len--) {
    var item = data[len];

    if (item.attrcode === field) {
      item.disabled = status;
      break;
    }
  }

  this._this.meta.setMeta(meta);
}
/* 设置某个字段是否必填*/


function setRequiredByFieldEve(moduleId, field, status) {
  var meta = this._this.meta.getMeta() || {};
  var data = meta[moduleId].items;
  var len = data.length;

  while (len--) {
    var item = data[len];

    if (item.attrcode === field) {
      item.required = !!status;
      break;
    }
  }

  this._this.meta.setMeta(meta);
}

function _setTemlateByField(moduleId, field, property, value) {
  var meta = this._this.meta.getMeta() || {};
  var data = meta[moduleId].items;
  var len = data.length;

  while (len--) {
    var item = data[len];

    if (item.attrcode === field) {
      item[property] = value;
      break;
    }
  }

  this._this.meta.setMeta(meta);
}

function getOprtypeByFieldEve(moduleId, field) {
  var searchInfo = this.state.searchInfo;
  var data = searchInfo.snapshotMap[searchInfo.status];

  function getValue(list) {
    var result = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
    list.forEach(function (item) {
      if (item.children) {
        getValue(item.children, result);
      } else {
        if (item.attrcode === field) {
          result.push(item.operationSign);
        }
      }
    });
    return result;
  }

  return getValue(data);
}
/*=======================================以下为输出方法=============================*/

/*
*	因为查询区有3种展示状态，所以需要根据当前状态判断业务组操作的是在哪种状态下进行的。
*
*	@ 规则：
*	1、当高级面板展开 或者 展示查询方案时,取高级面板中的 普通或高级中的数据
*	2、当高级面板收起 并且 不展示查询方案时，取外面简单查询区的值
*
*	@ 状态：
*	高级面板显影性：  			searchInfo.showAdvModal   ( true/false )
*	高级面板当前是普通或高级：  searchInfo.advSearchStatus	（normal/super）
*
* */

/* 获取查询区所有数据 */


function getAllSearchData(moduleId) {
  var flag = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  if (!_this) return null;
  var searchInfo = _this.state.searchInfo;
  var snapshot = searchInfo.snapshotMap[searchInfo.status];
  return getAllSearchDataEve.call(_this, moduleId, snapshot, flag);
}
function getQueryInfo(moduleId) {
  var flag = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

  // let _this = this.myState.search[`searchArea_${moduleId}`];
  if (Object(index_["isEmpty"])(this.state.meta[moduleId])) {
    // toast({ content: multiLang['page-search-0046'], color: 'warning' });
    return {};
  } else {
    var data = getAllSearchData.call(this, moduleId, flag);

    if (data) {
      return {
        queryAreaCode: moduleId,
        oid: this.state.meta[moduleId].oid,
        querytype: 'tree',
        querycondition: data,
        nctz: getTimezoneOffset()
      };
    } else {
      return {};
    }
  }
}
/* 设置查询区具体某个字段数据 */

function setSearchValByField(moduleId, field, data, status) {
  var f = checkModuleId.call(this, moduleId);

  if (!f) {
    return;
  }

  var statusList = ['simple', 'plan', 'normal', 'super'];

  if (status && !statusList.some(function (item) {
    return item === status;
  })) {
    status = '';
  }

  var _this = this.myState.search["searchArea_".concat(moduleId)];
  setSearchValByFieldEve.call(_this, moduleId, field, data, status);
}
/* 设置查询区数据 */

function setSearchValue(moduleId, data, cb) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  setSearchValueEve.call(_this, moduleId, data, cb);
}
/*
*	获取表格某个字段的数据
* */

function getSearchValByField(moduleId, field, status) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var statusList = ['simple', 'plan', 'normal', 'super'];

  if (status && !statusList.some(function (item) {
    return item === status;
  })) {
    status = '';
  }

  var _this = this.myState.search["searchArea_".concat(moduleId)];
  return getValueByField.call(_this, moduleId, field, status);
}
/*
* 	设置某个查询条件是否可用
* 	@ field：控件的attrcode
*  	@ status: true可用；false不可用
* */

function setDisabledByField(moduleId, field, status) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  setDisabledByFieldEve.call(_this, moduleId, field, status);
}
/* 关闭查询方案区域 ，内部使用*/

function closeSearchPlanArea(moduleId) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  _this.state.searchInfo.status = 'simple';

  _this.setState({
    searchInfo: _this.state.searchInfo
  });
}
/* 打开/关闭 高级查询面板 */

function openAdvSearch(moduleId, status, callback) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return; //this.state.meta[moduleId].showAdvModal = status;

  var _this = this.myState.search["searchArea_".concat(moduleId)];

  if (status) {
    _this.state.searchAdvBtnClick(_this.state.searchInfo);
  }

  _this.setState({
    searchInfo: _this.state.searchInfo
  }, callback);
}
/* 设置查询区不可编辑 */

function methods_setDisabled(moduleId, status) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var data = this.state.meta[moduleId].items;
  var len = data.length;

  while (len--) {
    var item = data[len];
    item.disabled = status;
  }

  this.setState({
    meta: this.state.meta
  });
}
/* 清空查询区方法 */

function clearSearchArea(moduleId) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  clearSearchAreaEve.call(_this, moduleId);
}
/* 获取查询条件的操作符 */

function getOprtypeByField(moduleId, field) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  return getOprtypeByFieldEve.call(_this, moduleId, field);
}
/* 修改条件可见性 */

function changeItemVisibleByField(moduleId, field) {
  var _status = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  var searchInfo = _this.state.searchInfo;
  var isDefaultPlan = searchInfo.isDefaultPlan,
      snapshotMap = searchInfo.snapshotMap,
      status = searchInfo.status;
  var items = this.state.meta[moduleId].items;

  if (isDefaultPlan) {
    var context = _this.props.context;
    items.find(function (item) {
      return item.attrcode === field;
    }).visible = _status;
    Object.keys(snapshotMap).forEach(function (key) {
      if (status == key) {
        var snapshot = snapshotMap[key];

        if (key == 'super') {
          snapshotMap[key] = _addData.call(_this, items, 'super');
        } else {
          snapshotMap[key] = snapshotChangeByTemplate(snapshot, items, context);
        }
      }
    });
  } else {
    if (_status) {
      var ITEM = items.find(function (item) {
        return item.attrcode === field;
      });
      var obj = {
        key: field,
        attrcode: field,
        initialvalue: {
          display: "",
          value: ""
        },
        isExtend: false,
        isfixedcondition: false,
        label: ITEM.label,
        operationOptions: ITEM.queryOperateType.split('@'),
        operationSign: ITEM.queryOperateType.split('@')[0],
        remove: true,
        visible: true
      };
      snapshotMap[status].push(obj);
    } else {
      snapshotMap[status] = snapshotMap[status].filter(function (item) {
        return item.attrcode != field;
      });
    }
  }

  _this.setState({
    searchInfo: searchInfo
  });
}
/*修改查询模板必输性 */

function setRequiredByField(moduleId, field, status) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];
  setRequiredByFieldEve.call(_this, moduleId, field, status);
}
/*修改查询模板属性 */

function setTemlateByField(moduleId, field, property, value) {
  var f = checkModuleId.call(this, moduleId);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(moduleId)];

  _setTemlateByField.call(_this, moduleId, field, property, value);
}
function _addData(_items, status, callback, isTemplateOrder) {
  var searchInfo = this.state.searchInfo;
  var advancedData = searchInfo.snapshotMap[status];
  var targetPk = searchInfo.targetKey;
  var result = [];

  if (status === 'normal') {
    targetPk = null;
  }

  if (Object(index_["isArray"])(_items)) {
    //数组，代表初始化区域
    var items = _items.filter(function (item, index) {
      if (!(Number(item.visibleposition) > 0)) {
        item.visibleposition = 99999 + index;
      }

      return (item.visible || item.isfixedcondition) && item.isdrag;
    });

    var requireList = [];
    var fiexedList = [];
    var otherList = [];
    items.forEach(function (item, index) {
      if (!(Number(item.visibleposition) > 0)) {
        item.visibleposition = 99999 + index;
      }

      if (item.isfixedcondition) {
        fiexedList.push(item);
      } else if (item.required) {
        requireList.push(item);
      } else {
        otherList.push(item);
      }
    });
    fiexedList.sort(function (v1, v2) {
      return Number(v1.visibleposition) - Number(v2.visibleposition);
    });

    if (isTemplateOrder) {
      var notFixed = requireList.concat(otherList).sort(function (v1, v2) {
        return Number(v1.visibleposition) - Number(v2.visibleposition);
      });
      items = fiexedList.concat(notFixed);
    } else {
      requireList.sort(function (v1, v2) {
        return Number(v1.visibleposition) - Number(v2.visibleposition);
      });
      otherList.sort(function (v1, v2) {
        return Number(v1.visibleposition) - Number(v2.visibleposition);
      });
      items = fiexedList.concat(requireList).concat(otherList);
    } // fiexedList.sort((v1, v2) => Number(v1.visibleposition) - Number(v2.visibleposition));
    // requireList.sort((v1, v2) => Number(v1.visibleposition) - Number(v2.visibleposition));
    // otherList.sort((v1, v2) => Number(v1.visibleposition) - Number(v2.visibleposition));
    // items = fiexedList.concat(requireList).concat(otherList);


    var data = items.map(function (item) {
      var remove = item.required != true && item.isfixedcondition != true;

      if (searchInfo.snapshotCache && searchInfo.snapshotCache[searchInfo.status] && searchInfo.snapshotCache[searchInfo.status][item.attrcode]) {
        item.initialvalue = searchInfo.snapshotCache[searchInfo.status][item.attrcode];
      }

      return initData(item, remove);
    });

    if (status === 'normal') {
      // 普通区域
      searchInfo.snapshotMap[status] = data;
    } else if (data.length > 0 && data[0].refpk !== 'root') {
      //高级区域
      // 如果新增的数据是数组，并且是高级区域,外层没有根节点时，需要在外层添加一个逻辑运算符根节点，且不可移除。
      searchInfo.snapshotMap[status] = [{
        attrcode: 'root',
        refpk: 'root',
        key: 'root',
        operationSign: 'and',
        noRemove: true,
        //不可移除
        children: data,
        visible: true
      }];
    }

    Object(index_["isFunction"])(callback) && callback(status);
    result = searchInfo.snapshotMap[status];
  } else if (Object(index_["isObj"])(_items)) {
    // 对象代表拖拽添加元素
    //if (_items.isfixedcondition) return;
    var _data = initData(_items, true);

    _data.isExtend = false;

    if (!advancedData.length) {
      // 数据为空，拖拽到高级区域时需要初始化数据
      if (status === 'normal') {
        searchInfo.snapshotMap[status] = [_data];
      } else {
        // 如果新增的数据是数组，并且是高级区域,外层没有根节点时，需要在外层添加一个逻辑运算符根节点，且不可移除。
        searchInfo.snapshotMap[status] = [{
          attrcode: 'root',
          refpk: 'root',
          operationSign: 'and',
          noRemove: true,
          //不可移除
          children: [_data],
          visible: true
        }];
      }

      result = searchInfo.snapshotMap[status];
    } else {
      if (status === 'super' && searchInfo.targetKey) {
        var tempItem = searchInfo.itemsMap[searchInfo.targetKey]; // let targSnopItem  = 

        if (tempItem) {
          if (tempItem.visible && searchInfo.targetIsExtend) {
            Object(index_["toast"])({
              content: methods_multiLang['page-search-0091'],
              color: 'warning'
            });
            return null;
          } else if (tempItem.visible && tempItem.required) {
            Object(index_["toast"])({
              content: methods_multiLang['page-search-0058'],
              color: 'warning'
            });
            return null;
          }
        }
      }

      addDataEve.call(this, advancedData, _data, targetPk, status);
    }
  }

  methods_setStateEve.call(this);
  return result;
}
function _getAllSearchData(id, searchInfo, flag) {
  var snapshot = searchInfo.snapshotMap[searchInfo.status]; //searchInfo.currentData = JSON.parse(JSON.stringify(snapshot));

  searchInfo.currentData = createCurrentData.call(this, id, snapshot, flag);

  if (searchInfo.currentData === false) {
    return false;
  }

  checkResult(searchInfo.currentData);
  checkConditions(searchInfo.currentData);

  if (Object(index_["isArray"])(searchInfo.currentData) && !searchInfo.currentData.length) {
    return null;
  }

  if (searchInfo.status === 'normal' || searchInfo.status === 'plan') {
    return {
      logic: 'and',
      conditions: searchInfo.currentData
    };
  } else {
    return searchInfo.currentData[0];
  }
}
/* 设置searchPlanName */

function setSearchPlanName(id, name) {
  var f = checkTreeId.call(this, id);
  if (!f) return;
  var searchInfo = this.state.meta[id];
  searchInfo.searchPlanName = name;
  methods_setStateEve.call(this);
}
/* setState */

function methods_setStateEve() {
  this.setState({
    searchAdv: this.state.searchAdv
  });
}
/* 检查组件id是否存在 */


function checkTreeId(treeId) {
  if (!this.state.meta.hasOwnProperty(treeId)) {
    console.error('没有找到高级查询组件的id,请检查传参是否正确');
    return false;
  } else {
    return true;
  }
}
/* 初始化数据 */


function initData(item) {
  var remove = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var snapshotItem = {
    attrcode: item.attrcode,
    remove: remove,
    visible: true,
    isExtend: !!item.isfixedcondition
  };

  if (item.queryOperateType) {
    // 查询条件，设置操作符，初始化数据
    snapshotItem.operationSign = item.queryOperateType.split('@')[0];
    snapshotItem.refpk = snapshotItem.key = item.attrcode;

    if (snapshotItem.operationSign === 'between') {
      //似乎 between是 不设置默认值的  xuyang 此处得问问
      if (item.itemtype === 'refer') {
        snapshotItem.initialvalue = item.initialvalue || {
          value: [],
          display: []
        };
      } else {
        snapshotItem.initialvalue = item.initialvalue || {
          value: [],
          display: ''
        };
      }
    } else {
      if (item.itemtype === 'checkbox_switch') {
        snapshotItem.initialvalue = {
          value: item.initialvalue && item.initialvalue.value || false,
          display: ''
        };
      } else {
        snapshotItem.initialvalue = item.initialvalue || {
          value: '',
          display: ''
        };

        if (item.itemtype === 'residtxt') {
          var _item$languageMeta$fi;

          snapshotItem.initialvalue.index = ((_item$languageMeta$fi = item.languageMeta.filter(function (val) {
            return val.languageCode == index_["localeLang"];
          })[0]) === null || _item$languageMeta$fi === void 0 ? void 0 : _item$languageMeta$fi.index) || 1;
          snapshotItem.valueMap = {};
          snapshotItem.valueMap[snapshotItem.attrcode + snapshotItem.initialvalue.index] = {
            value: snapshotItem.initialvalue.value
          };
        }
      }
    }

    snapshotItem.operationOptions = methods_createOperation(item.queryOperateType);
  } else {
    //逻辑关系，默认‘并且’
    snapshotItem.operationOptions = methods_createOperation('=');
    snapshotItem.operationSign = '=';
    snapshotItem.initialvalue = item.initialvalue || {
      value: '',
      display: ''
    };
  }

  return snapshotItem;
}
/* 生成查询数据 */


function createCurrentData(id, snapshot, flag) {
  var _this3 = this;

  var searchInfo = this.state.searchInfo;
  var allRequire = checkRequired.call(this, id, snapshot, flag);
  if (!allRequire) return false;else {
    return snapshot.map(function (snapshotItem) {
      if (Array.isArray(snapshotItem.children)) {
        return {
          logic: snapshotItem.operationSign,
          conditions: createCurrentData.call(_this3, id, snapshotItem.children)
        };
      } else {
        var attrcode = snapshotItem.attrcode;
        var item = searchInfo.itemsMap[attrcode];
        var data = {
          firstvalue: null,
          secondvalue: null
        };
        var initialvalue = snapshotItem.initialvalue || {};
        var displayVal = initialvalue.display || null;
        var optSign = snapshotItem.operationSign;
        var isIncludeSub = snapshotItem.runWithChildren || false;
        var refurl = snapshotItem.refurl || '';
        var timeFunction = '';

        if (displayVal && snapshotItem.runWithChildren) {
          displayVal = displayVal + methods_multiLang['page-search-0044'];
        }

        if (item.itemtype === 'rangepicker' || (item.itemtype === 'datepicker' || item.itemtype === 'NCTZDatePickerEnd' || item.itemtype === 'NCTZDatePickerStart' || item.itemtype === 'datetimepicker') && snapshotItem.operationSign === 'between') {
          var vals = initialvalue.value;

          if (vals && !Object(index_["isArray"])(vals) && typeof vals === 'string') {
            vals = vals.split(',');
          } //给报表平台加的逻辑，如果是函数，则将函数直接传给后台


          if (isDateFunction(vals[0])) {
            timeFunction = vals.join(',');
          }

          if (vals && Object(index_["isArray"])(vals)) {
            if (vals.length > 0 && vals[0] && vals[0].format) {
              // 多时区转化
              var start = vals[0].format('YYYY-MM-DD');
              var end = vals[1].format('YYYY-MM-DD'); // 1 开始时间

              var currentZoneStartTime = Object(index_["moment"])(start).startOf('day').toDate();
              var currentZoneStartHours = currentZoneStartTime.getHours();
              var offsetZone = currentZoneStartTime.getTimezoneOffset() / 60; // 2 结束时间

              var currentZoneEndTime = Object(index_["moment"])(end).endOf('day').toDate();
              var currentZoneEndHours = currentZoneEndTime.getHours(); // 当地时间转换为东八区时间

              offsetZone = offsetZone + 8;
              currentZoneStartTime.setHours(currentZoneStartHours + offsetZone);
              currentZoneEndTime.setHours(currentZoneEndHours + offsetZone); //   newData.firstvalue = moment(currentZoneStartTime).format('YYYY-MM-DD HH:mm:ss');
              //   newData.secondvalue = moment(currentZoneEndTime).format('YYYY-MM-DD HH:mm:ss');

              data.firstvalue = Object(index_["moment"])(currentZoneStartTime).format('YYYY-MM-DD HH:mm:ss');
              data.secondvalue = Object(index_["moment"])(currentZoneEndTime).format('YYYY-MM-DD HH:mm:ss'); // newVal.push(value.format('YYYY-MM-DD'));
            } else if (vals.length > 0 && vals[0] && !vals[0].format) {
              data.firstvalue = vals[0];
              data.secondvalue = vals[1];
            } else {
              data.firstvalue = '';
              data.secondvalue = '';
            }
          }
        } else if (item.itemtype === 'refer') {
          if (snapshotItem.operationSign === 'between') {
            displayVal = (initialvalue.display || []).join(',');
            data.firstvalue = initialvalue.value[0];
            data.secondvalue = initialvalue.value[1];
          } else {
            var VALUE = getFunctionValueFromViewModal(initialvalue, _this3.props.context);
            displayVal = VALUE.display;
            data.firstvalue = VALUE.value;
          }
        } else if ((item.itemtype === 'select' || item.itemtype === 'number' || item.itemtype === 'datetimepicker' || item.itemtype === 'NCTZDatePickerEnd' || item.itemtype === 'NCTZDatePickerStart') && snapshotItem.operationSign === 'between') {
          data.firstvalue = (initialvalue.value || [])[0];
          data.secondvalue = (initialvalue.value || [])[1];
          displayVal = (initialvalue.display || [])[0] + '~' + (initialvalue.display || [])[1];
        } else {
          data.firstvalue = initialvalue.value;
        }

        var timeItemList = ['datepicker', 'datetimepicker', 'rangepicker', 'NCTZDatePickerStart', 'NCTZDatePickerEnd', 'NCTZDatePickClientTime', 'NCTZDatePickClientHourTime', 'NCTZDatePickerRangeDay', 'datePickerNoTimeZone']; // 需要从东八区时间处理当地时间，然后计算0点和24点，按照当地时间得0点和24点分别转为东八区时间

        var localToEast = ['datepicker', 'datetimepicker', 'NCTZDatePickClientTime', 'NCTZDatePickClientHourTime']; // 开始 和结束时间是时间戳概念  操作符为 = 时不需要进行扩充为日期范围

        var timeStampType = ['NCTZDatePickerStart', 'NCTZDatePickerEnd', 'datetimepicker'];

        if (timeItemList.some(function (val) {
          return val === item.itemtype;
        }) && !Object(index_["isEmpty"])(initialvalue.value)) {
          //xuyangt 需要优化此处逻辑 很混乱
          var firstvalue = '',
              secondvalue = '';

          if (isDateFunction(data.firstvalue) && !data.secondvalue) {
            timeFunction = data.firstvalue;
          }

          if (isDateFunction(data.firstvalue) || isDateFunction(data.secondvalue)) {
            if (optSign == '=' || optSign == '<>') {
              // start 取开始时间戳 end时 取结束时间戳
              if (timeStampType.includes(item.itemtype)) {
                if (item.itemtype === 'NCTZDatePickerEnd') {
                  firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue, {
                    flag: false
                  });
                } else {
                  firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
                }
              } else {
                firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
                secondvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue, {
                  flag: false
                });
              }
            } else if (optSign == '<' || optSign == '>=') {
              firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
            } else if (optSign == '>' || optSign == '<=') {
              firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue, {
                flag: false
              });
            } else if (optSign == 'between') {
              if (!Object(index_["isEmpty"])(data.firstvalue)) {
                firstvalue = Object(index_["timeFunctionTranslater"])(data.firstvalue);
              }

              if (!Object(index_["isEmpty"])(data.secondvalue)) {
                secondvalue = Object(index_["timeFunctionTranslater"])(data.secondvalue, {
                  flag: false
                });
              }
            }
          } else {
            if (optSign == '=' || optSign == '<>') {
              if (!timeStampType.includes(item.itemtype)) {
                // datepicker datepicker 需要处理时区从东八区时间转换为当地时间 计算当天时间[00:00:00, 23:59:59]在转换为东八区时间
                if (localToEast.includes(item.itemtype) && !isDateFunction(data.firstvalue)) {
                  firstvalue = Object(index_["DongbaToLocalTime"])(Object(index_["moment"])(data.firstvalue)).format('YYYY-MM-DD 00:00:00');
                  secondvalue = Object(index_["moment"])(firstvalue).format('YYYY-MM-DD 23:59:59'); // 转为东八区时间 

                  firstvalue = Object(index_["LocalToDongbaTime"])(Object(index_["moment"])(firstvalue)).format('YYYY-MM-DD HH:mm:ss');
                  secondvalue = Object(index_["LocalToDongbaTime"])(Object(index_["moment"])(secondvalue)).format('YYYY-MM-DD HH:mm:ss');
                } else {
                  // start end 类型暂未处理
                  firstvalue = Object(index_["moment"])(data.firstvalue).format('YYYY-MM-DD 00:00:00');
                  secondvalue = Object(index_["timeFunctionTranslater"])(Object(index_["moment"])(data.firstvalue).format('YYYY-MM-DD 23:59:59'));
                }
              } else {
                firstvalue = data.firstvalue;
                secondvalue = firstvalue;
              }
            } else if (optSign == '<' || optSign == '>=') {
              firstvalue = naturalTimeHandler(data.firstvalue, 'start');
            } else if (optSign == '>' || optSign == '<=') {
              firstvalue = naturalTimeHandler(data.firstvalue, 'end');
            } else if (optSign == 'between') {
              if (!Object(index_["isEmpty"])(data.firstvalue)) {
                firstvalue = naturalTimeHandler(data.firstvalue, 'start');
              }

              if (!Object(index_["isEmpty"])(data.secondvalue)) {
                secondvalue = naturalTimeHandler(data.secondvalue, 'end');
              }
            }

            if (firstvalue && secondvalue && CompareDate(firstvalue, secondvalue)) {
              firstvalue = Object(index_["timeFunctionTranslater"])(secondvalue);
              secondvalue = Object(index_["timeFunctionTranslater"])(firstvalue, {
                flag: false
              });
            }
          }

          if (optSign == '=') {
            optSign = 'between';
          }

          data.firstvalue = firstvalue;
          data.secondvalue = secondvalue;
        } //增加去除前后空格的逻辑 目前 ‘ ’作为例外情况处理


        if (data.firstvalue && typeof data.firstvalue === 'string' && data.firstvalue !== ' ') {
          data.firstvalue = data.firstvalue.trim();
        }

        if (data.secondvalue && typeof data.firstvalue === 'string' && data.secondvalue !== ' ') {
          data.secondvalue = data.secondvalue.trim();
        }

        var Obj = {
          field: attrcode,
          value: data,
          oprtype: optSign,
          display: String(displayVal || '').replace(/~/, ','),
          isIncludeSub: isIncludeSub,
          refurl: refurl,
          datatype: item.datatype || '',
          timeFunction: timeFunction,
          def5: item.label
        };

        if (item.itemtype === 'residtxt') {
          Obj.langSeq = initialvalue.index;
        }

        if (!Object(index_["isEmpty"])(Obj.value.firstvalue) || !Object(index_["isEmpty"])(Obj.value.secondvalue) || optSign == 'is null' || optSign == 'is not null') {
          return snapshotItem.visible ? Obj : null;
        } else {
          return null;
        }
      }
    });
  }
} //校验必填


function checkRequired(id, snapshot, flag) {
  var _this4 = this;

  var result = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
  var searchInfo = this.state.searchInfo;
  snapshot.forEach(function (item) {
    if (item.children) {
      result = checkRequired.call(_this4, id, item.children, flag, result);
    } else {
      var templateItem = searchInfo.itemsMap[item.attrcode];
      var initialvalue = templateItem.itemtype === 'refer' ? getFunctionValueFromViewModal(item.initialvalue, _this4.props.context) : item.initialvalue;

      if (templateItem && templateItem.required && flag && result && item.visible) {
        var isKong = false; // 因为 为空或者不为空的条件不可编辑 
        //但是后台需要校验，所以这两种类型的条件可以没有值就传给后台
        //所以必填校验也不用做了

        if (Object(index_["isEmpty"])(initialvalue.value) || Array.isArray(initialvalue.value) && !ArrayHas2Value(initialvalue.value)) {
          if (item.operationSign != 'is null' && item.operationSign != 'is not null') {
            isKong = true;
          }
        }

        if (isKong) {
          {
            Object(index_["toast"])({
              content: methods_multiLang['page-search-0045'],
              color: 'warning'
            });
          }
          result = false;
        }
      }
    }
  });
  return result;
}
/*
*   添加拖拽数据
*   @data: 要添加的数据
*   @targetPk: 拖拽的目标节点pk
*   @flag: 高级/普通  （super/normal）
*
* */


function addDataEve(treeData, data, targetPk, flag) {
  if (typeof targetPk === 'string' && targetPk !== 'root') {
    //有目标节点pk，并且不是根节点时
    var len = treeData.length;

    while (len--) {
      var item = treeData[len]; // 目标节点如果是逻辑符节点，添加到逻辑符节点的children内

      if (targetPk.split('@')[1] === 'root') {
        if (item.refpk === targetPk) {
          if (Array.isArray(item.children)) {
            var newTime = new Date().getTime();
            data.refpk = newTime + data.refpk; // !item.children.find(v => v.attrcode === data.attrcode) &&

            item.children.push(data);
          } else {
            item.children = [data];
          }

          return true;
        }
      } else {
        // 目标节点是查询条件节点时， 创建一个逻辑符根节点 ，节点的子节点为拖拽的节点和目标节点，并删除原目标节点
        if (item.refpk === targetPk && data.refpk !== item.refpk) {
          //必填字段不能合并？ xuyang
          if (item.advrequired) {
            return;
          } // 生成新节点，拖拽节点和目标节点的refpk都需要重新赋值，以免重复


          var _newTime = new Date().getTime();

          var newPk = _newTime + '@' + 'root';
          item.refpk = _newTime + item.refpk;
          data.refpk = _newTime + data.refpk;
          var newTree = {
            attrcode: newPk,
            refpk: newPk,
            operationSign: 'and',
            children: [item, data],
            visible: true
          }; //删除原节点 把新的节点插入到原有结构队尾
          // treeData.splice(len, 1);
          // treeData.push(newTree);
          //替换源节点

          treeData[len] = newTree;
          return true;
        }
      }

      if (Array.isArray(item.children)) {
        var res = addDataEve.call(this, item.children, data, targetPk);

        if (res) {
          return false;
        }
      }
    }
  } else {
    if (flag === 'super') {
      //高级区域需要加入到根节点的children中

      /* 疑问：逻辑符为并且时，是否可以在同一级中拖拽多个相同的查询条件？？？——wangshhj */
      // !treeData[0].children.find(item => item.refpk === data.refpk) &&
      var _newTime2 = new Date().getTime();

      data.refpk = _newTime2 + data.refpk;
      treeData[0].children.push(data);
    } else {
      //普通区域直接放到数组中
      //暂时去掉 普通查询中不能拖入重复条件的限制
      //!treeData.find((item) => item.refpk === data.refpk) && treeData.push(data);
      treeData.push(data);
    }
  }
}
/* 检测返回的数据，去掉null */


function checkResult(data) {
  if (!data.length) {
    return null;
  }

  data.map(function (item, index) {
    if (!item || item.value && Object(index_["isArray"])(item.value.firstvalue) && !item.value.firstvalue.length) {
      data.splice(index, 1);
      checkResult(data);
    } else if (Array.isArray(item.conditions)) {
      checkResult(item.conditions);
    }
  });
}
/* 检测数据的conditions是否有值，没有值，删除数据 */


function checkConditions(treeData) {
  var len = treeData.length;

  while (len--) {
    var item = treeData[len];

    if (Array.isArray(item.conditions) && item.conditions.length) {
      checkConditions(item.conditions);
    } else if (Array.isArray(item.conditions) && !item.conditions.length) {
      treeData.splice(len, 1);
    }
  }

  if (treeData.length && Array.isArray(treeData[0].conditions) && !treeData[0].conditions.length) {
    checkConditions(treeData);
  }
}
/* 处理运算符 */


function methods_createOperation(data) {
  data = data || '';
  data = data.replace(/^@+|@$/g, '');
  var o = data.split('@');
  var newArr = [];
  o.forEach(function (item) {
    for (var i = 0; i < methods_OperationOptions.length; i++) {
      if (item === methods_OperationOptions[i].value) {
        newArr.push(methods_OperationOptions[i]);
        break;
      }
    }
  });
  return newArr;
}
/* 清空当前所有数据 */

function clearAllValueEve(treeData) {
  var _this5 = this;

  var len = treeData.length;
  var itemsMap = this.state.searchInfo.itemsMap;

  var _loop2 = function _loop2() {
    var item = treeData[len];

    if (item.children && Array.isArray(item.children)) {
      clearAllValueEve.call(_this5, item.children);
    } else {
      var tempItem = itemsMap[item.attrcode];

      if (!tempItem.disabled) {
        if (tempItem.itemtype === 'residtxt') {
          item.initialvalue.value = '';
          item.initialvalue.display = '';

          if (item.valueMap) {
            Object.keys(item.valueMap).forEach(function (key) {
              item.valueMap[key].value = '';
            });
          }
        } else {
          item.initialvalue = {
            value: '',
            display: ''
          };
        }
      }
    }
  };

  while (len--) {
    _loop2();
  }
}
/*
*  删除节点
*  @ nodePk:删除的节点refpk
* */

function delNode(id, nodePk) {
  var f = checkTreeId.call(this, id);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(id)];
  var searchInfo = _this.state.searchInfo;
  var status = searchInfo.status;
  var snapshot = searchInfo.snapshotMap[status];
  delNodeEve(snapshot, nodePk);
  checkChildren(snapshot);
  methods_setStateEve.call(_this);
}
/* 检测节点的children是否有值，没有值，删除该节点 */

function checkChildren(treeData) {
  var len = treeData.length;

  while (len--) {
    var item = treeData[len];

    if (Array.isArray(item.children) && !item.children.length) {
      treeData.splice(len, 1);
    } else if (Array.isArray(item.children)) {
      checkChildren(item.children);
    }
  }
}
/* 删除节点事件 */


function delNodeEve(treeData, nodePk) {
  var len = treeData.length;

  while (len--) {
    var item = treeData[len];

    if (item.refpk === nodePk) {
      treeData.splice(len, 1);
      return true;
    } else if (Array.isArray(item.children)) {
      var res = delNodeEve(item.children, nodePk);

      if (res) {
        return false;
      }
    }
  }
}
/*
*   设置查询区具体某个字段数据   ps:内部使用字段的refpk设值， 业务组使用field设值
*   @ field: 字段
*   @ data: { value, display }
*   @ operationSign: 操作符
* */


function setSearchValByFieldHigh(searchId, refpk, data, operationSign) {
  // 业务组调用的
  var _this = this.myState.search["searchArea_".concat(searchId)];
  var searchInfo = _this.state.searchInfo;
  var snapshot = searchInfo.snapshotMap[searchInfo.status];
  setValueByField(snapshot, refpk, data, operationSign);
  methods_setStateEve.call(_this);
}
/* 根据attrcode设置某个查询条件的值 */

function setValueByField(treeData, field, value, operationSign) {
  var len = treeData.length;

  while (len--) {
    var item = treeData[len];

    if (item.attrcode === field) {
      //此处防止循环引用，导致保存方案报错
      if (item.attrcode.indexOf('@root') === -1) {
        item.initialvalue = value;
      }

      if (operationSign) {
        item.operationSign = operationSign;
      }
    } else if (Array.isArray(item.children)) {
      setValueByField(item.children, field, value, operationSign);
    }
  }
}
/* 获取当前普通区或高级区域的state，用于保存查询方案 */


function getCurrentTemplate(id) {
  var searchInfo = this.state.searchInfo;
  return searchInfo.snapshotMap[searchInfo.status].map(function (item) {
    return searchInfo.itemsMap[item.attrcode];
  });
}
/* 清空所有数据 */

function clearAllValue(id) {
  var f = checkTreeId.call(this, id);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(id)];
  var searchInfo = _this.state.searchInfo;
  var snapshot = searchInfo.snapshotMap[searchInfo.status];
  clearAllValueEve.call(_this, snapshot);
  methods_setStateEve.call(_this);
}
/* 整体替换数据，用于查询方案。数据结构完整，不需要初始化 */

function replaceData(id, data, planName) {
  var f = checkTreeId.call(this, id);
  if (!f) return;
  var _this = this.myState.search["searchArea_".concat(id)];
  var searchInfo = _this.state.searchInfo;
  var status = searchInfo.status;
  var plan = plan2snapshotTranslate(searchInfo, data, this.app_context, methods_createOperation);
  searchInfo.snapshotMap[status] = plan;
  searchInfo.searchPlanName = planName;
  methods_setStateEve.call(_this);
}
// CONCATENATED MODULE: ./src/platform/components/CreateSearch/templateEngine.js
function templateEngine_extends() { templateEngine_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return templateEngine_extends.apply(this, arguments); }

function templateEngine_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function templateEngine_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { templateEngine_ownKeys(Object(source), true).forEach(function (key) { templateEngine_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { templateEngine_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function templateEngine_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function templateEngine_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { templateEngine_typeof = function _typeof(obj) { return typeof obj; }; } else { templateEngine_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return templateEngine_typeof(obj); }

function templateEngine_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function templateEngine_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function templateEngine_createClass(Constructor, protoProps, staticProps) { if (protoProps) templateEngine_defineProperties(Constructor.prototype, protoProps); if (staticProps) templateEngine_defineProperties(Constructor, staticProps); return Constructor; }

// import DatePicker from 'bee-datepicker';

 // import { PubSub } from '@platform/api';

var ReferLoader = base_index_["Refer"].ReferLoader; // import toast from '../../api/toast';


 // import ReferLoader from '../../containers/Refer/ReferLoader';
// import { localeLang } from '../../public/currentLocale';
// import getSysFieldid from '../../api/getSysFieldid';

__webpack_require__(928);

var Option = base_index_["Select"].Option;

var templateEngine_templateEngine = /*#__PURE__*/function () {
  function templateEngine(_ref) {
    var id = _ref.id,
        searchInfo = _ref.searchInfo,
        snapshotItem = _ref.snapshotItem,
        onAfterEvent = _ref.onAfterEvent,
        setStateEve = _ref.setStateEve,
        renderItem = _ref.renderItem,
        _ref$showRequire = _ref.showRequire,
        showRequire = _ref$showRequire === void 0 ? true : _ref$showRequire,
        _ref$context = _ref.context,
        context = _ref$context === void 0 ? {} : _ref$context,
        createScript = _ref.createScript,
        _ref$showPlaceholder = _ref.showPlaceholder,
        showPlaceholder = _ref$showPlaceholder === void 0 ? true : _ref$showPlaceholder,
        multiLang = _ref.multiLang,
        LangData = _ref.LangData,
        parentRef = _ref.parentRef,
        clickSearch = _ref.clickSearch,
        hiddenFunList = _ref.hiddenFunList;

    templateEngine_classCallCheck(this, templateEngine);

    this.templetItem = searchInfo.itemsMap[snapshotItem.attrcode];
    var businessInfo = Object(index_["getBusinessInfo"])();
    this.Date = businessInfo ? Object(index_["moment"])(businessInfo.businessDate).format('YYYY-MM-DD') : Object(index_["moment"])().format('YYYY-MM-DD'); // this.Date = '2020-10-20';

    if (!this.templetItem) {
      //toast({ content: '查询方案损坏！', color: 'warning' });
      return null;
    }

    if (searchInfo.status == 'super' || searchInfo.status == 'normal') this.hideLabel = true;else this.hideLabel = false;
    Object.assign(this, {
      id: id,
      searchInfo: searchInfo,
      snapshotItem: snapshotItem,
      onAfterEvent: onAfterEvent,
      setStateEve: setStateEve,
      renderItem: renderItem,
      showRequire: showRequire,
      context: context,
      createScript: createScript,
      showPlaceholder: showPlaceholder,
      multiLang: multiLang,
      LangData: LangData,
      parentRef: parentRef,
      clickSearch: clickSearch,
      hiddenFunList: hiddenFunList
    });
    return this.createTemplateItemDom();
  } //  事件触发清除警告 通过全局的事件订阅发布 绕开了徐洋之前的逻辑(类组件内部状态处理有问题)
  //  采用全局事件订阅发布的方式 可能存在问题 待处理


  templateEngine_createClass(templateEngine, [{
    key: "clearRquiredWraning",
    value: function clearRquiredWraning(item) {
      if (item && item.required) {
        index_["PubSub"].publish('clearWarning', item.attrcode);
      }
    }
  }, {
    key: "trustString",
    value: function trustString(data) {
      if (typeof data === 'string') {
        return Object(index_["formatNumber"])(data, true);
      } else if (Array.isArray(data)) {
        return data.filter(function (item) {
          return item;
        }).map(function (item) {
          return Object(index_["formatNumber"])(item, true);
        }).join('~');
      }
    }
  }, {
    key: "isTrueEmpty",
    value: function isTrueEmpty(data) {
      if (Object(index_["isEmpty"])(data)) return true;else if (Array.isArray(data)) {
        return data.filter(function (item) {
          return item;
        }).length === 0;
      }
    } //获得查询条件的操作符的展示

  }, {
    key: "getQueryOperateDisplay",
    value: function getQueryOperateDisplay(queryOperateType) {
      var result = '';

      if (queryOperateType) {
        queryOperateType = queryOperateType.replace(/^@+|@$/g, '');
        var opt = String(queryOperateType).split('@')[0];

        switch (opt) {
          case '<>':
            result = '≠';
            break;

          case '<':
            result = '<';
            break;

          case '>':
            result = '>';
            break;

          case '>=':
            result = '≥';
            break;

          case '<=':
            result = '≤';
            break;
        }
      }

      return result;
    } //getDateDisplay

  }, {
    key: "getDateDisplay",
    value: function getDateDisplay(value) {
      if (isNaN(Date.parse(value))) {
        return value;
      } else {
        var format = 'YYYY-MM-DD';
        return Object(index_["moment"])(value).format(format);
      }
    }
  }, {
    key: "timeFunCallBack",
    value: function timeFunCallBack(data, timeValue) {
      if (data && timeValue) {
        data.initialvalue = {
          display: timeValue.label,
          value: timeValue.value
        };
      }

      this.setStateEve();
    }
    /* 编辑后事件 */

  }, {
    key: "onAfterEve",
    value: function onAfterEve(field, val, index, eventType) {
      if (index == undefined) {
        index = 0;
      }

      if (Object(index_["isFunction"])(this.onAfterEvent)) {
        // code value modleID operationSign betweenIndex
        this.onAfterEvent(field, val, this.id, this.snapshotItem.operationSign, index, eventType);
      }
    } //input输入改变,更新state

  }, {
    key: "onInputChange",
    value: function onInputChange(item, val) {
      this.clearRquiredWraning(item);
      this.snapshotItem.initialvalue.value = val;
      this.snapshotItem.initialvalue.display = val; //xuyangt 2018/11/20添加

      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, val, 0, 'onchange'));
    }
    /* input失去焦点事件 */

  }, {
    key: "inputBlur",
    value: function inputBlur(item, type, val) {
      if (type === 'number') this.snapshotItem.initialvalue.value = val;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, val, 0, 'onblur'));
    } //select改变，更新state

  }, {
    key: "onSelectedChange",
    value: function onSelectedChange(item, val) {
      this.clearRquiredWraning(item);

      if (val === '__clear__' || val === undefined) {
        // 清空
        this.snapshotItem.initialvalue = {
          value: '',
          display: ''
        };
      } else {
        this.snapshotItem.initialvalue = {
          value: val,
          display: item.options.find(function (i) {
            return i.value == val;
          }).display
        };
      }

      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, val === '__clear__' ? undefined : val));
    }
  }, {
    key: "onSelectedBetweenChange",
    value: function onSelectedBetweenChange(item, i, val) {
      this.clearRquiredWraning(item);
      var data = this.snapshotItem;
      data.initialvalue.display = data.initialvalue.display || [];
      data.initialvalue.value = data.initialvalue.value || [];
      data.initialvalue.display[i] = item.options.find(function (i) {
        return i.value == val;
      }).display;
      data.initialvalue.value[i] = val;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, data.initialvalue.value));
    }
    /* select多选 */

  }, {
    key: "onMultipleChange",
    value: function onMultipleChange(item) {
      var val = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
      this.clearRquiredWraning(item);
      var opt = item.options;
      var valuelist = opt.filter(function (vv) {
        return val.some(function (v) {
          return vv.value == v;
        });
      });
      this.snapshotItem.initialvalue = {
        display: valuelist.map(function (vv) {
          return vv.display;
        }).join(','),
        value: valuelist.map(function (vv) {
          return vv.value;
        }).join(',')
      };
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, this.snapshotItem.initialvalue.value));
    }
  }, {
    key: "onDateSelect",
    value: function onDateSelect(data) {} //日期选择事件

  }, {
    key: "onDateChange",
    value: function onDateChange(item, date, display) {
      this.clearRquiredWraning(item);
      if (typeof date === 'string' || !date) this.snapshotItem.initialvalue.value = date;else if (templateEngine_typeof(date) === 'object') {
        if (Array.isArray(date)) {
          this.snapshotItem.initialvalue.value = date;
        } else {
          this.snapshotItem.initialvalue.value = date.value;
        }
      }
      this.snapshotItem.initialvalue.display = display;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, date));
    }
  }, {
    key: "onDateTimeBetweenChange",
    value: function onDateTimeBetweenChange(item, i, value, display) {
      this.clearRquiredWraning(item);
      var data = this.snapshotItem;
      var oldDisplay = data.initialvalue.display || '';
      data.initialvalue.value = data.initialvalue.value || []; //判断是否initialvalue是数组

      if (!Array.isArray(data.initialvalue.value)) {
        data.initialvalue.value = data.initialvalue.value.split(',');
      } // 判断display 是否为数组


      if (!Array.isArray(data.initialvalue.display)) {
        data.initialvalue.display = Array.from(2);
        data.initialvalue.value.map(function (item, index) {
          if (item) {
            data.initialvalue.display[index] = oldDisplay.split(',')[index];
          }
        });
      }

      data.initialvalue.display[i] = display;
      data.initialvalue.value[i] = value;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, data.initialvalue));
    } //区间类型日期事件

  }, {
    key: "onRangDateChange",
    value: function onRangDateChange(item, date, display) {
      this.clearRquiredWraning(item);
      this.snapshotItem.initialvalue.value = date || '';
      this.snapshotItem.initialvalue.display = Array.isArray(display) && display.join(',') || '';
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, this.snapshotItem.initialvalue));
    } //参照更改事件

  }, {
    key: "referChangeEve",
    value: function referChangeEve(item, val, foolValue) {
      var _this = this;

      this.clearRquiredWraning(item);
      this.snapshotItem.initialvalue = templateEngine_objectSpread(templateEngine_objectSpread({}, foolValue), val);

      if (Array.isArray(val)) {
        val.forEach(function (vv) {
          var VALUE = getFunctionValueFromViewModal({
            display: vv.refname,
            value: vv.refpk
          }, _this.context);
          vv.refname = VALUE.display;
          vv.refpk = VALUE.value;
          _this.snapshotItem.runWithChildren = vv.runWithChildren;
          _this.snapshotItem.refurl = vv.queryTreeUrl;
        }, this);
      } else {
        var VALUE = getFunctionValueFromViewModal({
          display: val.refname,
          value: val.refpk
        }, this.context);
        val.refname = VALUE.display;
        val.refpk = VALUE.value;
      }

      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, val));
    }
  }, {
    key: "betweenReferChangeEve",
    value: function betweenReferChangeEve(i, item, value, foolValue) {
      var _this2 = this;

      this.clearRquiredWraning(item);
      var data = this.snapshotItem;
      data.initialvalue.display = data.initialvalue.display || [];
      data.initialvalue.value = data.initialvalue.value || [];
      data.initialvalue.display[i] = foolValue.display;
      data.initialvalue.value[i] = foolValue.value;
      data.runWithChildren = value.runWithChildren;

      if (Array.isArray(value)) {
        value.forEach(function (vv) {
          var VALUE = getFunctionValueFromViewModal({
            display: vv.refname,
            value: vv.refpk
          }, _this2.context);
          vv.refname = VALUE.display;
          vv.refpk = VALUE.value;
          _this2.snapshotItem.runWithChildren = vv.runWithChildren;
          _this2.snapshotItem.refurl = vv.queryTreeUrl;
        }, this);
      }

      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, value, i));
    } //单选change事件

  }, {
    key: "radioChange",
    value: function radioChange(item, val) {
      this.clearRquiredWraning(item);
      this.snapshotItem.initialvalue.value = val;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, val));
    } // checkbox_switch 事件

  }, {
    key: "onChangeCheckbox_switch",
    value: function onChangeCheckbox_switch(item, e) {
      this.clearRquiredWraning(item);
      if (item.disabled) return;
      e.stopPropagation();
      var value = !this.snapshotItem.initialvalue.value;
      this.snapshotItem.initialvalue.value = value;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, value));
    } //开关事件

  }, {
    key: "switchChange",
    value: function switchChange(item) {
      this.clearRquiredWraning(item);
      var value = !this.snapshotItem.initialvalue.value;
      this.snapshotItem.initialvalue.value = value;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, value));
    } // 数字类型事件

  }, {
    key: "changeNumber",
    value: function changeNumber(item, data) {
      this.clearRquiredWraning(item);
      this.snapshotItem.initialvalue.value = data;
      this.snapshotItem.initialvalue.display = data;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, this.snapshotItem.initialvalue.value));
    } //对最大值和最小值进行合法性校验

  }, {
    key: "checkNumberHandler",
    value: function checkNumberHandler(data) {
      var result = true;
      var propList = ['min', 'max']; // propList.forEach((item) => {
      // 	if (data.hasOwnProperty(item)) {
      // 		if (typeof data[item] !== 'string' && typeof data[item] !== 'number') {
      // 			result = false;
      // 			console.error(item + '类型错误');
      // 		}
      // 	}
      // });

      if (propList.every(function (item) {
        return data.hasOwnProperty(item);
      })) {
        if (data.max < data.min) {
          result = false;
          console.error('错误：最小值大于最大值');
        }
      }

      return result;
    }
  }, {
    key: "onMultiLangTextChange",
    value: function onMultiLangTextChange(item, data) {
      this.clearRquiredWraning(item);
      var value = '';
      /*  Object.keys(data).forEach(key => {
           if (data[key].index == this.snapshotItem.initialvalue.index) {
               this.snapshotItem.initialvalue = {
                   value: data[key].value,
                   display: data[key].value,
                   index: data[key].index,
               };
               value = data[key].value;
           }
       }); */
      // xiquanquan

      for (var key in data) {
        if (data.hasOwnProperty(key)) {
          data[key].index = data[key].index || '1';

          if (data[key].index == this.snapshotItem.initialvalue.index) {
            this.snapshotItem.initialvalue = {
              value: data[key].value,
              display: data[key].value,
              index: data[key].index
            };
            value = data[key].value;
            break;
          }
        }
      }

      this.snapshotItem.valueMap = data;
      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, value));
    }
  }, {
    key: "onMultiLangTextSelect",
    value: function onMultiLangTextSelect(item, value, index) {
      this.clearRquiredWraning(item);
      this.snapshotItem.initialvalue = {
        value: value,
        index: index,
        display: value
      };

      if (!this.snapshotItem.valueMap) {
        this.snapshotItem.valueMap = {};
        this.snapshotItem.valueMap[this.snapshotItem.attrcode + index] = {
          value: value
        };
      }

      this.setStateEve(this.onAfterEve.bind(this, item.attrcode, value));
    }
  }, {
    key: "createTemplateItemDom",
    value: function createTemplateItemDom() {
      var _this3 = this;

      var id = this.id,
          snapshotItem = this.snapshotItem,
          templetItem = this.templetItem,
          renderItem = this.renderItem,
          multiLang = this.multiLang,
          LangData = this.LangData,
          hiddenFunList = this.hiddenFunList;
      var that = this;
      var data = templetItem;
      var disabledOperationSign = ['is null', 'is not null'];

      if (disabledOperationSign.some(function (item) {
        return item === snapshotItem.operationSign;
      })) {
        var disabled = true;
      } else {
        var disabled = data.disabled;
      }

      var val;
      var initialvalue = snapshotItem.initialvalue;
      var type = data.itemtype || {};
      var hiddenfunlist = hiddenFunList[snapshotItem.attrcode] || [];

      if (snapshotItem.hasOwnProperty('operationSign') && (type === 'datepicker' || type === 'NCTZDatePickerEnd' || type === 'NCTZDatePickerStart')) {
        if (snapshotItem.operationSign === 'between') {
          type = 'rangepicker';
        }
      } else if (type === 'textarea') {
        type = 'input';
      } else if (type === 'radio' || type === 'checkbox') {
        type = 'select';
      }

      if (type === 'select') {
        //多选 val为 数组['1','4']； 单选val为字符串 ’1‘
        if (data.isMultiSelectedEnabled) {
          val = initialvalue.value ? String(initialvalue.value).split(',') : [];
          initialvalue.display = [];

          if (templetItem.options) {
            val.forEach(function (v) {
              var _templetItem$options$;

              initialvalue.display.push(((_templetItem$options$ = templetItem.options.find(function (o) {
                return o.value == v;
              })) === null || _templetItem$options$ === void 0 ? void 0 : _templetItem$options$.display) || '');
            });
          }

          initialvalue.display = initialvalue.display.join(',');
        } else {
          if (snapshotItem.operationSign === 'between') {
            if (Array.isArray(initialvalue.value)) {
              val = initialvalue.value;
            } else {
              val = [];
            }
          } else {
            val = String(initialvalue.value) || '';
          }
        }
      } else if (type === 'checkbox') {
        val = initialvalue.value ? String(initialvalue.value).split(',') : '';
      } else if (type === 'checkbox_switch') {
        val = initialvalue.value || false;
      } else if (type === 'datepicker') {
        typeof initialvalue.value === 'string' ? val = initialvalue.value : val = '';
      } else if (type === 'rangepicker' || (type === 'datetimepicker' || type === 'NCTZDatePickerEnd' || type === 'NCTZDatePickerStart') && snapshotItem.operationSign === 'between') {
        if (Array.isArray(initialvalue.value)) {
          val = initialvalue.value;
        } else if (initialvalue.value) {
          val = initialvalue.value.split(',');
        } else {
          val = [];
        }
      } else {
        val = (initialvalue || {}).value || (initialvalue || {}).display;
      }

      if ((type === 'datepicker' || type === 'NCTZDatePickerEnd' || type === 'NCTZDatePickerStart') && snapshotItem.operationSign === '=') {
        if (Array.isArray(initialvalue.value)) {
          val = initialvalue.value[0];
        }
      } //  必输项标识


      var mustFillIn1 = null;
      var mustFillIn2 = null;

      if (data.required && this.showRequire) {
        mustFillIn1 = /*#__PURE__*/React.createElement("span", {
          className: "mustFillIn_search1"
        }, "*");
      }

      var betweenType = ['refer', 'select', 'datetimepicker', 'number'];

      if (data.required && this.showRequire && snapshotItem.operationSign === 'between' && betweenType.includes(type)) {
        mustFillIn2 = /*#__PURE__*/React.createElement("span", {
          className: "mustFillIn_search2"
        }, "*");
      }

      var searchChildDom = null; // 查询条件的tip值

      var fieldTip = '';
      var timeValue = '';
      var optText = that.getQueryOperateDisplay(data.queryOperateType);
      data.placeholder = this.showPlaceholder ? data.label + optText : '';

      if (!data.hasOwnProperty('maxlength')) {
        data.maxlength = Infinity;
      }

      switch (type) {
        case 'refer':
          var refData = initialvalue,
              referDom = null;

          if (renderItem[data.attrcode]) {
            referDom = renderItem[data.attrcode];
          }

          var refDisplay = ''; // else if (data.refcode) {
          // 	this.createScript(that.searchInfo.moduletype, id, data.attrcode, data.refcode);
          // }

          if (snapshotItem.hasOwnProperty('operationSign') && snapshotItem.operationSign === 'between') {
            var VALUE = [];
            VALUE = (refData.value || []).map(function (v, index) {
              var vv = {
                value: v,
                display: refData.display ? refData.display[index] : ''
              };
              return getFunctionValueFromViewModal(vv, _this3.context);
            });
            refDisplay = VALUE.map(function (v) {
              return v.display;
            }).join('~');
            var vv = {
              value: '',
              display: ''
            };

            if (referDom) {
              referDom = templateEngine_objectSpread(templateEngine_objectSpread({}, referDom), {}, {
                props: templateEngine_objectSpread(templateEngine_objectSpread(templateEngine_objectSpread({}, referDom.props), data), {}, {
                  placeholder: data.placeholder,
                  foolValue: templateEngine_objectSpread(templateEngine_objectSpread({}, initialvalue), Object(index_["isEmpty"])(VALUE) ? vv : VALUE[0]),
                  onChange: that.betweenReferChangeEve.bind(that, '0', data),
                  showTitle: false
                })
              });
            }

            searchChildDom = /*#__PURE__*/React.createElement("div", {
              className: "between-refer",
              fieldid: Object(index_["getSysFieldid"])(data.attrcode)
            }, /*#__PURE__*/React.createElement("div", {
              className: "startRefer between-refer-item"
            }, referDom || /*#__PURE__*/React.createElement(ReferLoader, templateEngine_extends({}, data, {
              placeholder: data.placeholder,
              foolValue: templateEngine_objectSpread(templateEngine_objectSpread({}, initialvalue), Object(index_["isEmpty"])(VALUE[0]) ? vv : VALUE[0]),
              onChange: that.betweenReferChangeEve.bind(that, '0', data),
              showTitle: false
            }))), /*#__PURE__*/React.createElement("div", {
              className: "between-refer-line"
            }, "-", mustFillIn2), /*#__PURE__*/React.createElement("div", {
              className: "endRefer between-refer-item"
            }, referDom || /*#__PURE__*/React.createElement(ReferLoader, templateEngine_extends({}, data, {
              placeholder: data.placeholder,
              foolValue: templateEngine_objectSpread(templateEngine_objectSpread({}, initialvalue), Object(index_["isEmpty"])(VALUE[1]) ? vv : VALUE[1]),
              onChange: that.betweenReferChangeEve.bind(that, '1', data),
              showTitle: false
            }))));
          } else {
            if (Array.isArray(refData.value)) {
              refData = {
                value: refData.value[0],
                display: refData.display[0]
              };
            }

            var _VALUE = getFunctionValueFromViewModal(refData, this.context);

            refDisplay = _VALUE.display;

            if (referDom) {
              referDom = templateEngine_objectSpread(templateEngine_objectSpread({}, referDom), {}, {
                props: templateEngine_objectSpread(templateEngine_objectSpread(templateEngine_objectSpread({}, referDom.props), data), {}, {
                  placeholder: data.placeholder,
                  foolValue: templateEngine_objectSpread(templateEngine_objectSpread({}, initialvalue), _VALUE),
                  onChange: that.referChangeEve.bind(that, data),
                  showTitle: false
                })
              });
            }

            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, referDom || /*#__PURE__*/React.createElement(ReferLoader, templateEngine_extends({}, data, {
              placeholder: data.placeholder,
              foolValue: templateEngine_objectSpread(templateEngine_objectSpread({}, initialvalue), _VALUE),
              onChange: that.referChangeEve.bind(that, data),
              showTitle: false
            })));
          }

          fieldTip = refDisplay && data.label ? data.label + ':' + refDisplay : '';
          break;

        case 'input':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["Input"], templateEngine_defineProperty({
            disabled: !!disabled,
            value: val,
            isCheckChinese: !!data.maxlength,
            maxlength: data.maxlength,
            onBlur: that.inputBlur.bind(that, data),
            placeholder: data.placeholder,
            onChange: that.onInputChange.bind(that, data)
          }, "maxlength", data.maxlength)));
          fieldTip = val && data.label ? data.label + ':' + val : '';
          break;

        case 'select':
          if (val === '') {
            val = undefined;
          }

          if (data.isMultiSelectedEnabled) {
            //多选暂时这样，UE还没有出，后续再改
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["Select"], {
              disabled: !!disabled,
              className: "multiple-select",
              multiple: true,
              getPopupContainer: function getPopupContainer() {
                return _this3.parentRef || document.body;
              },
              style: {
                marginRight: 6
              },
              placeholder: data.placeholder,
              value: val,
              onChange: that.onMultipleChange.bind(that, data),
              fieldid: data.attrcode,
              supportSearch: data.supportSearch
            }, data.options && data.options.map(function (val, index) {
              return /*#__PURE__*/React.createElement(Option, {
                key: index,
                value: String(val.value)
              }, val.display);
            })));
          } else {
            if (snapshotItem.hasOwnProperty('operationSign') && snapshotItem.operationSign === 'between') {
              searchChildDom = /*#__PURE__*/React.createElement("span", {
                className: "search-dom"
              }, /*#__PURE__*/React.createElement(base_index_["SelectBetween"], {
                disabled: !!disabled,
                showSearch: true,
                style: {
                  marginRight: 6
                },
                placeholder: data.placeholder,
                value: val,
                mustFill: mustFillIn2,
                optionFilterProp: "children",
                onChange: that.onSelectedBetweenChange.bind(that, data),
                fieldid: data.attrcode,
                options: data.options
              }));
            } else {
              searchChildDom = /*#__PURE__*/React.createElement("span", {
                className: "search-dom"
              }, /*#__PURE__*/React.createElement(base_index_["Select"], {
                disabled: !!disabled,
                showSearch: true,
                showClear: !data.required,
                getPopupContainer: function getPopupContainer(trigger) {
                  var node = trigger.parentNode.parentNode;
                  return node || document.body;
                },
                style: {
                  marginRight: 6
                },
                placeholder: data.placeholder,
                value: val,
                optionFilterProp: "children",
                onChange: that.onSelectedChange.bind(that, data),
                fieldid: data.attrcode,
                supportSearch: data.supportSearch
              }, data.options && data.options.map(function (val, index) {
                return /*#__PURE__*/React.createElement(Option, {
                  key: index,
                  value: String(val.value)
                }, val.display);
              })));
            }
          }

          var tips = initialvalue.display;

          if (initialvalue && initialvalue.value === 'Y') {
            tips = multiLang['page-search-0089'];
          } else if (initialvalue && initialvalue.value === 'N') {
            tips = multiLang['page-search-0090'];
          }

          fieldTip = !Object(index_["isEmpty"])(val) && data.label ? data.label + ':' + tips : '';
          break;

        case 'datepicker':
          var format = 'YYYY-MM-DD';
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["DatePickerClient"], {
            panelValue: this.Date,
            arrowKeyDownEnable: true,
            fieldid: data.attrcode,
            disabled: !!disabled //format={format}
            ,
            onSelect: that.onDateSelect,
            onChange: that.onDateChange.bind(that, data) // locale={zhCN}
            ,
            value: val,
            placeholder: data.placeholder,
            operationSign: snapshotItem.operationSign //timeFunCallBack = {timeFunCallBack.bind(that,data)}
            ,
            showTimeFunction: true,
            hiddenFunList: hiddenfunlist,
            multiLang: multiLang,
            LangData: LangData,
            showClear: true
          }));
          timeValue = initialvalue.display;
          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(timeValue, 'date') : '';
          break;

        case 'datetimepicker':
          if (snapshotItem.hasOwnProperty('operationSign') && snapshotItem.operationSign === 'between') {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["DateTimePickerBetween"], {
              panelValue: this.Date,
              arrowKeyDownEnable: true,
              fieldid: data.attrcode,
              disabled: !!disabled,
              className: "search",
              mustFill: mustFillIn2 //format="YYYY-MM-DD HH:mm:ss"
              ,
              onSelect: that.onDateSelect,
              onChange: that.onDateTimeBetweenChange.bind(that, data) // locale={zhCN}
              ,
              value: val,
              placeholder: data.placeholder,
              showTimeFunction: true,
              hiddenFunList: hiddenfunlist,
              showClear: true
            }));

            if (this.isTrueEmpty(initialvalue.display)) {
              timeValue = '';
            } else {
              timeValue = Array.isArray(initialvalue.display) ? "".concat(Object(index_["formatDatetime"])(initialvalue.display[0], 'datetime') || '', "~").concat(Object(index_["formatDatetime"])(initialvalue.display[1], 'datetime') || '') : Object(index_["formatDatetime"])(initialvalue.display, 'datetime');
            }
          } else {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["TZDatePickClientTime"], {
              panelValue: this.Date,
              arrowKeyDownEnable: true,
              fieldid: data.attrcode,
              disabled: !!disabled //format="YYYY-MM-DD HH:mm:ss"
              ,
              onSelect: that.onDateSelect,
              onChange: that.onDateChange.bind(that, data) // locale={zhCN}
              ,
              value: val,
              placeholder: data.placeholder //timeFunCallBack = {timeFunCallBack.bind(that,data)}
              ,
              showTimeFunction: true,
              hiddenFunList: hiddenfunlist
            }));
            timeValue = initialvalue.display;
            timeValue = Object(index_["formatDatetime"])(timeValue, 'datetime');
          } // console.log('datetimepicker----datetimepicker', timeValue);
          //此处有问题，时间函数类型的日期时间型的 val是 函数值，不能拿来做tips 需要一次准换


          fieldTip = !Object(index_["isEmpty"])(val) && data.label ? data.label + ':' + timeValue : '';
          break;

        case 'timepicker':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["Timepicker"], {
            fieldid: data.attrcode,
            arrowKeyDownEnable: true,
            disabled: !!disabled,
            format: "HH:mm:ss",
            onSelect: that.onDateSelect,
            onChange: that.onDateChange.bind(that, data) // locale={zhCN}
            ,
            value: val,
            placeholder: data.placeholder //timeFunCallBack = {timeFunCallBack.bind(that,data)}
            ,
            showTimeFunction: true,
            hiddenFunList: hiddenfunlist,
            onEnter: this.clickSearch
          }));
          timeValue = initialvalue.value;
          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(timeValue, 'time') : '';
          break;

        case 'rangepicker':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["RangePickerClient"], {
            panelValues: this.Date,
            fieldid: data.attrcode,
            arrowKeyDownEnable: true,
            disabled: !!disabled //format={Rangformat}
            ,
            onSelect: that.onDateSelect,
            onChange: that.onRangDateChange.bind(that, data),
            value: Object(index_["isEmpty"])(val) ? '' : val,
            showClear: true,
            placeholder: data.placeholder || ' ',
            dateInputPlaceholder: [multiLang['page-search-0039'] + '(YYYY-MM-DD)', multiLang['page-search-0040'] + '(YYYY-MM-DD)'],
            showTimeFunction: true,
            hiddenFunList: hiddenfunlist,
            multiLang: multiLang,
            LangData: LangData,
            onEnter: this.clickSearch
          }));
          var displayArray = [];

          if (Array.isArray(initialvalue.display)) {
            displayArray = initialvalue.display;
          } else if (initialvalue.display) {
            if (initialvalue.display.includes(',')) {
              displayArray = (initialvalue.display || '').split(',');
            } else {
              displayArray = (initialvalue.display || '').split('~');
            }
          }

          timeValue = [];

          for (var i = 0; i < val.length; i++) {
            if (val[i]) {
              if (val[i].indexOf('#') !== -1) {
                timeValue.push(displayArray[i]);
              } else {
                timeValue.push(Object(index_["formatDatetime"])(this.getDateDisplay(displayArray[i]), 'date'));
              }
            }
          }

          timeValue = timeValue.join('~');
          fieldTip = !Object(index_["isEmpty"])(timeValue) && data.label ? data.label + ':' + timeValue : '';
          break;

        case 'datePickerNoTimeZone':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["DatePicker"], {
            panelValue: this.Date,
            fieldid: data.attrcode,
            arrowKeyDownEnable: true,
            disabled: !!disabled //format="YYYY-MM-DD"
            ,
            onSelect: that.onDateSelect,
            onChange: that.onDateChange.bind(that, data) // locale={zhCN}
            ,
            value: val,
            placeholder: data.placeholder //timeFunCallBack = {timeFunCallBack.bind(that,data)}
            ,
            showTimeFunction: true,
            hiddenFunList: hiddenfunlist,
            showTime: false,
            onEnter: this.clickSearch,
            showClear: true
          })); // timeValue = moment(val).format(format);

          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(val, 'date') : '';
          break;

        case 'NCTZDatePickerStart':
          if (snapshotItem.hasOwnProperty('operationSign') && snapshotItem.operationSign === 'between') {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["TZDatePickerStartBetween"], {
              panelValue: this.Date,
              arrowKeyDownEnable: true,
              fieldid: data.attrcode,
              disabled: !!disabled //format="YYYY-MM-DD HH:mm:ss"
              ,
              onSelect: that.onDateSelect,
              onChange: that.onDateTimeBetweenChange.bind(that, data) // locale={zhCN}
              ,
              value: val,
              placeholder: data.placeholder,
              showTimeFunction: true,
              hiddenFunList: hiddenfunlist,
              showTime: false,
              showToday: false,
              onEnter: this.clickSearch,
              showClear: true
            }));

            if (this.isTrueEmpty(initialvalue.display)) {
              timeValue = '';
            } else {
              timeValue = Array.isArray(initialvalue.display) ? "".concat(Object(index_["formatDatetime"])(initialvalue.display[0], 'date') || '', "~").concat(Object(index_["formatDatetime"])(initialvalue.display[1], 'date') || '') : Object(index_["formatDatetime"])(initialvalue.display, 'date');
            }
          } else {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["TZDatePickerStart"], {
              panelValue: this.Date,
              arrowKeyDownEnable: true,
              fieldid: data.attrcode,
              disabled: !!disabled //format={data.format || 'YYYY-MM-DD HH:mm:ss'}
              ,
              placeholder: data.placeholder,
              value: val,
              onSelect: that.onDateSelect,
              onChange: that.onDateChange.bind(that, data),
              showTimeFunction: true,
              hiddenFunList: hiddenfunlist,
              showToday: false,
              showTime: false,
              onEnter: this.clickSearch,
              showClear: true
            }));
            timeValue = initialvalue.display ? initialvalue.display.split(' ')[0] : '';
          }

          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(timeValue, 'date') : '';
          break;

        case 'NCTZDatePickerRangeDay':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["TZDatePickerRangeDay"], {
            panelValue: this.Date,
            arrowKeyDownEnable: true,
            fieldid: data.attrcode,
            disabled: !!disabled //format={data.format || 'YYYY-MM-DD HH:mm:ss'}
            ,
            placeholder: data.placeholder,
            value: val,
            onSelect: that.onDateSelect,
            onChange: that.onRangDateChange.bind(that, data),
            onEnter: this.clickSearch,
            hiddenFunList: hiddenfunlist
          }));
          break;

        case 'NCTZDatePickClientHourTime':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["TZDatePickClientHourTime"], {
            panelValue: this.Date,
            arrowKeyDownEnable: true,
            fieldid: data.attrcode,
            disabled: !!disabled //format={data.format || 'YYYY-MM-DD HH:mm:ss'}
            ,
            placeholder: data.placeholder || '',
            value: val,
            onSelect: that.onDateSelect,
            onChange: that.onDateChange.bind(that, data),
            onEnter: this.clickSearch,
            hiddenFunList: hiddenfunlist
          }));
          timeValue = initialvalue.display;
          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(timeValue, 'date') : '';
          break;

        case 'NCTZDatePickClientTime':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["TZDatePickClientTime"], {
            panelValue: this.Date,
            arrowKeyDownEnable: true,
            fieldid: data.attrcode,
            disabled: !!disabled //format={data.format || 'YYYY-MM-DD HH:mm:ss'}
            ,
            placeholder: data.placeholder || '',
            value: val,
            onSelect: that.onDateSelect,
            onChange: that.onDateChange.bind(that, data),
            onEnter: this.clickSearch,
            hiddenFunList: hiddenfunlist
          }));
          timeValue = initialvalue.display;
          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(timeValue, 'datetime') : '';
          break;

        case 'NCTZDatePickerEnd':
          if (snapshotItem.hasOwnProperty('operationSign') && snapshotItem.operationSign === 'between') {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["TZDatePickerEndBetween"], {
              panelValue: this.Date,
              arrowKeyDownEnable: true,
              fieldid: data.attrcode,
              disabled: !!disabled //format="YYYY-MM-DD HH:mm:ss"
              ,
              onSelect: that.onDateSelect,
              onChange: that.onDateTimeBetweenChange.bind(that, data) // locale={zhCN}
              ,
              value: val,
              placeholder: data.placeholder,
              showTimeFunction: true,
              hiddenFunList: hiddenfunlist,
              showTime: false,
              showToday: false,
              onEnter: this.clickSearch,
              showClear: true
            }));

            if (this.isTrueEmpty(initialvalue.display)) {
              timeValue = '';
            } else {
              timeValue = Array.isArray(initialvalue.display) ? "".concat(Object(index_["formatDatetime"])(initialvalue.display[0], 'date') || '', "~").concat(Object(index_["formatDatetime"])(initialvalue.display[1], 'date') || '') : Object(index_["formatDatetime"])(initialvalue.display, 'date');
            }
          } else {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["TZDatePickerEnd"], {
              panelValue: this.Date,
              arrowKeyDownEnable: true,
              fieldid: data.attrcode,
              disabled: !!disabled //format={data.format || 'YYYY-MM-DD HH:mm:ss'}
              ,
              placeholder: data.placeholder || '',
              value: val,
              onSelect: that.onDateSelect,
              onChange: that.onDateChange.bind(that, data),
              showTimeFunction: true,
              hiddenFunList: hiddenfunlist,
              showTime: false,
              showToday: false,
              onEnter: this.clickSearch,
              showClear: true
            }));
            timeValue = initialvalue.display ? initialvalue.display.split(' ')[0] : '';
          }

          fieldTip = val && data.label ? data.label + ':' + Object(index_["formatDatetime"])(timeValue, 'date') : '';
          break;

        case 'radio':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["Select"], {
            disabled: !!disabled,
            showSearch: true,
            style: {
              marginRight: 6
            },
            placeholder: data.placeholder,
            value: val,
            optionFilterProp: "children",
            onChange: that.onSelectedChange.bind(that, data),
            fieldid: data.attrcode
          }, data.options && data.options.map(function (val, index) {
            return /*#__PURE__*/React.createElement(Option, {
              key: index,
              value: String(val.value)
            }, val.display);
          }))); // searchChildDom = (
          // 	<span>
          // 		<span className="radioName">{data.label?data.label+':':''}&nbsp;</span>
          // 		<NCRadio.NCRadioGroup
          // 			name={data.label}
          // 			selectedValue={String(val)}
          // 			onChange={radioChange.bind(that, data)}
          // 		>
          // 			{data.options.map((val, index) => {
          // 				return (
          // 					<NCRadio disabled={!!disabled} key={index} value={String(val.value)}>
          // 						{val.display}
          // 					</NCRadio>
          // 				);
          // 			})}
          // 		</NCRadio.NCRadioGroup>
          // 	</span>
          // );

          break;

        case 'number':
          var dataScale = (data.initialvalue || {}).scale;
          var scale = !Object(index_["isEmpty"])(dataScale) && dataScale != '-1' ? dataScale : data.scale;

          if (snapshotItem.hasOwnProperty('operationSign') && snapshotItem.operationSign === 'between') {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["BetweenNum"], {
              disabled: !!disabled,
              onChange: that.changeNumber.bind(that, data),
              onBlur: that.inputBlur.bind(that, data, 'number'),
              scale: Number(scale),
              mustFill: mustFillIn2,
              max: that.checkNumberHandler(data) ? data.max : null,
              min: that.checkNumberHandler(data) ? data.min : null,
              maxlength: Number(data.maxlength),
              placeholder: data.placeholder,
              defaultPlaceholder: data.defaultPlaceholder || {
                start: data.label + multiLang['page-search-0078'],
                end: data.label + multiLang['page-search-0079']
              } // start={{
              // 	placeholder: '起始'
              // }}
              // end={{
              // 	placeholder: '结束'
              // }}
              ,
              value: val || []
            }));
          } else {
            searchChildDom = /*#__PURE__*/React.createElement("span", {
              className: "search-dom"
            }, /*#__PURE__*/React.createElement(base_index_["NumberInput"], {
              disabled: !!disabled,
              onBlur: that.inputBlur.bind(that, data, 'number'),
              scale: Number(scale),
              value: val,
              maxlength: Number(data.maxlength),
              placeholder: data.placeholder,
              onChange: that.changeNumber.bind(that, data),
              max: that.checkNumberHandler(data) ? data.max : null,
              min: that.checkNumberHandler(data) ? data.min : null
            }));
          }

          fieldTip = !this.isTrueEmpty(val) && data.label ? data.label + ':' + this.trustString(val) : '';
          break;

        case 'checkbox':
          if (val === '') {
            val = undefined;
          }
          /* 初始化checkbox的时候, initialvalue数据格式应该是什么样的 ?先用数组 */


          if (initialvalue.value || initialvalue.value == 0) {
            data.options.forEach(function (option) {
              if (Object(index_["isArray"])(initialvalue.value)) {
                if (initialvalue.value.includes(option.value)) {
                  option.checked = true;
                }
              }
            });
          }

          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["Select"], {
            disabled: !!disabled,
            className: "multiple-select",
            multiple: true,
            style: {
              marginRight: 6
            },
            placeholder: data.placeholder,
            value: val,
            onChange: that.onMultipleChange.bind(that, data),
            fieldid: data.attrcode
          }, data.options.map(function (val, index) {
            return /*#__PURE__*/React.createElement(Option, {
              key: index,
              value: String(val.value),
              title: val.display
            }, val.display);
          })));
          break;

        case 'checkbox_switch':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "condition-item-contant checkbox",
            style: {
              cursor: 'pointer'
            },
            onClick: function onClick(e) {
              return that.onChangeCheckbox_switch.call(that, data, e);
            }
          }, /*#__PURE__*/React.createElement("span", {
            className: "switchSpan"
          }, data.label, " "), /*#__PURE__*/React.createElement(base_index_["Checkbox"], {
            disabled: !!disabled,
            ref: "test",
            checked: initialvalue.value,
            type: "switch",
            onClick: function onClick(e) {
              return that.onChangeCheckbox_switch.call(that, data, e);
            }
          }));
          break;

        case 'switch':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "condition-item-contant switch  search-dom",
            style: {
              cursor: 'pointer'
            },
            onClick: that.switchChange.bind(that, data)
          }, /*#__PURE__*/React.createElement("span", {
            className: "switchSpan"
          }, data.label), /*#__PURE__*/React.createElement(base_index_["Checkbox"], {
            className: "checkbox",
            disabled: !!disabled,
            checked: val,
            onClick: that.switchChange.bind(that, data)
          }));
          break;

        case 'password':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, /*#__PURE__*/React.createElement(base_index_["Input"], {
            disabled: !!disabled,
            value: val,
            onBlur: that.inputBlur.bind(that, data),
            placeholder: data.placeholder,
            onChange: that.onInputChange.bind(that, data),
            maxlength: data.maxlength,
            type: "password"
          }));
          break;

        case 'residtxt':
          searchChildDom = /*#__PURE__*/React.createElement("span", {
            className: "search-dom"
          }, data.languageMeta && /*#__PURE__*/React.createElement(base_index_["MultiLangText"], {
            disabled: !!disabled,
            value: snapshotItem.valueMap || {},
            LangIndex: snapshotItem.initialvalue.index || '',
            attrcode: data.attrcode,
            isCheckChinese: !!data.maxlength,
            maxlength: data.maxlength,
            languageMeta: data.languageMeta,
            onBlur: that.inputBlur.bind(that, data),
            placeholder: data.placeholder,
            onSelect: that.onMultiLangTextSelect.bind(that, data),
            onChange: that.onMultiLangTextChange.bind(that, data)
          }));
          fieldTip = !Object(index_["isEmpty"])(val) && data.label ? data.label + ':' + initialvalue.display : '';
          break;
      }

      var tip = /*#__PURE__*/React.createElement("div", {
        className: "te-tips",
        style: {
          fontSize: '13px',
          wordBreak: 'break-all'
        }
      }, fieldTip); // 通过api设置值

      if (initialvalue.value) {
        this.clearRquiredWraning(data);
      }

      return /*#__PURE__*/React.createElement("div", {
        key: data.attrcode
        /* onClick={() => console.log('触发单击事件')} onFocus={() => console.log('触发焦点事件')} */

      }, Number(data.leftspace) ? /*#__PURE__*/React.createElement(base_index_["Col"], {
        md: Number(data.leftspace),
        xs: xs,
        sm: sm
      }) : null, /*#__PURE__*/React.createElement(base_index_["Tooltip"], {
        delayShow: 800,
        inverse: true,
        className: "search",
        overlay: fieldTip && this.showPlaceholder ? tip : null,
        placement: "top",
        trigger: "hover" //className='search-area-tooltip'
        // style={!fieldTip && { display: 'none' }}

      }, /*#__PURE__*/React.createElement("div", {
        className: "condition-contant"
      }, mustFillIn1, searchChildDom)), Number(data.rightspace) ? /*#__PURE__*/React.createElement(base_index_["Col"], {
        md: Number(data.rightspace),
        xs: xs,
        sm: sm,
        key: index
      }) : null);
    }
  }]);

  return templateEngine;
}();


// CONCATENATED MODULE: ./src/platform/components/CreateSearch/SearchAdvCom.js
function SearchAdvCom_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { SearchAdvCom_typeof = function _typeof(obj) { return typeof obj; }; } else { SearchAdvCom_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return SearchAdvCom_typeof(obj); }

function SearchAdvCom_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function SearchAdvCom_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { SearchAdvCom_ownKeys(Object(source), true).forEach(function (key) { SearchAdvCom_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { SearchAdvCom_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function SearchAdvCom_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function SearchAdvCom_asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function SearchAdvCom_asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { SearchAdvCom_asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { SearchAdvCom_asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || SearchAdvCom_unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function SearchAdvCom_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return SearchAdvCom_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return SearchAdvCom_arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return SearchAdvCom_arrayLikeToArray(arr); }

function SearchAdvCom_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function SearchAdvCom_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function SearchAdvCom_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function SearchAdvCom_createClass(Constructor, protoProps, staticProps) { if (protoProps) SearchAdvCom_defineProperties(Constructor.prototype, protoProps); if (staticProps) SearchAdvCom_defineProperties(Constructor, staticProps); return Constructor; }

function SearchAdvCom_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) SearchAdvCom_setPrototypeOf(subClass, superClass); }

function SearchAdvCom_setPrototypeOf(o, p) { SearchAdvCom_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return SearchAdvCom_setPrototypeOf(o, p); }

function SearchAdvCom_createSuper(Derived) { var hasNativeReflectConstruct = SearchAdvCom_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = SearchAdvCom_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = SearchAdvCom_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return SearchAdvCom_possibleConstructorReturn(this, result); }; }

function SearchAdvCom_possibleConstructorReturn(self, call) { if (call && (SearchAdvCom_typeof(call) === "object" || typeof call === "function")) { return call; } return SearchAdvCom_assertThisInitialized(self); }

function SearchAdvCom_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function SearchAdvCom_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function SearchAdvCom_getPrototypeOf(o) { SearchAdvCom_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return SearchAdvCom_getPrototypeOf(o); }

/*
*   查询区高级查询弹出框组件  --wangshhj
* */

 // import Ajax from 'src/api/ajax';
// import { promptBox } from 'src';







 // import toast from '../../api/toast';
// import getSysFieldid from '../../api/getSysFieldid';

__webpack_require__(929);

var NCTabPane = base_index_["Tabs"].TabPane;
var NCTreeNode = base_index_["Tree"].TreeNode;
var NCOption = base_index_["Select"].Option;
var NCRadioGroup = base_index_["Radio"].RadioGroup; // 查询区渲染完成发布订阅标识

var BEFORECOMPLETE = 'beforeAreaChangeComplete';
var COMPLETE = 'areaChangeComplete';
/*
*   SearchAdvModal组件，props中的参数解释：
*
*   moduleId ,                   //查询区组件id
*	advMeta ,                    //查询区模板
*	closeModal ,                 //关闭组件方法
*	searchBtnClick ,             //查询按钮回调
*	onAfterEvent ,               //编辑后事件
*   showAdvSearchPlanBtn ,       //是否显示保存方案按钮 ，默认显示
*   replaceAdvBody ,             //替换高级查询body区域
*   addAdvTabs ,                 //添加自定义tab页签
*   addAdvBody ,                 //添加自定义查询条件
*   replaceRightBody ,           //添加高级查询区右侧区域自定义查询条件Dom (fun)
*   searchPlanCache ,            //查询方案数据
*   searchPlanCacheChange ,      //查询方案修改后，回调
*   oid ,                        // 查询模板的oid
*   hideSearchCondition = false, // 隐藏候选条件
*   hideSearchPlan = false       // 隐藏高级查询的查询方案
*   saveSearchPlan,              // 保存查询方案确定按钮事件 ，用于业务组返回自定义的查询条件
*   clickPlanEve,                // 点击高级面板中的查询方案事件 ,用于业务组为自定义查询区赋值
*   advSearchClearEve,           // 高级面板中的清空按钮点击事件回调，用于业务组清除自定义查询条件的值
* */

var SearchAdvCom_SearchAdvCom = /*#__PURE__*/function (_Component) {
  SearchAdvCom_inherits(SearchAdvCom, _Component);

  var _super = SearchAdvCom_createSuper(SearchAdvCom);

  function SearchAdvCom(_props) {
    var _this;

    SearchAdvCom_classCallCheck(this, SearchAdvCom);

    _this = _super.call(this, _props);

    _this.initByProps = function (props, flag) {
      if (flag || !_this.state.showModal) {
        _this.state.status = props.searchInfo.status || 'normal'; // 当前操作区域

        _this.state.normalAdvId = props.moduleId + '@' + 'normal'; // 普通查询区id

        _this.state.superAdvId = props.moduleId + '@' + 'super'; // 高级查询区id

        _this.state.leftTab = props.hideSearchCondition ? '2' : props.leftTab || '1'; // 左侧tab的key值

        _this.state.currentPlan = props.searchInfo.currentClickPlan || props.searchInfo.currentPlan; // 当前正在操作的查询方案

        _this.state.searchPlanName = _this.state.currentPlan.name || ''; // 修改查询方案名称

        _this.state.searchInfo.itemsMap = {};
        _this.state.searchInfo.status = _this.state.status;
      }

      props.searchInfo.currentClickPlan = null; //每次更新都需要同步的数据，主要是模板的内容

      _this.state.searchInfo.searchPlanCache = props.searchPlanCache || []; // 查询方案数据

      _this.state.searchPlan = props.searchPlanCache || []; // 查询方案数据

      var items = props.meta.items || [];
      _this.items = items;
      _this.state.searchInfo.fixedConditionGroup = props.searchInfo.fixedConditionGroup;
      items.forEach(function (item) {
        return _this.state.searchInfo.itemsMap[item.attrcode] = item;
      }); //根据currentPlan初始化普通和高级区域的快照数据
      //如果是预制方案就按照simple的数据去初始化normal和super，如果不是预制方案就根据方案的类型初始化数据

      _this.defaultOpen = true; //let items = deepClone(this.props.advMeta)||[];

      /* 添加树组件需要的字段 */

      items.forEach(function (item) {
        if (!item.hasOwnProperty('attrcode')) {
          console.error('查询模板中有字段缺少attrcode字段，请检查');
        }

        if (!item.hasOwnProperty('label')) {
          console.error('查询模板中有字段缺少label字段，请检查');
        }

        item.refpk = item.attrcode;
        item.refname = item.label;
        item.isleaf = true;
      }); //items = items.filter(item=>item.isCondition===true);
      // 当业务组要替换整个body区域或者不需要候选条件时，不加载候选条件

      if (!Object(index_["isFunction"])(props.replaceAdvBody) && !props.hideSearchCondition && !flag) {
        //每次更新高级查询都更新左侧的内容
        _this.createSearchCondition.call(SearchAdvCom_assertThisInitialized(_this), items);
      } // 当业务组需要替换整个body区或者替换右侧body区域时，不默认加载右侧 必输条件


      if (!Object(index_["isFunction"])(props.replaceAdvBody) && !Object(index_["isFunction"])(props.replaceRightBody)) {
        _this.tabIndex = _this.tabIndex || '0';

        if (Object(index_["isFunction"])(props.addAdvTabs)) {
          var def = _toConsumableArray(props.addAdvTabs());

          for (var index = 0; index < def.length; index++) {
            var element = def[index];

            if (element.defaultOpen === true) {
              _this.tabIndex = String(index + 1);
              break;
            }
          }
        } //为了处理非首次初始化高级弹窗导致的 根据模板更新右侧区域
        // if (isEmpty(searchInfo.snapshotMap.normal)) { this.addRequiredItems.call(this, items); }


        var searchInfo = _this.state.searchInfo;
        var currentPlan = _this.state.currentPlan;
        var isDefaultPlan = currentPlan.pk_ncc_queryscheme == '001';
        searchInfo.isDefaultPlan = isDefaultPlan;
        var currentSnap = _clone(currentPlan.renderobj4web_snap);
        var defaultSnap = _clone(props.searchInfo.defaultPlan.renderobj4web);

        if (flag || !_this.state.showModal) {
          if (isDefaultPlan) {
            if (_this.state.status == 'super') {
              _this.state.searchInfo.snapshotMap.normal = plan2snapshotTranslate(searchInfo, defaultSnap, props.context, methods_createOperation);
              _this.state.searchInfo.snapshotMap["super"] = currentSnap;
            } else {
              _this.state.searchInfo.snapshotMap.normal = plan2snapshotTranslate(searchInfo, currentSnap, props.context, methods_createOperation);
              _this.state.searchInfo.snapshotMap["super"] = [{
                attrcode: 'root',
                refpk: 'root',
                key: 'root',
                operationSign: 'and',
                noRemove: true,
                //不可移除
                children: _clone(_this.state.searchInfo.snapshotMap.normal),
                visible: true
              }];
            }
          } else {
            if (searchInfo.status == 'super') {
              // let superSnap = [...searchInfo.fixedConditionGroup, ...currentSnap[0].children];
              // this.state.searchInfo.snapshotMap.super = plan2snapshotTranslate(searchInfo, currentSnap, props.context, createOperation);
              if (currentSnap && currentSnap.length && currentSnap[0]) {
                _this.state.searchInfo.snapshotMap["super"] = plan2snapshotTranslate(searchInfo, currentSnap, props.context, methods_createOperation);
              } else {
                _this.state.searchInfo.snapshotMap["super"] = [{
                  attrcode: 'root',
                  refpk: 'root',
                  key: 'root',
                  operationSign: 'and',
                  noRemove: true,
                  //不可移除
                  children: plan2snapshotTranslate(searchInfo, currentSnap, props.context, methods_createOperation),
                  visible: true
                }];
              }

              _this.state.searchInfo.snapshotMap.normal = plan2snapshotTranslate(searchInfo, defaultSnap, props.context, methods_createOperation);
            } else {
              // let normalSnap = [...searchInfo.fixedConditionGroup, ...currentSnap[0].children];
              _this.state.searchInfo.snapshotMap.normal = plan2snapshotTranslate(searchInfo, currentSnap, props.context, methods_createOperation);
              _this.state.searchInfo.snapshotMap["super"] = [{
                attrcode: 'root',
                refpk: 'root',
                key: 'root',
                operationSign: 'and',
                noRemove: true,
                //不可移除
                children: plan2snapshotTranslate(searchInfo, defaultSnap, props.context, methods_createOperation),
                visible: true
              }];
            }
          }
        } else {
          console.log('gaoji已经打开');
        }
      } //同步高级弹窗的状态


      _this.state.showModal = props.searchInfo.showAdvModal;
      props.searchInfo.snapshotMap.normal = _this.state.searchInfo.snapshotMap.normal;
      props.searchInfo.snapshotMap["super"] = _this.state.searchInfo.snapshotMap["super"]; // if (!searchInfo.currentPlan.isMyPlan) {
      // 	this.clickSearchPlan(searchInfo.currentPlan);
      // }

      _this.firstInit = false;
    };

    _this.createDefaultSnap = function (itemsMap, currentSnap) {
      _this.state.searchInfo.snapshotMap.normal = currentSnap.map(function (item) {
        var _item$initialvalue, _item$initialvalue2;

        var itemObj = itemsMap[item.attrcode];

        if (itemObj) {
          if (itemObj.queryOperateType) {
            item.operationOptions = methods_createOperation(itemObj.queryOperateType);
          } else {
            item.operationOptions = methods_createOperation('=');
          }
        }

        return {
          attrcode: item.attrcode,
          initialvalue: {
            value: ((_item$initialvalue = item.initialvalue) === null || _item$initialvalue === void 0 ? void 0 : _item$initialvalue.value) || '',
            display: ((_item$initialvalue2 = item.initialvalue) === null || _item$initialvalue2 === void 0 ? void 0 : _item$initialvalue2.display) || ''
          },
          isExtend: item.isExtend,
          key: item.attrcode,
          remove: item.remove,
          visible: item.visible,
          refpk: item.attrcode,
          operationSign: item.operationSign,
          operationOptions: item.operationOptions
        };
      });
      _this.state.searchInfo.snapshotMap["super"] = [{
        attrcode: 'root',
        refpk: 'root',
        key: 'root',
        operationSign: 'and',
        noRemove: true,
        //不可移除
        children: _clone(_this.state.searchInfo.snapshotMap.normal),
        visible: true
      }];
    };

    _this.setStateEve = function (callback) {
      _this.setState(_this.state, callback);
    };

    _this.getSnapshotCache = function (searchInfo) {
      function setvalue(list, cache) {
        list.forEach(function (item) {
          if (item.children) {
            setvalue(item.children, cache);
          } else {
            if (cache[item.attrcode]) {
              item.initialvalue = cache[item.attrcode];
            }
          }
        });
      }

      Object.keys(searchInfo.snapshotMap).forEach(function (status) {
        var snapshot = searchInfo.snapshotMap[status];
        var cache = searchInfo.snapshotCache[status];

        if (!Object(index_["isEmpty"])(cache)) {
          setvalue(snapshot, cache);
          searchInfo.snapshotCache[status] = {};
        }
      });
    };

    _this.getConditionTreeFromItems = function (items) {
      items.forEach(function (item) {
        if (!item.hasOwnProperty('attrcode')) {
          console.error(_this.multiLang['page-search-0026'] + 'attrcode' + _this.multiLang['page-search-0027'] + '，' + _this.multiLang['page-search-0028']);
        }

        if (!item.hasOwnProperty('label')) {
          console.error(_this.multiLang['page-search-0026'] + 'label' + _this.multiLang['page-search-0027'] + '，' + _this.multiLang['page-search-0028']);
        }

        item.refpk = item.attrcode || '';
        item.refname = item.label || '';
        !item.pid && delete item.pid;
      });
      return _this.props.syncTree.createTreeData(items);
    };

    _this.searchBtnClickEve = /*#__PURE__*/SearchAdvCom_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
      var data, id, template, snapshot, f, finalData, clickResult;
      return regeneratorRuntime.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              data = null;
              id = null;
              template = [];
              snapshot = _this.state.searchInfo.snapshotMap[_this.state.searchInfo.status]; // let simple_snapshot = tree2Array(this.state.searchInfo.snapshotMap[this.state.searchInfo.status]);
              // 如果业务组替换整个body或者右侧body区域，则需要业务组自己组织自定义查询条件

              if (!(Object(index_["isFunction"])(_this.props.replaceRightBody) || Object(index_["isFunction"])(_this.props.replaceAdvBody))) {
                _context.next = 13;
                break;
              }

              /* 此时查询按钮的回调方法中，data为 'userControl'，表示需要业务组自己处理自定义的查询条件 */
              data = 'userControl';

              if (!Object(index_["isFunction"])(_this.props.searchBtnClick)) {
                _context.next = 11;
                break;
              }

              _context.next = 9;
              return _this.props.searchBtnClick(SearchAdvCom_objectSpread(SearchAdvCom_objectSpread({}, _this.props._this._this), _this.props._this._this.props), data, 'super');

            case 9:
              f = _context.sent;

              if (!f) {
                _this.state.searchInfo.status = _this.lastStatus;

                _this.close(true);
              }

            case 11:
              _context.next = 29;
              break;

            case 13:
              data = _getAllSearchData.call(SearchAdvCom_assertThisInitialized(_this), _this.props.id, _this.state.searchInfo, true);
              template = getCurrentTemplate.call(_this.props._this, _this.props.moduleId);

              if (!(data !== false)) {
                _context.next = 29;
                break;
              }

              finalData = {
                queryAreaCode: _this.props.id,
                oid: _this.props.oid || _this.props.meta.oid,
                //这块是一个暂时的处理，因为有些场景this.props.oid ==undefined 原因还没查出来
                querytype: 'tree',
                querycondition: data,
                template: template,
                nctz: getTimezoneOffset()
              }; // 外层样式 plan => simple  add by wanglongx 不过滤有值无值

              if (!Object(index_["isFunction"])(_this.props.searchBtnClick)) {
                _context.next = 24;
                break;
              }

              _context.next = 20;
              return _this.props.searchBtnClick(SearchAdvCom_objectSpread(SearchAdvCom_objectSpread({}, _this.props._this._this), _this.props._this._this.props), data, 'super', data && finalData);

            case 20:
              clickResult = _context.sent;

              if (!clickResult) {
                // this.state.searchInfo.currentSnapshot = snapshotFilter(snapshot,this.state.searchInfo.itemsMap);
                // this.state.searchInfo.currentSnapshot = snapshot;
                _this.props.searchInfo.snapshotMap['simple'] = snapshot;
                _this.state.currentPlan.renderobj4web_snap = snapshot; // this.props.searchInfo.currentPlan.renderobj4web_snap = snapshot;

                _this.props.searchInfo.currentPlan = _this.state.currentPlan || {};
                _this.props.searchInfo.status = 'simple';

                _this.close(true);
              }

              _context.next = 29;
              break;

            case 24:
              // this.state.searchInfo.currentSnapshot = snapshotFilter(snapshot,this.state.searchInfo.itemsMap);
              // this.state.searchInfo.currentSnapshot = snapshot;
              _this.props.searchInfo.snapshotMap['simple'] = snapshot;
              _this.state.currentPlan.renderobj4web_snap = snapshot; // this.props.searchInfo.currentPlan.renderobj4web_snap = snapshot;

              _this.props.searchInfo.currentPlan = _this.state.currentPlan || {};
              _this.props.searchInfo.status = 'simple';

              _this.close(true);

            case 29:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));

    _this.cancelClick = function (e) {
      if (e) e.stopPropagation();
      var backPosition = _this.props.backPosition;
      Object(index_["isFunction"])(backPosition) && backPosition();

      if (!_this.state.onlyShowSuperBtn) {
        _this.props.searchInfo.status = _this.lastStatus;
      }

      _this.close(0);
    };

    _this.saveSearchPlanClick = function () {
      // this.props.modal.show('saveSearchPlan@' + this.props.moduleId);
      _methods_beSureBtnClick.call(SearchAdvCom_assertThisInitialized(_this), 'save');
    };

    _this.addSearchPlanClick = function () {
      _this.props.modal.show('addSearchPlan@' + _this.props.moduleId);
    };

    _this.close = function (flag) {
      var _this$props = _this.props,
          onlyShowModalCancelCallback = _this$props.onlyShowModalCancelCallback,
          onlyShowModal = _this$props.onlyShowModal;
      var statusChangeEvent = _this.props.statusChangeEvent;
      statusChangeEvent && statusChangeEvent(_this.state.searchInfo.status);
      !flag && onlyShowModal && Object(index_["isFunction"])(onlyShowModalCancelCallback) && onlyShowModalCancelCallback(); // 由于卸载导致  state 回调不触发
      // PubSub.publish(COMPLETE, true);
      // let { renderobj4web_snap, renderobj4web } = this.props.searchInfo.currentPlan;
      // if (flag === 0 && renderobj4web_snap.length > 0) {
      //     if (renderobj4web && renderobj4web.length > 0 && renderobj4web[0].attrcode != renderobj4web_snap.attrcode)
      //         delete this.props.searchInfo.currentPlan.renderobj4web_snap;
      // }

      index_["PubSub"].publishSync(BEFORECOMPLETE, true);

      _this.props._this._this.infoExchangeController.publishSync('heightChange', {
        area: 'searchArea'
      });

      _this.setState({
        showModal: false
      }, function () {
        _this.props._this._this.infoExchangeController.publishSync('heightChange', {
          area: 'searchArea'
        }); // 发布通知表格更新高度


        index_["PubSub"].publish(COMPLETE, true);
      });

      document.body.style.overflow = 'auto';

      _this.props.closeModal();
    };

    _this.mathSignChange = function (data, val, oldValue) {
      var advancedData = _this.state.searchInfo.snapshotMap[_this.state.searchInfo.status];

      if (val !== 'between' && oldValue === 'between') {
        data.initialvalue.value = '';
        data.initialvalue.display = '';
      } else if (val === 'between' && oldValue !== 'between') {
        data.initialvalue.display = [];
        data.initialvalue.value = [];
      }

      data.operationSign = val; //this.mathSignChangeEve(advancedData, data.refpk, val);

      _this.setStateEve(function () {
        typeof _this.props.onOperateTypeChange === 'function' && _this.props.onOperateTypeChange(data.attrcode, val);
      });
    };

    _this.onDropChildren = function (e) {
      e.preventDefault();
      var keys = JSON.parse(e.currentTarget.getAttribute('keys'));
      _this.state.searchInfo.targetKey = keys.attrcode;
      _this.state.searchInfo.targetIsExtend = keys.isExtend;
    };

    _this.onDragOver = function (e) {
      e.preventDefault();
      return true;
    };

    _this.logicSelectChange = function (data, val, oldval) {
      setSearchValByFieldHigh.call(_this.props._this._this, _this.props.moduleId, data.refpk, data, val);
    };

    _this.tabChange = function (val) {
      if (val === '2') {//如果还没查询过查询方案，去查询  暂时注释掉
        //this.querySearchPlan();
      }

      _this.setState({
        leftTab: val
      });
    };

    _this.createSearchCondition = function (items) {
      //去掉固定条件和模板不显示的项
      var _item = items.filter(function (item) {
        return item.isfixedcondition != true && item.visible == true;
      }); //_item.forEach(v=>v);


      var tree = _this.props.syncTree.createTreeData(_clone(_item));

      _this.props.syncTree.setSyncTreeData(_this.props.moduleId, tree);
    };

    _this.addRequiredItems = function (items) {
      if (!items) return;
      var newItems = [];
      /* 过滤默认显示项 */

      var filterMeta = function filterMeta(data) {
        data.map(function (item) {
          if (Array.isArray(item.children)) {
            filterMeta(item.children);
          }

          if (item.visible || item.isfixedcondition) {
            //item.advrequired = !!item.required;
            newItems.push(item);
          }
        });
      };

      filterMeta(items); //排序这个 先放一下 ，看看在哪里比较合适
      //newItems.sort((v1, v2) => v1.visibleposition - v2.visibleposition);

      if (newItems.length) {
        _addData.call(SearchAdvCom_assertThisInitialized(_this), newItems, 'normal', _this.firstInit && _this.props.setInitValueEvent, _this.props.isTemplateOrder);

        _addData.call(SearchAdvCom_assertThisInitialized(_this), newItems, 'super', _this.firstInit && _this.props.setInitValueEvent, _this.props.isTemplateOrder);
      }
    };

    _this.advOrNormal = function (val) {
      _this.state.searchInfo.status = val;
      var statusChangeEvent = _this.props.statusChangeEvent;
      statusChangeEvent && statusChangeEvent(_this.state.searchInfo.status);
      /* 返回当前页签是普通还是高级 + 业务组是否自定义查询区 */

      _this.props.statusChange(val, _this.state.userControlAll);

      _this.setStateEve();
    };

    _this.onDragOver = function (e) {
      e.preventDefault();
      return true;
    };

    _this.clickRight = function () {
      _this.onDrop('clickRight');
    };

    _this.onDrop = function (flag) {
      if (flag === 'clickRight') {
        //hover 候选条件的时候 出现的右侧单击箭头，点击的时候获得node
        _this.state.moveNode = _clone(_this.props.syncTree.getHoverNodeKey(_this.props.moduleId));
      } else {
        _this.state.moveNode = _clone(_this.props.syncTree.getMoveNodeKey(_this.props.moduleId));
      } //如果拖拽的节点是数组并且第一项的isdrag为false或者 节点为对象并且isdrag 为false，不允许拖拽


      if (Object(index_["isArray"])(_this.state.moveNode) && _this.state.moveNode[0].isdrag === false || _this.state.moveNode.isdrag === false) {
        return;
      }

      if (_this.state.moveNode.hasOwnProperty('children')) {
        delete _this.state.moveNode.children;
      }

      _addData.call(SearchAdvCom_assertThisInitialized(_this), _this.state.moveNode, _this.state.searchInfo.status); //this.scrollBottom('normal');

    };

    _this.scrollBottom = function (ref) {
      var target = _this.refs[ref];
      var clientHeight = target.clientHeight;
      var scrollHeight = target.scrollHeight;
      target.scrollTop = clientHeight + scrollHeight;
    };

    _this.clearAdvValue = function () {
      Object(index_["isFunction"])(_this.props.advSearchClearEve) && _this.props.advSearchClearEve(); //同步内外的status

      _this.props.searchInfo.status = _this.state.searchInfo.status;
      clearAllValue.call(_this.props._this._this, _this.props.moduleId);
    };

    _this.editSearchPlanName = function (item, e) {
      // e.stopPropagation()  
      _this.clickSearchPlan(item); // this.state.currentPlan = item;
      // this.state.editPlanName = item.name
      // this.state.searchPlanName = item.name;
      // this.setStateEve();


      _this.props.modal.show('editSearchPlanName@' + _this.props.moduleId);
    };

    _this.delSearchPlan = function (item) {
      _this.clickSearchPlan(item); // this.state.currentPlan = item;


      PromptBox_promptBox({
        color: 'warning',
        hotKeyboard: true,
        title: _this.multiLang['page-search-0031'],
        content: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          dangerouslySetInnerHTML: {
            __html: _this.multiLang['page-search-0015']
          }
        }),
        // 提示内容,非必输
        beSureBtnName: _this.multiLang['page-search-0009'],
        // 确定按钮名称, 默认为"确定",非必输
        cancelBtnName: _this.multiLang['page-search-0010'],
        beSureBtnClick: beSureBtnClick_Del.bind(SearchAdvCom_assertThisInitialized(_this))
      });
    };

    _this.addMark = function (data) {
      data.map(function (item) {
        if (item.initialvalue && (item.initialvalue.value === '' || item.initialvalue.value === null || Object(index_["isArray"])(item.initialvalue.value) && !item.initialvalue.value.length || Object(index_["isArray"])(item.initialvalue.value) && item.initialvalue.value[0] === null)) {
          item.isEmpty = true;
        } else {
          item.isEmpty = false;
        }

        if (Array.isArray(item.children)) {
          _this.addMark(item.children);
        }
      });
    };

    _this.clickSearchPlan = function (item, e) {
      if (item.pk_ncc_queryscheme == _this.state.currentPlan.pk_ncc_queryscheme) return;
      item.renderobj4web && item.renderobj4web.forEach(function (val) {
        return val.advrequired = !!val.required;
      });
      _this.state.currentPlan = item;
      _this.state.searchInfo.isDefaultPlan = item.pk_ncc_queryscheme == '001';
      _this.state.searchPlanName = item.name;
      var extendsList = _this.state.searchInfo.fixedConditionGroup; // const extendsList = item.pk_ncc_queryscheme == '001' ? [] : this.state.searchInfo.fixedConditionGroup;

      Object(index_["isFunction"])(_this.props.clickPlanEve) && _this.props.clickPlanEve(item, _this.props._this._this);

      if (item.renderobj4web && item.renderobj4web.length && item.renderobj4web[0].refpk === 'root') {
        //高级
        _this.state.searchInfo.status = 'super';
        _this.props.searchInfo.status = 'super';
        item.renderobj4web[0].children = extendsList.concat(item.renderobj4web[0].children);
        var plan = item.renderobj4web;
        _this.state.searchInfo.snapshotMap["super"] = plan2snapshotTranslate(_this.state.searchInfo, plan, _this.props.context, methods_createOperation);
      } else {
        //普通
        _this.state.searchInfo.status = 'normal';
        _this.props.searchInfo.status = 'normal';
        var _plan = item.renderobj4web;

        if (item.pk_ncc_queryscheme == '001') {
          _this.state.searchInfo.snapshotMap.normal = plan2snapshotTranslate(_this.state.searchInfo, _plan, _this.props.context, methods_createOperation);
        } else {
          _this.state.searchInfo.snapshotMap.normal = plan2snapshotTranslate(_this.state.searchInfo, [].concat(_toConsumableArray(extendsList), _toConsumableArray(_plan)), _this.props.context, methods_createOperation);
        } // if (item.pk_ncc_queryscheme !== '001') {
        //     plan = extendsList.concat(plan);
        // }

      } //同步内外状态


      _this.props.searchInfo.snapshotMap.normal = _this.state.searchInfo.snapshotMap.normal;
      _this.props.searchInfo.snapshotMap["super"] = _this.state.searchInfo.snapshotMap["super"]; //this.props.changeCompleteFlag && this.props.changeCompleteFlag.call(this, true);
      // replaceData.call(this.props._this._this, this.props.moduleId, plan, item.name);
      // isFunction(this.props.setInitValueEvent) && this.props.setInitValueEvent(this.state.searchInfo.status);

      _this.setStateEve();
    };

    _this.createSearchPlan = function () {
      /*ajax*/
      if (!_this.props.searchPlanCache || !_this.props.searchPlanCache.length) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
          className: "searchPlanList"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "searchPlanName"
        }, _this.multiLang['page-search-0029']));
      }

      var newCache = _clone(_this.props.searchPlanCache);
      return newCache.map(function (item) {
        // if (item.isquickqs) {
        //     this.state.preparedPlanName = item.name;
        // }
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
          className: "searchPlanList ".concat(_this.state.currentPlan.name == item.name ? 'active' : ''),
          key: item.pk_ncc_queryscheme
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "searchPlanName",
          onClick: _this.clickSearchPlan.bind(SearchAdvCom_assertThisInitialized(_this), item)
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          delayShow: 800,
          inverse: true,
          overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, item.name),
          placement: "top"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", null, item.name))), !item.isquickqs && !item.isMyPlan && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: _this.multiLang['page-search-icon-modify'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "searchPlanEdit",
          onClick: _this.editSearchPlanName.bind(SearchAdvCom_assertThisInitialized(_this), item)
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "iconfont icon-gerenpeizhi"
        }))), !item.isquickqs && !item.isMyPlan && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: _this.multiLang['page-search-icon-delete'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "searchPlanDel",
          onClick: _this.delSearchPlan.bind(SearchAdvCom_assertThisInitialized(_this), item)
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "iconfont icon-shanchu"
        }))));
      });
    };

    _this.searchPlanNameChange = function (val) {
      _this.setState({
        searchPlanName: val
      });
    };

    _this.mathSignChangeEve = function (treeData, pk, val) {
      var len = treeData.length;

      while (len--) {
        var item = treeData[len];

        if (item.refpk === pk) {
          /* 处理between和非between类型切换时，数据格式处理。between数据类型为数组，起始和结束的值都为切换前的value值。非between类型时，数据格式为字符串，取between的起始值 */
          if (val !== 'between' && item.operationSign === 'between') {
            item.initialvalue.value = '';
            item.initialvalue.display = '';
          } else if (val === 'between' && item.operationSign !== 'between') {
            item.initialvalue.display = [];
            item.initialvalue.value = [];
          }

          item.operationSign = val;
          return true;
        } else if (Array.isArray(item.children)) {
          var res = _this.mathSignChangeEve(item.children, pk, val);

          if (res) {
            return false;
          }
        }
      }
    };

    _this.modalContent = function (status) {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "plan-content"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "label"
      }, _this.multiLang['page-search-0012'] + ':'), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "content"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          high: ['enter']
        },
        handlers: {
          high: _methods_beSureBtnClick.bind(SearchAdvCom_assertThisInitialized(_this), status, 'enter')
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        id: "NC_searchPlanModalInput",
        autoFocus: true,
        className: "searchPlanModal",
        value: _this.state.searchPlanName,
        onChange: _this.searchPlanNameChange.bind(SearchAdvCom_assertThisInitialized(_this)),
        maxlength: 100
      }))));
    };

    _this.createDomItem = function (snapshotItem) {
      var templetItem = _this.state.searchInfo.itemsMap[snapshotItem.attrcode];
      var renderItem = _this.props.renderItem;

      if (!templetItem) {
        //
        return null;
      } else {
        return new templateEngine_templateEngine({
          id: _this.props.moduleId,
          searchInfo: _this.state.searchInfo,
          snapshotItem: snapshotItem,
          onAfterEvent: _this.props.onAfterEvent,
          setStateEve: _this.setStateEve,
          renderItem: renderItem,
          context: _this.props.context,
          showRequire: false,
          createScript: _this.props.createScript,
          showPlaceholder: false,
          hiddenFunList: _this.props.hiddenFunList,
          multiLang: _this.multiLang,
          LangData: _this.LangData // parentRef:this.refs.NCSearchAdvComBox

        });
      }
    };

    _this.createDom = function (status) {
      // const fixedConditionGroup = this.state.searchInfo.fixedConditionGroup;
      if (typeof status === 'string') {
        var snapshot = _this.state.searchInfo.snapshotMap[status].filter(function (item) {
          return item.visible;
        });
      } else if (SearchAdvCom_typeof(status) === 'object') {
        var snapshot = status.filter(function (item) {
          return item.visible;
        });
      }

      if (!snapshot.length) {
        return;
      }

      return snapshot.map(function (data, ind) {
        //  必输项标识
        var item = _this.state.searchInfo.itemsMap[data.attrcode];

        if (!item && !data.attrcode.includes('root')) {
          return null;
        }

        var mustFillIn = null;

        if (item && item.required) {
          mustFillIn = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "mustFillIn"
          }, "*");
        }

        var searchChildDom = _this.createDomItem(data);
        /* 树节点dom */


        var treeTitle = function treeTitle() {
          var logicOptions = {
            and: _this.multiLang['page-search-0035'],
            or: _this.multiLang['page-search-0036']
          };

          if (data.children && data.children.length) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
              className: "advancedSearchSign"
            }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
              key: data.refpk // 疑问：key为什么没设置上？？？_targetInit中是null
              ,
              keys: JSON.stringify({
                attrcode: data.refpk,
                isExtend: !!data.isExtend
              }) // field={data.refpk}
              ,
              className: "advancedSearchChild",
              onDrop: _this.onDropChildren,
              onDragOver: _this.onDragOver
            }, data.attrcode === 'root' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
              className: "advancedSearch_root"
            }, logicOptions[data.operationSign]) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
              className: "select-containter"
            }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Select"], {
              className: "NC_logicSign",
              showClear: false,
              value: String(data.operationSign || 'and'),
              onChange: _this.logicSelectChange.bind(SearchAdvCom_assertThisInitialized(_this), data),
              fieldid: data.attrcode
            }, Object.keys(logicOptions).map(function (val, index) {
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCOption, {
                key: index,
                value: String(val)
              }, logicOptions[val]);
            })))), !data.noRemove && !data.isfixedcondition && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
              className: "searchAdvCom_remove",
              onClick: _this.removeDom.bind(SearchAdvCom_assertThisInitialized(_this), data)
            }, _this.multiLang['page-search-0037']));
          } else {
            if (data.operationOptions) {
              var selectDom = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "NC_searchAdvCom",
                key: data.refpk // field={data.refpk}
                //keys={data.refpk}
                ,
                keys: JSON.stringify({
                  attrcode: data.refpk,
                  isExtend: !!data.isExtend
                }),
                onDrop: _this.onDropChildren,
                onDragOver: _this.onDragOver
              }, _this.state.searchInfo.status === 'super' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                className: "remove"
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "link"
              })) : null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                className: "remove"
              }, data.remove ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "searchAdvCom_remove",
                onClick: _this.removeDom.bind(SearchAdvCom_assertThisInitialized(_this), data)
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
                className: "iconfont icon-qingkong"
              })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "searchAdvCom_remove"
              }, _this.state.searchInfo.status === 'super' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "link"
              }) : null)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                className: "content"
              }, mustFillIn, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
                delayShow: 800,
                inverse: true,
                overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, item.label),
                placement: "top"
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "searchAdvCom_name"
              }, item.label)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "searchAdvCom_select"
              }, data.operationOptions.length > 1 ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Select"], {
                className: "NC_operateSign",
                showClear: false,
                disabled: !!item.disabled,
                value: String(data.operationSign || _this.multiLang['page-search-0035']),
                onChange: _this.mathSignChange.bind(SearchAdvCom_assertThisInitialized(_this), data),
                fieldid: "operateSign"
              }, data.operationOptions.map(function (val, index) {
                return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCOption, {
                  key: index,
                  value: String(val.value)
                }, val.display);
              })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                className: "option-label"
              }, (data.operationOptions[0] || {}).display)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                className: "searchAdvCom_com"
              }, searchChildDom)));
              return selectDom;
            } else {
              console.log('the data is', data);
            }
          }
        };

        if (data.children && data.children.length) {
          var logicOptions = {
            and: _this.multiLang['page-search-0035'],
            or: _this.multiLang['page-search-0036']
          };
          var children = data.children;
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCTreeNode, {
            key: data.refpk + ind,
            title: treeTitle.call(SearchAdvCom_assertThisInitialized(_this), data),
            className: "search-right-area-tree-node",
            liAttr: {
              fieldid: Object(index_["getSysFieldid"])(logicOptions[data.operationSign] + '_node')
            }
          }, _this.createDom(children));
        }

        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCTreeNode, {
          key: data.attrcode + ind,
          title: treeTitle.call(SearchAdvCom_assertThisInitialized(_this), data),
          liAttr: {
            fieldid: Object(index_["getSysFieldid"])(data.attrcode + '_node')
          },
          className: "search-right-area-tree-node".concat(_this.state.searchInfo.status === 'super' ? ' child-node' : '')
        });
      }).filter(function (item) {
        return item;
      });
    };

    _this.removeDom = function (data) {
      var _this$props$searchInf = _this.props.searchInfo,
          status = _this$props$searchInf.status,
          snapshotMap = _this$props$searchInf.snapshotMap;
      var queryconditionCount = snapshotMap[status].filter(function (item) {
        return item.attrcode === data.attrcode;
      }).length;

      if (!_this.props.removeQuerConditionEve || !_this.props.removeQuerConditionEve.call(_this.props._this._this, _this.props.moduleId, data.attrcode, queryconditionCount)) {
        _this.state.searchInfo.targetKey = null;
        delNode.call(_this.props._this._this, _this.props.moduleId, data.refpk);
      } // isFunction(advData.remove) && advData.remove(this.comId)

    };

    _this.onDragEnterBox = function () {
      _this.state.searchInfo.targetKey = null;
    };

    _this.creatConditionUIDom = function (data) {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        id: _this.props.moduleId,
        ref: "NCSearchAdvComBox",
        className: "NC_searchAdvComBox" // onDrop={ onDrop.bind(this)}
        ,
        onDragEnter: _this.onDragEnterBox.bind(SearchAdvCom_assertThisInitialized(_this)),
        fieldid: Object(index_["getSysFieldid"])('advSearch_tree-area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        fieldid: Object(index_["getSysFieldid"])('advSearch_tree')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tree"] // showLine = {showLine}
      // selectedKeys = { thisTree.selectedValue }
      // onSelect = { onSelect.bind(this) }
      // onExpand={ onExpand.bind(this) }    //  节点展开事件
      // expandedKeys={ [] }    //搜索节点关键字后要展开的父节点
      // autoExpandParent={ thisTree.autoExpandParent }    //是否展开所有节点
      // onMouseLeave={ onMouseLeave.bind(this) }    //鼠标离开节点事件
      // onMouseEnter={ onMouseEnter.bind(this) }    // 鼠标进入节点事件
      // multiple = {true} //是否允许选择多个节点
      , {
        defaultExpandedKeys: "root0",
        closeIcon: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          className: "tree-icon-content"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          className: "first",
          type: "uf-add-s-o"
        }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          className: "secend",
          type: "uf-minus"
        }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          className: "third",
          type: "uf-treefolderopen"
        })),
        openIcon: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          className: "tree-icon-content"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          className: "first",
          type: "uf-reduce-s-o"
        }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          className: "secend",
          type: "uf-minus"
        }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          className: "third",
          type: "uf-treefolderopen"
        })) // draggable
        // onDragEnter={ onDragEnter.bind(this) }
        // onDragOver={ onDragOverBox.bind(this) }
        // onDragStart={ onDragStart.bind(this) }
        // onDrop = { onDrop.bind(this) }

      }, _this.createDom(data))));
    };

    _this.defRightDom = function () {
      var searchStatus = _this.state.searchInfo.status;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "adv-right-area",
        id: "adv-right-area"
      }, Object(index_["isFunction"])(_this.props.addAdvBody) && _this.props.addAdvBody(), !_this.props.hideSearchType && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCRadioGroup, {
        selectedValue: searchStatus,
        onChange: _this.handleChange.bind(SearchAdvCom_assertThisInitialized(_this))
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        value: "normal"
      }, _this.multiLang['page-search-0006']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        value: "super"
      }, _this.multiLang['page-search-0007'])), searchStatus === 'normal' && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        ref: "normal",
        className: "normalArea",
        id: "advArea",
        style: {
          height: Object(index_["isFunction"])(_this.props.addAdvBody) || _this.props.hideSearchType ? 'auto' : 'calc(100% - 40px)'
        },
        onDragOver: _this.onDragOver,
        onDrop: _this.onDrop.bind(SearchAdvCom_assertThisInitialized(_this))
      }, _this.creatConditionUIDom('normal')), searchStatus === 'super' && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        id: "advArea",
        className: "superArea",
        style: {
          height: Object(index_["isFunction"])(_this.props.addAdvBody) ? 'auto' : 'calc(100% - 40px)'
        },
        onDragOver: _this.onDragOver,
        onDrop: _this.onDrop.bind(SearchAdvCom_assertThisInitialized(_this))
      }, _this.creatConditionUIDom('super')));
    };

    _this.tabOnChange = function (e) {
      _this.tabIndex = e;
      e = Number(e);

      if (e > 0 && Object(index_["isFunction"])(_this.props.addAdvTabs)) {
        var callback = _this.props.addAdvTabs()[e - 1].callback;

        Object(index_["isFunction"])(callback) && callback();
      }

      _this.setStateEve();
    };

    _this.createRightDom = function () {
      var def = [{
        name: _this.props.searchConditionName || _this.multiLang['page-search-0025'],
        content: _this.defRightDom()
      }];

      if (Object(index_["isFunction"])(_this.props.addAdvTabs)) {
        def = [].concat(_toConsumableArray(def), _toConsumableArray(_this.props.addAdvTabs()));
      }

      return def;
    };

    _this.onInputFocus = function () {
      var input = document.getElementById('NC_searchPlanModalInput').focus();
    };

    _this.state = {
      showModal: true,
      // 组件显影性
      moveNode: null,
      // 拖拽节点
      // planTabKey: props.hideSearchCondition ? '2' : '1', // 查询方案的tabkey, 默认2，业务组不需要候选条件时改为1
      // preparedPlanName: '', // 预制查询方案名称
      // needReveal: false, // 是否需要展示查询方案的未填写项；
      userControlAll: false,
      // 业务组自定义整个高级查询区,
      // advMeta: '',
      // searchInfo: deepClone(props.searchInfo),
      searchInfo: {
        snapshotMap: {
          simple: [],
          normal: [],
          "super": []
        }
      },
      onlyShowSuperBtn: _props.onlyShowSuperBtn
    };
    _this.lastStatus = _props.lastStatus; // 业务组自定义查询区域 ，点查询方案时，不用展示方案中的未填写项

    if (Object(index_["isFunction"])(_props.replaceRightBody)) {
      _this.state.userControlAll = true;

      _props.statusChange(_this.state.status, _this.state.userControlAll);
    }

    _this.firstInit = true;
    _this.multiLang = _props.multiLang;
    _this.LangData = _props.LangData;
    setMultiLangHigh(_this.multiLang);

    _this.initByProps(_props, true); // this.getSnapshotCache(this.state.searchInfo);


    return _this;
  }

  SearchAdvCom_createClass(SearchAdvCom, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var _this2 = this;

      if (!Object(index_["isFunction"])(this.props.replaceAdvBody) && !this.props.hideSearchCondition) {
        //每次更新高级查询都更新左侧的内容
        this.createSearchCondition.call(this, this.items);
      } // 没办法了 只能通过全局订阅发布做了 


      this.searchChoosePlan = index_["PubSub"].subscribe('searchChoosePlan', function (msg, data) {
        if (data) {
          var currentPlan = _this2.props.searchPlanCache.find(function (item) {
            return item.name == data;
          });

          if (currentPlan) {
            _this2.setState({
              currentPlan: currentPlan
            });

            _this2.clickSearchPlan(currentPlan);
          }
        }
      });
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.searchChoosePlan && index_["PubSub"].unsubscribe(this.searchChoosePlan);
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(props) {
      // this.state.searchInfo = deepClone(props.searchInfo)
      // this.state.searchPlan = props.searchPlanCache;
      // this.state.currentPlan = props.searchInfo.currentPlan;
      // this.getSnapshotCache(this.state.searchInfo);
      // this.lastStatus = props.lastStatus;
      // 当从方案里面切进 super时 选中"2" 并选中当前方案
      // if ('leftTab' in props && props.leftTab == '2') {
      //     this.setState({ leftTab: props.leftTab });
      // }
      if (props.searchInfo.showAdvModal) {
        this.initByProps(props, false);
      } // if (this.state.currentPlan.name !== props.searchInfo.currentPlan.name) {
      // 	this.clickSearchPlan(this.state.currentPlan);
      // }
      // 繁琐判断 需重新思考
      // if('choosePlanName' in props && props.choosePlanName != undefined && !props.choosePlanFlag){
      // 	let currentPlan = props.searchPlanCache.find(item => item.name == props.choosePlanName)
      // 	if(currentPlan){
      // 		this.setState({
      // 			currentPlan: currentPlan
      // 		})
      // 		this.clickSearchPlan(currentPlan)
      // 	}
      // }

    }
  }, {
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps, nextState) {
      if (!nextProps.onlyShowAdvArea && !nextProps.searchInfo.showAdvModal) {
        return false;
      }

      return true;
    }
  }, {
    key: "handleChange",
    value: function handleChange(value) {
      this.state.searchInfo.status = value;
      this.props.searchInfo.status = value;
      var statusChangeEvent = this.props.statusChangeEvent;
      statusChangeEvent && statusChangeEvent(this.state.searchInfo.status);
      this.setStateEve();
    }
    /* 默认右侧区域dom */

  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "modalBody",
        ref: "modalBody"
      }, Object(index_["isFunction"])(this.props.replaceAdvBody) && this.props.replaceAdvBody(), !Object(index_["isFunction"])(this.props.replaceAdvBody) && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "modalBodyBox"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "leftArea",
        fieldid: Object(index_["getSysFieldid"])('left_area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tabs"], {
        defaultActiveKey: "1",
        onChange: this.tabChange.bind(this),
        activeKey: this.state.leftTab,
        tabBarStyle: "noborder",
        className: "searchTabStyle"
      }, !this.props.hideSearchCondition &&
      /*#__PURE__*/
      // <NCTabPane tab={this.multiLang['page-search-0004']} key="1">
      external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCTabPane, {
        tab: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: this.state.leftTab == '1' && 'tab-label-in'
        }, this.multiLang['page-search-0004']),
        key: "1"
      }, this.props.syncTree.createSyncTree({
        treeId: this.props.moduleId,
        showLine: false,
        neverDisable: true,
        expandedKeys: ['root'],
        onDoubleClickEve: this.clickRight,
        // metaId:'treeForm',  // 树模板的id
        needEdit: false,
        //是否需要编辑节点功能，默认为true,可编辑；false：不可编辑
        draggable: true,
        searchType: 'filtration',
        nodeRightOpt: this.state.searchInfo.status === 'normal' ? {
          icon: 'uf-triangle-right',
          callback: this.clickRight
        } : false
      })), !this.props.hideSearchPlan && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCTabPane, {
        tab: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: this.state.leftTab == '2' && 'tab-label-in'
        }, this.multiLang['page-search-0005']),
        key: "2" // key={this.state.planTabKey}

      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", {
        className: "searchPlanUl"
      }, this.createSearchPlan())))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "rightArea",
        fieldid: Object(index_["getSysFieldid"])('rigit_area'),
        style: {
          overflow: Object(index_["isFunction"])(this.props.replaceRightBody) ? 'auto' : 'hidden'
        }
      }, Object(index_["isFunction"])(this.props.replaceRightBody) && this.props.replaceRightBody(), !Object(index_["isFunction"])(this.props.replaceRightBody) && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "clearData",
        onClick: this.clearAdvValue
      }, this.multiLang['page-search-0017']), !Object(index_["isFunction"])(this.props.replaceRightBody) && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tabs"], {
        style: {
          height: '100%'
        },
        className: "lucia",
        onChange: this.tabOnChange.bind(this),
        activeKey: this.tabIndex || '0'
      }, this.createRightDom().map(function (e, i) {
        if (e.defaultOpen === true && _this3.defaultOpen) {
          // this.tabIndex = String(i);
          _this3.defaultOpen = false;
        }

        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(NCTabPane, {
          tab: e.name,
          key: i
        }, e.content);
      }, this)))), !Object(index_["isEmpty"])(this.multiLang) && this.props.modal.createModal('editSearchPlanName@' + this.props.moduleId, {
        title: this.multiLang['page-search-0082'],
        content: this.modalContent.call(this, 'edit'),
        beSureBtnClick: _methods_beSureBtnClick.bind(this, 'edit'),
        leftBtnName: this.multiLang['page-search-0009'],
        rightBtnName: this.multiLang['page-search-0010'],
        zIndex: 310,
        onEntered: this.onInputFocus,
        size: 'sm',
        className: 'search-modal'
      }), !Object(index_["isEmpty"])(this.multiLang) && this.props.modal.createModal('addSearchPlan@' + this.props.moduleId, {
        title: this.multiLang['page-search-0081'],
        content: this.modalContent.call(this, 'add'),
        size: 'sm',
        backdrop: 'static',
        beSureBtnClick: _methods_beSureBtnClick.bind(this, 'add'),
        leftBtnName: this.multiLang['page-search-0009'],
        rightBtnName: this.multiLang['page-search-0010'],
        zIndex: 310,
        onEntered: this.onInputFocus,
        className: 'search-modal'
      }));
    }
  }]);

  return SearchAdvCom;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/CreateSearch/SearchAdvModal.js
function SearchAdvModal_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { SearchAdvModal_typeof = function _typeof(obj) { return typeof obj; }; } else { SearchAdvModal_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return SearchAdvModal_typeof(obj); }

function SearchAdvModal_extends() { SearchAdvModal_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return SearchAdvModal_extends.apply(this, arguments); }

function SearchAdvModal_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function SearchAdvModal_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function SearchAdvModal_createClass(Constructor, protoProps, staticProps) { if (protoProps) SearchAdvModal_defineProperties(Constructor.prototype, protoProps); if (staticProps) SearchAdvModal_defineProperties(Constructor, staticProps); return Constructor; }

function SearchAdvModal_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) SearchAdvModal_setPrototypeOf(subClass, superClass); }

function SearchAdvModal_setPrototypeOf(o, p) { SearchAdvModal_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return SearchAdvModal_setPrototypeOf(o, p); }

function SearchAdvModal_createSuper(Derived) { var hasNativeReflectConstruct = SearchAdvModal_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = SearchAdvModal_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = SearchAdvModal_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return SearchAdvModal_possibleConstructorReturn(this, result); }; }

function SearchAdvModal_possibleConstructorReturn(self, call) { if (call && (SearchAdvModal_typeof(call) === "object" || typeof call === "function")) { return call; } return SearchAdvModal_assertThisInitialized(self); }

function SearchAdvModal_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function SearchAdvModal_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function SearchAdvModal_getPrototypeOf(o) { SearchAdvModal_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return SearchAdvModal_getPrototypeOf(o); }

/*
 * @Author: summer
 * @Date: 2019-08-07 13:32:42
 * @LastEditTime: 2020-08-04 13:55:37
 * @LastEditors: wanglongx
 * @Description: 
 */

/*
*   查询区高级查询弹出框组件  --wangshhj
* */






__webpack_require__(929);

var SearchAdvModal_SearchAdvModal = /*#__PURE__*/function (_Component) {
  SearchAdvModal_inherits(SearchAdvModal, _Component);

  var _super = SearchAdvModal_createSuper(SearchAdvModal);

  function SearchAdvModal(props) {
    var _this;

    SearchAdvModal_classCallCheck(this, SearchAdvModal);

    _this = _super.call(this, props);
    _this.state = {
      position: null
    };

    _this.backPosition = function () {
      _this.setState({
        position: {
          x: 0,
          y: 0
        }
      });
    };

    _this.handStart = function (a, b) {
      _this.setState({
        position: {
          x: b.x,
          y: b.y
        }
      });
    };

    _this.handleStop = function (a, b) {
      _this.setState({
        position: {
          x: b.x,
          y: b.y
        }
      });
    };

    _this.getChildrenRef = function (ref) {
      if (ref) {
        _this.savePlanFun = ref.saveSearchPlanClick;
        _this.queryFun = ref.searchBtnClickEve;
        _this.cancelClick = ref.cancelClick;
        _this.addPlanFun = ref.addSearchPlanClick;
      }
    };

    return _this;
  }

  SearchAdvModal_createClass(SearchAdvModal, [{
    key: "componentDidMount",
    value: function componentDidMount() {}
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(props) {}
  }, {
    key: "getFunction",
    value: function getFunction(savePlanFun, queryFun, cancelClick, addPlanFun) {// this.savePlanFun = savePlanFun;
      // this.queryFun = queryFun;
      // this.cancelClick = cancelClick;
      // this.addPlanFun = addPlanFun;
    } // 从新回到原来位置

  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          multiLang = _this$props.multiLang,
          searchModalTitle = _this$props.searchModalTitle,
          fieldid = _this$props.fieldid; // 业务组传入  title 

      var title = searchModalTitle || multiLang['page-search-0025'];
      return /*#__PURE__*/external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.createPortal( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "NC_searchAdvModalBox ".concat(this.props.className, " search_").concat(this.props.moduleId)
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          colse: base_index_["HotKeys"].USUAL_KEYS.ICON_CLOSE
        },
        handlers: {
          colse: this.props.searchInfo.status === 'normal' ? function () {
            _this2.cancelClick();
          } : function () {}
        },
        className: "close-hotkeys-wrapper",
        focused: true,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "NC_searchAdvModalBackground"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "NC_searchAdvModal",
        fieldid: Object(index_["getSysFieldid"])(fieldid) ? "".concat(fieldid, "-search_modal-area") : "search_modal-area"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Dnd"], {
        handle: ".super-handle",
        cancel: ".super-cancel",
        position: this.state.position // onStart = {this.handStart}
        ,
        onStop: this.handleStop,
        bounds: ".search_".concat(this.props.moduleId)
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "NC_searchAdvModal_drag"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "modalHead super-handle",
        fieldid: Object(index_["getSysFieldid"])('header-area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("img", {
        src: __webpack_require__(411),
        className: "modal-header-img"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        fieldid: Object(index_["getSysFieldid"])("".concat(title, "_title")),
        className: "modalTitle"
      }, title), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "closeBtn iconfont icon-guanbi super-cancel",
        onClick: function onClick() {
          _this2.cancelClick();
        },
        title: "Esc"
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(SearchAdvCom_SearchAdvCom, SearchAdvModal_extends({
        ref: this.getChildrenRef
      }, this.props, {
        backPosition: this.backPosition
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "modalFooter",
        fieldid: Object(index_["getSysFieldid"])('bottom-area')
      }, this.props.showAdvSearchPlanBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "saveSearchPlan"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: function onClick() {
          _this2.savePlanFun();
        },
        shape: "border" //colors="danger"
        ,
        className: "secondary-button secondary-button-wrapper footer-button-left",
        fieldid: "savePlan"
      }, multiLang['page-search-0008']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: function onClick() {
          _this2.addPlanFun();
        },
        shape: "border" //colors="danger"//
        ,
        className: "secondary-button secondary-button-wrapper footer-button-right",
        fieldid: "addPlan"
      }, multiLang['page-search-0081'])), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "searchBtnGroup"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "searchBtn search-btn-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: function onClick() {
          _this2.queryFun();
        },
        colors: "danger",
        fieldid: "search",
        className: "button-primary button-primary-wrapper "
      }, this.props.searchBtnName || multiLang['page-search-0001'])), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "cancelBtn search-btn-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: function onClick() {
          _this2.cancelClick();
        },
        shape: "border",
        fieldid: "cancel",
        className: "secondary-button secondary-button-wrapper"
      }, multiLang['page-search-0010']))))))))), document.body);
    }
  }]);

  return SearchAdvModal;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// EXTERNAL MODULE: ./src/platform/base/DatePickerTimeZoneConversion/dateFunction.js
var dateFunction = __webpack_require__(83);

// CONCATENATED MODULE: ./src/platform/components/CreateSearch/item.js
function item_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { item_typeof = function _typeof(obj) { return typeof obj; }; } else { item_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return item_typeof(obj); }

function item_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function item_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function item_createClass(Constructor, protoProps, staticProps) { if (protoProps) item_defineProperties(Constructor.prototype, protoProps); if (staticProps) item_defineProperties(Constructor, staticProps); return Constructor; }

function item_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) item_setPrototypeOf(subClass, superClass); }

function item_setPrototypeOf(o, p) { item_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return item_setPrototypeOf(o, p); }

function item_createSuper(Derived) { var hasNativeReflectConstruct = item_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = item_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = item_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return item_possibleConstructorReturn(this, result); }; }

function item_possibleConstructorReturn(self, call) { if (call && (item_typeof(call) === "object" || typeof call === "function")) { return call; } return item_assertThisInitialized(self); }

function item_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function item_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function item_getPrototypeOf(o) { item_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return item_getPrototypeOf(o); }

/*
 * @Author: wanglongx
 * @Date: 2019-05-10 10:39:14
 * @LastEditors: wanglongx
 * @desc 外层方案修改
 * @LastEditTime: 2020-08-04 13:49:09
 */


 // query items 



var item_Item = /*#__PURE__*/function (_Component) {
  item_inherits(Item, _Component);

  var _super = item_createSuper(Item);

  function Item(props) {
    var _this;

    item_classCallCheck(this, Item);

    _this = _super.call(this, props);
    _this.state = {
      value: _this.props.value,
      showFlag: true
    };

    _this.handleChange = function (v) {
      _this.setState({
        value: v
      });
    };

    _this.handleConfirm = function (e) {
      var _this$props = _this.props,
          searchInfo = _this$props.searchInfo,
          multiLang = _this$props.multiLang,
          value = _this$props.value,
          editSearchPlan = _this$props.editSearchPlan,
          beSureBtnClick = _this$props.beSureBtnClick;

      if (e) {
        e.stopPropagation();
      }

      if (_this.state.value === value) {
        _this.setState({
          showFlag: true
        });

        return;
      } else if (searchInfo.searchPlanCache.find(function (item) {
        return item.name === _this.state.value;
      }) !== undefined) {
        {
          Object(index_["toast"])({
            content: multiLang['page-search-0083'],
            color: 'warning'
          });
        }

        _this.setState({
          showFlag: false
        });

        return;
      } else if (_this.state.value.replace(/\s+/g, '') === '') {
        {
          Object(index_["toast"])({
            content: multiLang['page-search-0032'],
            color: 'warning'
          });
        }

        _this.setState({
          showFlag: false
        });

        return;
      }

      _this.setState({
        showFlag: true
      });

      editSearchPlan(_this.state.value);
      beSureBtnClick();
    };

    return _this;
  }

  item_createClass(Item, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps, nextState) {
      var searchInfo = nextProps.searchInfo;

      if (searchInfo.showFlag) {
        this.setState({
          showFlag: true
        });
      }

      if ('value' in nextProps) {
        this.setState({
          value: nextProps.value
        });
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props2 = this.props,
          chooseSearchPlan = _this$props2.chooseSearchPlan,
          item = _this$props2.item,
          searchAdvBtnClick = _this$props2.searchAdvBtnClick,
          delSearchPlan = _this$props2.delSearchPlan,
          multiLang = _this$props2.multiLang,
          searchInfo = _this$props2.searchInfo,
          value = _this$props2.value;
      var current = searchInfo.currentPlan || searchInfo.defaultPlan;
      var currentPlan = current.name;
      var currentpk = current.pk_ncc_queryscheme;
      var iconClass = classnames_default()({
        'icon-disable': item.isMyPlan || item.isquickqs
      });
      var itemClass = classnames_default()({
        'item-current': currentPlan == value
      });
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "query_item ".concat(itemClass)
      }, this.state.showFlag ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "search_planName",
        onClick: chooseSearchPlan
      }, this.state.value, "\xA0\xA0", currentPlan == this.state.value && currentpk == this.props.item.pk_ncc_queryscheme ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "iconfont icon-shenpitongguo"
      }) : null) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          high: ['enter']
        },
        handlers: {
          high: this.handleConfirm
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        className: "search_input",
        autoFocus: true,
        value: this.state.value,
        onClick: function onClick(e) {
          e.stopPropagation();
        },
        onChange: function onChange(v) {
          _this2.setState({
            value: v
          });
        }
      })), this.state.showFlag ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "search-plan-set"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        delayShow: 800,
        inverse: true,
        delayHide: 1,
        overlay: multiLang['page-search-0092'],
        placement: "top"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "iconfont icon-cxzhongmingming ".concat(iconClass),
        onClick: function onClick(e) {
          e.stopPropagation();
          if (item.isMyPlan || item.isquickqs) return;

          _this2.setState({
            showFlag: !_this2.state.showFlag
          });
        }
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        delayShow: 800,
        inverse: true,
        delayHide: 1,
        overlay: multiLang['page-search-0093'],
        placement: "top"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "iconfont icon-cxxiugai",
        onClick: searchAdvBtnClick
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        delayShow: 800,
        delayHide: 1,
        inverse: true,
        overlay: multiLang['page-search-0094'],
        placement: "top"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "iconfont icon-cxshanchu ".concat(iconClass),
        onClick: function onClick(e) {
          e.stopPropagation();
          if (item.isMyPlan || item.isquickqs) return;
          delSearchPlan();
        }
      }))) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "search-list-button"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "button-item right",
        onClick: this.handleConfirm
      }, multiLang['page-search-0009']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "button-item left",
        onClick: function onClick(e) {
          e.stopPropagation();

          _this2.setState({
            showFlag: true,
            value: _this2.props.value
          });
        }
      }, multiLang['page-search-0010'])));
    }
  }]);

  return Item;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// EXTERNAL MODULE: ./src/platform/components/WithAutoFocus/executeAutoFocus.js
var executeAutoFocus = __webpack_require__(22);

// CONCATENATED MODULE: ./src/platform/components/WithAutoFocus/searchWithAutoFocus.js
function searchWithAutoFocus_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { searchWithAutoFocus_typeof = function _typeof(obj) { return typeof obj; }; } else { searchWithAutoFocus_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return searchWithAutoFocus_typeof(obj); }

function searchWithAutoFocus_extends() { searchWithAutoFocus_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return searchWithAutoFocus_extends.apply(this, arguments); }

function searchWithAutoFocus_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function searchWithAutoFocus_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function searchWithAutoFocus_createClass(Constructor, protoProps, staticProps) { if (protoProps) searchWithAutoFocus_defineProperties(Constructor.prototype, protoProps); if (staticProps) searchWithAutoFocus_defineProperties(Constructor, staticProps); return Constructor; }

function searchWithAutoFocus_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) searchWithAutoFocus_setPrototypeOf(subClass, superClass); }

function searchWithAutoFocus_setPrototypeOf(o, p) { searchWithAutoFocus_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return searchWithAutoFocus_setPrototypeOf(o, p); }

function searchWithAutoFocus_createSuper(Derived) { var hasNativeReflectConstruct = searchWithAutoFocus_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = searchWithAutoFocus_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = searchWithAutoFocus_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return searchWithAutoFocus_possibleConstructorReturn(this, result); }; }

function searchWithAutoFocus_possibleConstructorReturn(self, call) { if (call && (searchWithAutoFocus_typeof(call) === "object" || typeof call === "function")) { return call; } return searchWithAutoFocus_assertThisInitialized(self); }

function searchWithAutoFocus_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function searchWithAutoFocus_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function searchWithAutoFocus_getPrototypeOf(o) { searchWithAutoFocus_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return searchWithAutoFocus_getPrototypeOf(o); }

/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-10-10 09:56:58
 * @LastEditors: bbq
 * @LastEditTime: 2021-03-05 15:47:43
 */




function SearchWithAutoFocus(WrappedComponent) {
  var _temp;

  return _temp = /*#__PURE__*/function (_Component) {
    searchWithAutoFocus_inherits(WithAutoFocus, _Component);

    var _super = searchWithAutoFocus_createSuper(WithAutoFocus);

    function WithAutoFocus() {
      var _this;

      searchWithAutoFocus_classCallCheck(this, WithAutoFocus);

      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      _this = _super.call.apply(_super, [this].concat(args));
      _this.state = {
        isPass: true
      };
      return _this;
    }

    searchWithAutoFocus_createClass(WithAutoFocus, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        var _this2 = this;

        var _this$props = this.props,
            areaId = _this$props.areaId,
            name = _this$props.name;
        this.searchRequiredToken = index_["PubSub"].subscribe('searchRequired', function (msg, data) {
          var selector = '';

          if (Array.isArray(data) && data.includes(name)) {
            // 如果没有获取到对应的itemtype 就统一用normal来处理， 如果碰到特殊的就在往matchItemFocus里加
            _this2.setState({
              isPass: false
            });

            if (name === data[0]) {
              selector = "".concat(areaId ? '#' + areaId : '', " [hotkeytag=\"searchArea-").concat(data[0], "\"]"); // console.log(selector);

              executeAutoFocus["a" /* matchItemFocus */][_this2.props.itemtype] === undefined ? executeAutoFocus["a" /* matchItemFocus */]['normal'](selector) : executeAutoFocus["a" /* matchItemFocus */][_this2.props.itemtype](selector);
            }
          } else if (data === name) {
            _this2.setState({
              isPass: false
            });

            selector = "".concat(areaId ? '#' + areaId : '', " [hotkeytag=\"searchArea-").concat(data, "\"]"); // console.log(selector);

            executeAutoFocus["a" /* matchItemFocus */][_this2.props.itemtype] === undefined ? executeAutoFocus["a" /* matchItemFocus */]['normal'](selector) : executeAutoFocus["a" /* matchItemFocus */][_this2.props.itemtype](selector);
          }
        });
        this.clearWarningToken = index_["PubSub"].subscribe('clearWarning', function (msg, data) {
          if (Array.isArray(data) && data.includes(name)) {
            _this2.setState({
              isPass: true
            });
          } else if (name == data) {
            _this2.setState({
              isPass: true
            });
          }
        });
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        this.searchRequiredToken && index_["PubSub"].subscribe(this.searchRequiredToken);
        this.clearWarningToken && index_["PubSub"].subscribe(this.clearWarningToken);
        this.dom = null;
      }
    }, {
      key: "render",
      value: function render() {
        var _this3 = this;

        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(WrappedComponent, searchWithAutoFocus_extends({
          ref: function ref(dom) {
            _this3.dom = dom;
          }
        }, this.props, {
          isPass: this.state.isPass
        }));
      }
    }]);

    return WithAutoFocus;
  }(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]), _temp;
}

/* harmony default export */ var searchWithAutoFocus = (SearchWithAutoFocus);
// CONCATENATED MODULE: ./src/platform/components/CreateSearch/searchItem.js
function searchItem_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { searchItem_typeof = function _typeof(obj) { return typeof obj; }; } else { searchItem_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return searchItem_typeof(obj); }

var _class;

function searchItem_extends() { searchItem_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return searchItem_extends.apply(this, arguments); }

function searchItem_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = searchItem_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function searchItem_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function searchItem_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function searchItem_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function searchItem_createClass(Constructor, protoProps, staticProps) { if (protoProps) searchItem_defineProperties(Constructor.prototype, protoProps); if (staticProps) searchItem_defineProperties(Constructor, staticProps); return Constructor; }

function searchItem_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) searchItem_setPrototypeOf(subClass, superClass); }

function searchItem_setPrototypeOf(o, p) { searchItem_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return searchItem_setPrototypeOf(o, p); }

function searchItem_createSuper(Derived) { var hasNativeReflectConstruct = searchItem_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = searchItem_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = searchItem_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return searchItem_possibleConstructorReturn(this, result); }; }

function searchItem_possibleConstructorReturn(self, call) { if (call && (searchItem_typeof(call) === "object" || typeof call === "function")) { return call; } return searchItem_assertThisInitialized(self); }

function searchItem_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function searchItem_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function searchItem_getPrototypeOf(o) { searchItem_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return searchItem_getPrototypeOf(o); }

/*
 * @Author: wanglongx
 * @Date: 2019-05-13 14:30:27
 * @LastEditors: bbq
 * @desc 处理 查询时必填项获取光标
 * @LastEditTime: 2021-03-05 15:25:25
 */




var searchItem_SearchItem = searchWithAutoFocus(_class = /*#__PURE__*/function (_Component) {
  searchItem_inherits(SearchItem, _Component);

  var _super = searchItem_createSuper(SearchItem);

  function SearchItem() {
    searchItem_classCallCheck(this, SearchItem);

    return _super.apply(this, arguments);
  }

  searchItem_createClass(SearchItem, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          dom = _this$props.dom,
          isPass = _this$props.isPass,
          className = _this$props.className,
          others = searchItem_objectWithoutProperties(_this$props, ["dom", "isPass", "className"]);

      var verify = classnames_default()({
        un_pass: !isPass
      });
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", searchItem_extends({}, others, {
        className: "".concat(className, " ").concat(verify)
      }), dom);
    }
  }]);

  return SearchItem;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"])) || _class;


// CONCATENATED MODULE: ./src/platform/components/CreateSearch/searchComponent.js
function searchComponent_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { searchComponent_typeof = function _typeof(obj) { return typeof obj; }; } else { searchComponent_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return searchComponent_typeof(obj); }

function searchComponent_extends() { searchComponent_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return searchComponent_extends.apply(this, arguments); }

function searchComponent_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function searchComponent_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { searchComponent_ownKeys(Object(source), true).forEach(function (key) { searchComponent_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { searchComponent_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function searchComponent_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function searchComponent_toConsumableArray(arr) { return searchComponent_arrayWithoutHoles(arr) || searchComponent_iterableToArray(arr) || searchComponent_unsupportedIterableToArray(arr) || searchComponent_nonIterableSpread(); }

function searchComponent_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function searchComponent_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return searchComponent_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return searchComponent_arrayLikeToArray(o, minLen); }

function searchComponent_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function searchComponent_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return searchComponent_arrayLikeToArray(arr); }

function searchComponent_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function searchComponent_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function searchComponent_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function searchComponent_createClass(Constructor, protoProps, staticProps) { if (protoProps) searchComponent_defineProperties(Constructor.prototype, protoProps); if (staticProps) searchComponent_defineProperties(Constructor, staticProps); return Constructor; }

function searchComponent_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) searchComponent_setPrototypeOf(subClass, superClass); }

function searchComponent_setPrototypeOf(o, p) { searchComponent_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return searchComponent_setPrototypeOf(o, p); }

function searchComponent_createSuper(Derived) { var hasNativeReflectConstruct = searchComponent_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = searchComponent_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = searchComponent_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return searchComponent_possibleConstructorReturn(this, result); }; }

function searchComponent_possibleConstructorReturn(self, call) { if (call && (searchComponent_typeof(call) === "object" || typeof call === "function")) { return call; } return searchComponent_assertThisInitialized(self); }

function searchComponent_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function searchComponent_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function searchComponent_getPrototypeOf(o) { searchComponent_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return searchComponent_getPrototypeOf(o); }

/**
 * Created by wangshhj on 2018/1/11.  本地 xuyang updata
 * 说明 E8PyA2FlmQx8
 * 查询区组件的核心数据存在 this.state.searchInfo内。
 * 查询区内部存在4个状态,simple：简单查询，plan:查询方案，nomarl：普通，super:高级 ,存在 this.state.searchInfo.status。
 * 查询区用户输入的数据（主要是value和 操作符数据）存在 this.state.searchInfo.snapshotMap里面，它有四个属性对应四个状态（simple，plan，nomarl,super）
 */

 // import { moment } from '@platform/api';

 // import { setTimeout } from 'timers';








 // import toast from '../../api/toast';
// import { getMultiLang } from '../GetMultiLang';
// import { localeLang } from '../../public/currentLocale';
// import ViewModel from '../../shell/viewmodel/viewmodel';

 // import getSysFieldid from '../../api/getSysFieldid';
// 外层方案

 // 查询区每一项

 // import searchOpen from '../../../public/static/images/searchOpen.png';
// import searchClose from '../../../public/static/images/searchClose.png';

__webpack_require__(928); // 查询区渲染完成发布订阅标识


var searchComponent_BEFORECOMPLETE = 'beforeAreaChangeComplete';
var searchComponent_COMPLETE = 'areaChangeComplete';
var INITNUM = 5;
var ConstSearchInfo = {};
var searchPlanId = 'search@plan';

var searchComponent_SearchComponent = /*#__PURE__*/function (_Component) {
  searchComponent_inherits(SearchComponent, _Component);

  var _super = searchComponent_createSuper(SearchComponent);

  function SearchComponent(props) {
    var _this;

    searchComponent_classCallCheck(this, SearchComponent);

    _this = _super.call(this, props);
    _this.completeFlag = true;
    _this.state = {
      searchInfo: {},
      json: {},
      LangData: null,
      leftTab: '1',
      isRenderAdv: false
    };

    _this.props.get_this(searchComponent_assertThisInitialized(_this)); //把当前this 注册到全局this去


    _this._this = _this.props.getGloablThis();
    _this.meta = _this._this.state.meta[_this.props.id];
    _this.preHandlerFlag = true;
    _this.searchAreaHeight = 0;
    return _this;
  }

  searchComponent_createClass(SearchComponent, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      var meta = this.meta;
      var that = this;

      if (this.completeFlag) {
        var renderCompleteEvent = this.props.renderCompleteEvent; // 发布通知表格更新高度

        index_["PubSub"].publish(searchComponent_COMPLETE, true);
        setTimeout(function () {
          if (that.completeFlag && !Object(index_["isEmpty"])(meta)) {
            that._this.infoExchangeController.publish('heightChange', {
              area: 'searchArea'
            });

            renderCompleteEvent && renderCompleteEvent('');
            that.completeFlag = false;
          }
        });
      }
    } // componentWillUpdate(){
    //     let meta = this.meta;
    //     let that = this;
    //     if (this.completeFlag) {
    //         let renderCompleteEvent = this.props.renderCompleteEvent;
    //         // 发布通知表格更新高度
    //         PubSub.publish(COMPLETE, true);
    //         setTimeout(() => {
    //             if (that.completeFlag && !isEmpty(meta)) {
    //                 that._this.infoExchangeController.publish('heightChange', { area: 'searchArea' });
    //                 renderCompleteEvent && renderCompleteEvent('');
    //                 that.completeFlag = false;
    //             }
    //         });
    //     }
    // }

  }, {
    key: "render",
    value: function render() {
      return NCCreateSearch.call(this, this.props);
    } //WARNING! To be deprecated in React v17. Use new lifecycle static getDerivedStateFromProps instead.

  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      // 说明切换查询区了 by liyxt
      if (this.props.id !== nextProps.id) {
        this.completeFlag = true;
        nextProps.get_this(this); //把当前this 注册到全局this去

        this.meta = Object(index_["deepClone"])(this._this.state.meta[nextProps.id]); // console.log(this.meta);
      } else {
        this.meta = this._this.state.meta[nextProps.id];
      }

      if (!this.state.searchInfo.showAdvModal) {
        initSearchArea.call(this, nextProps, this.state.searchInfo);
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      if (this.searchDom) {
        // if (this.state.searchInfo.status == 'simple') {
        //     this.state.searchInfo.currentPlan.renderobj4web_snap = this.state.searchInfo.snapshotMap.simple;
        //     this.state.searchInfo.searchPlanSnap[this.state.searchInfo.currentPlan.pk_ncc_queryscheme] = this.state.searchInfo.currentPlan;
        // }
        if (this.searchAreaHeight !== this.searchDom.offsetHeight) {
          // 发布通知表格更新高度
          index_["PubSub"].publish(searchComponent_COMPLETE, true);
          this.searchAreaHeight = this.searchDom.offsetHeight; // if (this.completeFlag) {
          //     let renderCompleteEvent = this.props.renderCompleteEvent;
          //     renderCompleteEvent && renderCompleteEvent('');
          //     this.completeFlag = false;
          // }
        }
      }
    }
  }, {
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      initSearchArea.call(this, this.props, this.state.searchInfo); // 初始化调用getMultiLang方法获取多语

      var callback = function callback(json, bool, LangData) {
        _this2.setState({
          json: json,
          LangData: LangData
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'page_search',
        callback: callback
      }); // moduleId为所需加载json文件夹名称前缀

      if (this.props.useCache) {
        var searchInfo = index_["ViewModel"].getData("search_".concat(this.meta.oid || this.props.id));

        if (searchInfo) {
          this.setState({
            searchInfo: searchInfo
          });
        }
      }
    } // componentDidMount() {
    //     //解决NCC-38603问题
    //     PubSub.publish(COMPLETE, true);
    // }

  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      // this.props.remove_this();
      // if(this.meta&&this.meta.queryschemes)
      // 	this.meta.queryschemes.splice(0,1);
      this.completeFlag = true;

      if (this.props.useCache) {
        index_["ViewModel"].setData("search_".concat(this.meta.oid || this.props.id), this.state.searchInfo);
      }

      index_["PubSub"].publish(searchComponent_COMPLETE, true); // 移除 pubsub 事件监听

      index_["PubSub"].unsubscribe('searchRequired');
      index_["PubSub"].unsubscribe('clearWarning');
    }
  }]);

  return SearchComponent;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);



function initSearchArea(props, info) {
  var statusList = ['simple', 'normal', 'super'];
  var flag = false; //标识是否是第一次初始化

  info.status = props.onlyShowAdvArea ? 'normal' : 'simple';
  info.itemsMap = {};
  var meta = this.meta;
  meta.items.forEach(function (item) {
    return info.itemsMap[item.attrcode] = item;
  }); // info.snapshotCache = {};

  info.snapshotMap = {};
  statusList.forEach(function (item) {
    info.snapshotMap[item] = []; // info.snapshotCache[item] = {};
  }); //如果没有高级就一直展开，如果有高级就按照isunfold为true展开

  info.showSearchItems = !meta.isunfold;
  info.showSearchItems = props.showAdvBtn ? info.showSearchItems : false; //根据模板先把快照初始化出来，然后再根据方案缓存把快照恢复，主要是value

  var defaultRenderobj4web = initDefaultSnapshot.call(this, meta.items, props.context, props.isTemplateOrder);
  info.fixedConditionGroup = defaultRenderobj4web.filter(function (item) {
    return item.isExtend;
  }) || [];
  info.defaultPlan = {
    pk_ncc_queryscheme: '001',
    isMyPlan: true,
    name: '预置方案',
    renderobj4web: defaultRenderobj4web // renderobj4web_snap: spreadQueryPlan(defaultRenderobj4web),//方案快照，页面显示的内容，用户的操作都存在方案的快照中，每次更新都根据都根据模板和shang

  };
  var conditions;
  info.searchPlanCache = [info.defaultPlan].concat(searchComponent_toConsumableArray(meta.queryschemes || []));

  if (meta.queryschemes) {
    meta.queryschemes.forEach(function (item) {
      if (item.isquickqs) {
        conditions = item;
      } // if (item.renderobj4web && item.renderobj4web.length && item.renderobj4web[0].refpk === 'root') {
      //     let superSnap = [...info.fixedConditionGroup, ...item.renderobj4web[0].children];
      //     item.renderobj4web_snap = spreadQueryPlan(superSnap);
      // } else {
      //     let normalSnap = [...info.fixedConditionGroup, item.renderobj4web];
      //     item.renderobj4web_snap = spreadQueryPlan(normalSnap);
      // }

    });
  }

  if (!info.hasOwnProperty('moduletype')) {
    info.snapshotCache = {};
    statusList.forEach(function (item) {
      info.snapshotCache[item] = {};
    });
    info.moduletype = 'search';
  } //用于存储 查询区的基本状态 用于重置


  if (!ConstSearchInfo.hasOwnProperty(props.id)) {
    // info.searchPlanSnap = {};
    info.showAdvModal = false; // 高级面板的显隐性

    info.showSearchPlan = false; // 显示查询方案

    ConstSearchInfo[props.id] = {};
  }

  if (!info.isCompleted) {
    if (conditions) {
      // info.snapshotMap[info.status] = info.fixedConditionGroup.concat(conditions.renderobj4web_snap);
      // 快速方案添加到 当前方案
      info.currentPlan = conditions; // info.isDefaultPlan = false;
    } else {
      info.currentPlan = info.defaultPlan; // info.isDefaultPlan = true;
    }
  }

  if (info.currentPlan.isMyPlan) {
    var prev = '';
    var next = ''; //预制方案

    info.currentPlan.renderobj4web.forEach(function (item) {
      return prev = prev + item.attrcode;
    });
    info.defaultPlan.renderobj4web.forEach(function (item) {
      return next = next + item.attrcode;
    }); //模板变了

    if (prev != next) {
      info.currentPlan = info.defaultPlan;
    }
  } else {
    var plan = info.searchPlanCache.find(function (item) {
      return item.pk_ncc_queryscheme == info.currentPlan.pk_ncc_queryscheme;
    }); //说明查询区的查询方案变了

    if (!plan) {
      info.currentPlan = info.defaultPlan;
    }
  }

  info.isDefaultPlan = info.currentPlan.pk_ncc_queryscheme == '001'; //初始化并恢复快照

  initSimpleSnap(props.context, info, info.currentPlan); // info.snapshotMap['simple'] = recoverCurrentSnap(info.currentPlan, info.searchPlanSnap);

  info.snapshotMap['simple'] = info.currentPlan.renderobj4web_snap;

  if (!info.hasOwnProperty('isCompleted')) {
    info.isCompleted = true;
    flag = true;
  }

  if (flag) {
    Object(index_["isFunction"])(props.setInitValueEvent) && props.setInitValueEvent('simple');
  }
} // 展开查询方案 并处理成 快照


function spreadQueryPlan(context, planItems, temItem) {
  var level = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

  if (Array.isArray(planItems)) {
    return planItems.map(function (item) {
      if (Array.isArray(item.children)) {
        item.children = spreadQueryPlan(context, item.children, temItem, ++level);
        return item;
      } else {
        var initialvalue = {
          value: '',
          display: ''
        };

        if (!Object(index_["isEmpty"])(item.initialvalue)) {
          // initialvalue = { ...initialvalue, ...item.initialvalue };
          initialvalue.value = item.initialvalue.value;
          initialvalue.display = item.initialvalue.display;
        }

        item.initialvalue = item.initialvalue || item.value; //此处是为了兼容老版本代码的value 已经变成initialvalue了

        var tempItem = temItem[item.attrcode]; // let temItem = searchInfo.itemsMap;

        if (tempItem) {
          if (tempItem.itemtype === 'checkbox_switch') {
            if (item.initialvalue && item.initialvalue.value === '') {
              item.initialvalue.value = false;
            }
          } else if (tempItem.itemtype === 'refer' && item.initialvalue) {
            var refervalue = getFunctionValueFromViewModal(item.initialvalue, context);
            item.initialvalue.display = refervalue.display || item.initialvalue.display;
          } else if (tempItem.itemtype === 'residtxt') {
            var _tempItem$languageMet;

            var index = ((_tempItem$languageMet = tempItem.languageMeta.filter(function (val) {
              return val.languageCode == index_["localeLang"];
            })[0]) === null || _tempItem$languageMet === void 0 ? void 0 : _tempItem$languageMet.index) || 1;
            initialvalue.index = index;

            if (item.initialvalue && !item.initialvalue.hasOwnProperty('index')) {
              item.initialvalue.index = index;
            }
          }

          var obj = {
            attrcode: item.attrcode,
            initialvalue: initialvalue,
            operationSign: item.operationSign || (item.queryOperateType ? item.queryOperateType.split('@')[0] : ''),
            visible: item.visible === false ? item.visible : tempItem.visible,
            isExtend: !!tempItem.isfixedcondition
          };

          if (tempItem.itemtype === 'residtxt') {
            if (!Object(index_["isEmpty"])(item.valueMap)) {
              obj.valueMap = item.valueMap;
            } else if (item.initialvalue && item.initialvalue.value) {
              obj.valueMap = {};
              obj.valueMap[item.attrcode + item.initialvalue.index] = {
                value: item.initialvalue.value
              };
            }
          } // if (tempItem.isfixedcondition && level < 2) {
          //     obj.visible = false;
          // }


          return obj;
        }
      }
    }).filter(function (obj) {
      return obj && obj.visible;
    });
  }
}

function recoverCurrentSnap(cerrentplan, searchPlanSnap) {
  if (searchPlanSnap[cerrentplan.pk_ncc_queryscheme]) {
    return searchPlanSnap[cerrentplan.pk_ncc_queryscheme].renderobj4web_snap;
  } else {
    return cerrentplan.renderobj4web_snap;
  }
}

function initSimpleSnap(context, info, currentPlan) {
  var flag = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
  if (!currentPlan) return;
  var isDefaultPlan = currentPlan.pk_ncc_queryscheme == '001';

  if (currentPlan.renderobj4web_snap && flag) {
    currentPlan.renderobj4web_snap = spreadQueryPlan(context, currentPlan.renderobj4web_snap, info.itemsMap);
  } else {
    if (isDefaultPlan) {
      currentPlan.renderobj4web_snap = spreadQueryPlan(context, info.defaultPlan.renderobj4web, info.itemsMap);
    } else {
      if (currentPlan.renderobj4web && currentPlan.renderobj4web.length && currentPlan.renderobj4web[0].refpk === 'root') {
        var superSnap = [].concat(searchComponent_toConsumableArray(info.fixedConditionGroup), searchComponent_toConsumableArray(currentPlan.renderobj4web[0].children));

        var currentPlanCopy = _clone(currentPlan);

        currentPlanCopy.renderobj4web[0].children = superSnap;
        currentPlan.renderobj4web_snap = spreadQueryPlan(context, currentPlanCopy.renderobj4web, info.itemsMap);
      } else {
        var normalSnap = [].concat(searchComponent_toConsumableArray(info.fixedConditionGroup), searchComponent_toConsumableArray(currentPlan.renderobj4web));
        currentPlan.renderobj4web_snap = spreadQueryPlan(context, normalSnap, info.itemsMap);
      }
    }
  }
}

function NCCreateSearch() {
  var _this3 = this;

  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
      id = _ref.id,
      clickSearchBtn = _ref.clickSearchBtn,
      _ref$searchBtnName = _ref.searchBtnName,
      searchBtnName = _ref$searchBtnName === void 0 ? '' : _ref$searchBtnName,
      onAfterEvent = _ref.onAfterEvent,
      _ref$showSearchBtn = _ref.showSearchBtn,
      showSearchBtn = _ref$showSearchBtn === void 0 ? true : _ref$showSearchBtn,
      _ref$showAdvBtn = _ref.showAdvBtn,
      showAdvBtn = _ref$showAdvBtn === void 0 ? true : _ref$showAdvBtn,
      _ref$showClearBtn = _ref.showClearBtn,
      showClearBtn = _ref$showClearBtn === void 0 ? true : _ref$showClearBtn,
      _ref$showAdvSearchPla = _ref.showAdvSearchPlanBtn,
      showAdvSearchPlanBtn = _ref$showAdvSearchPla === void 0 ? true : _ref$showAdvSearchPla,
      replaceAdvBtnEve = _ref.replaceAdvBtnEve,
      replaceAdvBody = _ref.replaceAdvBody,
      addAdvTabs = _ref.addAdvTabs,
      addAdvBody = _ref.addAdvBody,
      replaceRightBody = _ref.replaceRightBody,
      _ref$hideSearchCondit = _ref.hideSearchCondition,
      hideSearchCondition = _ref$hideSearchCondit === void 0 ? false : _ref$hideSearchCondit,
      _ref$hideSearchPlan = _ref.hideSearchPlan,
      hideSearchPlan = _ref$hideSearchPlan === void 0 ? false : _ref$hideSearchPlan,
      saveSearchPlan = _ref.saveSearchPlan,
      clickPlanEve = _ref.clickPlanEve,
      clickAdvBtnEve = _ref.clickAdvBtnEve,
      _ref$hideBtnArea = _ref.hideBtnArea,
      hideBtnArea = _ref$hideBtnArea === void 0 ? false : _ref$hideBtnArea,
      advSearchClearEve = _ref.advSearchClearEve,
      _ref$onlyShowSuperBtn = _ref.onlyShowSuperBtn,
      onlyShowSuperBtn = _ref$onlyShowSuperBtn === void 0 ? false : _ref$onlyShowSuperBtn,
      _ref$replaceSuperBtn = _ref.replaceSuperBtn,
      replaceSuperBtn = _ref$replaceSuperBtn === void 0 ? '' : _ref$replaceSuperBtn,
      onOperateTypeChange = _ref.onOperateTypeChange,
      _ref$onlyShowAdvArea = _ref.onlyShowAdvArea,
      onlyShowAdvArea = _ref$onlyShowAdvArea === void 0 ? false : _ref$onlyShowAdvArea,
      _ref$onlyShowModal = _ref.onlyShowModal,
      onlyShowModal = _ref$onlyShowModal === void 0 ? false : _ref$onlyShowModal,
      renderCompleteEvent = _ref.renderCompleteEvent,
      statusChangeEvent = _ref.statusChangeEvent,
      _ref$context = _ref.context,
      context = _ref$context === void 0 ? {} : _ref$context,
      _ref$renderItem = _ref.renderItem,
      renderItem = _ref$renderItem === void 0 ? {} : _ref$renderItem,
      _ref$createScript = _ref.createScript,
      createScript = _ref$createScript === void 0 ? function () {} : _ref$createScript,
      setInitValueEvent = _ref.setInitValueEvent,
      isSynInitAdvSearch = _ref.isSynInitAdvSearch,
      _ref$onlyShowPlan = _ref.onlyShowPlan,
      onlyShowPlan = _ref$onlyShowPlan === void 0 ? false : _ref$onlyShowPlan,
      _ref$searchModalTitle = _ref.searchModalTitle,
      searchModalTitle = _ref$searchModalTitle === void 0 ? '' : _ref$searchModalTitle,
      _ref$searchConditionN = _ref.searchConditionName,
      searchConditionName = _ref$searchConditionN === void 0 ? '' : _ref$searchConditionN,
      _ref$currentSearch = _ref.currentSearch,
      currentSearch = _ref$currentSearch === void 0 ? true : _ref$currentSearch,
      fieldid = _ref.fieldid,
      opneBtnClick = _ref.opneBtnClick,
      removeQuerConditionEve = _ref.removeQuerConditionEve,
      isTemplateOrder = _ref.isTemplateOrder,
      _ref$hideSearchType = _ref.hideSearchType,
      hideSearchType = _ref$hideSearchType === void 0 ? false : _ref$hideSearchType,
      _ref$onlyShowSuperCon = _ref.onlyShowSuperCondition,
      onlyShowSuperCondition = _ref$onlyShowSuperCon === void 0 ? false : _ref$onlyShowSuperCon,
      hiddenFunList = _ref.hiddenFunList;

  var searchInfo = this.state.searchInfo;
  var meta = this.meta; //给供应链郑新测试用
  // let meta = this._this.state.meta[id];
  // let context = this.props.context;

  var oid = meta.oid;
  var multiLang = this.state.json;
  var LangData = this.state.LangData;
  setStateEve = setStateEve.bind(this);
  this.oid = oid; //这两句要回头看看xuyangt

  searchAdvBtnClick = searchAdvBtnClick.bind(this);
  this.state.searchAdvBtnClick = searchAdvBtnClick; // initSearchArea.call(this, searchInfo);

  if (!Object(index_["isEmpty"])(multiLang)) {
    setMultiLang(multiLang);
    setOperationOptionsMultiLang(multiLang);

    if (this.state.searchInfo.hasOwnProperty('snapshotMap') && this.preHandlerFlag) {
      this.preHandlerFlag = false;
      metaPreHandler(meta, multiLang);
    }
  }

  if (!Object(index_["isEmpty"])(multiLang) && !Object(index_["isEmpty"])(searchInfo.searchPlanCache)) {
    searchInfo.searchPlanCache.forEach(function (item) {
      if (item.pk_ncc_queryscheme == '001') {
        item.name = multiLang['page-search-0018'];
      }
    });
  }

  searchBtnName = searchBtnName || /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
    className: "iconfont icon-sousuo"
  });
  replaceSuperBtn = replaceSuperBtn || multiLang['page-search-0003']; // 查询区初始化配置相关方法
  //更新查询区数据

  function setStateEve(callBack) {
    this.setState({
      searchInfo: searchInfo
    }, function () {
      if (typeof callBack === 'function') {
        callBack();
      }
    });
  }

  function metaPreHandler(meta, multiLang) {
    var items = meta.items;
    var functionList = Object(dateFunction["d" /* setMultiLang */])(multiLang);
    var select = 'select';
    var targt = ['datepicker', 'datetimepicker', 'rangepicker', 'NCTZDatePickerStart', 'NCTZDatePickerEnd', 'NCTZDatePickClientTime', 'NCTZDatePickClientHourTime', 'NCTZDatePickerRangeDay', 'datePickerNoTimeZone'];

    var handler = function handler(i) {
      if (i.children) {
        i.children.forEach(function (ii) {
          return handler(ii);
        });
      } else {
        var item = items.find(function (ii) {
          return ii.attrcode == i.attrcode;
        }) || {};
        var mytar = [select].concat(targt);
        var value = i.initialvalue.value;

        if (value && mytar.some(function (ii) {
          return ii == item.itemtype;
        })) {
          if (i.operationSign === 'between' || item.isMultiSelectedEnabled) {
            if (typeof value == 'string') {
              value = value.split(',');
            }
          }

          if (item.itemtype == 'select') {
            if (Object(index_["isEmpty"])(item.options)) {
              item.options = [i.initialvalue];
            }

            var res = item.options.filter(function (ii) {
              if (typeof value == 'string') {
                return ii.value == value;
              } else {
                return value.find(function (iii) {
                  return ii.value === iii;
                });
              }
            }) || [];
            i.initialvalue.display = res.map(function (ii) {
              return ii.display;
            }).join(',');
          } else if (targt.some(function (ii) {
            return ii == item.itemtype;
          })) {
            if (Array.isArray(value)) {
              i.initialvalue.display = value.map(function (ii) {
                return Object(dateFunction["e" /* timeFunctionHandler */])(ii) ? functionList[ii] : ii;
              }).join('~');
            } else {
              i.initialvalue.display = Object(dateFunction["e" /* timeFunctionHandler */])(value) ? functionList[value] : value;
            }
          }
        }
      }
    };

    if (Array.isArray(meta.queryschemes)) {
      meta.queryschemes.forEach(function (qs) {
        if (Array.isArray(qs.renderobj4web)) {
          qs.renderobj4web.forEach(function (i) {
            return handler(i);
          });
        }
      });
    }
  }
  /* 请求到查询方案后，如果有默认方案，则筛选显示默认方案；没有默认方案，显示visible:true的条件 */


  function afterQuerySearchPlan(res) {
    if (res.length) {
      res.forEach(function (item) {
        return item.renderobj4web_snap = spreadQueryPlan(item.renderobj4web);
      }); //过滤掉undefined

      var conditions = res.find(function (item) {
        return item.isquickqs;
      });

      if (conditions) {
        searchInfo.status = 'simple';
        searchInfo.snapshotMap[searchInfo.status] = searchInfo.fixedConditionGroup.concat(conditions.renderobj4web_snap); // 快速方案添加到 当前方案

        searchInfo.currentPlan = conditions;
        searchInfo.isDefaultPlan = false;
      }
    }
  }
  /* 从模板借口获得查询方案*/


  function querySearchPlanFromTemplate(plan) {
    if (plan) {
      searchInfo.searchPlanCache = searchComponent_toConsumableArray(plan);
    } else {
      searchInfo.searchPlanCache = [];
    }

    searchInfo.searchPlanCache.unshift(searchInfo.defaultPlan);
    /* 等后台候选条件查询写好了之后，逻辑就没问题了 -- wangshhj */

    afterQuerySearchPlan(searchInfo.searchPlanCache); // ConstSearchInfo[id] = deepClone(searchInfo);
    //setStateEve();
  } //点击查询按钮事件


  var clickSearch = function clickSearch() {
    setTimeout(function () {
      var type = 'simple';
      var snapshot = searchInfo.snapshotMap[searchInfo.status];
      var data = getAllSearchDataEve.call(_this3, id, snapshot, true);

      if (data) {
        var template = templateFilter(searchInfo.itemsMap, snapshot);
        var finalData = {
          queryAreaCode: id,
          oid: oid,
          querytype: 'tree',
          querycondition: data,
          template: template,
          nctz: getTimezoneOffset()
        };

        if (clickSearchBtn && typeof clickSearchBtn == 'function') {
          clickSearchBtn(searchComponent_objectSpread(searchComponent_objectSpread({}, _this3._this), _this3._this.props), data, type, data && finalData);
        }
      }
    }, 0);
  }; //重置按钮事件


  var resetEvent = function resetEvent() {
    var oldvalue = _clone(searchInfo.snapshotMap[searchInfo.status]);

    var snapshot = searchInfo.status === 'plan' ? searchInfo.currentSnapshot : searchInfo.snapshotMap[searchInfo.status];
    clearAllValueEve.call(_this3, snapshot);
    _this3.state.searchInfo = searchInfo;

    if (advSearchClearEve && typeof advSearchClearEve == 'function') {
      advSearchClearEve(oldvalue);
    }

    setStateEve();
  };
  /* 高级查询按钮事件,控制查询面板的显影性 */


  function searchAdvBtnClick(search, type, choosePlanName) {
    if (Object(index_["isFunction"])(replaceAdvBtnEve)) {
      replaceAdvBtnEve();
    } else {
      var _search$currentClickP, _type;

      /* 请求候选条件 */
      //暂时不访问请求候选条件的接口
      document.body.style.overflow = 'hidden';
      search.showAdvModal = true;
      search.showSearchPlan = false;
      this.lastStatus = search.status;
      var currentClickPlan = search.searchPlanCache.find(function (item) {
        return item.name === choosePlanName;
      }); //如果点击的查询方案和当前方案不一致

      if (currentClickPlan && currentClickPlan.pk_ncc_queryscheme !== search.currentPlan.pk_ncc_queryscheme) {
        search.currentClickPlan = currentClickPlan;
      }

      search.isDefaultPlan = search.currentPlan.pk_ncc_queryscheme == '001';
      search.currentPlan.renderobj4web_snap || initSimpleSnap(context, search, search.currentPlan);
      ((_search$currentClickP = search.currentClickPlan) === null || _search$currentClickP === void 0 ? void 0 : _search$currentClickP.renderobj4web_snap) || initSimpleSnap(context, search, search.currentClickPlan);
      var currentPlan = search.currentClickPlan || search.currentPlan;

      if (currentPlan && !Object(index_["isEmpty"])(currentPlan.renderobj4web_snap) && currentPlan.renderobj4web_snap[0].attrcode == 'root') {
        search.status = 'super';
      } else {
        search.status = 'normal';
      }

      if ((_type = type) !== null && _type !== void 0 && _type.target) type = '1';
      this.state.leftTab = type || '1';
      this.state.isRenderAdv = true;

      if (choosePlanName) {
        index_["PubSub"].publish('searchChoosePlan', choosePlanName);
      }

      setStateEve(function () {
        if (Object(index_["isFunction"])(clickAdvBtnEve)) {
          clickAdvBtnEve();
        } else if (Object(index_["isFunction"])(statusChangeEvent)) {
          statusChangeEvent(search.status);
        }
      });
    }
  } //生成查询、清空、高级 按钮


  var createButton = function createButton() {
    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
      className: "search-component-rowArea"
    }, !onlyShowSuperBtn && showSearchBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
      delayShow: 800,
      inverse: true,
      overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, typeof searchBtnName == 'string' ? searchBtnName : "".concat(multiLang['page-search-0001'], "(Enter)")),
      placement: "top"
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      fieldid: Object(index_["getSysFieldid"])('search_btn'),
      className: showAdvBtn ? 'search-component-searchBtn' : 'search-component-searchBtn hide-adv-btn',
      onClick: clickSearch.bind(_this3)
    }, searchBtnName)), !onlyShowSuperBtn && showClearBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
      delayShow: 800,
      inverse: true,
      overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        style: {
          padding: '0'
        }
      }, "".concat(multiLang['page-search-0002'], "(Alt+Del)")),
      placement: "top"
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      className: "clearBtn",
      fieldid: Object(index_["getSysFieldid"])('searchClear_btn'),
      onClick: resetEvent.bind(_this3)
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
      className: "iconfont icon-qingkong1"
    }))), onlyShowSuperBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
      delayShow: 800,
      inverse: true,
      overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, replaceSuperBtn),
      placement: "top"
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
      style: {
        maxWidth: onlyShowSuperBtn ? 'initial' : '29%'
      } // className="superBtn"
      ,
      colors: "primary",
      onClick: searchAdvBtnClick.bind(_this3, searchInfo),
      fieldid: "replaceSuper"
    }, replaceSuperBtn)));
  }; // 生成查询条件


  var createDom = function createDom(snapshotItem) {
    var flag = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var buttonFlag = arguments.length > 2 ? arguments[2] : undefined;
    var zindex = arguments.length > 3 ? arguments[3] : undefined;
    var index = arguments.length > 4 ? arguments[4] : undefined;

    if (buttonFlag && zindex === 0) {
      return !searchInfo.showSearchItems && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "search-button"
      }, hideBtnArea ? null : createButton());
    }

    var templetItem = searchInfo.itemsMap[snapshotItem.attrcode];

    if (!templetItem) {
      //toast({ content: '查询方案损坏！', color: 'warning' });
      return null;
    } else {
      var dom = new templateEngine_templateEngine({
        id: id,
        searchInfo: searchInfo,
        snapshotItem: snapshotItem,
        onAfterEvent: onAfterEvent,
        setStateEve: setStateEve,
        renderItem: renderItem,
        context: _this3.props.context,
        createScript: createScript,
        multiLang: multiLang,
        LangData: LangData,
        clickSearch: clickSearch,
        hiddenFunList: hiddenFunList
      });
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(searchItem_SearchItem, {
        areaId: id,
        key: snapshotItem.attrcode + zindex + index,
        name: snapshotItem.attrcode,
        itemtype: templetItem.itemtype,
        fieldid: Object(index_["getSysFieldid"])(snapshotItem.attrcode),
        style: {
          marginTop: flag ? '8px' : '0'
        },
        className: "search-item-wrap",
        dom: dom,
        hotkeytag: "searchArea-".concat(snapshotItem.attrcode)
      });
    }
  }; // 显示查询方案


  var showSearchPlanEve = function showSearchPlanEve(e) {
    e.stopPropagation();
    searchInfo.showSearchPlan = !searchInfo.showSearchPlan;
    setStateEve();
  }; // 隐藏查询方案


  var hideSearchPlanEve = function hideSearchPlanEve() {
    searchInfo.showSearchPlan = false;
    setStateEve();
  }; // 点击查询方案  plan => simple


  var chooseSearchPlan = function chooseSearchPlan(item, e) {
    if (item.pk_ncc_queryscheme == searchInfo.currentPlan.pk_ncc_queryscheme) return;
    var attrcodeArr = []; // let searchInfo = this.state.searchInfo;

    searchInfo.status = 'simple';
    searchInfo.currentPlan = item;
    searchInfo.isDefaultPlan = item.pk_ncc_queryscheme == '001';

    if (!searchInfo.userControlAdvArea) {
      var advId = id;
      afterClickSearchPlan(advId);
    }

    initSimpleSnap(context, searchInfo, item, false);
    searchInfo.snapshotMap.simple = item.renderobj4web_snap;
    searchInfo.currentSnapshot = [];
    searchInfo.snapshotMap.simple.forEach(function (item) {
      if (item.initialvalue) {
        var VALUE = item.initialvalue;
        var tempItem = searchInfo.itemsMap[item.attrcode];

        if (tempItem.itemtype === 'refer') {
          VALUE = getFunctionValueFromViewModal(VALUE, context);
        }

        if (Object(index_["isEmpty"])(VALUE.value) && Object(index_["isEmpty"])(VALUE.display)) {
          searchInfo.currentSnapshot.push(item);
        }
      } // if (searchInfo.snapshotCache && searchInfo.snapshotCache[searchInfo.status] && searchInfo.snapshotCache[searchInfo.status][item.attrcode]) {
      //     item.initialvalue = searchInfo.snapshotCache[searchInfo.status][item.attrcode];
      // }


      attrcodeArr.push(item.attrcode);
    });
    hideSearchPlanEve();

    if (Object(index_["isFunction"])(clickPlanEve)) {
      clickPlanEve(item, _this3._this);
    }

    Object(index_["isFunction"])(setInitValueEvent) && setInitValueEvent('plan');
    Object(index_["isFunction"])(statusChangeEvent) && statusChangeEvent('plan'); //暂时去掉保存选择查询方案时 查询的方法 xuyang

    if (Object(index_["isFunction"])(clickSearchBtn) && allItemsFillComplete(searchInfo.snapshotMap[searchInfo.status], searchInfo, context)) {
      clickSearch();
    } //选择查询方案的时候触发变化方法


    _this3._this.infoExchangeController.publish('heightChange', {
      area: 'searchArea'
    }); // 发布通知表格更新高度


    index_["PubSub"].publish(searchComponent_COMPLETE, true); // 切换方案时  clearWraning

    index_["PubSub"].publish('clearWarning', attrcodeArr);
  }; // 修改方案名称


  var editSearchPlan = function editSearchPlan(index, newValue) {
    _this3.state.searchPlanName = newValue;
  };
  /* 删除查询方案 */


  var delSearchPlan = function delSearchPlan(pk_ncc_queryscheme) {
    // this.props.modal.show('delSearchPlan@' + id);
    PromptBox_promptBox({
      color: 'warning',
      hotKeyboard: true,
      title: multiLang['page-search-0031'],
      content: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        dangerouslySetInnerHTML: {
          __html: multiLang['page-search-0015']
        }
      }),
      // 提示内容,非必输
      beSureBtnName: multiLang['page-search-0009'],
      // 确定按钮名称, 默认为"确定",非必输
      cancelBtnName: multiLang['page-search-0010'],
      beSureBtnClick: beSureBtnClick_Del.bind(_this3, true, pk_ncc_queryscheme, clickSearch)
    });
  }; // 创建查询方案


  var createSearchPlan = function createSearchPlan() {
    // console.log(searchInfo)
    var searchPlan = searchInfo.searchPlanCache;
    var dom = null;

    if (!searchPlan || !searchPlan.length) {
      dom = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("a", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
        className: "searchPlanList",
        fiedlid: "".concat(multiLang['page-search-0019'], "_sub-btn")
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "searchPlanName"
      }, multiLang['page-search-0019'])), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
        className: "searchPlanList",
        fiedlid: "".concat(multiLang['page-search-0020'], "_sub-btn")
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "addSearchPlanHref",
        onClick: searchAdvBtnClick.bind(_this3, searchInfo)
      }, multiLang['page-search-0020'])));
    } else {
      // 外层方案查询 (已提出,可放置到内部)
      dom = searchPlan.map(function (key, index) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          key: key.pk_ncc_queryscheme,
          className: "searchPlanList",
          fielid: "".concat(key.name, "_sub-btn")
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(item_Item, {
          item: key,
          value: key.name,
          searchInfo: searchInfo,
          chooseSearchPlan: chooseSearchPlan.bind(_this3, key),
          searchAdvBtnClick: searchAdvBtnClick.bind(_this3, searchInfo, '2', key.name),
          editSearchPlan: editSearchPlan.bind(_this3, index),
          delSearchPlan: delSearchPlan.bind(_this3, key.pk_ncc_queryscheme),
          beSureBtnClick: _methods_beSureBtnClick.bind(_this3, 'edit', true, key.name),
          showFlag: searchInfo.showFlag,
          multiLang: multiLang
        }));
      });
    }

    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
      className: "searchPlanBox  ".concat(!searchInfo.showSearchPlan ? 'hideMore' : null)
    }, dom);
  };
  /* 关闭模态框 */


  var closeModal = function closeModal() {
    searchInfo.showAdvModal = false;
    setStateEve();
  };
  /* 修改查询方案 */


  var _searchPlanCacheChange = function searchPlanCacheChange(newSearch) {
    searchInfo.searchPlanCache = newSearch; //把新的方案同步到模板上

    _this3._this.state.meta[id].queryschemes = newSearch.filter(function (item) {
      return item.pk_ncc_queryscheme != '001';
    });
    setStateEve();
  }; // 更新界面方案(外部请求处理需要) add by wanglongx


  var _upDateSearchPlan = function upDateSearchPlan(newSearch) {
    searchInfo.snapshotMap['simple'] = newSearch.renderobj4web;
    searchInfo.currentPlan = newSearch;
    setStateEve();
  };
  /* 点击查询方案之后,需要展示未填写的查询条件 */


  var afterClickSearchPlan = function afterClickSearchPlan(dataSource) {
    searchInfo.dataSource = dataSource; // 查询方案区域的数据来源 ,高级面板中的普通区域id/高级区域的id

    setStateEve();
  }; // count search conditions --- add by wanglongx


  var countQueryConditions = function countQueryConditions(item) {
    switch (searchInfo.itemsMap[item.attrcode].itemtype) {
      case 'refer':
        return item.initialvalue.display;

      case 'select':
        return item.initialvalue.display;

      case 'datepicker':
        return item.initialvalue.display;

      case 'NCTZDatePickerEnd':
        return item.initialvalue.display;

      case 'NCTZDatePickerStart':
        return item.initialvalue.display;

      case 'radio':
        return item.initialvalue.display;

      case 'checkbox':
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
          checked: !(item.initialvalue.value === 'N' || item.initialvalue.value === false),
          disabled: true
        });

      case 'checkbox_switch':
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
          checked: !(item.initialvalue.value === 'N' || item.initialvalue.value === false),
          disabled: true
        });

      case 'rangepicker':
        return item.initialvalue.display;

      case 'datetimepicker':
        return item.initialvalue.display;

      default:
        return item.initialvalue.value;
    }
  }; // add by wanglongx 


  var createTitle = function createTitle() {
    var res = null;
    res = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, multiLang['page-search-0025'], ": ", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      className: "search-conditions-number"
    }, "(", tree2Array(searchInfo.snapshotMap['simple']).filter(function (item) {
      return checkIsVisible(item);
    }).length, ")"));
    return res;
  }; //查询区目前展示方式 ：1、只显示高级按钮 ；2、都显示


  var createSearchDom = function createSearchDom() {
    var status = searchInfo.status,
        snapshotMap = searchInfo.snapshotMap,
        itemsMap = searchInfo.itemsMap,
        showAdvModal = searchInfo.showAdvModal;

    if (onlyShowSuperBtn) {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "lightapp-component-search"
      }, hideBtnArea ? null : createButton());
    } else {
      // 每五个一行 第一行后面放 button
      var allItem = [];
      var temp = []; // let items1 = [];
      // let items2 = [];

      var snapshot_list = tree2Array(snapshotMap['simple']);
      var snapshot = snapshot_list.filter(function (item) {
        return item.visible;
      }); // let template  = templateFilter(itemsMap,snapshot);

      snapshot.map(function (item, index) {
        var val = itemsMap[item.attrcode];

        if (val) {
          temp.push(item);

          if (temp.length === INITNUM) {
            allItem.push(searchComponent_toConsumableArray(temp));
            temp = [];
          }
        }
      });
      allItem.push(temp);
      return (
        /*#__PURE__*/
        // 1909 search add by wanglongx
        // 内部快捷键 enter
        external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
          className: "lightapp-component-search",
          keyMap: {
            query: ['enter'],
            "delete": ['Alt+Del']
          },
          handlers: {
            "delete": function _delete() {
              // blur 触发保存 强制让 body 获取焦点
              document.body.focus();
              resetEvent.call(_this3);
            },
            query: function query() {
              clickSearch();
            }
          },
          attach: false
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
          keyMap: {
            high: ['f3']
          },
          handlers: {
            high: function high() {
              // f3 部分情况下禁用.
              currentSearch && showAdvBtn && !showAdvModal && searchAdvBtnClick(searchInfo);
            }
          },
          display: "inline",
          attach: document.body,
          focused: true
        }), showAdvBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "".concat(searchInfo.showSearchItems ? 'search-open-close' : ' ', " search-top")
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "search-edit"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Dropdown"], {
          trigger: ['click'],
          placement: "bottomLeft",
          overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "query_condo"
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", {
            className: "query_content"
          }, createSearchPlan.call(_this3)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "create_new",
            onClick: function onClick() {
              searchAdvBtnClick(searchInfo);
            },
            fieldid: Object(index_["getSysFieldid"])('create_new_btn')
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("sapn", {
            className: "new_content"
          }, " + ".concat(multiLang['page-search-0080'])))),
          onVisibleChange: function onVisibleChange(a) {
            if (a) {
              searchInfo.showFlag = true;
              setStateEve();
            }
          },
          fieldid: "search-plan"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "search-name-wrapper",
          fieldid: Object(index_["getSysFieldid"])('search-plan_btn')
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "search-plan-name"
        }, searchInfo.currentPlan && searchInfo.currentPlan.name || searchInfo.defaultPlan.name), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "iconfont icon-bottom"
        }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          delayShow: 800,
          inverse: true,
          overlay: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            style: {
              padding: '10px'
            }
          }, "F3"),
          placement: "top"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "search-super",
          onClick: function onClick(e) {
            searchAdvBtnClick(searchInfo);
          }
        }, multiLang['page-search-0003']))), searchInfo.showSearchItems && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Dropdown"], {
          trigger: ['hover'],
          overlayClassName: "search-dropdown",
          minOverlayWidthMatchTrigger: false,
          delayShow: 0.8 // overlayClassName="multi-lang-text-collapse"
          ,
          placement: "bottomLeft",
          overlay: snapshot_list.filter(function (item) {
            return item.initialvalue.value;
          }).length && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "search-condition"
          }, snapshot_list.map(function (item) {
            if (checkIsVisible(item)) {
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
                className: "search-condition-item"
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                className: "item-title"
              }, "".concat(searchInfo.itemsMap[item.attrcode].label, ": ")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                className: "item-content"
              }, countQueryConditions(item)));
            }
          }))
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "search-conditions-value",
          onClick: function onClick() {
            searchInfo.showSearchItems = false;
            setStateEve();
          }
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, searchInfo.showSearchItems && createTitle(), "\xA0\xA0", snapshot_list.map(function (item) {
          if (checkIsVisible(item)) {
            return searchInfo.itemsMap[item.attrcode].label + ';';
          }
        })))), !onlyShowPlan && !onlyShowSuperBtn && showAdvBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "search-open",
          onClick: function onClick() {
            searchInfo.showSearchItems = !searchInfo.showSearchItems;
            index_["PubSub"].publishSync(searchComponent_BEFORECOMPLETE, true);
            setStateEve(function () {
              _this3._this.infoExchangeController.publishSync('heightChange', {
                area: 'searchArea'
              }); // 发布通知表格更新高度


              opneBtnClick && opneBtnClick(); // PubSub.publish(COMPLETE, true);
            });
          }
        }, searchInfo.showSearchItems ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "search-open-icon"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "label"
        }, multiLang['page-search-0087']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "iconfont icon-chaxunmoren"
        })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "search-open-icon"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "label"
        }, multiLang['page-search-0088']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "down iconfont icon-chaxunmoren"
        })))), !onlyShowPlan && !searchInfo.showSearchItems && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "item-contant"
        }, allItem.map(function (item, zindex) {
          if (zindex === 0) item.push('button');
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "item-rows ".concat(searchInfo.hideSearch && zindex != 0 ? 'hideMore' : '')
          }, item.map(function (data, index) {
            return createDom(data, zindex > 0, index === item.length - 1, zindex, index);
          }));
        })))
      );
    }
  };

  function checkIsVisible(item) {
    if (item.operationSign == 'is null' || item.operationSign == 'is not null') {
      return true;
    } else if (!Object(index_["isEmpty"])(item.initialvalue.value) && item.type != 'refer') {
      return true;
    } else if (!Object(index_["isEmpty"])(item.initialvalue.value) && item.type == 'refer' && !isDateFunction(item.initialvalue.value)) {
      return true;
    } else {
      return false;
    }
  }

  var createEmptySearch = function createEmptySearch(snapshot) {
    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
      className: "NC_searchPlanMain"
    }, snapshot.map(function (item) {
      return createDom(item);
    }));
  };
  /* 关闭查询方案区 */


  var closeSearchPlan = function closeSearchPlan() {
    closeSearchPlanArea.call(_this3._this, id);
  };
  /* 更多按钮点击事件，展示隐藏项 */


  var moreSearchPlanClick = function moreSearchPlanClick() {
    searchInfo.showHideSearchPlan = !searchInfo.showHideSearchPlan;
    setStateEve();
  };
  /* 创建查询方案未填写项区域 及查询按钮 */


  var createSearchPlanArea = function createSearchPlanArea() {
    if (!Object(index_["isEmpty"])(searchInfo.currentSnapshot) && searchInfo.currentSnapshot.length > 12) {
      searchInfo.showMoreBtn = true;
    }

    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
      className: "lightapp-component-search ".concat(searchInfo.showHideSearchPlan && 'lightapp-component-search-absolute')
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
      md: 10,
      sm: 8,
      xs: 6,
      id: id,
      className: "NC_searchPlanBox ".concat(searchInfo.showHideSearchPlan ? null : 'searchPlanBoxHeight')
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
      className: "NC_searchPlanName"
    }, searchInfo.currentPlan.name), createEmptySearch(searchInfo.currentSnapshot), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
      className: "NC_searchPlanBtn"
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
      delayShow: 800,
      inverse: true,
      overlay: multiLang['page-search-0021'],
      placement: "top"
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      className: "closeSearchPlan",
      onClick: closeSearchPlan.bind(_this3)
    }, "\xD7")), searchInfo.showMoreBtn ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      className: "moreSearchPlan",
      onClick: moreSearchPlanClick.bind(_this3)
    }, searchInfo.showHideSearchPlan ? multiLang['page-search-0022'] : multiLang['page-search-0023']) : null)), createButton());
  };
  /* 当前高级查询面板中的状态 （普通/高级） and 业务组是否自定义高级查询区 true/false  */


  var advSearchStatus = function advSearchStatus(status, userControl) {
    searchInfo.advSearchStatus = status;
    searchInfo.userControlAdvArea = userControl;
  };
  /* 如果修改了默认方案，则需要更新查询区展示 */


  var afterEditSearchPlan = function afterEditSearchPlan(res) {
    // searchInfo.items = [];
    // filterData(res);
    setStateEve();
  };

  return Object(index_["isEmpty"])(multiLang) ? null : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    ref: function ref(dom) {
      _this3.searchDom = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(dom);
    },
    className: "search-area-contant ".concat(showAdvBtn ? '' : 'search-area-contant-margin'),
    fieldid: Object(index_["getSysFieldid"])(fieldid ? "".concat(fieldid, "_search-area") : 'search-area')
  }, !onlyShowAdvArea ? !onlyShowModal ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Row"], {
    id: id,
    style: {
      minHeight: searchInfo.showHideSearchPlan ? '90px' : '0px'
    },
    className: " NC_CreateSearch ".concat(searchInfo.status === 'plan' ? 'NC_searchAreaHeight' : null)
  }, (searchInfo.status === 'simple' || searchInfo.showAdvModal || onlyShowSuperBtn) && createSearchDom(), searchInfo.status === 'plan' && !onlyShowSuperBtn && createSearchPlanArea(), showAdvBtn && (isSynInitAdvSearch || this.state.isRenderAdv) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(SearchAdvModal_SearchAdvModal, searchComponent_extends({
    moduleId: id,
    searchBtnName: searchBtnName,
    searchModalTitle: searchModalTitle,
    searchConditionName: searchConditionName,
    onlyShowSuperCondition: onlyShowSuperCondition,
    hideSearchType: hideSearchType,
    className: "".concat(searchInfo.showAdvModal ? 'showAdvModal' : 'hideAdvModal'),
    closeModal: closeModal,
    searchBtnClick: clickSearchBtn,
    onAfterEvent: onAfterEvent // 编辑后事件
    ,
    showAdvSearchPlanBtn: showAdvSearchPlanBtn // 是否显示保存方案按钮
    ,
    replaceAdvBody: replaceAdvBody // 替换整个body
    ,
    addAdvTabs: addAdvTabs // 添加自定义页签
    ,
    addAdvBody: addAdvBody // 在body区域添加自定义条件
    ,
    searchPlanCache: searchInfo.searchPlanCache // 查询方案变量缓存记录
    ,
    searchPlanCacheChange: function searchPlanCacheChange(i) {
      return _searchPlanCacheChange(i);
    } // 查询方案修改回调
    ,
    upDateSearchPlan: function upDateSearchPlan(e) {
      return _upDateSearchPlan(e);
    } //更新当前界面的查询方案
    ,
    oid: oid,
    hideSearchCondition: hideSearchCondition // 隐藏候选条件
    ,
    hideSearchPlan: hideSearchPlan,
    saveSearchPlan: saveSearchPlan // 业务组自定义查询条件当前数据
    ,
    replaceRightBody: replaceRightBody // 替换右侧body区域
    ,
    afterClickSearchPlan: afterClickSearchPlan // 点击查询方案后，需要展示未填写的查询方案
    ,
    clickPlanEve: clickPlanEve // 查询方案点击事件回调函数，用于业务组设置自定义查询区数据
    ,
    statusChange: advSearchStatus // 获取当前高级面板中的状态
    ,
    advSearchClearEve: advSearchClearEve // 高级面板中的清空按钮点击事件回调
    ,
    afterEditSearchPlan: afterEditSearchPlan // 如果修改了默认方案，则需要更新查询展示
    ,
    onOperateTypeChange: onOperateTypeChange,
    searchInfo: searchInfo,
    _this: this,
    changeCompleteFlag: function changeCompleteFlag(flag) {
      return _this3.completeFlag = flag;
    },
    statusChangeEvent: statusChangeEvent,
    onlyShowSuperBtn: onlyShowSuperBtn,
    createScript: createScript,
    renderItem: renderItem,
    setInitValueEvent: setInitValueEvent,
    meta: this.meta,
    multiLang: this.state.json,
    LangData: LangData,
    lastStatus: this.lastStatus,
    leftTab: this.state.leftTab // 控制页签
    ,
    fieldid: fieldid,
    removeQuerConditionEve: removeQuerConditionEve,
    isTemplateOrder: isTemplateOrder,
    hiddenFunList: hiddenFunList
  }, this.props)) : null)) : showAdvBtn && (isSynInitAdvSearch || this.state.isRenderAdv) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(SearchAdvModal_SearchAdvModal, searchComponent_extends({
    moduleId: id,
    searchBtnName: searchBtnName,
    searchModalTitle: searchModalTitle,
    searchConditionName: searchConditionName,
    hideSearchType: hideSearchType,
    onlyShowSuperCondition: onlyShowSuperCondition,
    className: "".concat(searchInfo.showAdvModal ? 'showAdvModal' : 'hideAdvModal'),
    closeModal: closeModal,
    searchBtnClick: clickSearchBtn,
    onAfterEvent: onAfterEvent // 编辑后事件
    ,
    showAdvSearchPlanBtn: showAdvSearchPlanBtn // 是否显示保存方案按钮
    ,
    replaceAdvBody: replaceAdvBody // 替换整个body
    ,
    addAdvTabs: addAdvTabs // 添加自定义页签
    ,
    addAdvBody: addAdvBody // 在body区域添加自定义条件
    ,
    searchPlanCache: searchInfo.searchPlanCache // 查询方案变量缓存记录
    ,
    searchPlanCacheChange: function searchPlanCacheChange(i) {
      return _searchPlanCacheChange(i);
    } // 查询方案修改回调
    ,
    upDateSearchPlan: function upDateSearchPlan(e) {
      return _upDateSearchPlan(e);
    } //更新当前界面的查询方案
    ,
    oid: oid,
    hideSearchCondition: hideSearchCondition // 隐藏候选条件
    ,
    hideSearchPlan: hideSearchPlan,
    saveSearchPlan: saveSearchPlan // 业务组自定义查询条件当前数据
    ,
    replaceRightBody: replaceRightBody // 替换右侧body区域
    ,
    afterClickSearchPlan: afterClickSearchPlan // 点击查询方案后，需要展示未填写的查询方案
    ,
    clickPlanEve: clickPlanEve // 查询方案点击事件回调函数，用于业务组设置自定义查询区数据
    ,
    statusChange: advSearchStatus // 获取当前高级面板中的状态
    ,
    advSearchClearEve: advSearchClearEve // 高级面板中的清空按钮点击事件回调
    ,
    afterEditSearchPlan: afterEditSearchPlan // 如果修改了默认方案，则需要更新查询展示
    ,
    onOperateTypeChange: onOperateTypeChange,
    searchInfo: searchInfo,
    _this: this,
    changeCompleteFlag: function changeCompleteFlag(flag) {
      return _this3.completeFlag = flag;
    },
    statusChangeEvent: statusChangeEvent,
    onlyShowSuperBtn: onlyShowSuperBtn,
    createScript: createScript,
    renderItem: renderItem,
    setInitValueEvent: setInitValueEvent,
    meta: this.meta,
    multiLang: this.state.json,
    LangData: LangData,
    lastStatus: this.lastStatus,
    leftTab: this.state.leftTab // 控制页签
    ,
    removeQuerConditionEve: removeQuerConditionEve,
    isTemplateOrder: isTemplateOrder,
    hiddenFunList: hiddenFunList
  }, this.props)) : null : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    className: "NC_searchAdvModal",
    fieldid: Object(index_["getSysFieldid"])('search_modal-area'),
    style: {
      width: '100%'
    }
  }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(SearchAdvCom_SearchAdvCom, searchComponent_extends({
    className: "".concat(searchInfo.showAdvModal ? 'showAdvModal' : 'hideAdvModal'),
    moduleId: id,
    searchBtnName: searchBtnName,
    closeModal: closeModal,
    searchBtnClick: clickSearchBtn,
    onAfterEvent: onAfterEvent // 编辑后事件
    ,
    showAdvSearchPlanBtn: showAdvSearchPlanBtn // 是否显示保存方案按钮
    ,
    replaceAdvBody: replaceAdvBody // 替换整个body
    ,
    addAdvTabs: addAdvTabs // 添加自定义页签
    ,
    searchConditionName: searchConditionName,
    hideSearchType: hideSearchType,
    onlyShowSuperCondition: onlyShowSuperCondition,
    addAdvBody: addAdvBody // 在body区域添加自定义条件
    ,
    searchPlanCache: searchInfo.searchPlanCache // 查询方案变量缓存记录
    ,
    searchPlanCacheChange: function searchPlanCacheChange(i) {
      return _searchPlanCacheChange(i);
    } // 查询方案修改回调
    ,
    upDateSearchPlan: function upDateSearchPlan(e) {
      return _upDateSearchPlan(e);
    } //更新当前界面的查询方案
    ,
    oid: oid,
    hideSearchCondition: hideSearchCondition // 隐藏候选条件
    ,
    hideSearchPlan: hideSearchPlan,
    saveSearchPlan: saveSearchPlan // 业务组自定义查询条件当前数据
    ,
    replaceRightBody: replaceRightBody // 替换右侧body区域
    ,
    afterClickSearchPlan: afterClickSearchPlan // 点击查询方案后，需要展示未填写的查询方案
    ,
    clickPlanEve: clickPlanEve // 查询方案点击事件回调函数，用于业务组设置自定义查询区数据
    ,
    statusChange: advSearchStatus // 获取当前高级面板中的状态
    ,
    advSearchClearEve: advSearchClearEve // 高级面板中的清空按钮点击事件回调
    ,
    afterEditSearchPlan: afterEditSearchPlan // 如果修改了默认方案，则需要更新查询展示
    ,
    onOperateTypeChange: onOperateTypeChange,
    searchInfo: searchInfo,
    _this: this,
    changeCompleteFlag: function changeCompleteFlag(flag) {
      return _this3.completeFlag = flag;
    },
    statusChangeEvent: statusChangeEvent,
    onlyShowSuperBtn: onlyShowSuperBtn,
    createScript: createScript,
    renderItem: renderItem,
    meta: this.meta,
    setInitValueEvent: setInitValueEvent,
    multiLang: this.state.json,
    LangData: LangData,
    lastStatus: this.lastStatus,
    isTemplateOrder: isTemplateOrder,
    removeQuerConditionEve: removeQuerConditionEve,
    hiddenFunList: hiddenFunList
  }, this.props))));
}
// CONCATENATED MODULE: ./src/platform/components/CreateSearch/createSearch.js
function createSearch_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function createSearch_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { createSearch_ownKeys(Object(source), true).forEach(function (key) { createSearch_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { createSearch_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function createSearch_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Created by wangshhj on 2018/1/11.  本地 xuyang updata
 */


 // import { timeFunctionTranslater } from '../../public/timer';
// import ViewModel from '../../shell/viewmodel/viewmodel';

/*
*   @ 查询区交互说明：
*   1、如果查询区需要查询方案，并且不是只显示高级按钮时，则先请求查询方案 ；如果查询方案中有默认查询方案，则页面永远展示默认查询方案中的查询条件；否则，展示查询模板中的visible:true的查询条件；
*   2、当用户修改了默认查询方案 ，需要实时更新同步查询区展示
*   3、当用户点击查询方案去查询时（无论是外面的查询方案还是高级面板中的查询方案），外面查询区需要展示该方案中的未填写项（该未填写项只按照保存方案时标记，修改了查询方案中的查询条件但是未保存的不算）
*   4、高级面板中，普通查询区不能拖拽多个相同的查询条件；
*   5、高级面板中，高级区域可以拖拽多个相同的查询条件，但是，默认展示的查询条件不能移除，也不能拖到默认展示的查询条件之上形成一组新的查询条件。非默认显示的查询条件可以和拖拽项组成新的、带逻辑运算的查询条件
*   6、默认查询方案只能修改不能删除
*   7、clickSearchBtn方法，在点击查询方案触发查询时，只返回方案中的公共查询条件，不包含自定义查询条件；如果有自定义查询条件，需要业务组在clickPlanEve方法中接收查询方案信息，并保存到业务组的state中，然后在 clickSearchBtn方法中自行合并公共条件和自定义条件，再去请求查询。
*   8、需要查询方案功能时，必须传参数oid（查询模板中的oid），可以通过createUIDom(data, callback)  回调拿到模板信息；
*   9、当只显示高级按钮时，不加载简单查询区的查询条件和查询按钮，点方案进行查询也不加载方案中的未填写项。
*
* */

function createSearch_NCCreateSearch(id) {
  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      clickSearchBtn = _ref.clickSearchBtn,
      _ref$searchBtnName = _ref.searchBtnName,
      searchBtnName = _ref$searchBtnName === void 0 ? '' : _ref$searchBtnName,
      onAfterEvent = _ref.onAfterEvent,
      _ref$showSearchBtn = _ref.showSearchBtn,
      showSearchBtn = _ref$showSearchBtn === void 0 ? true : _ref$showSearchBtn,
      _ref$showAdvBtn = _ref.showAdvBtn,
      showAdvBtn = _ref$showAdvBtn === void 0 ? true : _ref$showAdvBtn,
      _ref$showClearBtn = _ref.showClearBtn,
      showClearBtn = _ref$showClearBtn === void 0 ? true : _ref$showClearBtn,
      _ref$showAdvSearchPla = _ref.showAdvSearchPlanBtn,
      showAdvSearchPlanBtn = _ref$showAdvSearchPla === void 0 ? true : _ref$showAdvSearchPla,
      replaceAdvBtnEve = _ref.replaceAdvBtnEve,
      replaceAdvBody = _ref.replaceAdvBody,
      addAdvTabs = _ref.addAdvTabs,
      addAdvBody = _ref.addAdvBody,
      replaceRightBody = _ref.replaceRightBody,
      _ref$hideSearchCondit = _ref.hideSearchCondition,
      hideSearchCondition = _ref$hideSearchCondit === void 0 ? false : _ref$hideSearchCondit,
      _ref$hideSearchPlan = _ref.hideSearchPlan,
      hideSearchPlan = _ref$hideSearchPlan === void 0 ? false : _ref$hideSearchPlan,
      saveSearchPlan = _ref.saveSearchPlan,
      clickPlanEve = _ref.clickPlanEve,
      clickAdvBtnEve = _ref.clickAdvBtnEve,
      _ref$hideBtnArea = _ref.hideBtnArea,
      hideBtnArea = _ref$hideBtnArea === void 0 ? false : _ref$hideBtnArea,
      advSearchClearEve = _ref.advSearchClearEve,
      _ref$onlyShowSuperBtn = _ref.onlyShowSuperBtn,
      onlyShowSuperBtn = _ref$onlyShowSuperBtn === void 0 ? false : _ref$onlyShowSuperBtn,
      _ref$replaceSuperBtn = _ref.replaceSuperBtn,
      replaceSuperBtn = _ref$replaceSuperBtn === void 0 ? '' : _ref$replaceSuperBtn,
      onOperateTypeChange = _ref.onOperateTypeChange,
      _ref$onlyShowAdvArea = _ref.onlyShowAdvArea,
      onlyShowAdvArea = _ref$onlyShowAdvArea === void 0 ? false : _ref$onlyShowAdvArea,
      _ref$onlyShowModal = _ref.onlyShowModal,
      onlyShowModal = _ref$onlyShowModal === void 0 ? false : _ref$onlyShowModal,
      renderCompleteEvent = _ref.renderCompleteEvent,
      statusChangeEvent = _ref.statusChangeEvent,
      _ref$context = _ref.context,
      context = _ref$context === void 0 ? '' : _ref$context,
      setInitValueEvent = _ref.setInitValueEvent,
      _ref$useCache = _ref.useCache,
      useCache = _ref$useCache === void 0 ? true : _ref$useCache,
      _ref$isSynInitAdvSear = _ref.isSynInitAdvSearch,
      isSynInitAdvSearch = _ref$isSynInitAdvSear === void 0 ? false : _ref$isSynInitAdvSear,
      onlyShowModalCancelCallback = _ref.onlyShowModalCancelCallback,
      _ref$onlyShowPlan = _ref.onlyShowPlan,
      onlyShowPlan = _ref$onlyShowPlan === void 0 ? false : _ref$onlyShowPlan,
      _ref$searchModalTitle = _ref.searchModalTitle,
      searchModalTitle = _ref$searchModalTitle === void 0 ? '' : _ref$searchModalTitle,
      _ref$searchConditionN = _ref.searchConditionName,
      searchConditionName = _ref$searchConditionN === void 0 ? '' : _ref$searchConditionN,
      _ref$currentSearch = _ref.currentSearch,
      currentSearch = _ref$currentSearch === void 0 ? true : _ref$currentSearch,
      opneBtnClick = _ref.opneBtnClick,
      _ref$isTemplateOrder = _ref.isTemplateOrder,
      isTemplateOrder = _ref$isTemplateOrder === void 0 ? false : _ref$isTemplateOrder,
      removeQuerConditionEve = _ref.removeQuerConditionEve,
      fieldid = _ref.fieldid,
      _ref$hideSearchType = _ref.hideSearchType,
      hideSearchType = _ref$hideSearchType === void 0 ? false : _ref$hideSearchType,
      _ref$onlyShowSuperCon = _ref.onlyShowSuperCondition,
      onlyShowSuperCondition = _ref$onlyShowSuperCon === void 0 ? false : _ref$onlyShowSuperCon,
      _ref$hiddenFunList = _ref.hiddenFunList,
      hiddenFunList = _ref$hiddenFunList === void 0 ? {} : _ref$hiddenFunList;

  //模板没有值 就不渲染
  if (!(!Object(index_["isEmpty"])(this.state.meta[id]) && !Object(index_["isEmpty"])(this.state.meta[id].items))) {
    return null;
  } else {
    // let id = arguments[0];
    // let props = { id, ...arguments[1] };
    var get_this = function get_this(_this) {
      this.myState.search["searchArea_".concat(id)] = _this;
    };

    var remove_this = function remove_this() {
      this.myState.search["searchArea_".concat(id)] = {};
      delete this.myState.search["searchArea_".concat(id)];
    };

    var getGloablThis = function getGloablThis() {
      return this;
    }; //渲染监控=======
    // if (!this.hasOwnProperty('searchAreaRenderCount')) {
    //     this.searchAreaRenderCount = 1;
    // } else {
    //     this.searchAreaRenderCount++;
    // }
    // console.log('查询区组件渲染了' + this.searchAreaRenderCount + '次');
    //===============================
    // let refers = this.state.meta[id].items.filter((item) => item.itemtype === 'refer');
    // createScripts.call(this, 'search', id, refers);


    var contextMixin = createSearch_objectSpread(createSearch_objectSpread({}, index_["ViewModel"].getContext()), context || this.app_context); // console.log('contextMixin', contextMixin);


    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(searchComponent_SearchComponent, {
      renderItem: this.state.renderItem.search && this.state.renderItem.search.hasOwnProperty(id) ? this.state.renderItem.search[id] : {} //全局参照列表
      ,
      context: contextMixin //上下文数据 用于 函数翻译
      ,
      syncTree: this.syncTree //树
      ,
      modal: this.modal,
      get_this: get_this.bind(this),
      remove_this: remove_this.bind(this),
      createScript: index_["createScript"].bind(this),
      search: this.search,
      getGloablThis: getGloablThis.bind(this),
      id: id,
      clickSearchBtn: clickSearchBtn,
      searchBtnName: searchBtnName,
      onAfterEvent: onAfterEvent,
      showSearchBtn: showSearchBtn,
      showAdvBtn: showAdvBtn,
      showClearBtn: showClearBtn,
      showAdvSearchPlanBtn: showAdvSearchPlanBtn,
      replaceAdvBtnEve: replaceAdvBtnEve,
      replaceAdvBody: replaceAdvBody,
      addAdvTabs: addAdvTabs,
      addAdvBody: addAdvBody,
      replaceRightBody: replaceRightBody,
      hideSearchCondition: hideSearchCondition,
      hideSearchPlan: hideSearchPlan,
      saveSearchPlan: saveSearchPlan,
      clickPlanEve: clickPlanEve,
      clickAdvBtnEve: clickAdvBtnEve,
      hideBtnArea: hideBtnArea,
      advSearchClearEve: advSearchClearEve,
      onlyShowSuperBtn: onlyShowSuperBtn,
      replaceSuperBtn: replaceSuperBtn,
      onOperateTypeChange: onOperateTypeChange,
      onlyShowAdvArea: onlyShowAdvArea,
      onlyShowModal: onlyShowModal,
      renderCompleteEvent: renderCompleteEvent,
      statusChangeEvent: statusChangeEvent,
      setInitValueEvent: setInitValueEvent,
      useCache: useCache,
      isSynInitAdvSearch: isSynInitAdvSearch,
      onlyShowModalCancelCallback: onlyShowModalCancelCallback,
      onlyShowPlan: onlyShowPlan,
      searchModalTitle: searchModalTitle,
      searchConditionName: searchConditionName,
      onlyShowSuperCondition: onlyShowSuperCondition,
      currentSearch: currentSearch,
      fieldid: fieldid,
      opneBtnClick: opneBtnClick,
      isTemplateOrder: isTemplateOrder,
      removeQuerConditionEve: removeQuerConditionEve,
      hideSearchType: hideSearchType,
      hiddenFunList: hiddenFunList
    });
  }
}
// CONCATENATED MODULE: ./src/platform/components/CreateSearch/index.js
/**
 * Created by wangshhj on 2018/1/11.
 */


var CreateSearch_search = {
  NCCreateSearch: createSearch_NCCreateSearch,
  setSearchValue: setSearchValue,
  setSearchValByField: setSearchValByField,
  getAllSearchData: getAllSearchData,
  getSearchValByField: getSearchValByField,
  setDisabledByField: setDisabledByField,
  closeSearchPlanArea: closeSearchPlanArea,
  openAdvSearch: openAdvSearch,
  setDisabled: methods_setDisabled,
  clearSearchArea: clearSearchArea,
  getQueryInfo: getQueryInfo,
  getOprtypeByField: getOprtypeByField,
  changeItemVisibleByField: changeItemVisibleByField,
  setRequiredByField: setRequiredByField,
  setTemlateByField: setTemlateByField
};
/* harmony default export */ var CreateSearch = (CreateSearch_search);
// CONCATENATED MODULE: ./src/platform/components/CreateNCModal/createModal.js
function CreateNCModal_createModal_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { CreateNCModal_createModal_typeof = function _typeof(obj) { return typeof obj; }; } else { CreateNCModal_createModal_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return CreateNCModal_createModal_typeof(obj); }

function CreateNCModal_createModal_extends() { CreateNCModal_createModal_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return CreateNCModal_createModal_extends.apply(this, arguments); }

function CreateNCModal_createModal_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = CreateNCModal_createModal_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function CreateNCModal_createModal_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function CreateNCModal_createModal_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function CreateNCModal_createModal_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function CreateNCModal_createModal_createClass(Constructor, protoProps, staticProps) { if (protoProps) CreateNCModal_createModal_defineProperties(Constructor.prototype, protoProps); if (staticProps) CreateNCModal_createModal_defineProperties(Constructor, staticProps); return Constructor; }

function CreateNCModal_createModal_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) CreateNCModal_createModal_setPrototypeOf(subClass, superClass); }

function CreateNCModal_createModal_setPrototypeOf(o, p) { CreateNCModal_createModal_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return CreateNCModal_createModal_setPrototypeOf(o, p); }

function CreateNCModal_createModal_createSuper(Derived) { var hasNativeReflectConstruct = CreateNCModal_createModal_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = CreateNCModal_createModal_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = CreateNCModal_createModal_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return CreateNCModal_createModal_possibleConstructorReturn(this, result); }; }

function CreateNCModal_createModal_possibleConstructorReturn(self, call) { if (call && (CreateNCModal_createModal_typeof(call) === "object" || typeof call === "function")) { return call; } return CreateNCModal_createModal_assertThisInitialized(self); }

function CreateNCModal_createModal_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function CreateNCModal_createModal_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function CreateNCModal_createModal_getPrototypeOf(o) { CreateNCModal_createModal_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return CreateNCModal_createModal_getPrototypeOf(o); }

/**
 * Created by wangshhj on 2018/3/13.
 */




__webpack_require__(1900);

var createModal_NCModal = /*#__PURE__*/function (_Component) {
  CreateNCModal_createModal_inherits(NCModal, _Component);

  var _super = CreateNCModal_createModal_createSuper(NCModal);

  function NCModal(props) {
    var _this;

    CreateNCModal_createModal_classCallCheck(this, NCModal);

    _this = _super.call(this, props);

    _this.getTitle = function (title, color) {
      var json = _this.state.json;

      if (!title && color) {
        if (color === 'success') {
          title = json['0001'];
        } else if (color === 'info') {
          title = json['0002'];
        } else if (color === 'warning') {
          title = json['0003'];
        } else if (color === 'danger') {
          title = json['0004'];
        }
      }

      return title;
    };

    _this.state = {
      json: {}
    };
    return _this;
  }

  CreateNCModal_createModal_createClass(NCModal, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      var callback = function callback(json, bool) {
        if (bool) {
          _this2.setState({
            json: json
          }, function () {//console.log('多语加载完成')
          });
        }
      };

      Object(index_["getMultiLang"])({
        moduleId: 'container_toast',
        callback: callback
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var json = this.state.json;

      var _this$props = this.props,
          modalData = _this$props.modalData,
          close = _this$props.close,
          size = _this$props.size,
          className = _this$props.className,
          getClassName = _this$props.getClassName,
          hasCloseBtn = _this$props.hasCloseBtn,
          backdrop = _this$props.backdrop,
          indexInfo = _this$props.indexInfo,
          beSureClick = _this$props.beSureClick,
          cancelClick = _this$props.cancelClick,
          noFooter = _this$props.noFooter,
          showCustomBtns = _this$props.showCustomBtns,
          customBtns = _this$props.customBtns,
          _this$props$hotKeyboa = _this$props.hotKeyboard,
          hotKeyboard = _this$props$hotKeyboa === void 0 ? true : _this$props$hotKeyboa,
          others = CreateNCModal_createModal_objectWithoutProperties(_this$props, ["modalData", "close", "size", "className", "getClassName", "hasCloseBtn", "backdrop", "indexInfo", "beSureClick", "cancelClick", "noFooter", "showCustomBtns", "customBtns", "hotKeyboard"]);

      var _modalData$leftBtnNam = modalData.leftBtnName,
          leftBtnName = _modalData$leftBtnNam === void 0 ? json['0005'] : _modalData$leftBtnNam,
          _modalData$rightBtnNa = modalData.rightBtnName,
          rightBtnName = _modalData$rightBtnNa === void 0 ? json['0006'] : _modalData$rightBtnNa,
          color = modalData.color,
          title = modalData.title,
          content = modalData.content;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], CreateNCModal_createModal_extends({
        show: modalData.showModal,
        onHide: close.bind(this),
        size: size,
        className: className,
        backdrop: backdrop,
        indexInfo: indexInfo // draggable={false}
        // resizable={false}

      }, others, {
        ref: function ref(Modal) {
          return _this3.Modal = Modal;
        }
      }), hotKeyboard && !noFooter && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          sureBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM,
          cancelBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL
        },
        handlers: {
          sureBtnHandler: function sureBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              console.log('createModal sureBtnHandler 事件回调');
              beSureClick.bind(_this3)();
            }
          },
          cancelBtnHandler: function cancelBtnHandler() {
            // 取消按钮的事件  增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              console.log('createModal cancelBtnHandler 事件回调');
              cancelClick.bind(_this3)();
            }
          }
        },
        className: "ncmodel-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, {
        fieldid: "header-area",
        closeButton: !!hasCloseBtn
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, json['0007'])), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Title, {
        fieldid: "".concat(json['0007'])
      }, getClassName(color), " ", this.getTitle(title, color)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "createModal-body-content"
      }, content)), !noFooter ? showCustomBtns ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, showCustomBtns && customBtns ? customBtns : null) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(leftBtnName, "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM, ")"),
        trigger: ['hover', 'focus'],
        className: "model-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        fieldid: "confirm",
        onClick: beSureClick.bind(this),
        colors: "primary",
        tabIndex: "0"
      }, leftBtnName, "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "Y "), ")")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(rightBtnName, "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL, ")"),
        trigger: ['focus', 'hover'],
        className: "model-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        fieldid: "cancel",
        onClick: cancelClick.bind(this),
        shape: "border",
        tabIndex: "0"
      }, rightBtnName, "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "N"), ")"))) : null);
    }
  }]);

  return NCModal;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

function createModal_createModal(id) {
  var _this4 = this;

  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      title = _ref.title,
      content = _ref.content,
      beSureBtnClick = _ref.beSureBtnClick,
      cancelBtnClick = _ref.cancelBtnClick,
      leftBtnName = _ref.leftBtnName,
      rightBtnName = _ref.rightBtnName,
      _ref$noFooter = _ref.noFooter,
      noFooter = _ref$noFooter === void 0 ? false : _ref$noFooter,
      size = _ref.size,
      _ref$color = _ref.color,
      color = _ref$color === void 0 ? 'warning' : _ref$color,
      _ref$hasCloseBtn = _ref.hasCloseBtn,
      hasCloseBtn = _ref$hasCloseBtn === void 0 ? false : _ref$hasCloseBtn,
      _ref$closeByClickBack = _ref.closeByClickBackDrop,
      closeByClickBackDrop = _ref$closeByClickBack === void 0 ? false : _ref$closeByClickBack,
      _ref$zIndex = _ref.zIndex,
      zIndex = _ref$zIndex === void 0 ? 200 : _ref$zIndex,
      others = CreateNCModal_createModal_objectWithoutProperties(_ref, ["title", "content", "beSureBtnClick", "cancelBtnClick", "leftBtnName", "rightBtnName", "noFooter", "size", "color", "hasCloseBtn", "closeByClickBackDrop", "zIndex"]);

  if (!this.state.modal.hasOwnProperty(id)) {
    this.state.modal[id] = {
      color: color,
      showModal: false,
      title: title,
      content: content,
      beSureBtnClick: beSureBtnClick,
      cancelBtnClick: cancelBtnClick,
      leftBtnName: leftBtnName,
      rightBtnName: rightBtnName
    };
  }

  var modalData = this.state.modal[id]; // 按钮class

  var getClassName = function getClassName(color) {
    var iconName; //   let iconName = 'icon-wancheng';

    if (color === 'danger') {
      iconName = 'icon-shibai';
    } else if (color === 'warning') {
      iconName = 'icon-zhuyi1';
    } else if (color === 'info') {
      iconName = 'icon-tixing';
    } else if (color === 'success') {
      iconName = 'icon-wancheng';
    } else {
      iconName = 'icon-warning';
    }

    var name = "iconfont ".concat(iconName, " ").concat(color);
    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      className: name
    }, " ");
  }; //关闭模态框


  var close = function close() {
    modalData.showModal = false;

    _this4.setState({
      modal: _this4.state.modal
    });
  };
  /* 取消按钮事件 */


  var cancelClick = function cancelClick() {
    close();

    if (typeof modalData.cancelBtnClick === 'function') {
      modalData.cancelBtnClick.call(_this4);
    }
  }; //确认按钮事件


  var beSureClick = function beSureClick() {
    close();

    if (typeof modalData.beSureBtnClick === 'function') {
      modalData.beSureBtnClick.call(_this4);
    }
  };

  var indexInfo = {
    id: id,
    zIndex: zIndex
  };
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(createModal_NCModal, CreateNCModal_createModal_extends({
    fieldid: id,
    modalData: modalData,
    hasCloseBtn: hasCloseBtn,
    beSureClick: beSureClick,
    cancelClick: cancelClick,
    getClassName: getClassName,
    noFooter: noFooter,
    close: close,
    size: size // draggable={draggable}
    // resizable={resizable}
    ,
    className: "".concat(id, " NC_confirmModal createNcModal"),
    backdrop: closeByClickBackDrop ? true : 'static',
    indexInfo: indexInfo
  }, others));
}
// CONCATENATED MODULE: ./src/platform/components/CreateNCModal/methods.js
/**
 * Created by wangshhj on 2018/3/13.
 */
function CreateNCModal_methods_show(id) {
  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (!this.state.modal.hasOwnProperty(id)) {
    return false;
  }

  var modalData = this.state.modal[id];
  modalData = Object.assign(modalData, config);
  modalData.showModal = true;
  this.setState({
    modal: this.state.modal
  });
}
function CreateNCModal_methods_close(id) {
  var modalData = this.state.modal[id];
  modalData.showModal = false;
  this.setState({
    modal: this.state.modal
  });
}
// CONCATENATED MODULE: ./src/platform/components/CreateNCModal/index.js
/**
 * Created by wangshhj on 2018/3/13.
 */



// CONCATENATED MODULE: ./src/platform/components/CreateUploader/createUploader.js
function createUploader_extends() { createUploader_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return createUploader_extends.apply(this, arguments); }

function createUploader_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = createUploader_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function createUploader_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

/*
 * @Author: liyxt
 * @Date: 2019-10-21 14:15:59
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-03 14:54:19
 * @Description: file content
 */

/**
 * Created by zhouxini on 2018/7/19.
 */

function createUploader(id) {
  var _this = this;

  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      billId = _ref.billId,
      billNo = _ref.billNo,
      target = _ref.target,
      placement = _ref.placement,
      beforeUpload = _ref.beforeUpload,
      size = _ref.size,
      accept = _ref.accept,
      upData = _ref.upData,
      multiple = _ref.multiple,
      beforeDelete = _ref.beforeDelete,
      onHide = _ref.onHide,
      others = createUploader_objectWithoutProperties(_ref, ["billId", "billNo", "target", "placement", "beforeUpload", "size", "accept", "upData", "multiple", "beforeDelete", "onHide"]);

  if (!this.state.uploader.hasOwnProperty(id)) {
    this.state.uploader[id] = {
      billId: billId,
      billNo: billNo,
      target: target,
      placement: placement,
      beforeUpload: beforeUpload,
      size: size,
      accept: accept,
      upData: upData,
      multiple: multiple,
      beforeDelete: beforeDelete,
      onHide: onHide,
      showUploader: false
    };
  }

  var uploaderData = this.state.uploader[id]; // 上传前事件

  var beforeUploadFun = null;

  if (typeof uploaderData.beforeUpload === 'function') {
    beforeUploadFun = uploaderData.beforeUpload.bind(this);
  } // 删除前事件


  var beforeDeleteFun = null;

  if (typeof uploaderData.beforeDelete === 'function') {
    beforeDeleteFun = uploaderData.beforeDelete.bind(this);
  }

  var onHideFun = function onHideFun() {
    uploaderData.showUploader = false;

    _this.setState({
      uploader: _this.state.uploader
    });

    if (typeof uploaderData.onHide === 'function') {
      uploaderData.onHide.call(_this);
    }
  };

  return uploaderData.showUploader ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(Uploader, createUploader_extends({
    billId: uploaderData.billId,
    billNo: uploaderData.billNo,
    target: uploaderData.target,
    placement: uploaderData.placement,
    beforeUpload: beforeUploadFun,
    size: uploaderData.size,
    accept: uploaderData.accept,
    upData: uploaderData.upData,
    multiple: uploaderData.multiple,
    beforeDelete: beforeDeleteFun,
    onHide: onHideFun
  }, others)) : null;
}
// CONCATENATED MODULE: ./src/platform/components/CreateUploader/methods.js
/**
 * Created by zhouxini on 2018/7/19.
 */
function CreateUploader_methods_show(id) {
  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (!this.state.uploader.hasOwnProperty(id)) {
    return false;
  }

  var uploaderData = this.state.uploader[id];
  uploaderData = Object.assign(uploaderData, config);
  uploaderData.showUploader = true;
  this.setState({
    uploader: this.state.uploader
  });
}
function CreateUploader_methods_close(id) {
  if (!this.state.uploader.hasOwnProperty(id)) {
    return false;
  }

  var uploaderData = this.state.uploader[id];
  uploaderData.showUploader = false;
  this.setState({
    uploader: this.state.uploader
  });
}
// CONCATENATED MODULE: ./src/platform/components/CreateUploader/index.js
/**
 * Created by zhouxini on 2018/7/19.
 */



// CONCATENATED MODULE: ./src/platform/components/CrossServiceBtns/create.js
function CrossServiceBtns_create_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { CrossServiceBtns_create_typeof = function _typeof(obj) { return typeof obj; }; } else { CrossServiceBtns_create_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return CrossServiceBtns_create_typeof(obj); }

function CrossServiceBtns_create_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function CrossServiceBtns_create_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function CrossServiceBtns_create_createClass(Constructor, protoProps, staticProps) { if (protoProps) CrossServiceBtns_create_defineProperties(Constructor.prototype, protoProps); if (staticProps) CrossServiceBtns_create_defineProperties(Constructor, staticProps); return Constructor; }

function CrossServiceBtns_create_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) CrossServiceBtns_create_setPrototypeOf(subClass, superClass); }

function CrossServiceBtns_create_setPrototypeOf(o, p) { CrossServiceBtns_create_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return CrossServiceBtns_create_setPrototypeOf(o, p); }

function CrossServiceBtns_create_createSuper(Derived) { var hasNativeReflectConstruct = CrossServiceBtns_create_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = CrossServiceBtns_create_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = CrossServiceBtns_create_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return CrossServiceBtns_create_possibleConstructorReturn(this, result); }; }

function CrossServiceBtns_create_possibleConstructorReturn(self, call) { if (call && (CrossServiceBtns_create_typeof(call) === "object" || typeof call === "function")) { return call; } return CrossServiceBtns_create_assertThisInitialized(self); }

function CrossServiceBtns_create_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function CrossServiceBtns_create_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function CrossServiceBtns_create_getPrototypeOf(o) { CrossServiceBtns_create_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return CrossServiceBtns_create_getPrototypeOf(o); }



 //import BillErrorTrack from '../BillErrorTrack';


var nameSpace = 'nccloud_platfrom_native_socket_billinfo';

__webpack_require__(1901);
/**
 * 用于列表操作列的组件
 */


function createErrorButton(config) {
  var _config$record = config.record,
      record = _config$record === void 0 ? {} : _config$record,
      sucessCallBack = config.sucessCallBack; // record 可能还有一级  需要完善下数据

  record = record.values || record; // 这个方法以后会无效

  return typeof sucessCallBack === 'function' && sucessCallBack(this.props, record, this); // return saga_status.value !== '1' && typeof sucessCallBack === 'function' && sucessCallBack(this.props, record, this);
  // return (
  //     <CrossServiceListBtn
  //         pageInstance={this}
  //         isError={saga_status.value === "1"}
  //         sucessCallBack={sucessCallBack}
  //         output={this.output}
  //         rootprops={this.props}
  //     />
  // )
} // class CrossServiceListBtn extends Component {
//     constructor(props) {
//         super(props);
//     }
//     render() {
//         let { isError, sucessCallBack } = this.props;
//         return (
//             <span>{!isError && typeof sucessCallBack === "function" && sucessCallBack()}</span>
//         )
//     }
// }

/**
 * 用于卡片标题区
 */

function createErrorFlag(config) {
  var _this2 = this;

  var headBtnAreaCode = config.headBtnAreaCode;
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(create_CrossServiceCardBtn, {
    getThis: function getThis(_this) {
      _this2.myCrossServiceBtn[headBtnAreaCode] = _this;
    },
    pageInstance: this,
    moduleId: headBtnAreaCode,
    output: this.output,
    rootprops: this.props
  });
} // get nearest parent element matching selector   origin from stackoverflow  add by bbqin

var create_Closest = function Closest(el, selector) {
  if (!el) {
    return null;
  }

  var matchesSelector = el.matches || el.webkitMatchesSelector || el.mozMatchesSelector || el.msMatchesSelector;

  while (el) {
    if (matchesSelector.call(el, selector)) {
      break;
    }

    el = el.parentElement;
  }

  return el;
};

var create_CrossServiceCardBtn = /*#__PURE__*/function (_Component) {
  CrossServiceBtns_create_inherits(CrossServiceCardBtn, _Component);

  var _super = CrossServiceBtns_create_createSuper(CrossServiceCardBtn);

  function CrossServiceCardBtn(props) {
    var _this3;

    CrossServiceBtns_create_classCallCheck(this, CrossServiceCardBtn);

    _this3 = _super.call(this, props);

    _this3.queryBillTrack = function () {
      var pageInstance = _this3.props.pageInstance; // let { formAreaCode, billtype, billpkname } = pageInstance.nativeSocketBillInfo;

      var _ref = index_["ViewModel"].getData(nameSpace) || {},
          formAreaCode = _ref.formAreaCode,
          billtype = _ref.billtype,
          billpkname = _ref.billpkname;

      _this3.billtype = billtype;
      var gtxid = pageInstance.form.getFormItemsValue(formAreaCode, 'saga_gtxid');
      _this3.gtxid = gtxid && gtxid.value;
      var billpk = pageInstance.form.getFormItemsValue(formAreaCode, billpkname);
      _this3.billpk = billpk && billpk.value;

      _this3.setState({
        showBillTrack: true
      });
    };

    typeof _this3.props.getThis === 'function' && _this3.props.getThis(CrossServiceBtns_create_assertThisInitialized(_this3));
    _this3.state = {
      isError: _this3.props.isError || false,
      showBillTrack: false,
      json: {},
      LangData: null
    };
    _this3.gtxid = '';
    _this3.billpk = '';
    _this3.billtype = '';
    return _this3;
  }

  CrossServiceBtns_create_createClass(CrossServiceCardBtn, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this4 = this;

      var callback = function callback(json, bool, LangData) {
        _this4.setState({
          json: json,
          LangData: LangData
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'base_errorTip',
        callback: callback
      });
    } //根据 props 更新 

  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var oldState = this.state;
      var isEquat = true;

      for (var _i = 0, _Object$keys = Object.keys(nextProps); _i < _Object$keys.length; _i++) {
        var pop = _Object$keys[_i];

        if (oldState.hasOwnProperty(pop) && oldState[pop] !== nextProps[pop]) {
          isEquat = false;
          oldState[pop] = nextProps[pop];
        }
      } //判断两个对象是否相等


      if (!isEquat) {
        this.setState({
          oldState: oldState
        });
      }
    }
  }, {
    key: "componentDidMount",
    value: function componentDidMount() {
      var isError = this.state.isError,
          $this = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(this),
          $parent = create_Closest($this, '.nc-bill-header-area,.u-affix-content');
      if (!$parent) return;
      $parent.className = $parent.className.replace(/socket-error-class/g, '');

      if (isError) {
        $parent.className = $parent.className + ' socket-error-class';
      } // console.log('dom in cross', $this, $parent);

    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate() {
      var isError = this.state.isError,
          $this = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(this),
          $parent = create_Closest($this, '.nc-bill-header-area,.socket-error-class,.u-affix-content');
      if (!$parent) return;
      $parent.className = $parent.className.replace(/socket-error-class/g, '');

      if (isError) {
        $parent.className = $parent.className + ' socket-error-class';
      } // console.log('dom in cross', $this, $parent);

    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      var $this = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(this),
          $parent = create_Closest($this, '.socket-error-class,.nc-bill-header-area,.u-affix-content');
      if (!$parent) return;
      $parent.className = $parent.className.replace(/socket-error-class/g, '');
    }
  }, {
    key: "render",
    value: function render() {
      var _this5 = this;

      var _this$state = this.state,
          isError = _this$state.isError,
          showBillTrack = _this$state.showBillTrack,
          json = _this$state.json;
      var errorViewType = this.props.errorViewType;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "billHead-errorBtn-wrapper"
      }, isError && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        inverse: true,
        trigger: "hover",
        overlay: json['base-error-tip-0001'] || '点击查看错误原因',
        placement: "top",
        delay: 1,
        delayShow: 800
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "error-flag iconfont icon icon-gantanhao",
        onClick: this.queryBillTrack
      })), errorViewType !== 'none' && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["BillErrorTrack"], {
        show: showBillTrack,
        close: function close() {
          _this5.setState({
            showBillTrack: false
          });
        },
        pk: this.billpk //单据id
        ,
        type: this.billtype //单据类型
        ,
        gtxid: this.gtxid //错误id
        ,
        errorViewType: errorViewType // pk= "1001Z81000000001PYQH" //单据id
        // type='5F'  //单据类型
        // gtxid='2019110863519ada-eef2-4a47-93b5-446478d3d31b' //错误id
        //bodyClientHeight="500" //在第二层iframe里不用配置，如果iframe层更多，需要传一下body的高度

      }));
    }
  }]);

  return CrossServiceCardBtn;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);
// CONCATENATED MODULE: ./src/platform/components/CrossServiceBtns/methods.js
function methods_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function methods_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { methods_ownKeys(Object(source), true).forEach(function (key) { CrossServiceBtns_methods_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { methods_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function CrossServiceBtns_methods_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * 更新跨服务按钮状态
 * @param {*string} areaId 按钮区域id
 * @param {*object} data 配置参数
 * data示例：{
 *   isError: true //显示重试、回退；否则显示浏览器按钮
 * } 
 */
function toggleErrorStatus(areaId, data) {
  if (!this.myCrossServiceBtn[areaId]) {
    return;
  }

  var btnInstance = this.myCrossServiceBtn[areaId];

  var newState = methods_objectSpread(methods_objectSpread({}, btnInstance.state), data);

  btnInstance.setState({
    isError: newState.isError,
    tipContent: newState.tipContent
  });
}
// CONCATENATED MODULE: ./src/platform/components/CrossServiceBtns/index.js


/* harmony default export */ var CrossServiceBtns = ({
  createErrorButton: createErrorButton,
  createErrorFlag: createErrorFlag,
  toggleErrorStatus: toggleErrorStatus
});
// CONCATENATED MODULE: ./src/platform/components/Socket/getUserId.js

var getUserId_getGlobalStorage = index_["ViewModel"].getGlobalStorage;
function getUserId() {
  var userid = '';
  var userDataJSON = getUserId_getGlobalStorage('localStorage', "STOREFORINFODATA");
  var userData = userDataJSON && JSON.parse(userDataJSON);
  userid = userData && userData.userId;
  return userid;
}
// CONCATENATED MODULE: ./src/platform/components/Socket/getUserInfo.js

var getUserInfo_getGlobalStorage = index_["ViewModel"].getGlobalStorage;
function getUserInfo(name) {
  var userDataJSON = getUserInfo_getGlobalStorage('localStorage', 'STOREFORINFODATA');
  var userData = userDataJSON && JSON.parse(userDataJSON);
  return name && userData && userData[name];
}
// CONCATENATED MODULE: ./src/platform/components/Socket/closeStatus.js
// https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes
// https://tools.ietf.org/html/rfc6455#section-7.4.1
var codes = {
  1000: {
    reason: 'Normal Closure',
    desc: 'Normal closure; the connection successfully completed whatever purpose for which it was created.',
    tips: ''
  },
  1001: {
    reason: 'Going Away',
    desc: 'The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.',
    tips: ''
  },
  1002: {
    reason: 'Protocol Error',
    desc: 'The endpoint is terminating the connection due to a protocol error.',
    tips: ''
  },
  1003: {
    reason: 'Unsupported Data',
    desc: 'The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data).',
    tips: ''
  },
  1004: {
    reason: '',
    desc: 'Reserved. A meaning might be defined in the future.',
    tips: ''
  },
  1005: {
    reason: 'No Status Received',
    desc: 'Reserved.  Indicates that no status code was provided even though one was expected.',
    tips: ''
  },
  // 异常关闭比较常见
  1006: {
    reason: 'Abnormal Closure',
    desc: 'Reserved. Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected.',
    tips: ''
  },
  1007: {
    reason: 'Invalid frame payload data',
    desc: 'The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message).',
    tips: ''
  },
  1008: {
    reason: 'Policy Violation',
    desc: 'The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable.',
    tips: ''
  },
  1009: {
    reason: 'Message too big',
    desc: 'The endpoint is terminating the connection because a data frame was received that is too large.',
    tips: ''
  },
  1010: {
    reason: 'Missing Extension',
    desc: 'The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn\'t.',
    tips: ''
  },
  1011: {
    reason: 'Internal Error',
    desc: 'The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request.',
    tips: ''
  },
  1012: {
    reason: 'Service Restart',
    desc: 'The server is terminating the connection because it is restarting. [Ref]',
    tips: ''
  },
  1013: {
    reason: 'Try Again Later',
    desc: 'The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients. [Ref]',
    tips: ''
  },
  1014: {
    reason: 'Bad Gateway',
    desc: 'The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code.',
    tips: ''
  },
  1015: {
    reason: 'TLS Handshake',
    desc: 'Reserved. Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can\'t be verified).',
    tips: ''
  },
  4501: {
    reason: '服务内部的错误。',
    desc: '服务内部的错误。',
    tips: '联系管理员或者相关技术人员进行分析解决。'
  }
};
// CONCATENATED MODULE: ./src/platform/components/Socket/uniqueChannel.js
function uniqueChannel_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function uniqueChannel_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function uniqueChannel_createClass(Constructor, protoProps, staticProps) { if (protoProps) uniqueChannel_defineProperties(Constructor.prototype, protoProps); if (staticProps) uniqueChannel_defineProperties(Constructor, staticProps); return Constructor; }

// socket 全局消息控制器

var setGlobalStorage = index_["ViewModel"].setGlobalStorage,
    uniqueChannel_getGlobalStorage = index_["ViewModel"].getGlobalStorage,
    uniqueChannel_removeGlobalStorage = index_["ViewModel"].removeGlobalStorage,
    getDecryptData = index_["ViewModel"].getDecryptData;
/**
 * 生成唯一标 识
 */

function uniqueChannel_uuidv4() {
  return "xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g, function (c) {
    var r = Object(index_["getSafeRandom"])() * 16 | 0,
        v = c == "x" ? r : r & 0x3 | 0x8;
    return v.toString(16);
  });
}

var ChannelCtrl = /*#__PURE__*/function () {
  // 动作标识
  function ChannelCtrl() {
    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    uniqueChannel_classCallCheck(this, ChannelCtrl);

    this.props = props;
    this.recieve = this.recieve.bind(this);
    this.uuidv4 = uniqueChannel_uuidv4();
    this.unique = props.unique || this.uuidv4;
    this.re = new RegExp('^' + this.unique);
  }

  uniqueChannel_createClass(ChannelCtrl, [{
    key: "recieve",
    value: function recieve(e) {
      var onRecieve = this.props.onRecieve;

      if (String(e.key).match(this.re)) {
        // localStorage.setItem時 如   ___socket_channel___ 前缀  localStorage.setItem('___socket_channel___XXXX')
        var key = e.key.replace(this.re, '');
        var value = getDecryptData(e.newValue) || uniqueChannel_getGlobalStorage('localStorage', e.key);
        var obj = value ? JSON.parse(value) : '';
        onRecieve && onRecieve(obj, key);
      }
    }
  }, {
    key: "setRecieve",
    value: function setRecieve(f) {
      this.props.onRecieve = f;
    }
  }, {
    key: "start",
    value: function start() {
      window.addEventListener('storage', this.recieve, false);
      return this;
    }
  }, {
    key: "send",
    value: function send(event, message) {
      var _this = this;

      setGlobalStorage('localStorage', this.unique + event, JSON.stringify(message)); // clean up localstorage

      setTimeout(function () {
        uniqueChannel_removeGlobalStorage('localStorage', _this.unique + event);
      }, 10);
    }
  }, {
    key: "destroy",
    value: function destroy() {
      this.props.onRecieve = null;
      window.removeEventListener('storage', this.recieve);
    }
  }]);

  return ChannelCtrl;
}();

ChannelCtrl.ChannelAction = {
  check: 'checkUnique',
  message: 'sendMessage',
  reply: 'uniqueReply'
};
/* harmony default export */ var uniqueChannel = (ChannelCtrl);
// CONCATENATED MODULE: ./src/platform/components/Socket/heartCheck.js
function heartCheck_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function heartCheck_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function heartCheck_createClass(Constructor, protoProps, staticProps) { if (protoProps) heartCheck_defineProperties(Constructor.prototype, protoProps); if (staticProps) heartCheck_defineProperties(Constructor, staticProps); return Constructor; }

// 心跳检测  暂时不需要使用 send方法socket服务端不支持
var HeartCheck = /*#__PURE__*/function () {
  function HeartCheck() {
    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    heartCheck_classCallCheck(this, HeartCheck);

    this.props = props;
    this.count = props.count || 3;
    this.timeout = props.timeout || 3000;
  }

  heartCheck_createClass(HeartCheck, [{
    key: "start",
    value: function start() {
      var _this = this;

      var running = this.props.running;
      console.log(this.timeout);
      this.timeoutObj = setInterval(function () {
        _this.count--;
        running && running(_this);
      }, this.timeout);
    }
  }, {
    key: "restart",
    value: function restart() {
      this.count = 3;
      this.stop();
      this.start();
    }
  }, {
    key: "stop",
    value: function stop() {
      clearInterval(this.timeoutObj);
    }
  }, {
    key: "destory",
    value: function destory() {// TODO
    }
  }]);

  return HeartCheck;
}();


// CONCATENATED MODULE: ./src/platform/components/Socket/connect.js
function connect_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { connect_typeof = function _typeof(obj) { return typeof obj; }; } else { connect_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return connect_typeof(obj); }

function connect_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function connect_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { connect_ownKeys(Object(source), true).forEach(function (key) { connect_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { connect_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function connect_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function connect_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function connect_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function connect_createClass(Constructor, protoProps, staticProps) { if (protoProps) connect_defineProperties(Constructor.prototype, protoProps); if (staticProps) connect_defineProperties(Constructor, staticProps); return Constructor; }

function connect_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) connect_setPrototypeOf(subClass, superClass); }

function connect_setPrototypeOf(o, p) { connect_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return connect_setPrototypeOf(o, p); }

function connect_createSuper(Derived) { var hasNativeReflectConstruct = connect_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = connect_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = connect_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return connect_possibleConstructorReturn(this, result); }; }

function connect_possibleConstructorReturn(self, call) { if (call && (connect_typeof(call) === "object" || typeof call === "function")) { return call; } return connect_assertThisInitialized(self); }

function connect_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function connect_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function connect_getPrototypeOf(o) { connect_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return connect_getPrototypeOf(o); }



 //import BillErrorTrack from '../BillErrorTrack';






var connect_gzip = new index_["gzip"]();

__webpack_require__(930);

var connect_getGlobalStorage = index_["ViewModel"].getGlobalStorage,
    connect_setGlobalStorage = index_["ViewModel"].setGlobalStorage;
var isLocal = NODE_ENV === 'development';
var defaultUserId = isLocal ? 'renyjk' : ''; // 仅仅用于本地测试 

var ReadyState = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'],
    Timeout = 4000,
    Count = 99999,
    MESSAGE = uniqueChannel.ChannelAction.message;

var connect_SocketConnect = /*#__PURE__*/function (_Component) {
  connect_inherits(SocketConnect, _Component);

  var _super = connect_createSuper(SocketConnect);

  function SocketConnect(props) {
    var _this;

    connect_classCallCheck(this, SocketConnect);

    _this = _super.call(this, props); // 错误追溯使用

    _this.closeSocket = function () {
      _this.isConnect && connect_setGlobalStorage('localStorage', '__socket_connect_', 'N');

      if (_this.CWebSocket) {
        //关闭websocket连接
        _this.CWebSocket.close(); // 1000 组件注销关闭
        // alert("关闭了WebSocket连接")


        _this.CWebSocket = null;
      }
    };

    _this.WebSocketConnect = function () {
      if (!_this.tabid) {
        // 使用top来保持多层的tabid相同
        _this.tabid = top && top.WebSocketTabid ? top.WebSocketTabid : _this.randomNumber(); // 挂载下 给ajax 使用

        window.WebSocketTabid = _this.tabid;
        top.WebSocketTabid = _this.tabid;
        console.log('页签时间戳值为：', _this.tabid);
      } // 判断当前浏览器中是否已经建立了链接


      var isConnect = connect_getGlobalStorage('localStorage', '__socket_connect_') === 'Y';
      if (isConnect) return; // 启动定时器 不停发送消息避免链接中断

      _this.HeartCheck.restart(); // 注意下用户信息的获取顺序


      var userid = _this.state.userid || getUserId() || defaultUserId,
          ds = _this.state.ds || getUserInfo('datasource') || '',
          serverIP = window.top.location.hostname,
          serverPort = window.location.port ? ':' + window.location.port : window.location.port,
          wsLocation = serverIP + serverPort,
          loacalWsLocation = _this.props.serverLocation;
      if (loacalWsLocation) wsLocation = loacalWsLocation; // 加密

      var cipherFlag = connect_getGlobalStorage('localStorage', 'rockin'); // 将是否加密缓存到组件单例上

      index_["Cipher"].CipherFlag = cipherFlag === 'true';
      var socketParams = index_["Cipher"].CipherFlag ? index_["Cipher"].encrypt("userid=".concat(userid).concat(ds), '15469120627904bc557cd9d084a8fae1') : "userid=".concat(userid).concat(ds);
      if (!userid) return;
      _this.wsUrl = "".concat(window.location.protocol == 'https:' ? 'wss' : 'ws', "://").concat(wsLocation, "/websocket/api/messagelistener/?") + socketParams;

      try {
        _this.CWebSocket = new WebSocket(_this.wsUrl);

        _this.init();
      } catch (e) {
        console.log('catch');

        _this.reconnect();
      }
    };

    _this.createWebSocket = function () {
      // 请求开发 判断是否是合盘环境，若为合盘环境，不使用websocket
      var connectSwitch = connect_getGlobalStorage('localStorage', '_ncc_websocket_switch_');

      if (connectSwitch === null) {
        Object(index_["ajax"])({
          url: '/nccloud/platform/query/merge.do',
          data: {},
          async: false,
          method: 'post',
          success: function success(res) {
            if (res.success) {
              if (res.data) {
                //合盘环境，开关是“0” 不建立websocket
                connect_setGlobalStorage('localStorage', '_ncc_websocket_switch_', '0');
              } else {
                //分盘环境，开关时“1”建立webscoket
                connect_setGlobalStorage('localStorage', '_ncc_websocket_switch_', '1');

                _this.WebSocketConnect();
              }
            }
          }
        });
      } else if (connectSwitch === '1') {
        _this.WebSocketConnect();
      }
    };

    _this.init = function () {
      _this.CWebSocket.onclose = function (event) {
        console.log('websocket连接关闭', event, event.reason, codes[event.code]);
        connect_setGlobalStorage('localStorage', '__socket_connect_', 'N'); // 记录是否已经链接了

        if (event.code != 1000) {
          _this.reconnect();
        }
      };

      _this.CWebSocket.onerror = function (event) {
        console.log('websocket连接发生异常了', event);
        connect_setGlobalStorage('localStorage', '__socket_connect_', 'N'); // 记录是否已经链接了

        _this.reconnect();
      };

      _this.CWebSocket.onopen = function () {
        _this.count = Count;
        connect_setGlobalStorage('localStorage', '__socket_connect_', 'Y'); // 记录是否已经链接了
        // 记录当前socket 是否链接

        _this.isConnect = true; // 链接是否打开

        console.log(_this.CWebSocket);
        console.log(ReadyState[_this.CWebSocket.readyState]);
      };

      _this.CWebSocket.onmessage = function (event) {
        _this.count = Count;
        connect_setGlobalStorage('localStorage', '__socket_connect_', 'Y'); // 记录是否已经链接了
        // 记录当前socket 是否链接

        _this.isConnect = true;
        console.log('websocket接收到消息'); // 发消息给其他页签

        _this.ChannelCtrl.send(MESSAGE, event.data);

        _this.sendMessageToIframe({
          data: event.data
        });

        _this.handleMessage(event); //拿到任何消息都说明当前连接是正常的

      };
    };

    _this.handleMessage = function (evt) {
      var userid = getUserId() || defaultUserId,
          ds = getUserInfo('datasource') || '',
          data = JSON.parse(evt.data);

      if (data && data.origin === 'websocket-server') {
        // system 是 true时，为公共系统提示
        return;
      }

      var json = _this.state.json;
      var resMessage = connect_gzip.unzip(data.message) || {};
      var _this$props = _this.props,
          _this$props$isShowVie = _this$props.isShowView,
          isShowView = _this$props$isShowVie === void 0 ? true : _this$props$isShowVie,
          _this$props$isShowToa = _this$props.isShowToast,
          isShowToast = _this$props$isShowToa === void 0 ? true : _this$props$isShowToa,
          onMessage = _this$props.onMessage,
          billpkname = _this$props.billpkname; // 当前用户，激活页签下显示

      var condition = data.targetids.includes(userid + ds) && !document.hidden; // 为 saga 错误类型时显示

      var saga_mesg = data.origin === 'ncc-server' && resMessage.type === 'saga_error'; // 为龙哥新增 重试、回退成功后的错误消息

      var hint_mesg = data.origin === 'ncc-server' && resMessage.type === 'saga_hint';

      if (condition) {
        // 如果返回了消息清除  重试中和回退中的提示 
        Object(index_["clearToast"])('socketReSetErrorToast');
        Object(index_["clearToast"])('socketBackErrorToast'); // saga出错提示

        if (saga_mesg) {
          if (resMessage.error) {
            if (resMessage.billtype) _this.billtype = resMessage.billtype;

            if (Array.isArray(resMessage.refreshData) && resMessage.refreshData.length > 0) {
              _this.gtxid = resMessage.refreshData[0].saga_gtxid;
              _this.billpk = resMessage.refreshData[0][billpkname || '_businessPk'];
            } // 内外页参数同步


            isShowView = top && _this.gtxid && top.SocketConfig && top.SocketConfig[_this.gtxid] ? top.SocketConfig[_this.gtxid] : isShowView;
            isShowToast = top && _this.gtxid && top.SocketConfig && top.SocketConfig[_this.gtxid] ? top.SocketConfig[_this.gtxid] : isShowToast;

            if (resMessage.msg) {
              var isdisplay = typeof resMessage.isdisplay === 'undefined' ? true : resMessage.isdisplay;
              isShowToast && Object(index_["toast"])({
                mark: 'socketErrorToast' + _this.gtxid,
                color: 'danger',
                title: json['page-socket-0001'] || '发送失败',
                customBtnBeforeClose: isShowView && isdisplay ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                  "data-mark": _this.gtxid,
                  onClick: function onClick(event) {
                    //-- 解决CLOUD-182009
                    var current_gtxid = event.target.getAttribute('data-mark');

                    if (current_gtxid) {
                      _this.gtxid = current_gtxid;
                      var current_saga = _this.saga_popInfo[_this.gtxid];
                      _this.billpk = current_saga && current_saga.billpk;
                      _this.billtype = current_saga && current_saga.billtype;
                    }

                    _this.setState({
                      showBillTrack: true
                    });
                  }
                }, json['page-socket-0002'] || '立即查看') : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null),
                groupOperation: true,
                groupOperationMsg: [resMessage.msg]
              }); //存储当前页面多条saga返回数据,解决CLOUD-182009

              _this.saga_popInfo[_this.gtxid] = {
                billpk: _this.billpk,
                billtype: _this.billtype
              };
            }
          } else {
            // 只是给测试统计跨服务事务效率用的，先单元测试，去掉
            isShowToast && Object(index_["toast"])({
              // mark: 'socketErrorToast',
              color: 'success',
              title: json['page-socket-0003'] || '跨服务事务处理成功！'
            });
          }
        } // 重试或者回退成功的消息提示


        if (hint_mesg) {
          // 清除一进入页面就出现的提示
          console.log('socketErrorToast' + _this.gtxid);
          Object(index_["clearToast"])('socketErrorToast');
          Object(index_["clearToast"])('socketErrorToast' + _this.gtxid);

          if (!resMessage.error) {
            //成功的消息提示
            // clearToast('socketErrorToast'); // 清除一进入页面就出现的提示
            isShowToast && Object(index_["toast"])({
              color: 'success',
              content: resMessage.msg
            });
          } else {
            // 失败的消息提示
            isShowToast && Object(index_["toast"])({
              color: 'danger',
              content: resMessage.msg
            });
          }
        }
      } // 消息和交互分開


      if (data.targetids.includes(userid + ds) && resMessage.tabid === _this.tabid) {
        //调用业务组注册的回调
        if (typeof onMessage === 'function') {
          // 错误中心，重试或者回退成功的提示，无法获取到，因为重试或者回退成功，龙哥给的tabid不对(始终是第一次重试的tabid)
          onMessage(connect_objectSpread(connect_objectSpread({}, _this.props), _this.output), resMessage);
        }

        if (typeof window.top.onSocketMessage === 'function') {
          window.top.onSocketMessage(resMessage);
        }
      }
    };

    _this.reconnect = function () {
      if (_this.lockReconnect) {
        return;
      }

      if (_this.count <= 0) {
        Object(index_["toast"])({
          color: 'error',
          title: _this.state.json['page-socket-0004'] || 'Socket重连已达次数上限,请联系管理员或者刷新页面重试！'
        });
        return;
      }

      _this.lockReconnect = true;
      _this.count--;
      console.log(_this.count); //没连接上会一直重连，设置延迟避免请求过多

      setTimeout(function () {
        console.log('websocket发起重连');

        _this.createWebSocket();

        _this.lockReconnect = false;
      }, Timeout);
    };

    _this.randomNumber = function () {
      var now = new Date();
      var month = now.getMonth() + 1;
      var day = now.getDate();
      var hour = now.getHours();
      var minutes = now.getMinutes();
      var seconds = now.getSeconds();
      return now.getFullYear().toString() + month.toString() + day + hour + minutes + seconds + Math.round(Object(index_["getSafeRandom"])() * 23 + 100).toString();
    };

    _this.state = {
      showBillTrack: false,
      userId: props.userId,
      ds: props.ds,
      json: {},
      LangData: null
    };
    _this.saga_popInfo = {};
    _this.gtxid = '';
    _this.billpk = '';
    _this.billtype = props.billtype; // 页面连接标识，用户接收消息时，判断是不是该连接

    _this.tabid = ''; // 重连计数器

    _this.count = Count; // soket实例

    _this.CWebSocket = null; // 连接标识，避免重复连接

    _this.lockReconnect = false; // 创建多页签消息机制

    _this.recieve = _this.recieve.bind(connect_assertThisInitialized(_this));
    _this.running = _this.running.bind(connect_assertThisInitialized(_this));
    _this.ChannelCtrl = new uniqueChannel({
      unique: '___socket_channel___',
      onRecieve: _this.recieve
    }).start(); // 添加心跳检测

    _this.HeartCheck = new HeartCheck({
      running: _this.running,
      count: 99999,
      timeout: 50 * 1000 // 每50秒发送一次信息

    });
    console.log('socket connect channel ');
    return _this;
  }

  connect_createClass(SocketConnect, [{
    key: "running",
    value: function running() {
      console.log('send message for connect check');
      this.isConnect && this.CWebSocket && this.CWebSocket.send(String(new Date().getTime()));
    } // 接收多页签消息

  }, {
    key: "recieve",
    value: function recieve(obj, key) {
      // 收到其他页签的socket的消息  然后提示
      if (key == MESSAGE && obj && !this.isConnect) {
        //TODO 可能还要判断消息是不是自己发的 避免自己提示自己
        console.log(obj);

        try {
          this.sendMessageToIframe({
            data: obj
          });
        } catch (error) {
          console.error ? console.error(error) : console.log(error); // throw error;
        } // 这里一定要先更新内页  这样才能把一些信息参数更新掉
        // 比如把内页的参数  更新之后就可以同步到外页了


        this.handleMessage({
          data: obj
        });
      }
    }
  }, {
    key: "sendMessageToIframe",
    value: function sendMessageToIframe(obj) {
      if (top && top.SocketMessageFun) {
        for (var item in top.SocketMessageFun) {
          if (typeof top.SocketMessageFun[item] == 'function') {
            top.SocketMessageFun[item](obj);
          }
        }
      }
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var _this2 = this;

      console.log(nextProps.userId);

      if (nextProps.userId !== this.state.userId) {
        // 更新链接
        this.setState({
          userId: nextProps.userId,
          ds: nextProps.ds
        }, function () {
          // 销毁之后不在重连
          _this2.lockReconnect = true;

          _this2.closeSocket();

          _this2.createWebSocket();
        });
      }
    }
  }, {
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this3 = this;

      var callback = function callback(json, bool, LangData) {
        _this3.setState({
          json: json,
          LangData: LangData
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'page_socket',
        callback: callback
      });
    }
  }, {
    key: "componentDidMount",
    value: function componentDidMount() {
      // 界面初始化时，建立websocket连接
      this.createWebSocket();
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      // 销毁之后不在重连
      this.lockReconnect = true;
      this.closeSocket();
      this.isConnect && connect_setGlobalStorage('localStorage', '__socket_connect_', 'N');
      this.ChannelCtrl.destroy();
      this.HeartCheck.stop();
    }
  }, {
    key: "render",
    value: function render() {
      var _this4 = this;

      var _this$props$errorView = this.props.errorViewType,
          errorViewType = _this$props$errorView === void 0 ? true : _this$props$errorView;
      errorViewType = top && top.SocketConfig && top.SocketConfig[this.gtxid] ? top.SocketConfig[this.gtxid] : errorViewType;
      return errorViewType === 'none' ? null : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["BillErrorTrack"], {
        show: this.state.showBillTrack,
        close: function close() {
          _this4.setState({
            showBillTrack: false
          });
        },
        pk: this.billpk //单据id
        ,
        type: this.billtype //单据类型
        ,
        gtxid: this.gtxid //错误id
        ,
        errorViewType: errorViewType // bodyClientHeight="500" //在第二层iframe里不用配置，如果iframe层更多，需要传一下body的高度

      });
    }
  }]);

  return SocketConnect;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// EXTERNAL MODULE: ./src/platform/components/DragWidthCom/index.js
var DragWidthCom = __webpack_require__(382);

// CONCATENATED MODULE: ./src/platform/components/HotkeyHelper/staticData.js
/**
 * 快捷键描述的静态数据 维护老麻烦了
 */
var staticData_langJson = {};

function getLangJson(code) {
  return staticData_langJson[code] || "";
}

function _getData(type) {
  var data = [];

  switch (type) {
    case "grid":
      data = [{
        name: "Tab",
        desc: getLangJson("hk-0012")
      }, {
        name: "Shift+Tab",
        desc: getLangJson("hk-0013")
      }, {
        name: "↑",
        desc: getLangJson("hk-0010")
      }, {
        name: "↓",
        desc: getLangJson("hk-0011")
      }, {
        name: "Enter",
        desc: getLangJson("hk-0014")
      }, {
        name: "Esc",
        desc: getLangJson("hk-0023")
      }, {
        name: "Alt+Y",
        desc: getLangJson("hk-0015")
      }, {
        name: "Alt+N",
        desc: getLangJson("hk-0016")
      }, {
        name: "Fn+↑、Pageup",
        desc: getLangJson("hk-0017")
      }, {
        name: "Fn+↓、Pagedown",
        desc: getLangJson("hk-0018")
      }, {
        name: "Fn+←",
        desc: getLangJson("hk-0019")
      }, {
        name: "Fn+→",
        desc: getLangJson("hk-0020")
      }, {
        name: "Ctrl+←",
        desc: getLangJson("hk-0021")
      }, {
        name: "Ctrl+→",
        desc: getLangJson("hk-0022")
      }];
      break;

    case "gridMulti":
      data = [{
        name: "Tab",
        desc: getLangJson("hk-0012")
      }, {
        name: "Shift+Tab",
        desc: getLangJson("hk-0013")
      }, {
        name: "↑",
        desc: getLangJson("hk-0010")
      }, {
        name: "↓",
        desc: getLangJson("hk-0011")
      }, {
        name: getLangJson("hk-0025"),
        desc: getLangJson("hk-0024")
      }, {
        name: "Enter",
        desc: getLangJson("hk-0014")
      }, {
        name: "Esc",
        desc: getLangJson("hk-0023")
      }, {
        name: "Alt+Y",
        desc: getLangJson("hk-0015")
      }, {
        name: "Alt+N",
        desc: getLangJson("hk-0016")
      }, {
        name: "Fn+↑、Pageup",
        desc: getLangJson("hk-0017")
      }, {
        name: "Fn+↓、Pagedown",
        desc: getLangJson("hk-0018")
      }, {
        name: "Fn+←",
        desc: getLangJson("hk-0019")
      }, {
        name: "Fn+→",
        desc: getLangJson("hk-0020")
      }, {
        name: "Ctrl+←",
        desc: getLangJson("hk-0021")
      }, {
        name: "Ctrl+→",
        desc: getLangJson("hk-0022")
      }];
      break;

    case "tree":
      data = [{
        name: "Tab",
        desc: getLangJson("hk-0012")
      }, {
        name: "Shift+Tab",
        desc: getLangJson("hk-0013")
      }, {
        name: "↑",
        desc: getLangJson("hk-0010")
      }, {
        name: "↓",
        desc: getLangJson("hk-0011")
      }, {
        name: "←",
        desc: getLangJson("hk-0026")
      }, {
        name: "→",
        desc: getLangJson("hk-0027")
      }, {
        name: "Enter",
        desc: getLangJson("hk-0014")
      }, {
        name: "Esc",
        desc: getLangJson("hk-0023")
      }, {
        name: "Alt+Y",
        desc: getLangJson("hk-0015")
      }, {
        name: "Alt+N",
        desc: getLangJson("hk-0016")
      }, {
        name: "Fn+↑、Pageup",
        desc: getLangJson("hk-0017")
      }, {
        name: "Fn+↓、Pagedown",
        desc: getLangJson("hk-0018")
      }, {
        name: "Fn+←",
        desc: getLangJson("hk-0019")
      }, {
        name: "Fn+→",
        desc: getLangJson("hk-0020")
      }, {
        name: "Ctrl+←",
        desc: getLangJson("hk-0021")
      }, {
        name: "Ctrl+→",
        desc: getLangJson("hk-0022")
      }];
      break;

    case "treeMulti":
      data = [{
        name: "Tab",
        desc: getLangJson("hk-0012")
      }, {
        name: "Shift+Tab",
        desc: getLangJson("hk-0013")
      }, {
        name: "↑",
        desc: getLangJson("hk-0010")
      }, {
        name: "↓",
        desc: getLangJson("hk-0011")
      }, {
        name: "←",
        desc: getLangJson("hk-0026")
      }, {
        name: "→",
        desc: getLangJson("hk-0027")
      }, {
        name: getLangJson("hk-0025"),
        desc: getLangJson("hk-0024")
      }, {
        name: "Enter",
        desc: getLangJson("hk-0014")
      }, {
        name: "Esc",
        desc: getLangJson("hk-0023")
      }, {
        name: "Alt+Y",
        desc: getLangJson("hk-0015")
      }, {
        name: "Alt+N",
        desc: getLangJson("hk-0016")
      }, {
        name: "Fn+↑、Pageup",
        desc: getLangJson("hk-0017")
      }, {
        name: "Fn+↓、Pagedown",
        desc: getLangJson("hk-0018")
      }, {
        name: "Fn+←",
        desc: getLangJson("hk-0019")
      }, {
        name: "Fn+→",
        desc: getLangJson("hk-0020")
      }, {
        name: "Ctrl+←",
        desc: getLangJson("hk-0021")
      }, {
        name: "Ctrl+→",
        desc: getLangJson("hk-0022")
      }];
      break;

    case "gridTree":
      data = [{
        name: "Tab",
        desc: getLangJson("hk-0012")
      }, {
        name: "Shift+Tab",
        desc: getLangJson("hk-0013")
      }, {
        name: "↑",
        desc: getLangJson("hk-0010")
      }, {
        name: "↓",
        desc: getLangJson("hk-0011")
      }, {
        name: "←",
        desc: getLangJson("hk-0010")
      }, {
        name: "→",
        desc: getLangJson("hk-0011")
      }, {
        name: "Shift+←",
        desc: getLangJson("hk-0028")
      }, {
        name: "Shift+→",
        desc: getLangJson("hk-0029")
      }, {
        name: "Enter",
        desc: getLangJson("hk-0014")
      }, {
        name: "Esc",
        desc: getLangJson("hk-0023")
      }, {
        name: "Alt+Y",
        desc: getLangJson("hk-0015")
      }, {
        name: "Alt+N",
        desc: getLangJson("hk-0016")
      }, {
        name: "Fn+↑、Pageup",
        desc: getLangJson("hk-0017")
      }, {
        name: "Fn+↓、Pagedown",
        desc: getLangJson("hk-0018")
      }, {
        name: "Fn+←",
        desc: getLangJson("hk-0019")
      }, {
        name: "Fn+→",
        desc: getLangJson("hk-0020")
      }, {
        name: "Ctrl+←",
        desc: getLangJson("hk-0021")
      }, {
        name: "Ctrl+→",
        desc: getLangJson("hk-0022")
      }];
      break;

    case "gridTreeMulti":
      data = [{
        name: "Tab",
        desc: getLangJson("hk-0012")
      }, {
        name: "Shift+Tab",
        desc: getLangJson("hk-0013")
      }, {
        name: "↑",
        desc: getLangJson("hk-0010")
      }, {
        name: "↓",
        desc: getLangJson("hk-0011")
      }, {
        name: "←",
        desc: getLangJson("hk-0026")
      }, {
        name: "→",
        desc: getLangJson("hk-0027")
      }, {
        name: "Shift+←",
        desc: getLangJson("hk-0028")
      }, {
        name: "Shift+→",
        desc: getLangJson("hk-0029")
      }, {
        name: getLangJson("hk-0025"),
        desc: getLangJson("hk-0024")
      }, {
        name: "Enter",
        desc: getLangJson("hk-0014")
      }, {
        name: "Esc",
        desc: getLangJson("hk-0023")
      }, {
        name: "Alt+Y",
        desc: getLangJson("hk-0015")
      }, {
        name: "Alt+N",
        desc: getLangJson("hk-0016")
      }, {
        name: "Fn+↑、Pageup",
        desc: getLangJson("hk-0017")
      }, {
        name: "Fn+↓、Pagedown",
        desc: getLangJson("hk-0018")
      }, {
        name: "Fn+←",
        desc: getLangJson("hk-0019")
      }, {
        name: "Fn+→",
        desc: getLangJson("hk-0020")
      }, {
        name: "Ctrl+←",
        desc: getLangJson("hk-0021")
      }, {
        name: "Ctrl+→",
        desc: getLangJson("hk-0022")
      }];
      break;

    case "view":
      data = [{
        area: getLangJson("hk-0032"),
        name: "Ctrl+/",
        desc: getLangJson("hk-0037")
      }, {
        area: getLangJson("hk-0032"),
        name: "Ctrl+/",
        desc: getLangJson("hk-0038")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+P",
        desc: getLangJson("hk-0039")
      }, {
        area: getLangJson("hk-0032"),
        // name: "Ctrl+Del",
        name: "Ctrl+Backspace",
        desc: getLangJson("hk-0040")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+C",
        desc: getLangJson("hk-0041")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+B",
        desc: getLangJson("hk-0042")
      }, {
        area: getLangJson("hk-0032"),
        name: "Ctrl+B",
        desc: getLangJson("hk-0043")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+R",
        desc: getLangJson("hk-0044")
      }, {
        area: getLangJson("hk-0032"),
        name: "Esc",
        desc: getLangJson("hk-0045")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+Pageup",
        desc: getLangJson("hk-0046")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+Pagedown",
        desc: getLangJson("hk-0047")
      }, {
        area: getLangJson("hk-0032"),
        name: "F5",
        desc: getLangJson("hk-0048")
      }, {
        area: getLangJson("hk-0032"),
        name: getLangJson("hk-0051"),
        desc: getLangJson("hk-0049")
      }, {
        area: getLangJson("hk-0032"),
        name: getLangJson("hk-0051"),
        desc: getLangJson("hk-0050")
      }, // --2
      {
        area: getLangJson("hk-0035"),
        name: "Ctrl+I",
        desc: getLangJson("hk-0052")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+I",
        desc: getLangJson("hk-0053")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+U",
        desc: getLangJson("hk-0054")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+U",
        desc: getLangJson("hk-0055")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+G",
        desc: getLangJson("hk-0056")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+G",
        desc: getLangJson("hk-0057")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+J",
        desc: getLangJson("hk-0058")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+J",
        desc: getLangJson("hk-0059")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+J",
        desc: getLangJson("hk-0060")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+J",
        desc: getLangJson("hk-0061")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+Alt+E",
        desc: getLangJson("hk-0062")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+Alt+C",
        desc: getLangJson("hk-0063")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+P",
        desc: getLangJson("hk-0064")
      }, {
        area: getLangJson("hk-0035"),
        name: "Ctrl+K",
        desc: getLangJson("hk-0065")
      }, {
        area: getLangJson("hk-0035"),
        name: getLangJson("hk-0051"),
        desc: getLangJson("hk-0066")
      }, {
        area: getLangJson("hk-0035"),
        name: getLangJson("hk-0051"),
        desc: getLangJson("hk-0067")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+O",
        desc: getLangJson("hk-0068")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+D",
        desc: getLangJson("hk-0069")
      }, {
        area: getLangJson("hk-0035"),
        name: "Alt+L",
        desc: getLangJson("hk-0070")
      }, // -3
      {
        area: getLangJson("hk-0036"),
        name: "Ctrl+Tab",
        desc: getLangJson("hk-0071")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+Shift+Tab",
        desc: getLangJson("hk-0072")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+W",
        desc: getLangJson("hk-0073")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+R",
        desc: getLangJson("hk-0074")
      }, {
        area: getLangJson("hk-0036"),
        name: getLangJson("hk-0025"),
        desc: getLangJson("hk-0075")
      }, {
        area: getLangJson("hk-0036"),
        name: "Home",
        desc: getLangJson("hk-0076")
      }, {
        area: getLangJson("hk-0036"),
        name: "End",
        desc: getLangJson("hk-0077")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl++",
        desc: getLangJson("hk-0078")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+-",
        desc: getLangJson("hk-0079")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+0",
        desc: getLangJson("hk-0080")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+F",
        desc: getLangJson("hk-0081")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+←",
        desc: getLangJson("hk-0082")
      }, {
        area: getLangJson("hk-0036"),
        name: "Ctrl+→",
        desc: getLangJson("hk-0083")
      }];
      break;

    case "edit":
    default:
      data = [// - 1
      {
        area: getLangJson("hk-0030"),
        name: "Tab",
        desc: getLangJson("hk-0084")
      }, {
        area: getLangJson("hk-0030"),
        name: "Shift+Tab",
        desc: getLangJson("hk-0085")
      }, {
        area: getLangJson("hk-0030"),
        name: "Esc",
        desc: getLangJson("hk-0086")
      }, {
        area: getLangJson("hk-0030"),
        name: "←",
        desc: getLangJson("hk-0087")
      }, {
        area: getLangJson("hk-0030"),
        name: "→",
        desc: getLangJson("hk-0088")
      }, {
        area: getLangJson("hk-0030"),
        name: "↑",
        desc: getLangJson("hk-0089")
      }, {
        area: getLangJson("hk-0030"),
        name: "↓",
        desc: getLangJson("hk-0090")
      }, {
        area: getLangJson("hk-0030"),
        name: "F3",
        desc: getLangJson("hk-0091")
      }, {
        area: getLangJson("hk-0030"),
        name: "F2",
        desc: getLangJson("hk-0092")
      }, {
        area: getLangJson("hk-0030"),
        name: "Enter",
        desc: getLangJson("hk-0093")
      }, {
        area: getLangJson("hk-0030"),
        // name: "Del",
        name: "Backspace",
        desc: getLangJson("hk-0094")
      }, {
        area: getLangJson("hk-0030"),
        name: "Pageup",
        desc: getLangJson("hk-0095")
      }, {
        area: getLangJson("hk-0030"),
        name: "Pagedown",
        desc: getLangJson("hk-0096")
      }, {
        area: getLangJson("hk-0030"),
        name: "Alt+←",
        desc: getLangJson("hk-0097")
      }, {
        area: getLangJson("hk-0030"),
        name: "Alt+→",
        desc: getLangJson("hk-0098")
      }, {
        area: getLangJson("hk-0030"),
        name: "Alt+↑",
        desc: getLangJson("hk-0095")
      }, {
        area: getLangJson("hk-0030"),
        name: "Alt+↓",
        desc: getLangJson("hk-0096")
      }, // - 2
      {
        area: getLangJson("hk-0031"),
        name: "Alt+N",
        desc: getLangJson("hk-0099")
      }, {
        area: getLangJson("hk-0031"),
        // name: "Alt+Del",
        name: "Alt+Backspace",
        desc: getLangJson("hk-0100")
      }, {
        area: getLangJson("hk-0031"),
        name: "Alt+I",
        desc: getLangJson("hk-0101")
      }, {
        area: getLangJson("hk-0031"),
        name: "Alt+C",
        desc: getLangJson("hk-0102")
      }, {
        area: getLangJson("hk-0031"),
        name: "Alt+V",
        desc: getLangJson("hk-0103")
      }, {
        area: getLangJson("hk-0031"),
        name: "Ctrl+Alt+V",
        desc: getLangJson("hk-0104")
      }, {
        area: getLangJson("hk-0031"),
        name: "F4",
        desc: getLangJson("hk-0105")
      }, {
        area: getLangJson("hk-0031"),
        name: getLangJson("hk-0051"),
        desc: getLangJson("hk-0106")
      }, {
        area: getLangJson("hk-0031"),
        name: "Alt+P",
        desc: getLangJson("hk-0107")
      }, {
        area: getLangJson("hk-0031"),
        name: "Alt+R",
        desc: getLangJson("hk-0108")
      }, // - 3
      {
        area: getLangJson("hk-0032"),
        name: "F3",
        desc: getLangJson("hk-0109")
      }, {
        area: getLangJson("hk-0032"),
        name: "Ctrl+S",
        desc: getLangJson("hk-0110")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+S",
        desc: getLangJson("hk-0111")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+T",
        desc: getLangJson("hk-0112")
      }, {
        area: getLangJson("hk-0032"),
        name: "Alt+Q",
        desc: getLangJson("hk-0113")
      }, {
        area: getLangJson("hk-0032"),
        name: "Ctrl+Alt+S",
        desc: getLangJson("hk-0114")
      }, {
        area: getLangJson("hk-0032"),
        name: "Shift+←",
        desc: getLangJson("hk-0115")
      }, {
        area: getLangJson("hk-0032"),
        name: "Shift+→",
        desc: getLangJson("hk-0116")
      }, {
        area: getLangJson("hk-0032"),
        name: "Shift+↑",
        desc: getLangJson("hk-0117")
      }, {
        area: getLangJson("hk-0032"),
        name: "Shift+↓",
        desc: getLangJson("hk-0118")
      }, // - 4
      {
        area: getLangJson("hk-0033"),
        name: "Alt+Y",
        desc: getLangJson("hk-0119")
      }, {
        area: getLangJson("hk-0033"),
        name: "Alt+N",
        desc: getLangJson("hk-0120")
      }, {
        area: getLangJson("hk-0033"),
        name: "Enter",
        desc: getLangJson("hk-0121")
      }, {
        area: getLangJson("hk-0033"),
        name: "Esc",
        desc: getLangJson("hk-0122")
      }];
      break;
  }

  return data;
}

var staticData = {
  setLangJson: function setLangJson(json) {
    staticData_langJson = json || [];
  },
  getData: function getData(type, multi) {
    if (type == "tree" && multi) {
      type = "treeMulti";
    }

    if (type == "grid" && multi) {
      type = "gridMulti";
    }

    if (type == "gridTree" && multi) {
      type = "gridTreeMulti";
    }

    return _getData(type);
  }
};
// CONCATENATED MODULE: ./src/platform/components/HotkeyHelper/panel.js
function panel_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { panel_typeof = function _typeof(obj) { return typeof obj; }; } else { panel_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return panel_typeof(obj); }

function panel_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function panel_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function panel_createClass(Constructor, protoProps, staticProps) { if (protoProps) panel_defineProperties(Constructor.prototype, protoProps); if (staticProps) panel_defineProperties(Constructor, staticProps); return Constructor; }

function panel_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) panel_setPrototypeOf(subClass, superClass); }

function panel_setPrototypeOf(o, p) { panel_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return panel_setPrototypeOf(o, p); }

function panel_createSuper(Derived) { var hasNativeReflectConstruct = panel_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = panel_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = panel_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return panel_possibleConstructorReturn(this, result); }; }

function panel_possibleConstructorReturn(self, call) { if (call && (panel_typeof(call) === "object" || typeof call === "function")) { return call; } return panel_assertThisInitialized(self); }

function panel_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function panel_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function panel_getPrototypeOf(o) { panel_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return panel_getPrototypeOf(o); }





__webpack_require__(931);

var panel_HotkeyHelperPanel = /*#__PURE__*/function (_Component) {
  panel_inherits(HotkeyHelperPanel, _Component);

  var _super = panel_createSuper(HotkeyHelperPanel);

  function HotkeyHelperPanel(props) {
    var _this;

    panel_classCallCheck(this, HotkeyHelperPanel);

    _this = _super.call(this, props); // 多语装载

    staticData.setLangJson(_this.props.langJson);
    _this.state = {
      data: _this.getInitData(),
      currentIndex: 0
    }; // 搜索关键字的缓存

    _this.caheKey = "";
    return _this;
  } // static defaultProps = {};
  // 更新数据


  panel_createClass(HotkeyHelperPanel, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      if (nextProps.data != this.props.data) {
        this.setState({
          data: this.getInitData(newData),
          currentIndex: 0
        });
      } // 更新多语


      if (nextProps.langJson != this.props.langJson) {
        // console.log(nextProps.langJson);
        staticData.setLangJson(nextProps.langJson);
        this.setState({
          data: this.getInitData(),
          currentIndex: 0
        });
      }
    }
    /**
     * 获取初始化结果
     */

  }, {
    key: "getInitData",
    value: function getInitData(newData) {
      var _this$props = this.props,
          _this$props$panelType = _this$props.panelType,
          panelType = _this$props$panelType === void 0 ? "common" : _this$props$panelType,
          _this$props$data = _this$props.data,
          data = _this$props$data === void 0 ? [] : _this$props$data,
          limit = _this$props.limit,
          isMultiSelectedEnabled = _this$props.isMultiSelectedEnabled;
      data = newData || data;
      this.initData = this.currentData = [].concat(staticData.getData(panelType, isMultiSelectedEnabled), data); // 建立缓存区

      this.bufferData = this.currentData.slice(limit);
      this.currentData = this.currentData.slice(0, limit);
      return this.currentData;
    }
    /**
     * 获取查询结果
     * @param {*} key
     */

  }, {
    key: "getSearchData",
    value: function getSearchData(key) {
      var _this$props2 = this.props,
          _this$props2$panelTyp = _this$props2.panelType,
          panelType = _this$props2$panelTyp === void 0 ? "common" : _this$props2$panelTyp,
          limit = _this$props2.limit,
          data = [];
      this.initData.map(function (item) {
        var area = item.area,
            name = item.name,
            desc = item.desc; // 不区分大小写

        var nameLow = (name + "").toLocaleLowerCase();
        var keyLow = (key + "").toLocaleLowerCase();
        var descLow = "".concat(desc).toLocaleLowerCase(); // 检索的规则 // area.indexOf(key) != "-1" ||

        if (nameLow.indexOf(keyLow) != "-1" || descLow.indexOf(keyLow) != "-1") {
          data.push(item);
        }
      }); // 建立缓存区

      this.bufferData = data.slice(limit);
      this.currentData = data.slice(0, limit); // 缓存当前的搜索关键字

      this.caheKey = key;
      return this.currentData;
    }
    /**
     * 处理字符串 添加高亮提示
     */

  }, {
    key: "highLight",
    value: function highLight() {
      var str = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "";
      var key = arguments.length > 1 ? arguments[1] : undefined;

      if (key === "" || key === null || key === undefined) {
        return [str];
      } // 不区分大小写


      var keyLow = "".concat(key).toLocaleLowerCase();
      var strLow = "".concat(str).toLocaleLowerCase();

      if (strLow.indexOf(keyLow) === -1) {
        return [str];
      } // 截取


      var remianStr = str;
      var spans = [];
      var len = key.length; // 执行计数器

      var count = 0;

      while (remianStr.length > 0 && len > 0 && count < 300) {
        // while 很容易引起崩溃  注意这个问题
        count++;
        var i = strLow.indexOf(keyLow);

        if (i !== -1) {
          spans.push(remianStr.substring(0, i));
          spans.push( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "search-high"
          }, remianStr.substring(i, i + len)));
          remianStr = remianStr.substring(i + len);
          strLow = strLow.substring(i + len);
        } else {
          spans.push(remianStr);
          remianStr = "";
        }
      } // let arrStr = str.split(key),
      //     spans = [];
      // arrStr.map((item, i) => {
      //     if (i != 0) {
      //         spans.push(<span className="search-high">{key}</span>);
      //     }
      //     spans.push(item);
      // });


      return spans;
    }
    /**
     * 区域是否存在判断
     */

  }, {
    key: "hasArea",
    value: function hasArea() {
      var _this$props3 = this.props,
          panelType = _this$props3.panelType,
          isMultiSelectedEnabled = _this$props3.isMultiSelectedEnabled;
      return isMultiSelectedEnabled && ["tree", "grid", "gridTree"].indexOf(panelType) != -1;
    }
    /**
     * 数据分组
     */

  }, {
    key: "dataGrouping",
    value: function dataGrouping(data) {
      var md = new Map();
      data.map(function (_ref, i) {
        var _ref$area = _ref.area,
            area = _ref$area === void 0 ? "unknown" : _ref$area,
            _ref$name = _ref.name,
            name = _ref$name === void 0 ? "" : _ref$name,
            _ref$desc = _ref.desc,
            desc = _ref$desc === void 0 ? "" : _ref$desc;
        var child = md.get(area) || [];
        child.push({
          name: name,
          desc: desc
        });
        md.set(area, child);
      });
      return md;
    }
    /**
     * 渲染表格行
     */

  }, {
    key: "renderItems",
    value: function renderItems() {
      var _this2 = this;

      var data = this.state.data,
          currentIndex = this.state.currentIndex,
          key = this.caheKey,
          dg = this.dataGrouping(data),
          result = []; // 数据分组
      // console.log(data, dg);

      dg.forEach(function (items, area) {
        var len = items.length;
        items.map(function (_ref2, i) {
          var _ref2$name = _ref2.name,
              name = _ref2$name === void 0 ? "" : _ref2$name,
              _ref2$desc = _ref2.desc,
              desc = _ref2$desc === void 0 ? "" : _ref2$desc;
          result.push( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("tr", {
            tabIndex: currentIndex === i ? "0" : "-1"
          }, _this2.hasArea() || i !== 0 ? "" : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("td", {
            rowSpan: len,
            className: "hkq-group"
          }, _this2.highLight(area, key)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("td", null, _this2.highLight(name, key)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("td", null, _this2.highLight(desc, key))));
        });
      });
      return result;
    }
    /**
     * 查询
     * @param {*} e
     */

  }, {
    key: "searchHandle",
    value: function searchHandle(e) {
      if (e.target) {
        e.target.value && (e.target.nextElementSibling.style.display = "");
        this.setState({
          data: this.getSearchData(e.target.value),
          currentIndex: 0
        });
      }
    }
    /**
     * move to tabindex
     */

  }, {
    key: "moveHandle",
    value: function moveHandle(currentIndex) {
      var prevIndex = this.state.currentIndex,
          panelDOM = this.panel;
      this.setState({
        currentIndex: currentIndex,
        data: this.currentData
      }, function () {
        // 聚焦到下一个行
        var next = panelDOM && panelDOM.querySelector("tbody tr:nth-child(".concat(currentIndex + 1, ")")); // next && next.focus();
      });
    }
    /**
     * 文本框事件
     * // TODO 这里可以考虑把input作为单独的组件抽取  自己管理自己的状态
     */

  }, {
    key: "focusInputHandle",
    value: function focusInputHandle(e) {
      if (e.target && e.target.value) {
        e.target.nextElementSibling.style.display = "";
      }
    }
    /**
     * 文本框事件
     * // TODO 这里可以考虑把input作为单独的组件抽取  自己管理自己的状态
     */

  }, {
    key: "blurInputHandle",
    value: function blurInputHandle(e) {
      if (e.target && !this.enterClose) {
        e.target.nextElementSibling.style.display = "none";
      }
    }
    /**
     * 清除按钮
     */

  }, {
    key: "clearHandle",
    value: function clearHandle(e) {
      var i = this.panel && this.panel.querySelector("input") || {
        value: ""
      }; // 清空当前的搜索关键字

      this.caheKey = "";
      i.value = "";
      this.setState({
        data: this.getSearchData(""),
        currentIndex: 0
      });
      this.enterClose = false;
      e.target && (e.target.style.display = "none");
    }
    /**
     * 文本框查询按钮
     * @param {*} e
     */

  }, {
    key: "searchBtnHandle",
    value: function searchBtnHandle(e) {
      var i = this.panel && this.panel.querySelector("input") || {
        value: ""
      };
      this.setState({
        data: this.getSearchData(i.value),
        currentIndex: 0
      });
      e.target && e.target.value && (e.target.nextElementSibling.style.display = "");
    }
    /**
     * 展示更多
     */

  }, {
    key: "moreShow",
    value: function moreShow() {
      var limit = this.props.limit;

      if (this.bufferData.length > 0) {
        this.currentData = this.currentData.concat(this.bufferData);
        this.bufferData = [];
        this.moveHandle.bind(this)(limit - 1);
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var bufferLen = this.bufferData.length;
      var langJson = this.props.langJson;
      return [/*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "hkq-helper-panel",
        ref: function ref(dom) {
          _this3.panel = dom;
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          more: ["fn+up", "fn+down", "up", "down"]
        },
        handlers: {
          more: function more() {
            _this3.moreShow();
          }
        },
        attach: false
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "hkq-helper-input"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("input", {
        placeholder: langJson["hk-0004"],
        onChange: this.searchHandle.bind(this),
        onFocus: this.focusInputHandle.bind(this),
        onBlur: this.blurInputHandle.bind(this),
        type: "text"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "icon iconfont hkq-close",
        style: {
          display: "none"
        },
        onClick: this.clearHandle.bind(this),
        onMouseEnter: function onMouseEnter() {
          _this3.enterClose = true;
        },
        onMouseLeave: function onMouseLeave() {
          _this3.enterClose = false;
        }
      }, "\uE68D"), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "icon iconfont hkq-search",
        onClick: this.searchBtnHandle.bind(this)
      }, "\uE611")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "hkq-scroll-header"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("table", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("colgroup", null, this.hasArea() ? "" : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("col", {
        style: {
          "width": "140px",
          "min-width": "140px"
        }
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("col", {
        style: {
          "width": "140px",
          "min-width": "140px"
        }
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("col", null)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("thead", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("tr", null, this.hasArea() ? "" : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("th", null, langJson["hk-0005"]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("th", null, langJson["hk-0006"]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("th", null, langJson["hk-0007"]))))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "hkq-scroll-table",
        onScroll: function onScroll() {
          _this3.moreShow();
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("table", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("colgroup", null, this.hasArea() ? "" : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("col", {
        style: {
          "width": "140px",
          "min-width": "140px"
        }
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("col", {
        style: {
          "width": "140px",
          "min-width": "140px"
        }
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("col", null)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("tbody", null, this.renderItems()))))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("button", {
        className: "hk-show-more",
        tabIndex: "-1",
        onClick: this.moreShow.bind(this)
      }, bufferLen !== 0 ? langJson["hk-0008"] : langJson["hk-0009"])];
    }
  }]);

  return HotkeyHelperPanel;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

panel_HotkeyHelperPanel.defaultProps = {
  limit: 14,
  bufferSize: 4,
  data: []
};
/* harmony default export */ var panel = (panel_HotkeyHelperPanel);
// CONCATENATED MODULE: ./src/platform/components/HotkeyHelper/index.js
function HotkeyHelper_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { HotkeyHelper_typeof = function _typeof(obj) { return typeof obj; }; } else { HotkeyHelper_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return HotkeyHelper_typeof(obj); }

function HotkeyHelper_extends() { HotkeyHelper_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return HotkeyHelper_extends.apply(this, arguments); }

function HotkeyHelper_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = HotkeyHelper_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function HotkeyHelper_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function HotkeyHelper_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function HotkeyHelper_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function HotkeyHelper_createClass(Constructor, protoProps, staticProps) { if (protoProps) HotkeyHelper_defineProperties(Constructor.prototype, protoProps); if (staticProps) HotkeyHelper_defineProperties(Constructor, staticProps); return Constructor; }

function HotkeyHelper_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) HotkeyHelper_setPrototypeOf(subClass, superClass); }

function HotkeyHelper_setPrototypeOf(o, p) { HotkeyHelper_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return HotkeyHelper_setPrototypeOf(o, p); }

function HotkeyHelper_createSuper(Derived) { var hasNativeReflectConstruct = HotkeyHelper_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = HotkeyHelper_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = HotkeyHelper_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return HotkeyHelper_possibleConstructorReturn(this, result); }; }

function HotkeyHelper_possibleConstructorReturn(self, call) { if (call && (HotkeyHelper_typeof(call) === "object" || typeof call === "function")) { return call; } return HotkeyHelper_assertThisInitialized(self); }

function HotkeyHelper_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function HotkeyHelper_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function HotkeyHelper_getPrototypeOf(o) { HotkeyHelper_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return HotkeyHelper_getPrototypeOf(o); }






__webpack_require__(931);

var HotkeyHelper_HotkeyHelper = /*#__PURE__*/function (_Component) {
  HotkeyHelper_inherits(HotkeyHelper, _Component);

  var _super = HotkeyHelper_createSuper(HotkeyHelper);

  function HotkeyHelper(props) {
    var _this;

    HotkeyHelper_classCallCheck(this, HotkeyHelper);

    _this = _super.call(this, props);
    _this.state = {
      show: false,
      langJson: {}
    };
    return _this;
  }

  HotkeyHelper_createClass(HotkeyHelper, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      var callback = function callback(langJson, bool) {
        if (bool) {
          _this2.setState({
            langJson: langJson
          });
        }
      };

      Object(index_["getMultiLang"])({
        moduleId: "hotkey_helper",
        callback: callback
      });
    }
  }, {
    key: "hideHandle",
    value: function hideHandle() {
      // TODO  关闭时  聚焦回原来的元素位置
      this.setState({
        show: false
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var langJson = this.state.langJson;

      var _this$props = this.props,
          size = _this$props.size,
          className = _this$props.className,
          backdrop = _this$props.backdrop,
          indexInfo = _this$props.indexInfo,
          enabled = _this$props.enabled,
          data = _this$props.data,
          panelType = _this$props.panelType,
          others = HotkeyHelper_objectWithoutProperties(_this$props, ["size", "className", "backdrop", "indexInfo", "enabled", "data", "panelType"]);

      var overlay = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "hkq-helper-content"
      }, langJson["hk-0003"]);
      return enabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "hkq-helper-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        display: "inline-block",
        keyMap: {
          open: ["f3"]
        },
        handlers: {
          open: function open() {
            _this3.setState({
              show: true
            });
          }
        },
        focused: true
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "left",
        inverse: true,
        overlay: overlay,
        trigger: ["focus", "hover"],
        className: "hkq-helper-overlay"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "hkq-helper-btn"
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], HotkeyHelper_extends({
        ref: function ref(Modal) {
          return _this3.Modal = Modal;
        },
        show: this.state.show,
        onHide: this.hideHandle.bind(this),
        size: size,
        className: "combine  hkq-helper-modal  " + className,
        backdrop: backdrop,
        indexInfo: indexInfo
      }, others, {
        fieldid: "hkq-helper"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, {
        closeButton: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "hkq-helper-title"
      }, langJson["hk-0001"]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "hkq-helper-toast"
      }, langJson["hk-0002"]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "hkq-helper-esc",
        onClick: this.hideHandle.bind(this)
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf-close"
      }), "\xA0(esc)")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(panel, HotkeyHelper_extends({
        data: data,
        panelType: panelType,
        langJson: langJson
      }, others))))) : null;
    }
  }]);

  return HotkeyHelper;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

HotkeyHelper_HotkeyHelper.defaultProps = {
  className: "",
  backdrop: true,
  enabled: true
};
/* harmony default export */ var components_HotkeyHelper = (HotkeyHelper_HotkeyHelper);
// EXTERNAL MODULE: external "@platform/table-core/index"
var table_core_index_ = __webpack_require__(7);

// CONCATENATED MODULE: ./src/platform/components/InsertTable/constant.js
var CONST_IS_MULTILINGUAL = {};
CONST_IS_MULTILINGUAL.isMul = false;
// CONCATENATED MODULE: ./src/platform/components/InsertTable/methods.js
function InsertTable_methods_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { InsertTable_methods_typeof = function _typeof(obj) { return typeof obj; }; } else { InsertTable_methods_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return InsertTable_methods_typeof(obj); }

/**
 * Created by wangshhj on 2018/1/18.
 */

 // 总配置文件

var timeTypes = ['datepicker', 'NCTZDatePickerStart', 'NCTZDatePickerEnd', 'timepicker', 'datetimepicker', 'rangepicker', 'datePickerNoTimeZone'];
var displayTypes = ['select', 'radio', 'checkbox', 'refer'];

var getPageSizeStorage = table_core_index_["utils"].getPageSizeStorage;
function getInsertTableValue(id) {
  return this.state.insertTable[id];
}
/*
*   获取当前表格勾选所有数据
*   @ mianCord  主表主键字段
*   @childCord  子表主键字段
* */

function getInsertTableSelectedValue(id, mainCord, childCord) {
  var table = this.state.insertTable[id];
  var newArr = [];
  var bodyKey = null;
  table.mainCheckObj.checkedArray.map(function (item, index) {
    //先判断主表是否勾选，如果勾选，只返回主表主键即可，如果没有勾选，查看子表是否有数据，是否有勾选项，如果有，返回主表主键+子表主键
    var newObj = {};

    if (table.mainCheckObj.checkedArray[index]) {
      if (table.outerData[index].values.hasOwnProperty(mainCord)) {
        newObj[mainCord] = table.outerData[index].values[mainCord].value;
        newArr.push(newObj);
      } else {
        alert('没有找到主表主键');
      }
    } else {
      bodyKey = table.outerData[index].values.key;

      if (table.childCheckObj.hasOwnProperty(bodyKey)) {
        newObj[childCord] = [];
        table.childCheckObj[bodyKey].checkedArrayChild.map(function (val, index2) {
          if (table.childCheckObj[bodyKey].checkedArrayChild[index2]) {
            newObj[mainCord] = table.outerData[index].values[mainCord].value;
            newObj[childCord].push(table.bodyData.data[bodyKey].rows[index2].values[childCord].value);
          }
        });

        if (newObj[mainCord]) {
          newArr.push(newObj);
        }
      }
    }
  });
  return newArr;
} //获取pageInfo信息

function getPageInfo(id) {
  return this.state.insertTable[id].pageInfo;
}
/*
"refreshData": [{
  "saga_status": "1",
  "mny": "123",
  "cbillid": "123124",
  "ts": "2019-10-28 12:23:23"
 }, {
  "saga_status": "1",
  "mny": "444",
  "cbillid": "44444",
  "ts": "2019-10-28 12:23:23"
 }]
 */

/**34
 *  根据wensocket推送值，更新表格数据
 * refreshData
 */

function updateDataByRefresh(tableId, pkname, refreshData, saga_errormesg) {
  var _this = this;

  var myTable = this.state.insertTable[tableId];

  if (typeof tableId == 'string' && myTable && Array.isArray(refreshData)) {
    var _ret = function () {
      var outerData = myTable.outerData,
          bodyData = myTable.bodyData,
          oLen = outerData.length,
          refreshLen = refreshData.length,
          bLen = bodyData && bodyData.data && Object.keys(bodyData.data),
          RD = {};
      if (!oLen || !refreshLen) return {
        v: void 0
      }; // 数据转型

      refreshData.forEach(function (item, index) {
        var obj = {};

        for (var key in item) {
          if (item.hasOwnProperty(key)) {
            var val = item[key];
            obj[key] = {
              value: val.value || val,
              display: val.display || val
            };
          }
        }

        RD[item[pkname]] = obj;
      }); // 外层数据 过滤

      outerData.forEach(function (item, index) {
        var values = item.values,
            pkn = values[pkname],
            pkv = pkn && pkn.value,
            rd = RD[pkv];

        if (rd && pkn) {
          // 合并數據
          values = Object.assign(values, rd); //有错误信息时，将错误信息数据放表格行

          rd['saga_status'] === '1' && (values.saga_errormesg = saga_errormesg);
        }
      }); // 内存数据过滤

      if (bLen) {
        bodyData = bodyData.data;

        for (var key in bodyData) {
          if (bodyData.hasOwnProperty(key)) {
            var element = bodyData[key];
            element.rows.forEach(function (item, index) {
              var values = item.values,
                  pkn = values[pkname],
                  pkv = pkn && pkn.value,
                  rd = RD[pkv];

              if (rd && pkn) {
                // 合并數據
                values = Object.assign(values, rd); //有错误信息时，将错误信息数据放表格行

                rd['saga_status'] === '1' && (values.saga_errormesg = saga_errormesg);
              }
            });
          }
        }
      }

      _this.setState({
        insertTable: _this.state.insertTable
      });
    }();

    if (InsertTable_methods_typeof(_ret) === "object") return _ret.v;
  }
}
/*
*   更新外层表格数据
*   @ newData  外层表格数据
*   @ rowId  主表主键字段
* */

function setInsertTableValue(id, newData, rowId, reset) {
  CONST_IS_MULTILINGUAL.isMul = false;
  var currentTable = this.state.insertTable[id];

  if (newData.hasOwnProperty('pageInfo') && !Object(index_["isWrong"])(newData.pageInfo)) {
    //前端重置后端返回的页码，初次为0，应该改为1，有问题在看看
    newData.pageInfo.pageIndex === '0' ? newData.pageInfo.pageIndex = '1' : ''; //this.myTable[moduleId].state.table.pageInfo = data.pageInfo;
  } else {
    var prePageSize = getPageSizeStorage(this.state.meta, id);

    if (newData.rows.length > 0) {
      newData.pageInfo = currentTable ? currentTable.pageInfo : {
        pageSize: prePageSize,
        pageIndex: '1'
      };
    } else {
      newData.pageInfo = {
        pageSize: currentTable ? currentTable.pageInfo.pageSize : prePageSize,
        pageIndex: '1'
      };
    }
  }

  if (reset) {
    newData.pageInfo.pageIndex = '1';
  }

  if (newData.hasOwnProperty('allpks')) {//this.myTable[moduleId].state.table.allpks = data.allpks;
    // 存储到本地缓存中，卡片翻页需要用
    // CacheTools.set("allpks", data.allpks);
  } else {
    if (newData.rows.length > 0) {
      newData.allpks = currentTable ? currentTable.allpks : [];
    } else {
      newData.allpks = [];
    }
  } // expandedRowKeys


  newData.rows.map(function (val, index) {
    if (!val.rowId && val.rowId !== 0) {
      // val.rowId = new Date().getTime() + index;
      if (!val.values[rowId]) {
        console.error('setInsertTableValue方法中，rowId没找到');
        return false;
      }

      val.rowId = val.values[rowId].value;
    }

    val.values.key = val.rowId;
    val.values.rowIndex = index;
  });
  this.state.insertTable[id] = {
    outerData: newData.rows,
    pageInfo: newData.pageInfo,
    allpks: newData.allpks,
    firstTime: true,
    expandedRowKeys: []
  };
  this.setState({
    insertTable: this.state.insertTable
  });
}
/*
*   设置展开的子表数据
*   @ record  主表当前行信息
*   @ column  子表列模板信息
*   @ datas  子表数据
*   @ rowId  子表行 主键字段
* */

function setChildTableData(id, record, datas, rowId) {
  var table = this.state.insertTable[id];
  var checkedArrayChild = []; //子表每行勾选状态

  var key = record.key;
  var rowIndex = record.rowIndex;
  datas.rows.map(function (val, index) {
    if (!val.rowId && val.rowId !== 0) {
      // val.rowId = new Date().getTime() + index;
      if (!val.values[rowId]) {
        console.error('setChildTableData方法，没有找到rowId');
        return false;
      }

      val.rowId = val.values[rowId].value;
    }

    val.values.key = val.rowId;

    if (table.mainCheckObj.checkedArray[rowIndex]) {
      checkedArrayChild.push(true);
    } else {
      checkedArrayChild.push(false);
    }
  });
  table.bodyData.data[key] = datas; // 根据主表当前行是否勾选，设置子表复选框 勾选

  if (!table.childCheckObj.hasOwnProperty(key)) {
    table.childCheckObj[key] = {
      checkedAllChild: table.mainCheckObj.checkedArray[rowIndex],
      checkedArrayChild: checkedArrayChild
    };
  }

  this.setState({
    insertTable: this.state.insertTable
  });
}
/**
 * 获取一列合计
 *
 * @export
 * @param {*} column 
 * @param {*} source
 * @returns  res  为需要合计的列和值k v 集合
 */

function getTotal(column, source) {
  if (Object.prototype.toString.call(source) !== '[object Array]') {
    console.warn('源数据类型不为数组');
    return false;
  }

  if (Object.prototype.toString.call(column) !== '[object Array]') {
    console.warn('模板配置列数据类型不为数组');
    return false;
  } // 获取需要合计的属性 并储存


  var fileds = new Set(); // col.hasOwnProperty('istotal')

  column.map(function (col) {
    if (col.visible && col.istotal) {
      fileds.add(col.key);
    }
  }); // 获取合计属性值

  var values = new Map();
  fileds.forEach(function (filed) {
    if (!values.has(filed)) {
      values.set(filed, []);
    }

    source.map(function (node) {
      if (node.hasOwnProperty(filed) && node[filed].renderValue) {
        values.get(filed).push(node[filed].renderValue.replace(/,/g, ''));
      }

      ;
    });
  });
  var res = {}; // 进行加和计算

  values.forEach(function (counts, filed) {
    var avg = 0; // 计算counts数组最长精度，如果位数不够需要补零

    var countPre = precision(counts);
    counts.map(function (v) {
      avg += Number(v);
    });
    var stringTypeOfAvg = String(avg);
    res[filed] = Object(index_["formatAcuracy"])(stringTypeOfAvg, countPre);
  });
  return res;
}

function precision(count) {
  // 如果是数组的话就获取最长精度
  if (Object.prototype.toString.call(count) === '[object Array]') {
    var precs = count.map(function (c) {
      if (String(c).split('.')[1] === undefined) {
        return 0;
      } else {
        return String(c).split('.')[1].length;
      }
    });
    return Math.max.apply(null, precs);
  } else {
    if (String(count).split('.')[1]) {
      return String(count).split('.')[1].length;
    } else {
      return 0;
    }
  }
}
/**
 * liumings 获取选中的行
 * @param {*} moduleId 表格id
 * mofify
 */


function getCheckedRows(moduleId) {
  var insetTable = this.state.insertTable[moduleId];

  if (typeof moduleId == 'string' && insetTable) {
    var consArr = [];

    if (insetTable.mainCheckObj && Object(index_["isArray"])(insetTable.mainCheckObj.checkedArray)) {
      insetTable.mainCheckObj.checkedArray.map(function (item, index) {
        if (item) {
          consArr.push({
            data: insetTable.outerData[index],
            index: index
          });
        }
      });
    }

    return consArr;
  }

  Object(index_["warningOnce"])(false, "\u6240\u64CD\u4F5C\u7684\u8868\u683C\u4E2D\u65E0ID\u4E3A".concat(moduleId, "\u7684\u6570\u636E"));
  return false;
}
function deleteTableRowsByIndex(moduleId, index) {
  var insertTable = this.state.insertTable[moduleId];

  if (typeof moduleId == 'string' && insertTable) {
    if (typeof index == 'number' || Object(index_["isArray"])(index)) {
      if (typeof index == 'number') {
        index = [index];
      }

      var arr = JSON.parse(JSON.stringify(insertTable.outerData));
      var newdata = [];
      newdata = arr.filter(function (item, i) {
        return !index.includes(i);
      }); // debugger

      insertTable.outerData = newdata;
      insertTable.mainCheckObj.data = newdata;
      var checkarr = insertTable.mainCheckObj.checkedArray.concat();

      for (var i = 0; i < checkarr.length; i++) {
        if (index.includes(i)) {
          checkarr.splice(i, 1);
          i--;
        }
      }

      insertTable.mainCheckObj.checkedArray = checkarr;
      this.setState({
        insertTable: this.state.insertTable
      });
      console.log(insertTable);
      return false;
    } else {
      Object(index_["warningOnce"])(typeof rowId == 'string', '传入的第二个参数为数字，或数字的数组');
      return false;
    }
  }

  Object(index_["warningOnce"])(false, "\u6240\u64CD\u4F5C\u7684\u8868\u683C\u4E2D\u65E0ID\u4E3A".concat(tableId, "\u7684\u6570\u636E"));
  return false;
}
function getMultiChildChangeWidth(width, isMultiChild) {
  if (isMultiChild && width) {
    this.setState({
      fixedWidth: width
    });
  }
}
/**
 * 点击表头部排序图标排序对列进行排序
 * @param {*} val 被排序的每一行的详细数据
 * @param {*Object} sortType: 
 *         { mode:'single', backSource:false ,sortFun:(a)=> {console.log(a)}}
*                   mode：值为multiple'(多列排序) 或'single'(单列排序)
                   backSource：false是前端排序，值为true为后端排序,默认false
                   sortFun：后端排序的回调函数
 * @param {*Function} customSortRule 自定义排序规则
* 备注：转单内部使用
 */

function sortColumn(val, sortType, customSortRule) {
  var attrcode = val.attrcode,
      valType = val.itemtype;

  if (!Object(index_["isFunction"])(customSortRule)) {
    switch (true) {
      case valType === 'number':
        val.sorter = function (front, behind) {
          var frontValue = front[attrcode] ? front[attrcode].value || '0' : '0';
          var behindValue = behind[attrcode] ? behind[attrcode].value || '0' : '0';
          return Number(frontValue) - Number(behindValue);
        };

        break;

      case timeTypes.includes(valType):
        val.sorter = function (front, behind) {
          var frontValue = front[attrcode] ? front[attrcode].value || '0' : '0';
          var behindValue = behind[attrcode] ? behind[attrcode].value || '0' : '0';
          return Number(new Date(frontValue).getTime()) - Number(new Date(behindValue).getTime());
        };

        break;

      case displayTypes.includes(valType):
        val.sorter = function (front, behind) {
          var frontValue = String(front[attrcode] ? front[attrcode].display || '' : '');
          var behindValue = String(behind[attrcode] ? behind[attrcode].display || '' : ''); // if (behindValue > frontValue) {
          //     return -1;
          // } else if (behindValue < frontValue) {
          //     return 1;
          // } else {
          //     return 0;
          // }

          return frontValue.localeCompare(behindValue);
        };

        break;

      case valType === 'label':
        val.sorter = function (front, behind) {
          var fvalue = front[attrcode] ? front[attrcode].value || '' : '';
          var fdisplay = front[attrcode] ? front[attrcode].display : '';
          var bvalue = behind[attrcode] ? behind[attrcode].value || '' : '';
          var bdisplay = behind[attrcode] ? behind[attrcode].display : '';
          var frontValue = String(isNullOrVoid(fdisplay) ? fvalue : fdisplay);
          var behindValue = String(isNullOrVoid(bdisplay) ? bvalue : bdisplay); // if (behindValue > frontValue) {
          //     return -1;
          // } else if (behindValue < frontValue) {
          //     return 1;
          // } else {
          //     return 0;
          // }

          return frontValue.localeCompare(behindValue);
        };

        break;

      case attrcode !== 'numberindex' && attrcode !== 'opr':
        val.sorter = function (front, behind) {
          var frontValue = String(front[attrcode] ? front[attrcode].value || '' : '');
          var behindValue = String(behind[attrcode] ? behind[attrcode].value || '' : ''); // if (behindValue > frontValue) {
          //     return -1;
          // } else if (behindValue < frontValue) {
          //     return 1;
          // } else {
          //     return 0;
          // }

          return frontValue.localeCompare(behindValue);
        };

        break;
    }
  } else {
    customSortRule(val);
  }
  /**
   * columnInfo:排序的列的模板信息
   * type:排序的类型
   */


  val.sorterClick = function (columnInfo, type) {
    //排序的回调函数
    if (sortType && sortType.backSource === true && Object(index_["isFunction"])(sortType.sortFun)) {
      //后端排序
      sortType.sortFun(columnInfo, type);
    }
  };
} //设置行勾选状态 
//id string
//index是要设置的行的数组 array
//ischeck是设置是否勾选 bool

function changeCheck(id, index, ischeck) {
  var currentTable = this.state.insertTable[id];
  var allFlag = false;
  var mainCheckObj = currentTable.mainCheckObj;
  index.map(function (i) {
    mainCheckObj.checkedArray[i] = ischeck;
  });

  for (var i = 0; i < mainCheckObj.checkedArray.length; i++) {
    if (!mainCheckObj.checkedArray[i]) {
      allFlag = false;
      break;
    } else {
      allFlag = true;
    }
  }

  mainCheckObj.checkedAll = allFlag;
  var data = mainCheckObj.data;
  index.map(function (i) {
    var thisKey = data[i].values.key; //设置子表勾选

    if (JSON.stringify(currentTable.childCheckObj) !== '{}' && currentTable.childCheckObj.hasOwnProperty(thisKey)) {
      currentTable.childCheckObj[thisKey].checkedAllChild = ischeck;
      currentTable.childCheckObj[thisKey].checkedArrayChild.map(function (val, ind) {
        currentTable.childCheckObj[thisKey].checkedArrayChild[ind] = ischeck;
      });
    }
  });
  this.setState({
    insertTable: this.state.insertTable
  });
}
// CONCATENATED MODULE: ./src/platform/components/InsertTable/toolCell.js
function toolCell_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { toolCell_typeof = function _typeof(obj) { return typeof obj; }; } else { toolCell_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return toolCell_typeof(obj); }

function toolCell_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function toolCell_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function toolCell_createClass(Constructor, protoProps, staticProps) { if (protoProps) toolCell_defineProperties(Constructor.prototype, protoProps); if (staticProps) toolCell_defineProperties(Constructor, staticProps); return Constructor; }

function toolCell_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) toolCell_setPrototypeOf(subClass, superClass); }

function toolCell_setPrototypeOf(o, p) { toolCell_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return toolCell_setPrototypeOf(o, p); }

function toolCell_createSuper(Derived) { var hasNativeReflectConstruct = toolCell_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = toolCell_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = toolCell_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return toolCell_possibleConstructorReturn(this, result); }; }

function toolCell_possibleConstructorReturn(self, call) { if (call && (toolCell_typeof(call) === "object" || typeof call === "function")) { return call; } return toolCell_assertThisInitialized(self); }

function toolCell_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function toolCell_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function toolCell_getPrototypeOf(o) { toolCell_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return toolCell_getPrototypeOf(o); }






var toolCell_ToolCell = /*#__PURE__*/function (_Component) {
  toolCell_inherits(ToolCell, _Component);

  var _super = toolCell_createSuper(ToolCell);

  function ToolCell(props) {
    var _this;

    toolCell_classCallCheck(this, ToolCell);

    _this = _super.call(this, props);

    _this.handleMouseOver = function () {
      if (_this.cellDom) {
        var tipStatus = _this.state.tipStatus;

        if (_this.cellDom.scrollWidth > _this.cellDom.clientWidth && tipStatus === false) {
          _this.setState({
            tipStatus: true
          });
        }

        if (_this.cellDom.scrollWidth <= _this.cellDom.clientWidth && tipStatus === true) {
          _this.setState({
            tipStatus: false
          });
        }
      }
    };

    _this.state = {
      tipStatus: false
    };
    return _this;
  }

  toolCell_createClass(ToolCell, [{
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.cellDom = null;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          context = _this$props.context,
          multipleRowCell = _this$props.multipleRowCell,
          isLineAll = _this$props.isLineAll;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        onMouseOver: this.handleMouseOver,
        placement: "top",
        overlay: this.state.tipStatus ? context : '',
        className: "tooltip-word-color",
        delay: 1,
        inverse: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: classnames_default()({
          textLineAll: !multipleRowCell
        }, {
          noTextLineAll: !isLineAll
        }),
        ref: function ref(dom) {
          _this2.cellDom = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(dom);
        }
      }, context ? context : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, "\xA0")));
    }
  }]);

  return ToolCell;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

/* harmony default export */ var toolCell = (toolCell_ToolCell);
// CONCATENATED MODULE: ./src/platform/components/InsertTable/InsertTable.js
function InsertTable_toConsumableArray(arr) { return InsertTable_arrayWithoutHoles(arr) || InsertTable_iterableToArray(arr) || InsertTable_unsupportedIterableToArray(arr) || InsertTable_nonIterableSpread(); }

function InsertTable_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function InsertTable_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return InsertTable_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return InsertTable_arrayLikeToArray(o, minLen); }

function InsertTable_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function InsertTable_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return InsertTable_arrayLikeToArray(arr); }

function InsertTable_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function InsertTable_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function InsertTable_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { InsertTable_ownKeys(Object(source), true).forEach(function (key) { InsertTable_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { InsertTable_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function InsertTable_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * @Description: In User Settings Edit
 * @Author: your name
 * @Date: 2019-08-12 10:09:01
 * @LastEditTime: 2021-03-05 17:17:49
 * @LastEditors: bbq
 */

/**
 * Created by wangshhj on 2018/1/16.
 */







var setPageSizeStorage = table_core_index_["utils"].setPageSizeStorage,
    InsertTable_getPageSizeStorage = table_core_index_["utils"].getPageSizeStorage;


var InsertTable_total = table_core_index_["lib"].total;
var defaultColor = ['#111111', '#555555', '#111', '#555'];

__webpack_require__(1902);

var MetaTable = base_index_["Table"].SortTable;
var ComplexTable = InsertTable_total(MetaTable); //缓存全局多语

var varMultil; // 计算主表表体高度

var tableHeight = 0;
var screenHeight = window.screen.width;

if (screenHeight <= 1919 > 1440) {
  tableHeight = 48 * 10 + 'px';
} else if (screenHeight > 1919) {
  tableHeight = 56 * 10 + 'px';
} else {
  tableHeight = 40 * 10 + 'px';
}

var inserttableDom; // currentTable.tableHeight = 0;

var InsertTable_NCOption = base_index_["Select"].Option;
var bodyKey = null; //当前行的key

var defaultProps = {
  //复选框
  prefixCls: 'bee-table',
  multiSelect: {
    type: 'checkbox',
    param: 'key'
  }
}; //  检测所有子表是否有选中项

var checkChildSelected = function checkChildSelected(data) {
  var res = false;

  for (var key in data) {
    var item = data[key];

    if (item.checkedAllChild) {
      res = true;
      break;
    } else {
      var child = item.checkedArrayChild;
      var len = child.length;

      for (var i = 0; i < len; i++) {
        if (child[i]) {
          res = true;
          break;
        }
      }
    }
  }

  return res;
}; //  检测主表是否有选中项


var checkOutTableSelected = function checkOutTableSelected(data) {
  var i = data.length;
  var res = false;

  while (i--) {
    if (data[i]) {
      res = true;
      break;
    }
  }

  return res;
}; //  检测主表是否全选


var checkOutTableAllSelected = function checkOutTableAllSelected(Obj) {
  var out = Obj.mainCheckObj;
  var len = out.checkedArray.length;
  out.checkedAll = true;

  while (len--) {
    if (!out.checkedArray[len]) {
      out.checkedAll = false;
      break;
    }
  }
};

function createInsertTable(_ref) {
  var _this = this;

  var headTableId = _ref.headTableId,
      bodyTableId = _ref.bodyTableId,
      setTableBodyData = _ref.setTableBodyData,
      pageIndexChange = _ref.pageIndexChange,
      pageSizeChange = _ref.pageSizeChange,
      rowCheckChildChange = _ref.rowCheckChildChange,
      onAllCheckChangeEve = _ref.onAllCheckChangeEve,
      rowCheckChange = _ref.rowCheckChange,
      comType = _ref.comType,
      _ref$needIndex = _ref.needIndex,
      needIndex = _ref$needIndex === void 0 ? true : _ref$needIndex,
      _ref$childNeedIndex = _ref.childNeedIndex,
      childNeedIndex = _ref$childNeedIndex === void 0 ? false : _ref$childNeedIndex,
      _ref$mockRadio = _ref.mockRadio,
      mockRadio = _ref$mockRadio === void 0 ? false : _ref$mockRadio,
      _ref$isDrag = _ref.isDrag,
      isDrag = _ref$isDrag === void 0 ? true : _ref$isDrag,
      _ref$multipleRowCell = _ref.multipleRowCell,
      multipleRowCell = _ref$multipleRowCell === void 0 ? false : _ref$multipleRowCell,
      _ref$adaptionHeight = _ref.adaptionHeight,
      adaptionHeight = _ref$adaptionHeight === void 0 ? false : _ref$adaptionHeight,
      _ref$inModal = _ref.inModal,
      inModal = _ref$inModal === void 0 ? false : _ref$inModal,
      customSortRule = _ref.customSortRule,
      fieldid = _ref.fieldid,
      _ref$insertTableHeigh = _ref.insertTableHeight,
      insertTableHeight = _ref$insertTableHeigh === void 0 ? false : _ref$insertTableHeigh;

  if (!this.state.meta) {
    return false;
  }

  if (!this.state.meta.hasOwnProperty(headTableId) || !this.state.meta[headTableId]) {
    return false;
  }

  if (!this.state.insertTable[headTableId]) {
    return false;
  } //默认分页信息


  this.defPageInfo = {
    pageSize: InsertTable_getPageSizeStorage(this.state.meta, headTableId),
    pageIndex: 1,
    totalPageIndex: 5
  };
  var meta = this.state.meta;

  function adddDataIndex(colums) {
    colums.map(function (col) {
      col.dataIndex = col.attrcode;
    });
  }

  adddDataIndex(meta[headTableId].items);
  var sortTypeHead = {
    //排序的类型 Object
    mode: 'single',
    //'multiple'(多列排序) 或'single'(单列排序)(如果前端排序的时候想多列排序，对象里就穿这个字段就可以了),
    backSource: false,
    //false是前端排序，值为true为后端排序,默认false
    sortFun: function sortFun(sortParam, sortData) {
      var sortObj = {};
      var mainCheckObj = _this.state.insertTable[headTableId].mainCheckObj || {};
      var rows = _this.state.insertTable[headTableId].outerData || [];
      var sortRows = [];
      var colums = meta[headTableId].items;
      sortParam.forEach(function (item) {
        sortObj[item.field] = item;
      });
      colums.forEach(function (item) {
        //保存返回的column状态，没有则终止order状态
        if (sortObj[item.attrcode]) {
          item.order = sortObj[item.attrcode].order;
          item.orderNum = sortObj[item.attrcode].orderNum;
        } else {
          item.order = 'flatscend';
          item.orderNum = '';
        }
      });
      sortData.forEach(function (el) {
        rows.forEach(function (row) {
          if (el.key === row.values.key) {
            sortRows.push(row);
          }
        });
      });
      _this.state.insertTable[headTableId].outerData = sortRows;
      mainCheckObj.data = sortRows;
    }
  }; // const getColSetConfig = () => {
  //   //const appcode = pageTo.getAppCode();
  //   //const pagecode = pageTo.getPageCode();
  //   const areaCode = headTableId;
  //   let areaCodeMeta = this.state.meta[areaCode] || {};
  //   const appcode = areaCodeMeta.appcode || pageTo.getAppCode();
  //   const pagecode = areaCodeMeta.pagecode || pageTo.getPageCode();
  //   const areaId = areaCodeMeta.oid;
  //   const code = areaCodeMeta.templateCode || this.state.meta.code;
  //   const pageId = areaCodeMeta.pageid || this.state.meta.pageid;
  //   return { appcode, pagecode, areaCode, areaId, code, pageId };
  // };

  var currentTable = this.state.insertTable[headTableId];
  currentTable.tableHeight = tableHeight;
  console.log('子表表格的组件id:', headTableId, ';子表表格的组件id:', bodyTableId); // 如果是自适应的就进行高度计算
  // if (adaptionHeight) {
  //   if (inserttableDom) {
  //     // 普通情况
  //     let tableBody = inserttableDom.querySelectorAll('.u-table-body')[0];
  //     if (tableBody) {
  //       const tableHeight =
  //         document.body.offsetHeight - inserttableDom.getBoundingClientRect().bottom + tableBody.offsetHeight;
  //       tableBody = null;
  //       currentTable.tableHeight = tableHeight;
  //     } else {
  //       const tableHeight = document.body.offsetHeight - inserttableDom.getBoundingClientRect().bottom;
  //       tableBody = null;
  //       currentTable.tableHeight = tableHeight;
  //     }
  //   }
  // }

  function getExpandTableHeight(data, isTotal, wrapper) {
    var tableBody = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
    wrapper = wrapper || document;
    var expandTableHeight = 0;

    if (data && data.length) {
      var tableHead = wrapper.querySelector('.u-table-thead');
      var tbody = wrapper.querySelector('.u-table-tbody');
      var tableRow = tbody.querySelectorAll('.u-table-row')[0];
      var theadHeight = tableHead && tableHead.getBoundingClientRect().height;
      var trowHeight = tableRow && tableRow.getBoundingClientRect().height;
      var TotalRowHeight = isTotal ? 45 : 0; //合计行高度

      var BodyMinHeight = 30; //UE定的表体最小高度为55

      var paddingHeight = 10; //上下padding为6

      if (tableRow && theadHeight) {
        var baseHeight = theadHeight + paddingHeight + TotalRowHeight; // let baseHeight = theadHeight + TotalRowHeight;

        if (data.length < 11) {
          //最多展示10行
          if (data.length * trowHeight < BodyMinHeight) {
            expandTableHeight = BodyMinHeight + baseHeight;
          } else {
            expandTableHeight = data.length * trowHeight + baseHeight;
          }
        } else {
          expandTableHeight = 10 * trowHeight + baseHeight;
        }

        if (tableBody) {
          return data.length > 9 ? expandTableHeight - baseHeight : '';
        }

        return expandTableHeight;
      } else {
        return 0;
      }
    }

    if (data && data.length == 0 && isTotal) {
      return 110;
    }

    if (data && data.length == 0 && !isTotal) {
      return 65;
    }
  } // 订阅查询区高度回调
  // function handlePubSub(msg, data) {
  //   if (data) {
  //     if (inserttableDom) {
  //       let tableBody = inserttableDom.querySelectorAll('.u-table-body')[0];
  //       if (tableBody) {
  //         const tableHeight =
  //           document.body.offsetHeight - inserttableDom.getBoundingClientRect().bottom + tableBody.offsetHeight;
  //         tableBody = null;
  //         currentTable.tableHeight = tableHeight;
  //       } else {
  //         const tableHeight = document.body.offsetHeight - inserttableDom.getBoundingClientRect().bottom;
  //         tableBody = null;
  //         currentTable.tableHeight = tableHeight;
  //       }
  //     }
  //   }
  //   setTimeout(() => {
  //     PubSub.unsubscribe(subscribeToken);
  //   }, 5000);
  // };


  currentTable.multilingual = varMultil; // const _that = this;
  //调用多语

  var callback = function callback(json) {
    if (CONST_IS_MULTILINGUAL.isMul) return;
    currentTable.multilingual = json;
    varMultil = json;

    _this.setState({
      insertTable: _this.state.insertTable
    }, function () {
      CONST_IS_MULTILINGUAL.isMul = true;
    });
  };

  Object(index_["getMultiLang"])({
    moduleId: 'containers_insert_tree_table',
    callback: callback
  });
  currentTable.fatherTable = {};
  Object.defineProperty(currentTable.fatherTable, 'top', {
    set: function set(newVal) {
      currentTable.fatherTable.height = document.body.clientHeight - newVal - 100;
    }
  });
  var data = currentTable.outerData;
  var pageInfo = Object.assign({}, this.defPageInfo, currentTable.pageInfo);
  currentTable.pageInfo = pageInfo;
  var pageSize = pageInfo.pageSize;
  var pageIndex = pageInfo.pageIndex; // let totalPage = Math.ceil(pageInfo.total / pageSize);

  this.setTableBodyData = setTableBodyData; //设置内嵌表格数据

  this.pageIndexChange = pageIndexChange; //切换分页

  this.pageSizeChange = pageSizeChange; //切换每页显示条数

  var columns = this.state.meta[headTableId].items.filter(function (e) {
    return e.visible;
  });
  var bodyColumn = this.state.meta[bodyTableId].items.filter(function (e) {
    return e.visible;
  });
  var headPaginationInfo = this.state.meta[headTableId].pagination; // let bodyPagination = this.state.meta[bodyTableId].pagination;
  // 分割分页id

  var splitPks = function splitPks(data, pageIndex, pageSize) {
    var pks = [];
    var index = Number(pageIndex);
    var size = Number(pageSize);
    var start = (index - 1) * size;

    for (var i = start; i < start + size; i++) {
      if (data[i]) {
        pks.push(data[i]);
      } else {
        break;
      }
    }

    return pks;
  }; //切换分页


  var pageIndexChanges = function pageIndexChanges(eventKey) {
    var pks;
    currentTable.pageInfo.pageIndex = eventKey;

    if (Object(index_["isFunction"])(_this.pageIndexChange)) {
      if (currentTable.allpks) {
        pks = splitPks(currentTable.allpks, currentTable.pageInfo.pageIndex, currentTable.pageInfo.pageSize);
      }

      data = _this.pageIndexChange(eventKey, pks);
    }

    pageIndex = eventKey;

    _this.setState(_this.state);
  }; //每页显示条数


  var pageSizeSelect = function pageSizeSelect(val) {
    var total = currentTable.pageInfo.total;
    currentTable.pageInfo.pageSize = val;
    setPageSizeStorage(_this.state.meta, headTableId, val);
    currentTable.pageInfo.pageIndex = 1;
    currentTable.pageInfo.totalPage = Math.ceil(total / currentTable.pageInfo.pageSize);

    if (Object(index_["isFunction"])(pageSizeChange)) {
      var pks;

      if (currentTable.allpks) {
        pks = splitPks(currentTable.allpks, currentTable.pageInfo.pageIndex, currentTable.pageInfo.pageSize);
      }

      data = _this.pageSizeChange(val, pks);
    }

    pageSize = val;

    _this.setState(_this.state);
  }; //===========================子表添加复选框===========================================
  //子表复选框全选
  // const onAllCheckChangeChild = (record, index) => {
  //   let checkedArray = [];
  //   let mainCheckObj = currentTable.childCheckObj[record.key];
  //   for (var i = 0; i < mainCheckObj.checkedArrayChild.length; i++) {
  //     checkedArray[i] = !mainCheckObj.checkedAllChild;
  //   }
  //   currentTable.mainCheckObj.checkedArray[
  //     index
  //   ] = mainCheckObj.checkedAllChild = !mainCheckObj.checkedAllChild;
  //   mainCheckObj.checkedArrayChild = checkedArray;
  //   checkOutTableAllSelected(currentTable);
  //   this.setState(this.state);
  //   // onAllCheckChangeEve(mainCheckObj.checkedAllChild,currentTable.mainCheckObj.data,currentTable.bodyData)
  // };
  //子表复选框单个勾选


  var onCheckboxChangeChild = function onCheckboxChangeChild(text, record, index, parents, parentsIndex) {
    var allFlag = false;
    var childCheckObj = currentTable.childCheckObj[parents.key];
    childCheckObj.checkedArrayChild[index] = !childCheckObj.checkedArrayChild[index];

    for (var i = 0; i < childCheckObj.checkedArrayChild.length; i++) {
      if (!childCheckObj.checkedArrayChild[i]) {
        allFlag = false;
        break;
      } else {
        allFlag = true;
      }
    }

    currentTable.mainCheckObj.checkedArray[parentsIndex] = childCheckObj.checkedAllChild = allFlag;
    checkOutTableAllSelected(currentTable);

    if (typeof rowCheckChildChange === 'function') {
      rowCheckChildChange(childCheckObj.checkedArrayChild[index], record, currentTable);
    }

    _this.setState(_this.state); // rowCheckChange(checkedArrayChild[index],currentTable.bodyData.data[bodyKey])

  }; //子表  表格和复选框列组合到一起


  var renderColumnsMultiSelectChild = function renderColumnsMultiSelectChild(columns, records, indexs) {
    // if(!currentTable.childCheckObj.hasOwnProperty(bodyKey)){
    //     return false
    // }
    var checkedArrayChild = currentTable.childCheckObj[records.key].checkedArrayChild;
    var multiSelect = defaultProps.multiSelect;
    var indexCol = [{
      label: currentTable.multilingual && currentTable.multilingual['insert-tree-table-003'],
      attrcode: 'indexCol',
      dataIndex: 'indexCol',
      width: '60px',
      className: 'nunberindex',
      title: currentTable.multilingual && currentTable.multilingual['insert-tree-table-003'],
      render: function render(text, record2, index) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, index + 1);
      }
    }]; // 添加序号列

    var newColumn = columns;

    if (needIndex) {
      newColumn = indexCol.concat(newColumn);
    } // let indeterminate_bool = false;


    if (multiSelect && multiSelect.type === 'checkbox') {
      // let i = checkedArrayChild.length;
      // while (i--) {
      //   if (checkedArrayChild[i]) {
      //     indeterminate_bool = true;
      //     break;
      //   }
      // }
      var defaultColumns = [{
        label: '',
        attrcode: 'innerCheckbox',
        dataIndex: 'checkbox',
        width: '120px',
        render: function render(text, record, index) {
          // Socket改造
          //let { billpkname, billtype, errorViewType } = this.nativeSocketBillInfo;
          var values = record.values || record;
          return values && values.saga_status && values.saga_status.value === '1' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["ErrorPop"], {
            record: record
          }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
            className: "table-checkbox",
            checked: checkedArrayChild[index],
            onChange: onCheckboxChangeChild.bind(_this, text, record, index, records, indexs)
          });
        }
      }];
      newColumn = defaultColumns.concat(newColumn);
    }

    return newColumn;
  }; //子表添加序号


  var renderColumnsForChildOfIndex = function renderColumnsForChildOfIndex(columns) {
    // if(!currentTable.childCheckObj.hasOwnProperty(bodyKey)){
    //     return false
    // }
    // let { checkedAllChild, checkedArrayChild } = currentTable.childCheckObj[
    //   records.key
    // ];
    // let { multiSelect } = defaultProps;
    var indexCol = [{
      label: currentTable.multilingual && currentTable.multilingual['insert-tree-table-003'],
      attrcode: 'indexCol',
      dataIndex: 'indexCol',
      width: '60px',
      className: 'nunberindex',
      title: currentTable.multilingual && currentTable.multilingual['insert-tree-table-003'],
      render: function render(text, record2, index) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, index + 1);
      }
    }]; // 添加序号列

    var newColumn = columns;

    if (needIndex) {
      newColumn = indexCol.concat(newColumn);
    }

    return newColumn;
  }; // 处理模板


  var createNewColChild = function createNewColChild(column) {
    var multiCustomer = currentTable.multilingual && currentTable.multilingual['insert-tree-table-008'];
    var multiYes = currentTable.multilingual && currentTable.multilingual['insert-tree-table-009'];
    var multiNo = currentTable.multilingual && currentTable.multilingual['insert-tree-table-010'];
    return column.map(function (item) {
      var render = null;

      if (item.itemtype == 'customer') {
        item.width ? item.width : item.width = '90px';
        item.title = multiCustomer; // item.fixed = "right";
      }

      if (item.itemtype !== 'customer' && item.attrcode !== 'checkbox' && item.attrcode !== 'indexCol') {
        item.width ? item.width : item.width = '120px';
        item.title = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          fieldid: Object(index_["getSysFieldid"])(item.attrcode),
          style: {
            color: defaultColor.includes(item.color) ? '' : item.color
          },
          className: classnames_default()('title-container', {
            alignRight: item.itemtype === 'number'
          })
        }, item.required && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "mark-required"
        }, "*"), ' ', item.label, ' ');

        if (item.render) {
          render = function render(text, record, index) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
              fieldid: Object(index_["getSysFieldid"])(item.attrcode)
            }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(toolCell, {
              context: item.render(text, record, index),
              multipleRowCell: false
            }));
          };
        } else {
          render = function render(text, record) {
            if (record.hasOwnProperty(item.attrcode)) {
              var display = record[item.attrcode].display; // 行数据里的精度值

              var valSca = record[item.attrcode].scale;
              valSca = Number(valSca);
              var value = record[item.attrcode].value; // 如果是时间类型
              // if (isTimeType(item.itemtype)) {
              //   value = changeTime(value);
              // }
              // timeTypes: ['datepicker', 'NCTZDatePickerStart', 'NCTZDatePickerEnd', 'timepicker', 'datetimepicker', 'rangepicker', 'datePickerNoTimeZone'],

              switch (item.itemtype) {
                case 'datepicker':
                  value = Object(index_["changeTime"])(value);
                  value = Object(index_["formatDatetime"])(value, 'date');
                  break;

                case 'NCTZDatePickerEnd':
                  value = Object(index_["changeTime"])(value);
                  value = Object(index_["formatDatetime"])(value, 'date');
                  break;
                // case 'timepicker':
                //   value = changeTime(value, 'HH:mm:ss');
                //   break;

                case 'datetimepicker':
                  value = Object(index_["changeTime"])(value, 'YYYY-MM-DD HH:mm:ss');
                  value = Object(index_["formatDatetime"])(value, 'datetime');
                  break;
              } // 布尔值转换处理


              var itemtypeBool = ['switch', 'switch_browse', 'checkbox', 'checkbox_switch'];

              if (itemtypeBool.includes(item.itemtype)) {
                value = value === 'Y' || value === true ? multiYes : multiNo;
              }

              var dom = '';

              if (display || display == 0) {
                dom = display;
              } else {
                dom = value;
              }

              if (typeof dom === 'boolean') {
                dom = dom ? multiYes : multiNo;
              }

              if (item.itemtype === 'number') {
                var sc = Number(item.scale) > 0 ? Number(item.scale) : 0;

                if (!isNaN(valSca) && valSca >= 0) {
                  sc = valSca;
                }

                dom = Object(index_["formatAcuracy"])(value, sc);
                dom = Object(index_["formatNumber"])(dom);
                record[item.attrcode].renderValue = dom;
              }

              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
                fieldid: Object(index_["getSysFieldid"])(item.attrcode),
                className: classnames_default()({
                  alignRight: item.itemtype === 'number'
                })
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(toolCell, {
                context: dom,
                multipleRowCell: multipleRowCell
              }));
            }
          };
        }
      } else {
        render = item.render;
      }

      return InsertTable_objectSpread(InsertTable_objectSpread({}, item), {}, {
        render: render,
        key: item.attrcode,
        title: item.title,
        required: null
      });
    });
  }; //  处理数据


  var createNewData = function createNewData(data, column) {
    var colMap = new Map();

    if (column) {
      column.map(function (col) {
        if (col.itemtype && col.itemtype === 'number') {
          if (!colMap.has(col.attrcode)) colMap.set(col.attrcode, {});

          if (colMap.has(col.attrcode)) {
            colMap.get(col.attrcode).scale = col.scale;
          }
        }
      });
    }

    var datas = [];
    data.map(function (val, index) {
      if (column) {
        colMap.forEach(function (value, key) {
          var itemScale = val.values[key] && val.values[key].scale;
          itemScale = Number(itemScale);
          var sc = Number(value.scale) > 0 ? Number(value.scale) : 0;

          if (!isNaN(itemScale)) {
            sc = itemScale;
          }

          if (val.values[key] && val.values[key].value) {
            var renderValue = Object(index_["formatAcuracy"])(val.values[key].value, sc);
            val.values[key].renderValue = renderValue;
          }
        });
      }

      if (needIndex) {
        val.values.indexCol = {
          value: index
        };
      }

      datas.push(val.values);
    }); // {value: "张三"}

    return datas;
  }; // 判断是否为需要显示合计


  var isShowTotal = function isShowTotal(columns) {
    var isShowTotal = false;
    columns.map(function (v) {
      if (v.hasOwnProperty('istotal') && v.istotal) {
        isShowTotal = true;
      }
    });
    return isShowTotal;
  };

  var handleColAndSrc = function handleColAndSrc(col, src) {
    // 重新生成column
    var isGenerantorTotal = false;
    var heji = currentTable.multilingual && currentTable.multilingual['insert-tree-table-007'];
    var totalColumns = col.map(function (v) {
      // 如果有CheckBox就用这列做合计
      // 如果没有CheckBox 就用dataIndex做合计
      var obj = {};

      if (!v.istotal && !isGenerantorTotal) {
        obj.title = heji;
        obj.dataIndex = 'total';
        obj.key = 'total';
        obj.width = v.width ? v.width : '80px';
        isGenerantorTotal = true;
      } else if ((v.attrcode === 'checkbox' || v.dataIndex === 'checkbox') && !isGenerantorTotal) {
        obj.title = heji;
        obj.dataIndex = 'total';
        obj.key = 'total';
        obj.width = v.width ? v.width : '60px';
        isGenerantorTotal = true;
      } else if (v.attrcode === 'indexCol' && !isGenerantorTotal) {
        obj.title = heji;
        obj.dataIndex = 'total';
        obj.key = 'total';
        obj.width = v.width ? v.width : '';
        isGenerantorTotal = true;
      } else if (v.itemtype === 'customer' && !isGenerantorTotal) {
        obj.title = heji;
        obj.dataIndex = 'total';
        obj.key = 'total';
        obj.width = v.width ? v.width : '';
        isGenerantorTotal = true;
      } else {
        obj.title = v.title;
        obj.dataIndex = v.dataIndex || v.key;
        obj.width = v.width ? v.width : '';
        obj.key = v.key;
      }

      if (v.itemtype !== 'customer' && v.attrcode !== 'checkbox' && v.attrcode !== 'indexCol') {
        obj.width = v.width ? v.width : '120px';
      }

      obj.render = function (text) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "alignRight",
          fieldid: Object(index_["getSysFieldid"])(obj.dataIndex === 'total' ? 'firstcol' : v.attrcode)
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(toolCell, {
          context: text,
          isLineAll: true
        }));
      };

      return obj;
    });
    var totalData = getTotal(col, src);
    return {
      totalColumns: totalColumns,
      totalData: [InsertTable_objectSpread({
        total: heji
      }, totalData)]
    };
  }; //表格展开显示的内容


  var expandedRowRender = function expandedRowRender(record, index) {
    // if (JSON.stringify(bodyColumn) == "{}") {
    //   return false;
    // }
    if (!currentTable.childCheckObj.hasOwnProperty(record.key)) {
      return false;
    } //  根据组件类型，判断是否带复选框


    var newColumn = bodyColumn; // let classByType = null;

    if (comType === 'hasCheckBox_child') {
      newColumn = renderColumnsMultiSelectChild.call(_this, newColumn, record, index);
    }

    if (childNeedIndex) {
      // 给子表添加序号和父选框
      // newColumn = renderColumnsMultiSelectChild.call(
      //   this,
      //   newColumn,
      //   record,
      //   index
      // );
      newColumn = renderColumnsForChildOfIndex.call(_this, newColumn, record, index);
    }

    adddDataIndex(newColumn);
    var sortTypeChild = {
      //排序的类型 Object
      mode: 'single',
      //'multiple'(多列排序) 或'single'(单列排序)(如果前端排序的时候想多列排序，对象里就穿这个字段就可以了),
      backSource: false,
      //false是前端排序，值为true为后端排序,默认false
      sortFun: function sortFun(sortParam) {
        var sortObj = {};
        var colums = newColumn;
        sortParam.forEach(function (item) {
          sortObj[item.field] = item;
        });
        colums.forEach(function (item) {
          //保存返回的column状态，没有则终止order状态
          if (sortObj[item.attrcode]) {
            item.order = sortObj[item.attrcode].order;
            item.orderNum = sortObj[item.attrcode].orderNum;
          } else {
            item.order = 'flatscend';
            item.orderNum = '';
          }
        });
      }
    };

    if (currentTable.bodyData.data && currentTable.bodyData.data.hasOwnProperty(record.key)) {
      var _finalColumns = createNewColChild(newColumn);

      _finalColumns = _finalColumns.map(function (val) {
        if ( // val.itemtype == 'customer' ||
        val.attrcode !== 'checkbox' && val.attrcode !== 'indexCol') {
          sortColumn(val, sortTypeChild, customSortRule);
        }

        return val;
      });
      var fianlyData = createNewData(currentTable.bodyData.data[record.key].rows, newColumn); // 判断是否需要合计

      var _isTotal = isShowTotal(_finalColumns);

      var _totalConfig = {};

      if (_isTotal) {
        _totalConfig = handleColAndSrc(_finalColumns, fianlyData);
      }

      var childData = createNewData(currentTable.bodyData.data[record.key].rows);
      var expandTableHeight = getExpandTableHeight(childData, _isTotal, external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(inserttableDom));
      var expandTableBodyHeight = getExpandTableHeight(childData, _isTotal, external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(inserttableDom), true);
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        fieldid: Object(index_["getSysFieldid"])("".concat(fieldid || bodyTableId, "_table")),
        style: {
          height: "".concat(expandTableHeight, "px")
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ComplexTable // lazyload={false}
      , {
        className: "innerTable",
        columns: InsertTable_toConsumableArray(_finalColumns),
        data: childData,
        isTotal: _isTotal,
        inserttableTotalConfig: _totalConfig,
        isDrag: isDrag,
        bodyStyle: {
          minHeight: '30px'
        },
        scroll: {
          x: true,
          y: expandTableBodyHeight || 450
        },
        sort: sortTypeChild,
        totalBodyHeight: 30 // colsSettingParam={getColSetConfig()}
        // cancelCustomRightMenu={cancelCustomRightMenu}
        // updateColumnHandle={updateColumnAfterSetting.bind(this)}

      }));
    }
  }; //当点击展开的时候才去请求内嵌表格数据


  var getData = function getData(expanded, record) {
    if (expanded) {
      currentTable.expandedRowKeys.push(record.key);
      bodyKey = record.key; //判断是否已经有该子表数据，如果有，不需要再次请求。

      var hasThisChild = currentTable.childCheckObj.hasOwnProperty(bodyKey);

      _this.setTableBodyData(record, hasThisChild);
    } else {
      var index = currentTable.expandedRowKeys.indexOf(record.key);
      currentTable.expandedRowKeys.splice(index, 1);
    }

    _this.setState(_this.state);
  }; //============================================添加复选框==================================
  //主表复选框全选点击事件


  var onAllCheckChange = function onAllCheckChange() {
    var checkedArray = [];
    var errorDataKey = {};
    var mainCheckObj = currentTable.mainCheckObj;

    for (var i = 0; i < mainCheckObj.checkedArray.length; i++) {
      var cd = currentTable.outerData[i],
          values = cd.values;

      if (values && values.saga_status && values.saga_status.value === '1') {
        // socket 错误数据过滤
        errorDataKey[cd.rowId || values.key] = cd.rowId || values.key;
        checkedArray[i] = false;
      } else {
        checkedArray[i] = !mainCheckObj.checkedAll;
      }
    }

    mainCheckObj.checkedAll = !mainCheckObj.checkedAll;
    mainCheckObj.checkedArray = checkedArray;
    var childCheckObj = currentTable.childCheckObj; //设置子表勾选

    var _loop = function _loop(key) {
      if (errorDataKey[key]) {
        // 如果主表错误  则子表也不能选中数据
        childCheckObj[key].checkedAllChild = false;
        childCheckObj[key].checkedArrayChild = childCheckObj[key].checkedArrayChild.map(function () {
          return false;
        });
      } else {
        childCheckObj[key].checkedAllChild = mainCheckObj.checkedAll;
        childCheckObj[key].checkedArrayChild = childCheckObj[key].checkedArrayChild.map(function (val, i) {
          var bd = currentTable.bodyData.data[key].rows[i],
              values = bd.values;

          if (values && values.saga_status && values.saga_status.value === '1') {
            // socket 错误数据过滤
            return false;
          } else {
            return mainCheckObj.checkedAll;
          }
        });
      }
    };

    for (var key in childCheckObj) {
      _loop(key);
    } // 这里处理Socket saga_status 错误数据比较麻烦


    _this.setState(_this.state);

    if (typeof onAllCheckChangeEve === 'function') {
      onAllCheckChangeEve(currentTable.mainCheckObj.checkedAll, currentTable.mainCheckObj.data, currentTable.bodyData);
    }
  }; //主表复选框单个勾选


  var onCheckboxChange = function onCheckboxChange(text, record, index) {
    var allFlag = false;
    var thisKey = record.key;
    var mainCheckObj = currentTable.mainCheckObj;
    console.log(11122, currentTable);
    var oldState = mainCheckObj.checkedArray[index];
    mainCheckObj.checkedArray[index] = !mainCheckObj.checkedArray[index];

    if (mockRadio) {
      var resetCheckedArray = [];
      mainCheckObj.checkedArray.map(function (checked, i) {
        if (index === i) {
          resetCheckedArray.push(!oldState);
        } else {
          resetCheckedArray.push(false);
        }
      });
      mainCheckObj.checkedArray = resetCheckedArray;
    }

    for (var i = 0; i < mainCheckObj.checkedArray.length; i++) {
      if (!mainCheckObj.checkedArray[i]) {
        allFlag = false;
        break;
      } else {
        allFlag = true;
      }
    }

    mainCheckObj.checkedAll = allFlag; //设置子表勾选

    if (JSON.stringify(currentTable.childCheckObj) !== '{}' && currentTable.childCheckObj.hasOwnProperty(thisKey)) {
      currentTable.childCheckObj[thisKey].checkedAllChild = mainCheckObj.checkedArray[index];
      currentTable.childCheckObj[thisKey].checkedArrayChild.map(function (val, ind) {
        currentTable.childCheckObj[thisKey].checkedArrayChild[ind] = mainCheckObj.checkedArray[index];
      });
    }

    _this.setState(_this.state);

    if (typeof rowCheckChange === 'function') {
      rowCheckChange(mainCheckObj.checkedArray[index], currentTable.mainCheckObj.data[index], currentTable);
    }
  }; //主表  表格和复选框列组合到一起


  var renderColumnsMultiSelect = function renderColumnsMultiSelect(columns) {
    var checkedArray = currentTable.mainCheckObj.checkedArray;
    var multiSelect = defaultProps.multiSelect;
    var indeterminate_bool = false; //主表半选

    var indexCol = [{
      label: currentTable.multilingual && currentTable.multilingual['insert-tree-table-003'],
      attrcode: 'indexCol',
      dataIndex: 'indexCol',
      width: '60px',
      className: 'nunberindex',
      title: currentTable.multilingual && currentTable.multilingual['insert-tree-table-003'],
      render: function render(text, record, index) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          style: {
            width: '60px'
          }
        }, index + 1);
      }
    }]; // 添加序号列

    var newColumn = columns;

    if (needIndex) {
      newColumn = indexCol.concat(newColumn);
    }

    if (multiSelect && multiSelect.type === 'checkbox') {
      if (comType === 'hasCheckBox_child') {
        indeterminate_bool = checkOutTableSelected(checkedArray);

        if (!indeterminate_bool) {
          indeterminate_bool = checkChildSelected(currentTable.childCheckObj);
        }
      } else {
        indeterminate_bool = checkOutTableSelected(checkedArray);
      }

      var checkTilte = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
        className: "table-checkbox",
        checked: currentTable.mainCheckObj.checkedAll,
        indeterminate: indeterminate_bool && !currentTable.mainCheckObj.checkedAll,
        onChange: onAllCheckChange.bind(_this)
      });
      var tableTitle = mockRadio ? null : checkTilte;
      var defaultColumns = [{
        title: tableTitle,
        attrcode: 'checkbox',
        dataIndex: 'checkbox',
        width: '80px',
        render: function render(text, record, index) {
          var indeterminate_bool_child = false; //子表半选

          if (currentTable.childCheckObj && currentTable.childCheckObj.hasOwnProperty(record.key)) {
            var checkedArrayChild = currentTable.childCheckObj[record.key].checkedArrayChild;
            var i = checkedArrayChild.length;

            while (i--) {
              if (checkedArrayChild[i]) {
                indeterminate_bool_child = true;
                break;
              }
            }
          }

          if (comType === 'hasCheckBox') {
            // 如果是子表无复选框，那么主表就不需要半选状态
            indeterminate_bool_child = false;
          } // Socket改造
          //let { billpkname, billtype, errorViewType } = this.nativeSocketBillInfo;


          var values = record.values || record;
          return values && values.saga_status && values.saga_status.value === '1' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["ErrorPop"], {
            record: record
          }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
            className: "table-checkbox",
            checked: currentTable.mainCheckObj.checkedArray[index],
            indeterminate: indeterminate_bool_child && !currentTable.mainCheckObj.checkedArray[index],
            onChange: onCheckboxChange.bind(_this, text, record, index)
          });
        }
      }];
      newColumn = defaultColumns.concat(newColumn);
    }

    return newColumn;
  };

  if (data && currentTable.firstTime) {
    currentTable.firstTime = false; //初始化内嵌表格数据

    currentTable.bodyData = {
      column: {},
      data: {}
    };
    currentTable.childCheckObj = {}; //子表勾选情况
    //初始化复选框

    currentTable.mainCheckObj = {
      // 主表勾选情况
      checkedAll: false,
      checkedArray: [],
      data: data
    }; //设置每行是否勾选

    data.map(function () {
      currentTable.mainCheckObj.checkedArray.push(false);
    });
  } //  根据组件类型，判断是否带复选框


  var column = columns;
  var classByType = null;

  if (comType === 'hasCheckBox' || comType === 'hasCheckBox_child') {
    column = renderColumnsMultiSelect.call(this, columns);
    classByType = 'hasCheckBox';
  } // 处理模板


  var createNewCol = function createNewCol(column) {
    var multiCustomer = currentTable.multilingual && currentTable.multilingual['insert-tree-table-008'];
    var multiYes = currentTable.multilingual && currentTable.multilingual['insert-tree-table-009'];
    var multiNo = currentTable.multilingual && currentTable.multilingual['insert-tree-table-010'];
    return column.map(function (item, colIndex) {
      var isLineAll = true;
      var render = null;

      if (item.itemtype == 'customer') {
        item.width ? item.width : item.width = '90px';
        item.title = multiCustomer; // item.fixed = "right";
      }

      if (item.itemtype !== 'customer' && item.attrcode !== 'checkbox' && item.attrcode !== 'indexCol') {
        if (comType == 'normal' && colIndex == 0) {
          isLineAll = false;
        }

        item.width ? item.width : item.width = '120px';
        item.title = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          fieldid: Object(index_["getSysFieldid"])(item.attrcode),
          style: {
            color: defaultColor.includes(item.color) ? '' : item.color
          },
          className: classnames_default()('title-container', {
            alignRight: item.itemtype === 'number'
          })
        }, item.required && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "mark-required"
        }, "*"), ' ', item.label, ' ');

        render = function render(text, record) {
          if (record.hasOwnProperty(item.attrcode)) {
            var display = record[item.attrcode].display; // 行数据里的精度值

            var valSca = record[item.attrcode].scale;
            valSca = Number(valSca);
            var value = record[item.attrcode].value; // 如果是时间类型

            switch (item.itemtype) {
              case 'datepicker':
                value = Object(index_["changeTime"])(value);
                value = Object(index_["formatDatetime"])(value, 'date');
                break;

              case 'NCTZDatePickerEnd':
                value = Object(index_["changeTime"])(value);
                value = Object(index_["formatDatetime"])(value, 'date');
                break;

              case 'timepicker':
                value = value;
                break;

              case 'datetimepicker':
                value = Object(index_["changeTime"])(value, 'YYYY-MM-DD HH:mm:ss');
                value = Object(index_["formatDatetime"])(value, 'datetime');
                break;
            } // 布尔值转换处理


            var itemtypeBool = ['switch', 'switch_browse', 'checkbox', 'checkbox_switch'];

            if (itemtypeBool.includes(item.itemtype)) {
              value = value === 'Y' || value === true ? multiYes : multiNo;
            }

            var dom = '';

            if (display || display == 0) {
              dom = display;
            } else {
              dom = value;
            }

            if (typeof dom === 'boolean') {
              dom = dom ? multiYes : multiNo;
            }

            if (item.itemtype === 'number') {
              var sc = Number(item.scale) > 0 ? Number(item.scale) : 0;

              if (!isNaN(valSca) && valSca >= 0) {
                sc = valSca;
              }

              dom = Object(index_["formatAcuracy"])(value, sc);
              dom = Object(index_["formatNumber"])(dom);
              record[item.attrcode].renderValue = dom;
            }

            if (comType == 'normal' && colIndex == 0) {
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                fieldid: Object(index_["getSysFieldid"])(item.attrcode),
                className: classnames_default()({
                  alignRight: item.itemtype === 'number'
                })
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(toolCell, {
                context: dom,
                multipleRowCell: multipleRowCell,
                isLineAll: isLineAll
              }));
            } else {
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                fieldid: Object(index_["getSysFieldid"])(item.attrcode),
                className: classnames_default()({
                  alignRight: item.itemtype === 'number'
                })
              }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(toolCell, {
                context: dom,
                multipleRowCell: multipleRowCell,
                isLineAll: isLineAll
              }));
            }
          }
        };
      } else {
        render = item.render;
      }

      return InsertTable_objectSpread(InsertTable_objectSpread({}, item), {}, {
        render: render,
        key: item.attrcode,
        title: item.title,
        required: null
      });
    });
  };

  var finalColumns = createNewCol(column);
  finalColumns = finalColumns.map(function (val) {
    if ( // val.itemtype == 'customer' ||
    val.attrcode !== 'checkbox' && val.attrcode !== 'indexCol') {
      sortColumn(val, sortTypeHead, customSortRule);
    }

    return val;
  });
  var finalData = createNewData(currentTable.mainCheckObj.data, finalColumns); // 获取元素的样式属性值

  var getStyle = function getStyle(obj, attr) {
    if (obj.currentStyle) {
      return obj.currentStyle[attr];
    } else {
      return document.defaultView.getComputedStyle(obj, null)[attr];
    }
  };

  var isTotal = isShowTotal(finalColumns);
  var totalConfig = {};

  if (isTotal) {
    totalConfig = handleColAndSrc(finalColumns, finalData);
  }

  var bottom = Number(getStyle(document.body, 'paddingBottom').replace('px', ''));
  currentTable.tableHeight = currentTable.tableHeight - bottom;
  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    className: ['insertTable', classByType].join(' '),
    fieldid: Object(index_["getSysFieldid"])("".concat(fieldid || headTableId, "_table")),
    style: {
      overflow: 'hidden'
    },
    ref: function ref(_ref2) {
      if (_ref2) {
        inserttableDom = _ref2;
      }
    }
  }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ComplexTable, {
    otherAreaHeight: headPaginationInfo ? 38 : 0,
    adaptionHeight: adaptionHeight,
    inModal: inModal,
    lazyload: false // colsSettingParam={getColSetConfig()}
    // cancelCustomRightMenu={cancelCustomRightMenu}
    // updateColumnHandle={updateColumnAfterSetting.bind(this)}
    // key={Date.parse(new Date())}
    ,
    bodyStyle: {
      minHeight: insertTableHeight || '419px'
    },
    className: "outerTable",
    isTotal: isTotal,
    columns: finalColumns,
    data: finalData,
    onExpand: getData.bind(this),
    expandedRowKeys: currentTable.expandedRowKeys,
    expandedRowRender: expandedRowRender.bind(this),
    scroll: {
      x: true,
      y: currentTable.tableHeight
    },
    inserttableTotalConfig: totalConfig,
    isDrag: isDrag,
    sort: sortTypeHead
  }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
    md: 12,
    xs: 12,
    sm: 12
  }, headPaginationInfo && currentTable.multilingual ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    className: "insertTable-component-paginationDiv",
    fieldid: Object(index_["getSysFieldid"])('pagination-div')
  }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    className: "fl page-size"
  }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Select"], {
    className: "pageSizeDom",
    size: "lg",
    value: Number(pageSize || ''),
    style: {
      width: 90,
      marginRight: 6
    },
    onChange: pageSizeSelect.bind(this),
    fieldid: "page-size"
  }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(InsertTable_NCOption, {
    value: 5
  }, "5", currentTable.multilingual['insert-tree-table-004'], "/", currentTable.multilingual['insert-tree-table-006']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(InsertTable_NCOption, {
    value: 10
  }, "10", currentTable.multilingual['insert-tree-table-004'], "/", currentTable.multilingual['insert-tree-table-006']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(InsertTable_NCOption, {
    value: 20
  }, "20", currentTable.multilingual['insert-tree-table-004'], "/", currentTable.multilingual['insert-tree-table-006']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(InsertTable_NCOption, {
    value: 50
  }, "50", currentTable.multilingual['insert-tree-table-004'], "/", currentTable.multilingual['insert-tree-table-006']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(InsertTable_NCOption, {
    value: 100
  }, "100", currentTable.multilingual['insert-tree-table-004'], "/", currentTable.multilingual['insert-tree-table-006'])), !!+pageInfo.total && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
    className: "NC_total"
  }, ' ', currentTable.multilingual['insert-tree-table-005'], ' ', /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, pageInfo.total, ' '), currentTable.multilingual['insert-tree-table-004'], ' '))) : null, headPaginationInfo && pageInfo ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Pagination"] // className="Pagination"
  , {
    prev: true,
    next: true,
    boundaryLinks: true,
    items: pageInfo.totalPage ? Number(pageInfo.totalPage) : 1 //总页数
    ,
    maxButtons: 5 //显示最多页数按钮
    ,
    activePage: Number(pageIndex),
    onSelect: pageIndexChanges.bind(this)
  }) : ''));
}
/**
 * 列设置后更新模板
 * @param {*Array} newColumn 列设置后的模板
 * @param {*} areaCode 表格的区域id
 */
// export function updateColumnAfterSetting(newColumn, areaCode) {
//   let { meta } = this.state;
//   if (newColumn.length && areaCode) {
//     let finalColumn = [...meta[areaCode].items];
//     let sortIndexArr = [];
//     let sortObjArr = [];
//     newColumn.map(newItem => {
//       meta[areaCode].items.map((oldItem, index) => {
//         if (newItem.attrcode === oldItem.attrcode) {
//           oldItem.width = newItem.width;
//           oldItem.islock = newItem.islock;
//           oldItem.visible = newItem.visible;
//           sortIndexArr.push(index);
//           sortObjArr.push(oldItem);
//         };
//       });
//     });
//     sortIndexArr.sort((a, b) => a - b);
//     sortIndexArr.map((item, index) => {
//       finalColumn[item] = sortObjArr[index];
//     });
//     meta[areaCode].items = finalColumn;
//     this.setState({ meta });
//   }
// }
// CONCATENATED MODULE: ./src/platform/components/InsertTable/index.js
/**
 * Created by wangshhj on 2018/1/16.
 */


/* harmony default export */ var InsertTable = ({
  createInsertTable: createInsertTable,
  getInsertTableValue: getInsertTableValue,
  setInsertTableValue: setInsertTableValue,
  setChildTableData: setChildTableData,
  getInsertTableSelectedValue: getInsertTableSelectedValue,
  getPageInfo: getPageInfo,
  getCheckedRows: getCheckedRows,
  deleteTableRowsByIndex: deleteTableRowsByIndex,
  updateDataByRefresh: updateDataByRefresh,
  changeCheck: changeCheck
});
// CONCATENATED MODULE: ./src/platform/components/PrintOutput/index.js
function PrintOutput_extends() { PrintOutput_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return PrintOutput_extends.apply(this, arguments); }

function PrintOutput_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function PrintOutput_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { PrintOutput_ownKeys(Object(source), true).forEach(function (key) { PrintOutput_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { PrintOutput_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function PrintOutput_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function PrintOutput_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { PrintOutput_typeof = function _typeof(obj) { return typeof obj; }; } else { PrintOutput_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return PrintOutput_typeof(obj); }

function PrintOutput_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function PrintOutput_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function PrintOutput_createClass(Constructor, protoProps, staticProps) { if (protoProps) PrintOutput_defineProperties(Constructor.prototype, protoProps); if (staticProps) PrintOutput_defineProperties(Constructor, staticProps); return Constructor; }

function PrintOutput_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) PrintOutput_setPrototypeOf(subClass, superClass); }

function PrintOutput_setPrototypeOf(o, p) { PrintOutput_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return PrintOutput_setPrototypeOf(o, p); }

function PrintOutput_createSuper(Derived) { var hasNativeReflectConstruct = PrintOutput_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = PrintOutput_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = PrintOutput_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return PrintOutput_possibleConstructorReturn(this, result); }; }

function PrintOutput_possibleConstructorReturn(self, call) { if (call && (PrintOutput_typeof(call) === "object" || typeof call === "function")) { return call; } return PrintOutput_assertThisInitialized(self); }

function PrintOutput_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function PrintOutput_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function PrintOutput_getPrototypeOf(o) { PrintOutput_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return PrintOutput_getPrototypeOf(o); }





__webpack_require__(1903);

var PrintOutput_Option = base_index_["Select"].Option;

function is(a, b) {
  return a === b;
}

var PrintOutput_PrintOutput = /*#__PURE__*/function (_PureComponent) {
  PrintOutput_inherits(PrintOutput, _PureComponent);

  var _super = PrintOutput_createSuper(PrintOutput);

  function PrintOutput(props) {
    var _this;

    PrintOutput_classCallCheck(this, PrintOutput);

    _this = _super.call(this, props);

    _this.shouldComponentUpdate = function () {
      var nextProps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
      var nextState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var thisProps = _this.props || {},
          thisState = _this.state || {};

      if (Object.keys(thisProps).length !== Object.keys(nextProps).length || Object.keys(thisState).length !== Object.keys(nextState).length) {
        return true;
      }

      for (var key in nextProps) {
        if (!is(thisProps[key], nextProps[key])) {
          return true;
        }
      }

      for (var _key in nextState) {
        if (thisState[_key] !== nextState[_key] || !is(thisState[_key], nextState[_key])) {
          return true;
        }
      }

      return false;
    };

    _this.close = function () {
      _this.setState({
        show: false
      });
    };

    _this.open = function () {
      var _this$props$data = _this.props.data,
          funcode = _this$props$data.funcode,
          nodekey = _this$props$data.nodekey,
          appcode = _this$props$data.appcode,
          oids = _this$props$data.oids;
      Object(index_["ajax"])({
        method: 'post',
        url: '/nccloud/platform/print/queryTemplates.do',
        data: {
          funcode: funcode,
          nodekey: nodekey,
          appcode: appcode,
          oids: oids
        },
        mode: 'normal',
        success: function success(res) {
          var data = res.data.data || res.data;

          if (!data) {
            var error = res.data.error || res.error;

            if (error) {
              if (PrintOutput_typeof(error) === 'object') {
                var keys = Object.values(error);
                Object(index_["toast"])({
                  color: 'warning',
                  content: keys.join('||')
                });
              } else {
                Object(index_["toast"])({
                  color: 'warning',
                  content: String(res)
                });
              }
            }

            return;
          }

          var list = res.data.data || [];
          var printTemplateID = list.length ? list[0]['m_ctemplateid'] : '';

          _this.setState({
            printTemplateMenu: list,
            data: PrintOutput_objectSpread(PrintOutput_objectSpread({}, _this.state.data), {}, {
              printTemplateID: printTemplateID
            }),
            show: true
          });
        },
        error: function error(res) {
          Object(index_["toast"])({
            color: 'danger',
            content: res.message
          });
        }
      });
    };

    _this.submit = function () {
      //新加：license校验成功后，再打印
      Object(index_["ajax"])({
        method: 'post',
        url: '/nccloud/platform/print/queryPrintAuthorize.do',
        data: {},
        success: function success(res) {
          var data = Object.assign({}, _this.props.data, _this.state.data);
          var printTemplateID = _this.state.data.printTemplateID;
          data.printTemplateName = '';
          var printTemplateMenu = _this.state.printTemplateMenu;
          if (printTemplateMenu && printTemplateMenu instanceof Array) printTemplateMenu.forEach(function (item) {
            if (item.m_ctemplateid == printTemplateID) {
              data.printTemplateName = item.m_vtemplatename;
            }
          });
          var submitData = {
            url: _this.props.url || '/nccloud/reva/revecont/print.do',
            params: Object.assign({}, Object.assign({}, data, {
              outputSetting: JSON.stringify(data),
              download: "directOutput",
              outputMode: data.outputMode
            })),
            enctype: 2,
            isCipher: true
          };
          Object(index_["formDownload"])(submitData);

          if (typeof _this.props.callback === 'function') {
            _this.props.callback();
          }

          _this.close();
        }
      });
    };

    _this.handleTypeChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          outputMode: value
        })
      });
    };

    _this.handlePrintTemplateIDChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          printTemplateID: value
        })
      });
    };

    _this.handleMultiConfigChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          MultiConfig: value
        })
      });
    };

    _this.changePdfConfigCheck = function (value) {
      console.log(value);

      _this.setState({
        data: Object.assign({}, _this.state.data, {
          pdfConfig: value
        })
      });
    };

    _this.changeHtmlConfigCheck = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          htmlConfig: value
        })
      });
    };

    _this.handlePrefixInputChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          prefix: value
        })
      });
    };

    _this.handleThresholdInputChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          threshold: value
        })
      });
    };

    _this.gerMultitaskSetup = function () {
      //  "api-print-0018": "工作表名称","api-print-0019": "行数阈值","api-print-0020": "多任务设置","api-print-0021": "注：设置单个Excel文件的行数，超过此行数自动新建文件"
      var _this$state$data = _this.state.data,
          outputMode = _this$state$data.outputMode,
          sheetNamePreFix = _this$state$data.sheetNamePreFix,
          dsPositionPolicy = _this$state$data.dsPositionPolicy,
          fileVolume = _this$state$data.fileVolume,
          isDifDocDifFile = _this$state$data.isDifDocDifFile,
          _this$state$data$canM = _this$state$data.canModifyType,
          canModifyType = _this$state$data$canM === void 0 ? false : _this$state$data$canM;
      var _this$state$json = _this.state.json,
          json = _this$state$json === void 0 ? {} : _this$state$json;
      var multiTask = "";
      var radioStyle = {
        display: 'block'
      };
      var dsPositionPolicyList = [{
        display: json["api-print-0013"],
        value: 4
      }, //全部打印任务导出到同一个工作表
      {
        display: json["api-print-0014"],
        value: 5
      }, //每一个打印任务导出到不同的工作表
      {
        display: json["api-print-0015"],
        value: 6
      } //每一个打印任务导出到不同的工作簿
      ];
      var isDifDocDifFileList = [{
        display: json["api-print-0016"],
        value: false
      }, //全部打印任务导出到同一个文件
      {
        display: json["api-print-0017"],
        value: true
      } //每一个打印任务导出到不同的文件
      ];

      if (outputMode === "excel") {
        multiTask = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].RadioGroup, {
          name: "type",
          selectedValue: dsPositionPolicy,
          onChange: _this.handleOtherSheet.bind(PrintOutput_assertThisInitialized(_this), "dsPositionPolicy")
        }, dsPositionPolicyList.map(function (item, index) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
            disabled: !canModifyType,
            style: radioStyle,
            key: index.toString(),
            value: item.value
          }, item.display);
        })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "form-region"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          className: "label"
        }, json["api-print-0018"], "\uFF1A"), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "in-form"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
          value: sheetNamePreFix,
          onChange: _this.handleOtherSheet.bind(PrintOutput_assertThisInitialized(_this), "sheetNamePreFix")
        }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "form-region"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          inverse: true,
          placement: "top",
          overlay: json["api-print-0021"]
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          className: "label"
        }, json["api-print-0019"], "\uFF1A")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "in-form"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["InputNumber"], {
          iconStyle: 1,
          min: 1,
          value: fileVolume,
          onChange: _this.handleOtherSheet.bind(PrintOutput_assertThisInitialized(_this), "fileVolume")
        }))));
      } else if (["pdf", "html"].includes(outputMode)) {
        multiTask = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].RadioGroup, {
          name: "type",
          selectedValue: isDifDocDifFile,
          onChange: _this.handleOtherSheet.bind(PrintOutput_assertThisInitialized(_this), "isDifDocDifFile")
        }, isDifDocDifFileList.map(function (item, index) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
            disabled: !canModifyType,
            style: radioStyle,
            key: index.toString(),
            value: item.value
          }, item.display);
        })));
      }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "task-container"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("h3", null, json["api-print-0020"]), multiTask);
    };

    _this.state = {
      show: false,
      json: {},
      printTemplateMenu: [],
      data: {
        outputMode: 'pdf',
        MultiConfig: '1',
        pdfConfig: false,
        printTemplateID: '',
        htmlConfig: false,
        prefix: '',
        threshold: 0,
        dsPositionPolicy: 4,
        fileVolume: 16000,
        sheetNamePreFix: '新的工作表',
        isDifDocDifFile: false,
        canModifyType: props.canModifyType || false
      }
    };
    return _this;
  }

  PrintOutput_createClass(PrintOutput, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      var json = this.props.json;

      if (json) {
        this.setState({
          json: json
        });
      } else {
        var callback = function callback(json, bool, inlt) {
          var data = _this2.state.data;
          data.sheetNamePreFix = json['api-print-0022'] || "新的工作表", _this2.setState({
            json: json,
            data: data
          });
        };

        Object(index_["getMultiLang"])({
          moduleId: 'api-print',
          callback: callback
        });
      }
    }
  }, {
    key: "handleOtherSheet",
    value: function handleOtherSheet(type, val) {
      this.setState({
        data: Object.assign({}, this.state.data, PrintOutput_defineProperty({}, type, val))
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var type = this.state.data.type,
          _this$state = this.state,
          json = _this$state.json,
          printTemplateMenu = _this$state.printTemplateMenu;
      /*   let ConfigTag = () => {
               if (type === 'excel') {
                 return <div className='config'>
                     <fieldset>
                         <legend>多任务设置</legend>
                         <Radio.RadioGroup
                             name="MultiConfig"
                             selectedValue={this.state.data.MultiConfig}
                             onChange={this.handleMultiConfigChange.bind(this)}>
                               <Radio key={1} value="1">全部打印任务导出到同一个工作表</Radio>
                               <Radio key={2} disabled value="2">每个打印任务导出到不同的工作表</Radio>
                               <Radio key={3} disabled value="3">每个打印任务导出到不同的工作簿</Radio>
                           </Radio.RadioGroup>
                     </fieldset>
                       <Form>
                         <FormItem isRequire={true}
                                     labelName="工作表前缀"
                                     htmlType="chinese"
                                     errorMessage="前缀格式错误"
                                     method="blur"
                         >
                             <FormControl name="prefix"
                                            value={this.state.data.prefix}
                                            onChange={this.handlePrefixInputChange}
                                            placeholder="只能输入中文"/>
                         </FormItem>
                         <FormItem isRequire={true}
                                     labelName="行数阀值"
                                     method="blur"
                                     reg={/^[0-9]+$/}
                                     errorMessage="行数阀值格式错误">
                             <FormControl name="threshold"
                                            value={this.state.data.threshold}
                                            onChange={this.handleThresholdInputChange}
                             />
                         </FormItem>
                     </Form>
                   </div>
             } else if (type === 'pdf') {
                   return <div className='Config'>
                     <Checkbox checked={this.state.data.pdfConfig}
                                 onChange={this.changePdfConfigCheck}>每一个打印任务导出到不同的文件</Checkbox>
                 </div>
             } else {
                 return <div className='Config'>
                     <Checkbox checked={this.state.data.htmlConfig}
                                 onChange={this.changeHtmlConfigCheck}>每一个打印任务导出到不同的文件</Checkbox>
                 </div>
             }
         }*/

      var templateChoice = function templateChoice() {
        if (!printTemplateMenu || printTemplateMenu.length <= 1) {
          return '';
        } else {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "body",
            style: {
              padding: '20px'
            }
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, json['api-print-0008' || false], "\uFF1A"), ' ', /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Select"], {
            value: _this3.state.data.printTemplateID //style={{ width: 200, marginRight: 6 }}
            ,
            onChange: _this3.handlePrintTemplateIDChange,
            disabled: printTemplateMenu.length <= 1 ? true : false,
            fieldid: "print-list",
            className: "print-out-select"
          }, printTemplateMenu.map(function (item, index) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintOutput_Option, {
              value: item && item.m_ctemplateid,
              key: index,
              title: item && item.m_vtemplatename
            }, item && item.m_vtemplatename);
          })));
        }
      };

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], PrintOutput_extends({}, this.props, {
        fieldid: "print",
        show: this.state.show,
        ref: function ref(Modal) {
          return _this3.Modal = Modal;
        },
        className: "senior print-output-contain",
        onHide: this.close,
        zIndex: 220 //cardtable最大化之后会被盖住，所以加这个属性

      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          sureBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM,
          cancelBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL
        },
        handlers: {
          sureBtnHandler: function sureBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发 by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              _this3.submit();
            }
          },
          cancelBtnHandler: function cancelBtnHandler() {
            // 取消按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              _this3.close();
            }
          }
        },
        className: "print-template-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, {
        closeButton: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Title, null, this.props.title || json['api-print-0009'] || '输出到文件')), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "print-template-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "header"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].RadioGroup, {
        name: "type",
        selectedValue: this.state.data.outputMode,
        onChange: this.handleTypeChange.bind(this)
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        key: "excel",
        value: "excel"
      }, json['api-print-0010' || false]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        key: "pdf",
        value: "pdf"
      }, json['api-print-0011' || false]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        key: "html",
        value: "html"
      }, json['api-print-0012' || false]))), templateChoice(), this.gerMultitaskSetup())), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(json['api-print-0006'], "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM, ")"),
        trigger: ["hover", "focus"]
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        fieldid: "confirm",
        onClick: this.submit,
        colors: "primary"
      }, json['api-print-0006' || false], "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "Y"), ")")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(json['api-print-0007'], "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL, ")"),
        trigger: ["hover", "focus"]
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        fieldid: "cancel",
        onClick: this.close,
        colors: "info"
      }, json['api-print-0007' || false], "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "N"), ")"))));
    }
  }]);

  return PrintOutput;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["PureComponent"]);


// CONCATENATED MODULE: ./src/platform/components/PrintOutputModal/index.js
function PrintOutputModal_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { PrintOutputModal_typeof = function _typeof(obj) { return typeof obj; }; } else { PrintOutputModal_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return PrintOutputModal_typeof(obj); }

function PrintOutputModal_extends() { PrintOutputModal_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return PrintOutputModal_extends.apply(this, arguments); }

function PrintOutputModal_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function PrintOutputModal_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function PrintOutputModal_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function PrintOutputModal_createClass(Constructor, protoProps, staticProps) { if (protoProps) PrintOutputModal_defineProperties(Constructor.prototype, protoProps); if (staticProps) PrintOutputModal_defineProperties(Constructor, staticProps); return Constructor; }

function PrintOutputModal_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) PrintOutputModal_setPrototypeOf(subClass, superClass); }

function PrintOutputModal_setPrototypeOf(o, p) { PrintOutputModal_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return PrintOutputModal_setPrototypeOf(o, p); }

function PrintOutputModal_createSuper(Derived) { var hasNativeReflectConstruct = PrintOutputModal_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = PrintOutputModal_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = PrintOutputModal_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return PrintOutputModal_possibleConstructorReturn(this, result); }; }

function PrintOutputModal_possibleConstructorReturn(self, call) { if (call && (PrintOutputModal_typeof(call) === "object" || typeof call === "function")) { return call; } return PrintOutputModal_assertThisInitialized(self); }

function PrintOutputModal_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function PrintOutputModal_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function PrintOutputModal_getPrototypeOf(o) { PrintOutputModal_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return PrintOutputModal_getPrototypeOf(o); }






__webpack_require__(1904);

var PrintOutputModal_Option = base_index_["Select"].Option || base_index_["Select"].NCOption; //const OptGroup = NCSelect.OptGroup;

var PrintOutputModal_PrintOutputModal = /*#__PURE__*/function (_PureComponent) {
  PrintOutputModal_inherits(PrintOutputModal, _PureComponent);

  var _super = PrintOutputModal_createSuper(PrintOutputModal);

  function PrintOutputModal(props) {
    var _this;

    PrintOutputModal_classCallCheck(this, PrintOutputModal);

    _this = _super.call(this, props);

    _this.close = function () {
      _this.setState({
        show: false
      });

      _this.closeTimer = setTimeout(function () {
        var element = document.getElementsByClassName('print-output-modal-liuyjv-wrapper')[0];

        if (element) {
          external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.unmountComponentAtNode(element);
          clearTimeout(_this.closeTimer);
          document.getElementById('app').removeChild(element);
          _this.closeTimer = null;
        }
      }, 200);
    };

    _this.open = function () {
      _this.setState({
        show: true
      });
    };

    _this.submit = function () {
      var _this$props$data = _this.props.data,
          data = _this$props$data === void 0 ? {} : _this$props$data;
      var _data = data,
          _data$outputtype = _data.outputtype,
          outputtype = _data$outputtype === void 0 ? "templateOutput" : _data$outputtype; //新加：license校验成功后，再打印

      Object(index_["ajax"])({
        method: 'post',
        url: '/nccloud/platform/print/queryPrintAuthorize.do',
        data: {},
        success: function success(res) {
          data = Object.assign({}, _this.props.data, _this.state.data);
          var printTemplateID = _this.state.data.printTemplateID;
          data.printTemplateName = '';
          var printTemplateMenu = _this.props.printTemplateMenu;
          if (printTemplateMenu && printTemplateMenu instanceof Array) printTemplateMenu.forEach(function (item) {
            if (item.m_ctemplateid == printTemplateID) {
              data.printTemplateName = item.m_vtemplatename;
            }
          });
          var submitData = {
            url: _this.props.url || '/nccloud/reva/revecont/print.do',
            params: outputtype === "directOutput" ? Object.assign({}, Object.assign({}, data, {
              outputSetting: JSON.stringify(data),
              download: "directOutput",
              outputMode: data.outputMode
            })) : data,
            enctype: 2,
            isCipher: true
          };
          Object(index_["formDownload"])(submitData);

          if (typeof _this.props.callback === 'function') {
            _this.props.callback();
          }

          _this.close();
        }
      });
    };

    _this.handlePrintTemplateIDChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          printTemplateID: value
        })
      });
    };

    _this.handleTypeChange = function (value) {
      _this.setState({
        data: Object.assign({}, _this.state.data, {
          outputMode: value
        })
      });
    };

    _this.gerMultitaskSetup = function () {
      //  "api-print-0018": "工作表名称","api-print-0019": "行数阈值","api-print-0020": "多任务设置","api-print-0021": "注：设置单个Excel文件的行数，超过此行数自动新建文件"
      var _this$state$data = _this.state.data,
          outputMode = _this$state$data.outputMode,
          sheetNamePreFix = _this$state$data.sheetNamePreFix,
          dsPositionPolicy = _this$state$data.dsPositionPolicy,
          fileVolume = _this$state$data.fileVolume,
          isDifDocDifFile = _this$state$data.isDifDocDifFile,
          _this$state$data$canM = _this$state$data.canModifyType,
          canModifyType = _this$state$data$canM === void 0 ? false : _this$state$data$canM;
      var _this$state$json = _this.state.json,
          json = _this$state$json === void 0 ? {} : _this$state$json;
      var multiTask = "";
      var radioStyle = {
        display: 'block'
      };
      var dsPositionPolicyList = [{
        display: json["api-print-0013"],
        value: 4
      }, //全部打印任务导出到同一个工作表
      {
        display: json["api-print-0014"],
        value: 5
      }, //每一个打印任务导出到不同的工作表
      {
        display: json["api-print-0015"],
        value: 6
      } //每一个打印任务导出到不同的工作簿
      ];
      var isDifDocDifFileList = [{
        display: json["api-print-0016"],
        value: false
      }, //全部打印任务导出到同一个文件
      {
        display: json["api-print-0017"],
        value: true
      } //每一个打印任务导出到不同的文件
      ];

      if (outputMode === "excel") {
        multiTask = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].NCRadioGroup, {
          name: "type",
          selectedValue: dsPositionPolicy,
          onChange: _this.handleOtherSheet.bind(PrintOutputModal_assertThisInitialized(_this), "dsPositionPolicy")
        }, dsPositionPolicyList.map(function (item, index) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
            disabled: !canModifyType,
            style: radioStyle,
            key: index.toString(),
            value: item.value
          }, item.display);
        })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "form-region"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          className: "label"
        }, json["api-print-0018"], "\uFF1A"), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "in-form"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
          value: sheetNamePreFix,
          onChange: _this.handleOtherSheet.bind(PrintOutputModal_assertThisInitialized(_this), "sheetNamePreFix")
        }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "form-region"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          inverse: true,
          placement: "top",
          overlay: json["api-print-0021"]
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("p", {
          className: "label"
        }, json["api-print-0019"], "\uFF1A")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "in-form"
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["InputNumber"], {
          iconStyle: 1,
          min: 1,
          value: fileVolume,
          onChange: _this.handleOtherSheet.bind(PrintOutputModal_assertThisInitialized(_this), "fileVolume")
        }))));
      } else if (["pdf", "html"].includes(outputMode)) {
        multiTask = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].NCRadioGroup, {
          name: "type",
          selectedValue: isDifDocDifFile,
          onChange: _this.handleOtherSheet.bind(PrintOutputModal_assertThisInitialized(_this), "isDifDocDifFile")
        }, isDifDocDifFileList.map(function (item, index) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
            disabled: !canModifyType,
            style: radioStyle,
            key: index.toString(),
            value: item.value
          }, item.display);
        })));
      }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "task-container"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("h3", null, json["api-print-0020"]), multiTask);
    };

    _this.state = {
      json: {},
      show: true,
      data: {
        //确定输出以后传给后台数据
        printTemplateID: props.printTemplateMenu.length ? props.printTemplateMenu[0]['m_ctemplateid'] : '',
        //模板id
        outputMode: 'pdf',
        MultiConfig: '1',
        pdfConfig: false,
        htmlConfig: false,
        prefix: '',
        threshold: 0,
        dsPositionPolicy: 4,
        fileVolume: 16000,
        sheetNamePreFix: "新的工作表",
        isDifDocDifFile: false,
        canModifyType: props.canModifyType || false
      }
    };
    return _this;
  }

  PrintOutputModal_createClass(PrintOutputModal, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      var json = this.props.json;

      if (json) {
        this.setState({
          json: json
        });
      } else {
        var callback = function callback(json, bool, inlt) {
          var data = _this2.state.data;
          data.sheetNamePreFix = json['api-print-0022'] || "新的工作表", _this2.setState({
            json: json,
            data: data
          });
        };

        Object(index_["getPlatformLang"])({
          moduleId: 'api-print',
          callback: callback
        });
      }
    }
  }, {
    key: "handleOtherSheet",
    value: function handleOtherSheet(type, val) {
      this.setState({
        data: Object.assign({}, this.state.data, PrintOutputModal_defineProperty({}, type, val))
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$props = this.props,
          printTemplateMenu = _this$props.printTemplateMenu,
          _this$props$data2 = _this$props.data,
          data = _this$props$data2 === void 0 ? {} : _this$props$data2;
      var json = this.state.json;
      var hideChoice = !printTemplateMenu || printTemplateMenu.length <= 1;
      var _data$outputtype2 = data.outputtype,
          outputtype = _data$outputtype2 === void 0 ? "templateOutput" : _data$outputtype2;

      var templateChoice = function templateChoice() {
        if (hideChoice) {
          return '';
        } else {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
            className: "body",
            style: {
              padding: '20px'
            }
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, json['api-print-0008' || false], "\uFF1A"), ' ', /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Select"], {
            showClear: false,
            value: _this3.state.data.printTemplateID //style={{ width: 200, marginRight: 6 }}
            ,
            onChange: _this3.handlePrintTemplateIDChange,
            disabled: printTemplateMenu.length <= 1 ? true : false,
            fieldid: "print-list",
            className: "print-out-select"
          }, printTemplateMenu.map(function (item, index) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintOutputModal_Option, {
              value: item && item.m_ctemplateid,
              key: index,
              title: item && item.m_vtemplatename
            }, item && item.m_vtemplatename);
          })));
        }
      };

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], {
        fieldid: "output",
        className: "print-output-wrapper senior",
        show: this.state.show,
        ref: function ref(NCModal) {
          return _this3.NCModal = NCModal;
        },
        onHide: this.close,
        zIndex: 220 //cardtable最大化之后会被盖住，所以加这个属性

      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          sureBtnHandler: base_index_["HotKeys"].USUAL_KEYS.NC_MODAL_CONFIRM,
          cancelBtnHandler: base_index_["HotKeys"].USUAL_KEYS.NC_MODAL_CALCEL
        },
        handlers: {
          sureBtnHandler: function sureBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发 by bbqin
            if (_this3.NCModal && _this3.NCModal.isTopModal()) {
              _this3.submit();
            }
          },
          cancelBtnHandler: function cancelBtnHandler() {
            // 取消按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.NCModal && _this3.NCModal.isTopModal()) {
              _this3.close();
            }
          }
        },
        className: "print-template-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, {
        closeButton: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Title, null, this.props.title || json['api-print-0009'] || '输出到文件')), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "print-output-template-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "print-choice"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].NCRadioGroup, {
        name: "type",
        selectedValue: this.state.data.outputMode,
        onChange: this.handleTypeChange.bind(this)
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        key: "excel",
        value: "excel"
      }, json['api-print-0010' || false]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        key: "pdf",
        value: "pdf"
      }, json['api-print-0011' || false]), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
        key: "html",
        value: "html"
      }, json['api-print-0012' || false]))), templateChoice(), this.gerMultitaskSetup())), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(json['api-print-0006'], "  (").concat(base_index_["HotKeys"].USUAL_KEYS.NC_MODAL_CONFIRM, ")"),
        trigger: ["hover", "focus"]
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.submit,
        colors: "primary",
        fieldid: "confirm"
      }, json['api-print-0006' || false], "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "Y"), ")")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(json['api-print-0007'], "  (").concat(base_index_["HotKeys"].USUAL_KEYS.NC_MODAL_CALCEL, ")"),
        trigger: ["hover", "focus"]
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.close,
        colors: "info",
        fieldid: "cancel"
      }, json['api-print-0007' || false], "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "N"), ")"))));
    }
  }]);

  return PrintOutputModal;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["PureComponent"]);
function PrintOutputModal_output(props) {
  //funcode和appcode一样，nodekey？oids？//问董跃龙
  //默认是模板输出，如果outputtype是directOutput，是直接输出
  var _props$data = props.data,
      funcode = _props$data.funcode,
      nodekey = _props$data.nodekey,
      appcode = _props$data.appcode,
      oids = _props$data.oids,
      _props$data$outputtyp = _props$data.outputtype,
      outputtype = _props$data$outputtyp === void 0 ? "templateOutput" : _props$data$outputtyp; //先查模板

  var callback = function callback(json, bool, inlt) {
    if (outputtype === "directOutput") {
      return external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.render( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintOutputModal_PrintOutputModal, PrintOutputModal_extends({}, props, {
        printTemplateMenu: [],
        json: json
      })), div);
    } else {
      Object(index_["ajax"])({
        method: 'post',
        url: '/nccloud/platform/print/queryTemplates.do',
        //加 license 校验
        data: {
          funcode: funcode,
          nodekey: nodekey,
          appcode: appcode,
          oids: oids
        },
        mode: 'normal',
        success: function success(res) {
          var data = res.data.data || res.data;

          if (!data) {
            var error = res.data.error || res.error;

            if (error) {
              if (PrintOutputModal_typeof(error) === 'object') {
                var keys = Object.values(error);
                Object(index_["toast"])({
                  color: 'warning',
                  content: keys.join('||')
                });
              } else {
                Object(index_["toast"])({
                  color: 'warning',
                  content: String(res)
                });
              }
            }

            return;
          } //list模板列表，list是数组，元素为object，object为模板标识，


          var list = res.data.data;
          var isShow = document.getElementsByClassName('print-output-modal-liuyjv-wrapper')[0]; //阻止连续多次点击时页面出现多个toast弹框

          if (isShow) {
            return false;
          }

          var div = document.createElement('div');
          div.className = 'print-output-modal-liuyjv-wrapper';
          document.getElementById('app').appendChild(div);
          return external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.render( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintOutputModal_PrintOutputModal, PrintOutputModal_extends({}, props, {
            printTemplateMenu: list,
            json: json
          })), div);
        },
        error: function error(res) {
          Object(index_["toast"])({
            color: 'danger',
            content: res.message
          });
        }
      });
    }
  };

  Object(index_["getMultiLang"])({
    moduleId: 'api-print',
    callback: callback
  });
}
// CONCATENATED MODULE: ./src/platform/components/PrintTemplate/index.js
function PrintTemplate_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { PrintTemplate_typeof = function _typeof(obj) { return typeof obj; }; } else { PrintTemplate_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return PrintTemplate_typeof(obj); }

function PrintTemplate_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function PrintTemplate_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { PrintTemplate_ownKeys(Object(source), true).forEach(function (key) { PrintTemplate_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { PrintTemplate_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function PrintTemplate_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function PrintTemplate_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function PrintTemplate_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function PrintTemplate_createClass(Constructor, protoProps, staticProps) { if (protoProps) PrintTemplate_defineProperties(Constructor.prototype, protoProps); if (staticProps) PrintTemplate_defineProperties(Constructor, staticProps); return Constructor; }

function PrintTemplate_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) PrintTemplate_setPrototypeOf(subClass, superClass); }

function PrintTemplate_setPrototypeOf(o, p) { PrintTemplate_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return PrintTemplate_setPrototypeOf(o, p); }

function PrintTemplate_createSuper(Derived) { var hasNativeReflectConstruct = PrintTemplate_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = PrintTemplate_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = PrintTemplate_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return PrintTemplate_possibleConstructorReturn(this, result); }; }

function PrintTemplate_possibleConstructorReturn(self, call) { if (call && (PrintTemplate_typeof(call) === "object" || typeof call === "function")) { return call; } return PrintTemplate_assertThisInitialized(self); }

function PrintTemplate_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function PrintTemplate_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function PrintTemplate_getPrototypeOf(o) { PrintTemplate_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return PrintTemplate_getPrototypeOf(o); }






__webpack_require__(1905);

var PrintTemplate_PrintTemplate = /*#__PURE__*/function (_React$Component) {
  PrintTemplate_inherits(PrintTemplate, _React$Component);

  var _super = PrintTemplate_createSuper(PrintTemplate);

  function PrintTemplate(props) {
    var _this;

    PrintTemplate_classCallCheck(this, PrintTemplate);

    _this = _super.call(this, props);

    _this.close = function () {
      _this.setState({
        show: false
      });

      _this.closeTimer = setTimeout(function () {
        var element = document.getElementsByClassName('print-modal-liuyjv-wrapper')[0];

        if (element) {
          external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.unmountComponentAtNode(element);
          clearTimeout(_this.closeTimer);
          document.getElementById('app').removeChild(element);
          _this.closeTimer = null;
        }
      }, 200);
    };

    _this.submit = function () {
      if (!_this.state.printTemplateID) {
        return Object(index_["toast"])({
          color: 'warning',
          content: _this.state.json['api-print-0004'] || '模板ID参数为空'
        });
      }

      var data = Object.assign({}, _this.state.data, {
        printTemplateID: _this.state.printTemplateID
      });

      _this.props.callback(_this.state.type, _this.state.url, data, _this.props.isCipher);

      _this.close();
    };

    _this.handleChange = function (value) {
      _this.setState({
        printTemplateID: value
      });
    };

    _this.state = {
      show: true,
      appcode: _this.props.appcode || '',
      nodekey: _this.props.nodekey || '',
      type: _this.props.type || '',
      url: _this.props.url || '',
      data: _this.props.data || '',
      printTemplateMenu: _this.props.printTemplateMenu || [],
      printTemplateID: '',
      json: {}
    };
    return _this;
  }

  PrintTemplate_createClass(PrintTemplate, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      var json = this.props.json;

      if (json) {
        this.setState({
          printTemplateID: this.props.printTemplateMenu.length ? this.props.printTemplateMenu[0].m_ctemplateid : '',
          json: json
        });
      } else {
        var callback = function callback(json, bool, inlt) {
          _this2.setState({
            printTemplateID: _this2.props.printTemplateMenu.length ? _this2.props.printTemplateMenu[0].m_ctemplateid : '',
            json: json
          });
        };

        Object(index_["getMultiLang"])({
          moduleId: 'api-print',
          callback: callback
        });
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var json = this.state.json;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], {
        fieldid: "print-template",
        show: this.state.show,
        className: "print-template-modal-wrapper senior",
        ref: function ref(Modal) {
          return _this3.Modal = Modal;
        },
        onHide: this.close
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["HotKeys"], {
        keyMap: {
          sureBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM,
          cancelBtnHandler: base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL
        },
        handlers: {
          sureBtnHandler: function sureBtnHandler() {
            // 确定按钮的事件 增加top的判断避免所有弹窗逻辑都被触发 by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              _this3.submit();
            }
          },
          cancelBtnHandler: function cancelBtnHandler() {
            // 取消按钮的事件 增加top的判断避免所有弹窗逻辑都被触发  by bbqin
            if (_this3.Modal && _this3.Modal.isTopModal()) {
              _this3.close();
            }
          }
        },
        className: "print-template-hotkeys-wrapper",
        focused: true,
        attach: document.body,
        display: "inline"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, {
        closeButton: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Title, {
        className: 'u-modal-title'
      }, this.props.modalTitle || json['api-print-0005'] || '打印模板选择')), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "modal-body-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"].RadioGroup, {
        name: "fruit",
        selectedValue: this.state.printTemplateID,
        onChange: this.handleChange.bind(this)
      }, this.state.printTemplateMenu.map(function (item, index) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Radio"], {
          className: "nc-radio-wrapper",
          value: item && item.m_ctemplateid
        }, item && item.m_vtemplatename);
      })))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(json['api-print-0006'], "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CONFIRM, ")"),
        trigger: ["hover", "focus"]
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.submit,
        colors: "primary",
        fieldid: "confirm"
      }, json['api-print-0006' || false], "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "Y"), ")")), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        inverse: true,
        overlay: "".concat(json['api-print-0007'], "  (").concat(base_index_["HotKeys"].USUAL_KEYS.MODAL_CALCEL, ")"),
        trigger: ["hover", "focus"]
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.close,
        colors: "info",
        fieldid: "cancel"
      }, json['api-print-0007' || false], "(", /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "text-decoration-underline"
      }, "N"), ")"))));
    }
  }]);

  return PrintTemplate;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.Component);

function getUserAgent() {
  var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串
  //判断是否Opera浏览器

  if (userAgent.indexOf("Opera") > -1) {
    return "Opera";
  } //判断是否Firefox浏览器


  if (userAgent.indexOf("Firefox") > -1) {
    return "FF";
  } //判断是否chorme浏览器


  if (userAgent.indexOf("Chrome") > -1) {
    return "Chrome";
  } //判断是否Safari浏览器


  if (userAgent.indexOf("Safari") > -1) {
    return "Safari";
  } //判断是否IE浏览器


  if (userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1 && !isOpera) {
    return "IE";
  } //判断是否Edge浏览器


  if (userAgent.indexOf("Trident") > -1) {
    return "Edge";
  }
}

function htmlPrint(type, url, data, json1, callback) {
  var resCallback = function resCallback(json, bool, inlt) {
    Object(index_["ajax"])({
      method: "post",
      url: url,
      data: data,
      print: true,
      mode: "normal",
      success: function success(res) {
        if (res.data) {
          if (callback && typeof callback === "function") {
            callback();
          }

          var newWin = window.open(""); //新开页面
          // newWin.location = 'http://www.baidu.com';

          if (newWin) {
            newWin.document.title = json["api-print-0003"] || "打印预览"; // newWin.document.write(res.data); //输入要打印的内容

            newWin.document.body.innerHTML = res.data; // write 会导致ie下不能打印的问题
            // 打印后置

            if (getUserAgent() === "Chrome") {
              newWin.print();
              newWin.close();
            } else {
              setTimeout(function () {
                newWin.print();
                newWin.close();
              }, 50);
            }
          } else {
            Object(index_["toast"])({
              color: "warning",
              content: json["api-print-0001"] || "您的浏览器阻止了弹出式窗口,请查看浏览器设置"
            });
          }
        }
      },
      error: function error(res) {
        Object(index_["toast"])({
          color: "danger",
          content: res.message
        });
      }
    });
  };

  Object(index_["getMultiLang"])({
    moduleId: "api-print",
    callback: resCallback
  });
}

function pdfPrint(type, url, data) {
  var isCipher = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
  Object(index_["formDownload"])({
    params: data,
    url: url,
    enctype: 2,
    isCipher: isCipher
  });
}

function print() {
  var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "html";
  var url = arguments.length > 1 ? arguments[1] : undefined;
  var data = arguments.length > 2 ? arguments[2] : undefined;
  var searchTemplate = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
  var isCipher = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;
  var gzip = Object(index_["getGlobalStorage"])("localStorage", "gzip");
  var gziptools = new index_["gzip"](); //let callback = (json, bool, inlt) => {

  if (searchTemplate) {
    var funcode = data.funcode,
        nodekey = data.nodekey,
        appcode = data.appcode,
        oids = data.oids;
    Object(index_["ajax"])({
      method: "post",
      url: "/nccloud/platform/print/queryTemplates.do",
      data: {
        funcode: funcode,
        nodekey: nodekey,
        appcode: appcode,
        oids: oids
      },
      //mode: "normal",
      //print: true,
      async: false,
      success: function success(res) {
        var list = res.data.data || res.data;
        var error = res.data.error || res.error; //if (gzip) {
        //list = gziptools.unzip(list);
        //}

        if (error) {
          Object(index_["toast"])({
            color: "danger",
            content: error
          });
          return console.error(error);
        }

        if (Array.isArray(list)) {
          if (list.length === 1) {
            if (type === 'html') {
              htmlPrint(type, url, PrintTemplate_objectSpread(PrintTemplate_objectSpread({}, data), {}, {
                printTemplateID: list[0]["m_ctemplateid"] ? list[0]["m_ctemplateid"] : null
              }), {});
            } else {
              pdfPrint(type, url, PrintTemplate_objectSpread(PrintTemplate_objectSpread({}, data), {}, {
                printTemplateID: list[0]["m_ctemplateid"] ? list[0]["m_ctemplateid"] : null
              }), isCipher);
            } // print(
            // 	type,
            // 	url,
            // 	{
            // 		...data,
            // 		printTemplateID: list[0]["m_ctemplateid"]
            // 			? list[0]["m_ctemplateid"]
            // 			: null
            // 	},
            // 	json
            // );

          } else {
            if (list.length < 1) {
              Object(index_["getMultiLang"])({
                moduleId: "api-print",
                callback: function callback(json) {
                  Object(index_["toast"])({
                    color: "warning",
                    content: json["api-print-0002"] || "未查询到任何模板信息"
                  });
                }
              });
              return;
            }

            var isShow = document.getElementsByClassName("print-modal-liuyjv-wrapper")[0]; //阻止连续多次点击时页面出现多个toast弹框

            if (isShow) {
              return false;
            }

            var div = document.createElement("div");
            div.className = "print-modal-liuyjv-wrapper";
            document.getElementById("app").appendChild(div);
            return external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.render( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintTemplate_PrintTemplate, {
              appcode: appcode,
              nodekey: nodekey,
              type: type,
              url: url,
              data: data,
              printTemplateMenu: list //callback={print}
              ,
              callback: type === 'html' ? htmlPrint : pdfPrint,
              isCipher: isCipher
            }), div);
          }
        } else {
          if (list.data.length === 1) {
            if (type === 'html') {
              htmlPrint(type, url, PrintTemplate_objectSpread(PrintTemplate_objectSpread({}, data), {}, {
                printTemplateID: list.data[0]["m_ctemplateid"] ? list.data[0]["m_ctemplateid"] : null
              }), {});
            } else {
              pdfPrint(type, url, PrintTemplate_objectSpread(PrintTemplate_objectSpread({}, data), {}, {
                printTemplateID: list.data[0]["m_ctemplateid"] ? list.data[0]["m_ctemplateid"] : null
              }), isCipher);
            } // print(
            // 	type,
            // 	url,
            // 	{
            // 		...data,
            // 		printTemplateID: list.data[0]["m_ctemplateid"]
            // 			? list.data[0]["m_ctemplateid"]
            // 			: null
            // 	},
            // 	json
            // );

          } else if (list.data.length > 1) {
            var _isShow = document.getElementsByClassName("print-modal-liuyjv-wrapper")[0]; //阻止连续多次点击时页面出现多个toast弹框

            if (_isShow) {
              return false;
            }

            var _div = document.createElement("div");

            _div.className = "print-modal-liuyjv-wrapper";
            document.getElementById("app").appendChild(_div);
            return external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.render( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintTemplate_PrintTemplate, {
              appcode: appcode,
              nodekey: nodekey,
              type: type,
              url: url //json={json}
              ,
              data: data,
              printTemplateMenu: list.data //callback={print}
              ,
              callback: type === 'html' ? htmlPrint : pdfPrint,
              isCipher: isCipher
            }), _div);
          } else {
            Object(index_["getMultiLang"])({
              moduleId: "api-print",
              callback: function callback(json) {
                Object(index_["toast"])({
                  color: "warning",
                  content: json["api-print-0002"] || "未查询到任何模板信息"
                });
              }
            });
            return; // return toast({
            // 	color: "warning",
            // 	content: json["api-print-0002"] || "未查询到任何模板信息"
            // });
          }
        }
      },
      error: function error(res) {
        Object(index_["toast"])({
          color: "danger",
          content: res.message
        });
      }
    });
  } else {
    if (type == "html") {
      htmlPrint(type, url, data, {});
    } else {
      pdfPrint(type, url, data, isCipher);
    }
  } //};

}
function printer() {
  var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "html";
  var url = arguments.length > 1 ? arguments[1] : undefined;
  var data = arguments.length > 2 ? arguments[2] : undefined;
  var isCipher = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;
  var funcode = data.funcode,
      nodekey = data.nodekey,
      appcode = data.appcode,
      oids = data.oids; //let callback = (json, bool, inlt) => {

  Object(index_["ajax"])({
    method: "post",
    url: "/nccloud/platform/print/queryTemplates.do",
    data: {
      funcode: funcode,
      nodekey: nodekey,
      appcode: appcode,
      oids: oids
    },
    //mode: "normal",
    async: false,
    success: function success(res) {
      var list = res.data.data || res.data;

      if (list.length === 1) {
        // print(
        //     type,
        //     url,
        //     {
        //         ...data,
        //         printTemplateID: list[0]["m_ctemplateid"]
        //             ? list[0]["m_ctemplateid"]
        //             : null
        //     },
        //     json
        // );
        if (type === 'html') {
          htmlPrint(type, url, PrintTemplate_objectSpread(PrintTemplate_objectSpread({}, data), {}, {
            printTemplateID: list[0]["m_ctemplateid"] ? list[0]["m_ctemplateid"] : null
          }), {});
        } else {
          pdfPrint(type, url, PrintTemplate_objectSpread(PrintTemplate_objectSpread({}, data), {}, {
            printTemplateID: list[0]["m_ctemplateid"] ? list[0]["m_ctemplateid"] : null
          })), isCipher;
        }
      } else {
        if (list.length < 1) {
          Object(index_["getMultiLang"])({
            moduleId: "api-print",
            callback: function callback(json) {
              Object(index_["toast"])({
                color: "warning",
                content: json["api-print-0002"] || "未查询到任何模板信息"
              });
            }
          });
          return;
        }

        var isShow = document.getElementsByClassName("print-modal-liuyjv-wrapper")[0]; //阻止连续多次点击时页面出现多个toast弹框

        if (isShow) {
          return false;
        }

        var div = document.createElement("div");
        div.className = "print-modal-liuyjv-wrapper";
        document.getElementById("app").appendChild(div);
        return external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.render( /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(PrintTemplate_PrintTemplate, {
          appcode: appcode,
          nodekey: nodekey,
          type: type,
          url: url // json={json}
          ,
          data: data,
          printTemplateMenu: list //callback={print}
          ,
          callback: type === 'html' ? htmlPrint : pdfPrint,
          isCipher: isCipher
        }), div);
      }
    },
    error: function error(res) {
      Object(index_["toast"])({
        color: "danger",
        content: res.message
      });
    }
  }); //};
  //getMultiLang({ moduleId: "api-print", callback });
}
// CONCATENATED MODULE: ./src/platform/components/Socket/create.js
function Socket_create_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { Socket_create_typeof = function _typeof(obj) { return typeof obj; }; } else { Socket_create_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return Socket_create_typeof(obj); }

function create_toConsumableArray(arr) { return create_arrayWithoutHoles(arr) || create_iterableToArray(arr) || Socket_create_unsupportedIterableToArray(arr) || create_nonIterableSpread(); }

function create_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function Socket_create_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return Socket_create_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Socket_create_arrayLikeToArray(o, minLen); }

function create_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function create_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return Socket_create_arrayLikeToArray(arr); }

function Socket_create_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function Socket_create_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function Socket_create_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function Socket_create_createClass(Constructor, protoProps, staticProps) { if (protoProps) Socket_create_defineProperties(Constructor.prototype, protoProps); if (staticProps) Socket_create_defineProperties(Constructor, staticProps); return Constructor; }

function Socket_create_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) Socket_create_setPrototypeOf(subClass, superClass); }

function Socket_create_setPrototypeOf(o, p) { Socket_create_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return Socket_create_setPrototypeOf(o, p); }

function Socket_create_createSuper(Derived) { var hasNativeReflectConstruct = Socket_create_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = Socket_create_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = Socket_create_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return Socket_create_possibleConstructorReturn(this, result); }; }

function Socket_create_possibleConstructorReturn(self, call) { if (call && (Socket_create_typeof(call) === "object" || typeof call === "function")) { return call; } return Socket_create_assertThisInitialized(self); }

function Socket_create_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function Socket_create_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function Socket_create_getPrototypeOf(o) { Socket_create_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return Socket_create_getPrototypeOf(o); }

function Socket_create_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Socket_create_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Socket_create_ownKeys(Object(source), true).forEach(function (key) { Socket_create_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Socket_create_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Socket_create_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }





 //import BillErrorTrack from '..//BillErrorTrack';








var create_gzip = new index_["gzip"]();

__webpack_require__(930);

var create_getGlobalStorage = index_["ViewModel"].getGlobalStorage,
    create_setGlobalStorage = index_["ViewModel"].setGlobalStorage,
    create_getData = index_["ViewModel"].getData,
    setData = index_["ViewModel"].setData;
var updateHeadCache = index_["cardCache"].updateHeadCache,
    newUpdateHeadCache = index_["cardCache"].newUpdateHeadCache;
var create_defaultUserId = ''; // renyjk 仅仅用于本地测试 

var create_isLocal = NODE_ENV === 'development';
var create_nameSpace = 'nccloud_platfrom_native_socket_billinfo';
/**
 * 生成唯一标识
 */

function create_uuidv4() {
  return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    // eslint-disable-next-line no-bitwise
    var r = Object(index_["getSafeRandom"])() * 16 | 0,
        v = c == 'x' ? r : r & 0x3 | 0x8;
    return v.toString(16);
  });
} //let wsLocation = '172.27.35.1:9991';
//let wsLocation = '172.20.53.89:8883';
//let wsLocation = '172.20.58.20:80';

/**
 * 建立webSocket连接，并监听事件
 * @param {*} config 
 */


function connectMesg(config) {
  var _this2 = this;

  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(create_Socket, {
    getThis: function getThis(_this) {
      _this2.mySocket = _this;
    },
    pageInstance: this,
    config: config || {},
    output: this.output,
    rootprops: this.props
  });
}
/**
 * 主动显示提示
 * @param {*} config 
 */

function showToast() {
  var _this3 = this;

  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

  if (config.gtxid && this.mySocket) {
    // 使用gtxid进行对象的存储  这样connect中才能比较好一一对应
    top.SocketConfig = top.SocketConfig || {};
    top.SocketConfig[config.gtxid] = Socket_create_objectSpread(Socket_create_objectSpread({}, config), top.SocketConfig[config.gtxid] || {});
  } //查询追溯数据


  (config.gtxid || config.message) && Object(index_["ajax"])({
    url: '/nccloud/platform/fixdata/QueryErrormsgAction.do',
    data: {
      gtxid: config.gtxid || ''
    },
    success: function success(res) {
      // console.log(res); res.data && 
      if (res.data && res.success) {
        var topMark = 'socketErrorToast' + config.gtxid;
        var toastMark = top && top.document.querySelectorAll(".toast-zijinyun-project[data-mark=\"".concat(topMark, "\"]")); // CLOUD-183261  当设置了showtoast为false之后  他们也可能刷新内页  导致这个提示弹出

        if (top.isShowToast && _this3.mySocket && toastMark && toastMark.length && JSON.stringify(top.isShowToast).indexOf('false') !== -1) {
          return;
        } // 先弹出了外层  然后我刷新内页会导致再弹出一个 所以这里要清理下外层的toast


        if (toastMark && toastMark.length) {
          Array.from(toastMark).forEach(function (el) {
            if (el) {
              el.parentNode.removeChild(el);
            }
          });
          var toasts = Object.assign([], window.toastModal),
              n = 0;
          toasts.forEach(function (val, index) {
            if (val && val.props && val.props.mark && val.props.mark === topMark && window.toastModal) {
              window.toastModal.splice(index - n, 1);
              n++;
            }
          });
        } // 多语获取


        var viewTitle = _this3.mySocket ? _this3.mySocket.viewTitleLang : '发送失败';
        var viewBtnText = _this3.mySocket ? _this3.mySocket.viewBtnLang : '立即查看';
        Object(index_["toast"])({
          mark: 'socketErrorToast',
          // 解决当前页面刷新导致的多次弹出问题 也可以为切换数据也cardPagination使用
          color: 'danger',
          title: viewTitle,
          customBtnBeforeClose: config.isShowView !== false ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            onClick: function onClick() {
              if (_this3.mySocket) {
                _this3.mySocket.gtxid = config.gtxid;
                _this3.mySocket.billpk = config.billpk;

                _this3.mySocket.setState({
                  showBillTrack: true
                });
              }
            }
          }, " ", viewBtnText) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null),
          groupOperation: true,
          groupOperationMsg: [config.message || res.data || '']
        });
      } else {
        // 没有获取数据情况比较复杂  暂时不进行提示
        console.log('没有res.data或者res不成功', res);
      }
    },
    error: function error(err) {
      if (err) {
        console.error(err);
        Object(index_["toast"])({
          color: 'danger',
          content: JSON.stringify(err.message)
        });
      }
    }
  });
}

var create_Socket = /*#__PURE__*/function (_Component) {
  Socket_create_inherits(Socket, _Component);

  var _super = Socket_create_createSuper(Socket);

  function Socket(props) {
    var _this4;

    Socket_create_classCallCheck(this, Socket);

    _this4 = _super.call(this, props);

    _this4.handleBeforeUnLoad = function () {
      // 修复审批中心 回退成功不更新的bug
      top.SocketMessageFun[_this4.cuuid] = null;
      delete top.SocketMessageFun[_this4.cuuid]; //this.removeTabid();
      //有可能页签未关闭，1s后未关闭，重新放入localStorage
      // setTimeout(() => {
      //     this.addTabid();
      // }, 1000);
    };

    _this4.addTabid = function () {
      var tabidStore = create_getGlobalStorage('localStorage', 'tabidStore');

      if (tabidStore) {
        tabidStore = JSON.parse(tabidStore);

        if (tabidStore instanceof Array && _this4.tabid) {
          tabidStore.push(_this4.tabid);
        }
      } else {
        tabidStore = [_this4.tabid];
      }

      create_setGlobalStorage('localStorage', 'tabidStore', JSON.stringify(tabidStore));
    };

    _this4.hasOpenedTab = function (tabid) {
      var tabidStore = create_getGlobalStorage('localStorage', 'tabidStore');

      if (tabidStore) {
        tabidStore = JSON.parse(tabidStore);
        if (tabidStore instanceof Array && tabidStore.length && tabidStore.includes(tabid)) return true;
      }

      return false;
    };

    _this4.removeTabid = function () {
      var tabidStore = create_getGlobalStorage('localStorage', 'tabidStore');

      if (tabidStore) {
        tabidStore = JSON.parse(tabidStore);

        if (tabidStore instanceof Array && tabidStore.length && _this4.tabid) {
          var index = tabidStore.indexOf(_this4.tabid);

          if (index != -1) {
            tabidStore.splice(index, 1);
            create_setGlobalStorage('localStorage', 'tabidStore', JSON.stringify(tabidStore));
          }
        }
      }
    };

    _this4.mergeTableData = function () {
      var refreshTable = [];

      for (var _i = 0, _Object$values = Object.values(_this4.refreshTableData); _i < _Object$values.length; _i++) {
        var item = _Object$values[_i];
        refreshTable.push.apply(refreshTable, create_toConsumableArray(item));
      }

      return refreshTable;
    };

    _this4.handleMessage = function (evt) {
      var userid = getUserId() || create_defaultUserId,
          ds = getUserInfo('datasource') || '',
          data = JSON.parse(evt.data);

      if (data && data.origin === 'websocket-server') {
        // system 是 true时，为公共系统提示
        return;
      }

      var resMessage = create_gzip.unzip(data.message) || {};
      var _this4$props = _this4.props,
          pageInstance = _this4$props.pageInstance,
          config = _this4$props.config;
      var _config$isShowView = config.isShowView,
          isShowView = _config$isShowView === void 0 ? true : _config$isShowView,
          _config$errorViewType = config.errorViewType,
          errorViewType = _config$errorViewType === void 0 ? true : _config$errorViewType,
          _config$isShowToast = config.isShowToast,
          isShowToast = _config$isShowToast === void 0 ? true : _config$isShowToast,
          onMessage = config.onMessage,
          tableAreaCode = config.tableAreaCode,
          _config$tableType = config.tableType,
          tableType = _config$tableType === void 0 ? 'table' : _config$tableType,
          billpkname = config.billpkname,
          headBtnAreaCode = config.headBtnAreaCode,
          formAreaCode = config.formAreaCode,
          dataSource = config.dataSource; // 当前用户，激活页签下显示

      var condition = data.targetids.includes(userid + ds) && !document.hidden; // 为 saga 错误类型时显示

      var saga_mesg = data.origin === 'ncc-server' && resMessage.type === 'saga_error';

      if (condition) {
        if (saga_mesg) {
          //if (resMessage.error) {
          if (resMessage.billtype) _this4.billtype = resMessage.billtype;

          if (Array.isArray(resMessage.refreshData) && resMessage.refreshData.length > 0) {
            _this4.gtxid = resMessage.refreshData[0].saga_gtxid;
            _this4.billpk = resMessage.refreshData[0][billpkname || '_businessPk'];
          } //}

        }
      } // 使用gtxid进行对象的存储  这样connect中才能比较好一一对应


      if (top && _this4.gtxid) {
        top.SocketConfig = top.SocketConfig || {};
        top.SocketConfig[_this4.gtxid] = {
          isShowView: isShowView,
          errorViewType: errorViewType,
          isShowToast: isShowToast
        };
      } //正常的单据saga错误消息


      var billSagaErrorMesg = data.targetids.includes(userid + ds) && resMessage.tabid === _this4.tabid; //若返回的tabid 跟当前所有打开页签都不匹配，则对比pk后, 更新当前激活页签数据
      //使用场景：tabid不匹配时，只对比当前页签数据，更新当前页签
      // 1.重试或回退 返回的 tadid 始终是第一次重试的 tabid--后台无法处理;
      // 2.点了提交，关闭页签，又重新打开页签后，消息才返回；由于tabid不对，当前页签无法更新
      //let hintErrorMesg = condition && !this.hasOpenedTab(resMessage.tabid);


      var hintErrorMesg = condition && (resMessage.isRepeat || resMessage.isCompensate);
      console.log('若为重试/回退操作,只更新激活页签,hintErrorMesg:', hintErrorMesg); // 为龙哥新增 重试、回退成功后的错误消息

      var hint_mesg = data.origin === 'ncc-server' && resMessage.type === 'saga_hint'; // 重试或者回退成功的消息提示

      if (hint_mesg) {
        if (!resMessage.error) {
          Object(index_["clearToast"])('socketErrorToast'); // 清理一进入页面就提示处理的哪个问题
        }
      } // 消息和交互分開


      if (billSagaErrorMesg || hintErrorMesg) {
        //调用业务组注册的回调
        if (typeof onMessage === 'function') {
          // 错误中心，重试或者回退成功的提示，无法获取到，因为重试或者回退成功，龙哥给的tabid不对(始终是第一次重试的tabid)
          onMessage(Socket_create_objectSpread(Socket_create_objectSpread({}, _this4.props), _this4.output), resMessage);
        }

        if (typeof window.top.onSocketMessage === 'function') {
          window.top.onSocketMessage(resMessage);
        } //标准交互只监听来源为 ncc-server 且 错误类型为 saga_error 的消息


        if (!saga_mesg) return; // 更新界面时，先对比pk是否相同，相同时，在更新组件数据  已确认全领域 pk 唯一
        //1------------------更新列表 ----------------------//
        //更新表格状态

        if (tableAreaCode) {
          if (tableType === 'simpleTable') {
            tableType = 'table';
          } // 更新表格数据
          // 存在问题：连续调用多次，表格只更新一次， state更新问题
          // 根据billpk gtxid累加数据 更新时 累加数据一次更新


          _this4.refreshTableData[_this4.billpk || tableAreaCode] = resMessage.refreshData;

          if (!resMessage.refreshData) {
            // 有一些节点不传refreshData （财务杨龙  会计平台  平台日志）
            return;
          }

          var refreshData = _this4.mergeTableData();

          pageInstance[tableType].updateDataByRefresh(tableAreaCode, billpkname, refreshData, resMessage.msg);
        } //2-------------------更新卡片-----------------------//


        if (Array.isArray(resMessage.refreshData)) {
          var oldBillPk = pageInstance.form.getFormItemsValue(formAreaCode, billpkname);
          oldBillPk = oldBillPk && oldBillPk.value; // 当前页面billpk

          var _refreshData = resMessage.refreshData[0];

          if (resMessage.refreshData.length > 1) {
            _refreshData = resMessage.refreshData.find(function (e) {
              return e[billpkname] && e[billpkname] == oldBillPk || e['_businessPk'] == oldBillPk;
            });
          }

          var billpk = _refreshData && (_refreshData[billpkname] || _refreshData['_businessPk']); // 返回数据中的billpk

          console.log('billpk:', billpk, 'oldBillPk', oldBillPk); //更新标题区按钮状态 

          if (headBtnAreaCode && billpk == oldBillPk) {
            pageInstance.button.toggleErrorStatus(headBtnAreaCode, {
              isError: resMessage.error
            });
          } //更新卡片表头数据


          if (formAreaCode) {
            pageInstance.form.updateDataByRefresh(formAreaCode, _refreshData, billpkname, dataSource, resMessage.msg);
          }
        } // 更新缓存
        // let newData = resMessage.refreshData && (resMessage.refreshData[0] || {});
        // dataSource && formAreaCode && updateHeadCache(dataSource, newData[billpkname], formAreaCode, newData);
        // 特殊场景处理，一次返回多条数据的情况 --修复黄开高问题，待验证


        var newData = resMessage.refreshData || [];
        dataSource && formAreaCode && newUpdateHeadCache(dataSource, billpkname, formAreaCode, newData);
      }
    };

    _this4.randomNumber = function () {
      var now = new Date();
      var month = now.getMonth() + 1;
      var day = now.getDate();
      var hour = now.getHours();
      var minutes = now.getMinutes();
      var seconds = now.getSeconds();
      return now.getFullYear().toString() + month.toString() + day + hour + minutes + seconds + Math.round(Object(index_["getSafeRandom"])() * 23 + 100).toString();
    };

    typeof _this4.props.getThis === 'function' && _this4.props.getThis(Socket_create_assertThisInitialized(_this4));
    _this4.state = {
      showBillTrack: false,
      json: {},
      LangData: null
    };
    _this4.gtxid = '';
    _this4.billpk = '';
    _this4.billtype = _this4.props.config.billtype; //修改表格连续多次更新，只有最后一次更新有效问题

    _this4.refreshTableData = {}; // 页面连接标识，用户接收消息时，判断是不是该连接

    _this4.tabid = ''; // 生成唯一id   解决当前图标因为id唯一导致的不能多次渲染的问题

    _this4.cuuid = create_uuidv4(); // 全局通信器

    top.SocketMessageFun = top.SocketMessageFun || {};
    top.SocketMessageFun[_this4.cuuid] = _this4.handleMessage;
    return _this4;
  }

  Socket_create_createClass(Socket, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this5 = this;

      var callback = function callback(json, bool, LangData) {
        _this5.setState({
          json: json,
          LangData: LangData
        });

        _this5.viewTitleLang = json['page-socket-0001'];
        _this5.viewBtnLang = json['page-socket-0002'];
      };

      Object(index_["getMultiLang"])({
        moduleId: 'page_socket',
        callback: callback
      });
    }
  }, {
    key: "componentDidMount",
    value: function componentDidMount() {
      // 信息初始化到page上 给其他组件跨使用
      var _this$props = this.props,
          pageInstance = _this$props.pageInstance,
          config = _this$props.config;
      var _config$isShowToast2 = config.isShowToast,
          isShowToast = _config$isShowToast2 === void 0 ? true : _config$isShowToast2,
          tableAreaCode = config.tableAreaCode,
          billpkname = config.billpkname,
          formAreaCode = config.formAreaCode,
          billtype = config.billtype,
          billtypeFromList = config.billtypeFromList,
          errorViewType = config.errorViewType,
          dataSource = config.dataSource,
          extraInfos = config.extraInfos; // toast 比较特殊  单独一个参数

      top.isShowToast = top.isShowToast || {};
      top.isShowToast[this.cuuid] = isShowToast;
      var oldBillInfo = create_getData(create_nameSpace) || {};

      var nativeSocketBillInfo = Socket_create_objectSpread(Socket_create_objectSpread({}, oldBillInfo), {}, {
        billpkname: billpkname,
        billtype: billtype,
        errorViewType: errorViewType,
        dataSource: dataSource,
        extraInfos: extraInfos,
        billtypeFromList: billtypeFromList
      });

      console.log('websocket 初始化参数:', config);

      if (tableAreaCode) {
        // 列表
        nativeSocketBillInfo.tableAreaCode = tableAreaCode;
      }

      if (formAreaCode) {
        //卡片
        nativeSocketBillInfo.formAreaCode = formAreaCode;
      }

      setData(create_nameSpace, nativeSocketBillInfo); // tabid 给消息交互做页签标识  当前页签的才产生交互

      if (!this.tabid) {
        this.tabid = top && top.WebSocketTabid ? top.WebSocketTabid : this.randomNumber(); // 挂载下 给ajax 使用

        window.WebSocketTabid = this.tabid;
        top.WebSocketTabid = this.tabid; // 将tabid 放置全局缓存，重试、回退使用
        //this.addTabid();
      }

      console.log('当前页签的tabid为:', window.WebSocketTabid); //关闭当前页签

      window.addEventListener('beforeunload', this.handleBeforeUnLoad);
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      // 销毁之后删除tabid
      //this.removeTabid();
      top.SocketMessageFun[this.cuuid] = null;
      delete top.SocketMessageFun[this.cuuid];
      this.props.pageInstance.mySocket = null;
      window.removeEventListener('beforeunload', this.handleBeforeUnLoad);
    } //打开页签，将页签id存localStorage

  }, {
    key: "render",
    value: function render() {
      var _this6 = this;

      var config = this.props.config;
      var billtype = config.billtype,
          _config$errorViewType2 = config.errorViewType,
          errorViewType = _config$errorViewType2 === void 0 ? true : _config$errorViewType2;
      return errorViewType === 'none' ? null : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["BillErrorTrack"], {
        show: this.state.showBillTrack,
        close: function close() {
          _this6.setState({
            showBillTrack: false
          });
        },
        pk: this.billpk //单据id
        ,
        type: this.billtype || billtype //单据类型
        ,
        gtxid: this.gtxid //错误id
        ,
        errorViewType: errorViewType,
        fromToastTip: true
      });
    }
  }]);

  return Socket;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);
// CONCATENATED MODULE: ./src/platform/components/Socket/index.js

/* harmony default export */ var components_Socket = ({
  connectMesg: connectMesg,
  showToast: showToast
});
// EXTERNAL MODULE: external "@platform/template/index"
var template_index_ = __webpack_require__(12);

// EXTERNAL MODULE: external "@platform/form/index"
var form_index_ = __webpack_require__(24);
var form_index_default = /*#__PURE__*/__webpack_require__.n(form_index_);

// CONCATENATED MODULE: ./src/platform/components/Tree/util.js
function util_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function util_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { util_ownKeys(Object(source), true).forEach(function (key) { util_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { util_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function util_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function util_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = util_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function util_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }


var PID = '__root__';
var parentPk = null;
/* 根据key获取子树 */

function getItem(treeData, key) {
  if (!key) {
    return treeData;
  }

  var length = treeData.length;

  for (var i = 0; i < length; i++) {
    var item = treeData[i];

    if (item.key == key || item.refpk == key) {
      return item;
    } else if (Array.isArray(item.children)) {
      var res = getItem(item.children, key);

      if (res) {
        return res;
      }
    }
  }
}
;
/** 将树拉平为数据 */

function treeToList(treeData) {
  var list = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  if (Array.isArray(treeData)) {
    treeData.forEach(function (e) {
      // 获取除 children 外的其他属性，并且放进list数组
      var children = e.children,
          others = util_objectWithoutProperties(e, ["children"]);

      list.push(util_objectSpread({}, others));

      if (Array.isArray(e.children)) {
        treeToList(e.children, list);
      }
    }); // 返回list集合

    return list;
  } else {
    return false;
  }
}
/**获取所有主键*/

function getAllTreeKeys(treeData) {
  var list = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  if (Array.isArray(treeData)) {
    treeData.forEach(function (e) {
      // 获取除 children 外的其他属性，并且放进list数组
      var refpk = e.refpk,
          key = e.key,
          id = e.id;
      var pk = refpk || key || id;
      list.push(pk);

      if (Array.isArray(e.children)) {
        getAllTreeKeys(e.children, list);
      }
    }); // 返回list集合

    return list;
  } else {
    return false;
  }
}
/** 添加isleaf标识 ？？？？？*/
/// 外部未引用

function addIsLeaf(data) {
  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      resetIcon = _ref.resetIcon;

  (data || []).forEach(function (item) {
    // 不应该一股脑
    var ib = item.iconBox || {}; // 需求要求的是取  默认true

    item.iconBox = resetIcon === false ? ib : util_objectSpread({
      addIcon: true,
      delIcon: true,
      editIcon: true
    }, ib);

    if (!item.hasOwnProperty('isleaf')) {
      if (Array.isArray(item.children) && item.children.length) {
        item.isleaf = false;
        addIsLeaf(item.children);
      } else {
        item.isleaf = true;
      }
    }
  });
}
function addNodeFun(treeData, child, isBefore) {
  if (!child.pid) {
    treeData.push(child);
    return;
  }

  var loop = function loop(data) {
    data.forEach(function (item) {
      if (item.refpk === child.pid) {
        if (Array.isArray(item.children)) {
          if (isBefore) {
            item.children.unshift(child);
          } else {
            item.children.push(child);
          }
        } else {
          item.children = [child];
        }

        item.isleaf = false;
        item.isLeaf = false;
        return true;
      } else if (Array.isArray(item.children)) {
        var res = loop(item.children);

        if (res) {
          return false;
        }
      }
    });
  };

  loop(treeData);
} //外部未引用
//  获取符合查询关键字的节点的父节点

function getParentKey(key, tree) {
  var parentKey;

  for (var i = 0; i < tree.length; i++) {
    var node = tree[i];

    if (node.children) {
      if (node.children.some(function (item) {
        return (item.key || item.id) === key;
      })) {
        parentKey = node.key || node.id;
      } else if (getParentKey(key, node.children)) {
        parentKey = getParentKey(key, node.children);
      }
    }
  }

  return parentKey;
}
; //外部未引用
//  获取符合查询关键字的节点的父节点

function getAllParentKey(key, tree) {
  var parentKeys = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
  var parentKey;

  while (parentKey = getParentKey(key, tree)) {
    parentKeys.push(parentKey);
    key = parentKey;
  }

  return parentKeys;
}
;
function moveNodeEve(tree, node, targetpk) {
  var i = tree.length;

  while (i--) {
    var data = tree[i];

    if (data.refpk === targetpk) {
      if (Array.isArray(data.children)) {
        data.children.push(node);
      } else {
        data.children = [node];
      }

      return true;
    } else {
      if (Array.isArray(data.children)) {
        var res = moveNodeEve(data.children, node, targetpk);

        if (res) {
          return false;
        }
      }
    }
  }
}
function setLeafEdit(data, status) {
  data.forEach(function (item) {
    if (item.isleaf) {
      item.iconBox = {
        addIcon: status,
        delIcon: status,
        editIcon: status
      };
    } else if (Array.isArray(item.children)) {
      setLeafEdit(item.children, status);
    }
  });
}
function hideIconEve(tree, key, iconObj) {
  var i = tree.length;

  while (i--) {
    var data = tree[i];

    if (data.key === key) {
      data.iconBox = Object.assign(data.iconBox || {}, iconObj);
      return true;
    } else {
      if (Array.isArray(data.children)) {
        var res = hideIconEve(data.children, key, iconObj);

        if (res) {
          return false;
        }
      }
    }
  }
}
function addBrotherFun(treeData, child) {
  if (!child.pid) {
    treeData.push(child);
    return;
  }

  var loop = function loop(data) {
    var len = data.length;

    for (var i = 0; i < len; i++) {
      var item = data[i];

      if (item.pid === child.pid) {
        data.push(child);
        return true;
      } else if (Array.isArray(item.children)) {
        var res = loop(item.children);

        if (res) {
          return false;
        }
      }
    }
  };

  loop(treeData);
}
function editNodeFun(treeData, child) {
  if (!child.refpk) {
    console.error('树，编辑节点方法，传参错误，没找到refpk');
    return false;
  }

  var list = treeToList(treeData),
      old = list.find(function (e) {
    return e.refpk === child.refpk;
  });
  old && Object.assign(old, child);
  return createTreeData(list);
}
function util_delNode(tree, key) {
  var parentNode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
  if (!tree) return;
  var i = tree.length;

  while (i--) {
    var data = tree[i];

    if (data.refpk === key) {
      parentNode.parentPk = data.pid;
      tree.splice(i, 1);
      return true;
    } else {
      if (Array.isArray(data.children)) {
        var res = util_delNode(data.children, key);

        if (res) {
          return false;
        }
      }
    }
  }
}
function addIconBox(data) {
  if (data && data instanceof Array && data.length > 0) {
    data.forEach(function (item) {
      var ib = item.iconBox || {};
      item.iconBox = util_objectSpread({
        addIcon: true,
        delIcon: true,
        editIcon: true
      }, ib);

      if (Array.isArray(item.children)) {
        addIconBox(item.children);
      }
    });
  }
}
function setNodeDisableEve(treeData, disable, pk) {
  var findYou = false;
  var len = treeData.length;

  for (var i = 0; i < len; i++) {
    var item = treeData[i];

    if (pk) {
      if (item.refpk === pk) {
        treeData[i].disabled = disable;
        findYou = true;
        return;
      }
    } else {
      treeData[i].disabled = disable;
    }

    if (Array.isArray(item.children)) {
      setNodeDisableEve(item.children, disable, pk);

      if (findYou) {
        return false;
      }
    }
  }
}
function checkHasChildren(tree, pk) {
  var i = tree.length;

  while (i--) {
    var data = tree[i];

    if (data.refpk === pk) {
      if (Array.isArray(data.children) && data.children.length === 0) {
        delete data.children;
        data.isleaf = true;
      }

      return true;
    } else {
      if (Array.isArray(data.children)) {
        var res = checkHasChildren(data.children, pk);

        if (res) {
          return false;
        }
      }
    }
  }
}
function createTreeData(data) {
  var _ref2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      resetIcon = _ref2.resetIcon;

  if (!Object(index_["isArray"])(data)) {
    console.warn('createTreeData方法，参数应该为数组');
    return false;
  } // 创建Map集合


  var group = new Map();
  data.forEach(function (e) {
    // 如果没有pid的节点标记为 __root__ 祖节点
    e.pid = e.pid || PID; // 处理查询区树没有key的问题

    e.key || (e.key = e.refpk); // 把相同pid的节点放在一起 结构：以pid为键 以相同pid节点组成的数组为值

    group.get(e.pid) ? group.get(e.pid).push(e) : group.set(e.pid, [e]);
  });

  function makeDOM(pid) {
    // 如果map 里面 pid 有值，就给每个节点追加children属性
    if (group.get(pid)) {
      // 返回的是map生成的数组,数组成员是e
      return group.get(pid).map(function (e) {
        // 处理查询区树没有key的问题
        e.key || (e.key = e.refpk);
        e.children = makeDOM(e.refpk);
        return e;
      });
    } else {
      return null;
    }
  }

  var newData = makeDOM(PID);
  addIsLeaf(newData, {
    resetIcon: resetIcon
  });
  return newData;
}
// CONCATENATED MODULE: ./src/platform/components/Tree/store.js
function store_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { store_typeof = function _typeof(obj) { return typeof obj; }; } else { store_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return store_typeof(obj); }

function store_createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = store_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function store_toConsumableArray(arr) { return store_arrayWithoutHoles(arr) || store_iterableToArray(arr) || store_unsupportedIterableToArray(arr) || store_nonIterableSpread(); }

function store_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function store_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return store_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return store_arrayLikeToArray(o, minLen); }

function store_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function store_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return store_arrayLikeToArray(arr); }

function store_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function store_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function store_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function store_createClass(Constructor, protoProps, staticProps) { if (protoProps) store_defineProperties(Constructor.prototype, protoProps); if (staticProps) store_defineProperties(Constructor, staticProps); return Constructor; }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = store_getPrototypeOf(object); if (object === null) break; } return object; }

function store_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) store_setPrototypeOf(subClass, superClass); }

function store_setPrototypeOf(o, p) { store_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return store_setPrototypeOf(o, p); }

function store_createSuper(Derived) { var hasNativeReflectConstruct = store_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = store_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = store_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return store_possibleConstructorReturn(this, result); }; }

function store_possibleConstructorReturn(self, call) { if (call && (store_typeof(call) === "object" || typeof call === "function")) { return call; } return store_assertThisInitialized(self); }

function store_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function store_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function store_getPrototypeOf(o) { store_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return store_getPrototypeOf(o); }





var store_parentPk = null;

var store_Store = /*#__PURE__*/function (_BaseStore) {
  store_inherits(Store, _BaseStore);

  var _super = store_createSuper(Store);

  function Store(props) {
    var _this;

    store_classCallCheck(this, Store);

    _this = _super.call(this, props);
    _this.store = {
      formStore: null,
      //state 修改会影响视图
      searchValue: '',
      //搜索框录入值
      // 树组件属性
      focusable: true,
      //是否开启快捷键功能，使用Tab 键导航获取焦点↓↑选中下、上一个节点，→←展开或者收起一个节点,enter键为节点双击事件
      selectedKeys: [],
      // 设置选中的树节点 selectedKeys
      expandedKeys: [],
      //展开指定的树节点
      autoExpandParent: true,
      //是否自动展开父节点
      checkedKeys: [],
      //选中复选框的树节点:父子节点有关联，如果传入父节点 key，则子节点自动选中；相应当子节点 key 都传入，父节点也自动选中。当设置checkable和checkStrictly，它是一个有checked和halfChecked属性的对象，并且父子节点的选中与否不再关联
      treeData: [],
      //表格数据
      firstTime: false,
      //触发dataList计算
      needEdit: true,
      noDisableId: '',
      //addNodeName: '', //新增节点名
      disabledSearch: false,
      showEditModal: false
    };
    _this.cache = {
      deepData: [],
      //搜索前暂存数据
      saveExpandedKeys: [],
      //搜索前暂存展开状态
      saveCheckedKeys: [],
      //搜索前暂存复选框选中状态
      currentNode: null,
      //记录当前编辑行
      moveKey: '',
      //记录拖拽节点key
      isHover: '',
      //记录鼠标hover节点key
      selectedNode: null,
      //记录选中子树
      userControlIcon: false,
      //业务组控制图标按钮是否显示
      showModal: true,
      metaId: '',
      //记录业务传的表单metaId
      treeNodeOperation: '',
      searchType: 'location',
      treeType: "syncTree",
      noCheckWhenSelect: false //当选中文本时不勾选

    };
    _this.listeners = {// onTreeStatusChange,
      // selectedForInit,
      // onSelectEve,
      // onSelectedChange,
      // clickAddIconEve,
      // clickEditIconEve,
      // clickDelIconEve,
    };

    _this.getListener = function (listener) {
      return _this.listeners[listener];
    };

    _this.setListener = function (listener, func) {
      _this.listeners[listener] = func;
    };

    _this.setStateEve = function () {
      _this.forceUpdate();
    };

    _this.handleExpand = function (value, expandedKeys) {
      // let uniqueExpandedKeys = [];
      // expandedKeys.forEach(item => {
      //     if (item && uniqueExpandedKeys.indexOf(item) === -1) {
      //         uniqueExpandedKeys.push(item);
      //     }
      // });
      var uniqueExpandedKeys = store_toConsumableArray(new Set(expandedKeys));

      _this.setStore("expandedKeys", uniqueExpandedKeys);

      _this.setStore("searchValue", value);

      _this.setStore("autoExpandParent", true);

      if ((!value || value == '') && value !== '0') {
        _this.setStore("expandedKeys", _this.getCache('saveExpandedKeys'));
      }
    };

    _this.setNodeChecked = function (pk) {
      if (Object(index_["isArray"])(pk)) {
        _this.setStore('checkedKeys', pk);

        _this.setCache('saveCheckedKeys', pk);
      } else if (Object(index_["isString"])(pk)) {
        _this.setStore('checkedKeys', [pk]);

        _this.setCache('saveCheckedKeys', [pk]);
      } else {
        console.error('setNodeChecked方法传参格式不正确，第二个参数应该是数组或字符串');
        return false;
      }

      _this.setStateEve();
    };

    _this.delNodeSuceess = function (pk) {
      var noneChangeLeaf = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var parentNode = {};

      if (typeof pk === 'undefined') {
        console.error('delNodeSuceess方法第二个参数不能为空');
        return false;
      }

      var treeData = _this.getStore('treeData');

      util_delNode(treeData, pk, parentNode);

      var treeType = _this.getCache('treeType');

      if (treeType === "syncTree") {
        var deepData = _this.getCache('deepData'); // 删除备份的节点


        util_delNode(deepData, pk, parentNode);
      }

      _this.setCache('selectedNode', null);

      if (!noneChangeLeaf) {
        checkHasChildren(treeData, parentNode.parentPk);
      }

      _this.setStore('treeData', store_toConsumableArray(treeData));

      _this.setStore('showEditModal', false);

      _this.setStateEve();
    };

    _this.editNodeSuccess = function (newItem) {
      var treeData = _this.getStore('treeData');

      var treeType = _this.getCache('treeType');

      var deepData = [];

      if (treeType === "syncTree") {
        deepData = _this.getCache('deepData');
      }

      if (Object(index_["isArray"])(newItem)) {
        newItem.forEach(function (item) {
          if (treeData.length != 0) {
            var newTreeData = editNodeFun(treeData, item);

            _this.setStore('treeData', store_toConsumableArray(newTreeData));

            treeData = store_toConsumableArray(newTreeData);
          }

          if (treeType === "syncTree") {
            var newDeepData = editNodeFun(deepData, item);

            _this.setCache('deepData', newDeepData);

            deepData = newDeepData;
          }
        }); // TODO: 异步树没有这个逻辑
      } else {
        if (treeData.length != 0) {
          var newTreeData = editNodeFun(treeData, newItem);

          _this.setStore('treeData', store_toConsumableArray(newTreeData));
        }

        if (treeType === "syncTree") {
          var newDeepData = editNodeFun(deepData, newItem);

          _this.setCache('deepData', newDeepData);
        }
      }

      _this.setStateEve();
    };

    _this.closeNodeByPk = function (key) {
      var expandedKeys = _this.getStore('expandedKeys');

      if (key || key == 0) {
        if (Object(index_["isArray"])(key)) {
          key.forEach(function (item) {
            expandedKeys.splice(expandedKeys.indexOf(item), 1);
          });
        } else if (Object(index_["isString"])(key)) {
          if (expandedKeys.indexOf(key) !== -1) {
            expandedKeys.splice(expandedKeys.indexOf(key), 1);
          }
        }
      } else {
        expandedKeys = [];
      }

      _this.setStore('expandedKeys', expandedKeys);

      _this.setStateEve();
    };

    _this.hideIcon = function (key, data) {
      if (!Object(index_["isObj"])(data)) {
        console.warn('同步组件hideIcon方法，第三个参数应为对象，数据格式参考同步树API文档');
        return false;
      }

      var treeData = _this.getStore('treeData');

      hideIconEve(treeData, key, data);

      _this.setStateEve();
    };

    _this.addBrotherNode = function (data) {
      var treeData = _this.getStore('treeData');

      var userControlIcon = _this.getCache('userControlIcon');

      if (Object(index_["isArray"])(data)) {
        !userControlIcon && addIconBox(data);
        data.forEach(function (item) {
          return addBrotherFun(treeData, item);
        });
      } else {
        !userControlIcon && addIconBox([data]);
        addBrotherFun(treeData, data);
      }

      _this.setStore('firstTime', true); //新增节点成功时，需要重新分割当前树，用于查询定位树节点


      _this.setStore('treeData', store_toConsumableArray(treeData));

      _this.setStateEve();
    };

    _this.setNodeSelected = function (pk) {
      var treeData = _this.getStore('treeData');

      if (Object(index_["isArray"])(pk)) {
        _this.setStore('selectedKeys', pk);
      } else if (Object(index_["isString"])(pk)) {
        _this.setStore('selectedKeys', [pk]);

        _this.setCache('selectedNode', getItem(treeData, pk));
      } else {
        console.error('setNodeSelected方法传参格式不正确，第二个参数应该是数组或字符串');
        return false;
      }

      _this.setStateEve();
    };

    _this.cancelSelectedNode = function () {
      _this.setStore('selectedKeys', []);

      _this.setCache('selectedNode', null);

      _this.setStateEve();
    };

    _this.searchChange = function (value) {
      var deepData = _this.getCache('deepData');

      var treeData = _this.getStore('treeData');

      var searchType = _this.getCache('searchType');

      var dataList = _this.getCache('dataList'); // let expandedKeys = [dataList[0].key];


      var expandedKeys = [];

      var ySrc = store_toConsumableArray(deepData);

      if (searchType === 'filtration') {
        // 这里还有有一个神坑的 deepData 中不一定拥有树所有状态的数据 treeData
        // TODO deepData 与 treeData 数据状态的同步  主要包括 item内的设置项的同步 by bbqin 
        // need fixed 王洋
        var res = _this.filterTree(value, ySrc); //   let newDataKeys = res.parentKeys;


        dataList.forEach(function (item) {
          if (_this.strToLocaleLowerCase(item.title).indexOf(_this.strToLocaleLowerCase(value)) > -1) {
            expandedKeys.push(item.key);
          }
        });

        if (res.stack && res.stack.length > 0) {
          //data = res.stack;
          _this.setStore('treeData', res.stack);
        } else {
          res.stack = []; //data = [];

          _this.setStore('treeData', []);
        }

        var list = treeToList(res.stack);
        list.map(function (item) {
          expandedKeys.push(item.refpk);
        });

        _this.handleExpand(value, expandedKeys, ySrc);

        if ((!value || value == '') && value !== '0') {
          _this.setStore("expandedKeys", _this.getCache('saveExpandedKeys'));

          _this.setStore("selectedKeys", _this.getCache("saveCheckedKeys")); //data = ySrc;


          _this.setStore('treeData', ySrc);
        }
      } else {
        expandedKeys = _this.getStore('expandedKeys');
        dataList.forEach(function (item) {
          if (_this.strToLocaleLowerCase(item.title).indexOf(_this.strToLocaleLowerCase(value)) > -1) {
            expandedKeys = expandedKeys.concat(getAllParentKey(item.key || item.id, treeData));
          }
        });
        expandedKeys = store_toConsumableArray(new Set(expandedKeys));

        _this.handleExpand(value, expandedKeys);
      }

      _this.setStateEve();
    };

    _this.filterTree = function (value, treeData) {
      var overWriteFilterTree = _this.getListener('overWriteFilterTree');

      var selectedKeys = _this.getStore('selectedKeys');

      var res = [],
          keys = [];

      if (Object(index_["isFunction"])(overWriteFilterTree)) {
        var overWriteTreeData = overWriteFilterTree(value, treeData);
        var overWriteList = treeToList(overWriteTreeData);

        var _isHasSelectedValue = overWriteList.some(function (node) {
          if (node) {
            return node.key === selectedKeys[0];
          }
        });

        res = createTreeData(overWriteList);
        return {
          stack: res,
          parentKeys: [].concat(keys),
          isHasSelectedValue: _isHasSelectedValue
        };
      } // 拍平数据


      var list = treeToList(treeData); // 过滤出带有关键字的节点

      var filterNodes = list.filter(function (v) {
        var beforeName = v.beforeName ? v.beforeName : '';
        var afterName = v.afterName ? v.afterName : '';
        var name = v.refname ? v.refname : ''; // 如果beforeName afterName 是字符串参与搜索

        if (typeof beforeName === 'string') {
          name = beforeName + name;
        }

        if (typeof afterName === 'string') {
          name = name + afterName;
        }

        name = name.toLocaleLowerCase();
        value = value.toLocaleLowerCase();
        return name.includes(value);
      }); //........ 筛选出所有相关节点

      var nodesMap = new Map();

      var findAllParents = function findAllParents(child) {
        // 递归优化处理，已经走过的路径不再做递归操作
        if (nodesMap.has(child.refpk)) return; // 存入路径相关的树节点

        nodesMap.set(child.refpk, child);
        list.map(function (node) {
          // 如果当前节点child 有父节点  把当且节点父节点放进nodesMap集合
          if (child.pid === node.refpk) {
            findAllParents(node);
          } else {
            // 出口
            return true;
          }
        });
      }; // 递归函数入口


      filterNodes.map(function (node) {
        // 每一个含有搜索关键字的节点都会成为递归函数的入口
        findAllParents(node);
      }); // Map结构转换为map结构

      var finalLists = [];

      var _iterator = store_createForOfIteratorHelper(nodesMap.values()),
          _step;

      try {
        for (_iterator.s(); !(_step = _iterator.n()).done;) {
          var node = _step.value;
          finalLists.push(node);
        }
      } catch (err) {
        _iterator.e(err);
      } finally {
        _iterator.f();
      }

      var isHasSelectedValue = finalLists.some(function (node) {
        if (node) {
          return node.key === selectedKeys[0];
        }
      }); // 判断当前筛选数据是否有被选择的节点
      // 进行树结构重组处理

      res = createTreeData(finalLists, {
        resetIcon: false
      });
      return {
        stack: res,
        parentKeys: [].concat(keys),
        isHasSelectedValue: isHasSelectedValue
      };
    };

    _this.strToLocaleLowerCase = function (str) {
      return Object.prototype.toString.call(str) === '[object String]' ? str.toLocaleLowerCase() : String(str).toLocaleLowerCase();
    };

    _this.getHooks = function () {
      return {
        getCache: _this.getCache.bind(store_assertThisInitialized(_this)),
        setCache: _this.setCache.bind(store_assertThisInitialized(_this)),
        handleExpand: _this.handleExpand.bind(store_assertThisInitialized(_this)),
        setStateEve: _this.setStateEve.bind(store_assertThisInitialized(_this)),
        setStore: _this.setStore.bind(store_assertThisInitialized(_this)),
        getStore: _this.getStore.bind(store_assertThisInitialized(_this)),
        getListener: _this.getListener.bind(store_assertThisInitialized(_this)),
        setListener: _this.setListener.bind(store_assertThisInitialized(_this)),
        setNodeChecked: _this.setNodeChecked.bind(store_assertThisInitialized(_this)),
        delNodeSuceess: _this.delNodeSuceess.bind(store_assertThisInitialized(_this)),
        editNodeSuccess: _this.editNodeSuccess.bind(store_assertThisInitialized(_this)),
        closeNodeByPk: _this.closeNodeByPk.bind(store_assertThisInitialized(_this)),
        hideIcon: _this.hideIcon.bind(store_assertThisInitialized(_this)),
        addBrotherNode: _this.addBrotherNode.bind(store_assertThisInitialized(_this)),
        setNodeSelected: _this.setNodeSelected.bind(store_assertThisInitialized(_this)),
        cancelSelectedNode: _this.cancelSelectedNode.bind(store_assertThisInitialized(_this)),
        searchChange: _this.searchChange.bind(store_assertThisInitialized(_this)),
        filterTree: _this.filterTree.bind(store_assertThisInitialized(_this)),
        strToLocaleLowerCase: _this.strToLocaleLowerCase.bind(store_assertThisInitialized(_this))
      };
    };

    return _this;
  } // 影响视图更新的数据


  store_createClass(Store, [{
    key: "getStore",
    value: function getStore(paths) {
      return _get(store_getPrototypeOf(Store.prototype), "get", this).call(this, paths);
    }
  }, {
    key: "setStore",
    value: function setStore(paths, value) {
      var res = _get(store_getPrototypeOf(Store.prototype), "set", this).call(this, paths, value);

      return res;
    }
  }, {
    key: "getCache",
    value: function getCache(path) {
      return this.cache[path];
    }
  }, {
    key: "setCache",
    value: function setCache(path, value) {
      this.cache[path] = value;
    } // 搜索功能处理展开节点

  }]);

  return Store;
}(template_index_["BaseStore"]);

/* harmony default export */ var Tree_store = (Object(template_index_["hookFactory"])(store_Store));
// CONCATENATED MODULE: ./src/platform/components/Tree/Tree.js
function Tree_extends() { Tree_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return Tree_extends.apply(this, arguments); }

function Tree_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { Tree_typeof = function _typeof(obj) { return typeof obj; }; } else { Tree_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return Tree_typeof(obj); }

function Tree_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Tree_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Tree_ownKeys(Object(source), true).forEach(function (key) { Tree_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Tree_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Tree_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function Tree_toConsumableArray(arr) { return Tree_arrayWithoutHoles(arr) || Tree_iterableToArray(arr) || Tree_unsupportedIterableToArray(arr) || Tree_nonIterableSpread(); }

function Tree_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function Tree_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return Tree_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Tree_arrayLikeToArray(o, minLen); }

function Tree_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function Tree_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return Tree_arrayLikeToArray(arr); }

function Tree_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function Tree_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function Tree_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function Tree_createClass(Constructor, protoProps, staticProps) { if (protoProps) Tree_defineProperties(Constructor.prototype, protoProps); if (staticProps) Tree_defineProperties(Constructor, staticProps); return Constructor; }

function Tree_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) Tree_setPrototypeOf(subClass, superClass); }

function Tree_setPrototypeOf(o, p) { Tree_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return Tree_setPrototypeOf(o, p); }

function Tree_createSuper(Derived) { var hasNativeReflectConstruct = Tree_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = Tree_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = Tree_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return Tree_possibleConstructorReturn(this, result); }; }

function Tree_possibleConstructorReturn(self, call) { if (call && (Tree_typeof(call) === "object" || typeof call === "function")) { return call; } return Tree_assertThisInitialized(self); }

function Tree_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function Tree_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function Tree_getPrototypeOf(o) { Tree_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return Tree_getPrototypeOf(o); }

/*
 * 同步树组件
 */







var TreeNode = base_index_["Tree"].TreeNode;

var strToLocaleLowerCase = function strToLocaleLowerCase(str) {
  return Object.prototype.toString.call(str) === '[object String]' ? str.toLocaleLowerCase() : String(str).toLocaleLowerCase();
};

__webpack_require__(1906);

var Tree_SyncTree = /*#__PURE__*/function (_BaseComponent) {
  Tree_inherits(SyncTree, _BaseComponent);

  var _super = Tree_createSuper(SyncTree);

  function SyncTree(_props) {
    var _this;

    Tree_classCallCheck(this, SyncTree);

    _this = _super.call(this, _props);

    _this.transerDefaultConfigToStore = function (props) {
      _this.listeners = ['onTreeStatusChange', 'selectedForInit', 'onSelectEve', 'onSelectedChange', 'clickAddIconEve', 'clickEditIconEve', 'clickDelIconEve', 'loadTreeData', //异步树
      'overWriteFilterTree'];

      _this.listeners.forEach(function (item) {
        if (typeof props[item] !== 'undefined') {
          _this.props.store.setListener([item], props[item]);
        }
      });

      _this.lastData = []; //记录上次点击节点

      _this.dataList = []; //业务初始化数据 存store

      var store = _this.props.store;
      _this.cacheProps = ['showModal', 'userControlIcon', 'metaId', 'disabledSearch', 'searchType', 'noCheckWhenSelect'];

      _this.cacheProps.forEach(function (item) {
        if (typeof props[item] !== 'undefined') {
          store.setCache([item], props[item]);
        }
      });

      if (typeof props.needEdit !== 'undefined') {
        store.setStore('needEdit', props.needEdit);
      }
    };

    _this.getAllNodeKeys = function (data) {
      var allKeys = [];

      var getAllNodeKey = function getAllNodeKey(data) {
        data.forEach(function (item) {
          if (Array.isArray(item.children)) {
            allKeys.push(item.key);
            getAllNodeKey(item.children);
          }
        });
      };

      getAllNodeKey(data);
      return allKeys;
    };

    _this.generateList = function (data, dataList) {
      for (var i = 0; i < data.length; i++) {
        var node = data[i];
        var key = node.key || node.id;
        var beforeName = node.beforeName ? node.beforeName : '';
        var afterName = node.afterName ? node.afterName : '';
        var name = node.refname ? node.refname : '';

        if (typeof beforeName === 'string') {
          name = beforeName + name;
        }

        if (typeof afterName === 'string') {
          name = name + afterName;
        }

        dataList.push({
          key: key,
          title: name
        });

        if (node.children) {
          _this.generateList(node.children, dataList);
        }
      }
    };

    _this.handleClearState = function () {
      var store = _this.props.store;
      store.setStore('searchValue', '');
      store.setStore('expandedKeys', store.getCache('saveExpandedKeys'));
      store.setStore('treeData', store.getCache('deepData'));
    };

    _this.handleClearSearchVal = function () {
      var _this$props = _this.props,
          getSearchVal = _this$props.getSearchVal,
          clearSearchVal = _this$props.clearSearchVal,
          store = _this$props.store;

      if (_this.searchInputRef) {
        _this.searchInputRef.value = '';
      } // 处理清空状态


      _this.handleClearState();

      store.setStateEve();

      if (Object(index_["isFunction"])(clearSearchVal)) {
        clearSearchVal();
      }

      if (Object(index_["isFunction"])(getSearchVal)) {
        getSearchVal(store.getStore('searchValue'));
      }
    };

    _this.focusEve = function () {// let { store } = this.props;
      // let expandedKeys = store.getStore('expandedKeys');
      // let checkedKeys = store.getStore('checkedKeys');
      // if (store.getStore('treeData').length != store.getCache('deepData').length) return;
      // store.setCache('saveExpandedKeys', JSON.parse(JSON.stringify(expandedKeys)));
      // store.setCache('saveCheckedKeys', JSON.parse(JSON.stringify(checkedKeys)));
    };

    _this.onDoubleClickHandler = function (pk, node) {
      var onDoubleClickEve = _this.props.onDoubleClickEve;

      if (Object(index_["isFunction"])(onDoubleClickEve)) {
        onDoubleClickEve(pk, node);
      }

      _this.expandedRows(pk, node);
    };

    _this.expandedRows = function (pk, node) {
      var _this$props2 = _this.props,
          store = _this$props2.store,
          expandWhenDoubleClick = _this$props2.expandWhenDoubleClick;

      if (expandWhenDoubleClick) {
        return;
      }

      var expandedKeys = store.getStore('expandedKeys');
      var selectedItemKeys = node.node.props.refpk;
      var copy = JSON.parse(JSON.stringify(expandedKeys));

      if (copy.indexOf(selectedItemKeys) === -1) {
        copy.push(selectedItemKeys);
      } else {
        copy.map(function (v, i) {
          if (v === selectedItemKeys) copy.splice(i, 1);
        });
      }

      _this.onExpand(copy, node);
    };

    _this.onExpand = function (expandedKeys, info) {
      var _this$props3 = _this.props,
          store = _this$props3.store,
          onTreeExpand = _this$props3.onTreeExpand,
          treeType = _this$props3.treeType;
      store.setStore('expandedKeys', expandedKeys); //store.setStore('autoExpandParent', false);

      store.setStateEve();

      if (Object(index_["isFunction"])(onTreeExpand)) {
        onTreeExpand(expandedKeys, info);
      }
    };

    _this.onSelect = function (pk, node) {
      var _this$props4 = _this.props,
          onSelectCallBack = _this$props4.onSelectCallBack,
          onSelectAndChecked = _this$props4.onSelectAndChecked,
          onSelectedChange = _this$props4.onSelectedChange,
          onSelectEve = _this$props4.onSelectEve,
          onCheckEve = _this$props4.onCheckEve,
          store = _this$props4.store,
          treeType = _this$props4.treeType,
          pageOutput = _this$props4.pageOutput,
          triggerCheckWhenSelect = _this$props4.triggerCheckWhenSelect; //经营会计 王建卫  利润中心成本动因 公式编辑器

      if (Object(index_["isFunction"])(onSelectCallBack)) {
        onSelectCallBack(pk, node);
      }

      if (!node.selected) return;
      store.setStore('selectedKeys', pk);
      var checkedKeys = store.getStore('checkedKeys'); //------------TODO: 同步树逻辑，异步树没有
      //勾选节点操作，判断checkedKeys数组是否只有一个成员，如果有就勾选

      var noCheckWhenSelect = store.getCache('noCheckWhenSelect');

      if (checkedKeys.length < 2 && !noCheckWhenSelect) {
        checkedKeys = pk;
        store.setStore('checkedKeys', checkedKeys);
        var saveCheckedKeys = store.getCache("saveCheckedKeys");
        store.setCache("saveCheckedKeys", Tree_toConsumableArray(new Set([].concat(Tree_toConsumableArray(saveCheckedKeys), Tree_toConsumableArray(pk))))); //triggerCheckWhenSelect 设置选中时触发勾选回调

        if (triggerCheckWhenSelect) {
          var selectedNodes = node.selectedNodes,
              checkedNode = node.node;
          typeof onCheckEve === 'function' && onCheckEve(Tree_objectSpread(Tree_objectSpread({}, _this.props), pageOutput), checkedKeys, {
            checked: true,
            checkedNodes: selectedNodes,
            node: checkedNode,
            event: "check"
          });
        }

        if (onSelectAndChecked) {
          onSelectAndChecked(pk);
        }
      } //------------TODO: 同步树逻辑，异步树没有


      var treeData = store.getStore('treeData');

      var isChange = function isChange() {
        return _this.lastData[0] !== pk[0];
      };

      var item = getItem(treeData, pk[0]);

      if (isChange()) {
        if (onSelectedChange) {
          onSelectedChange(item);
        }
      }

      if (pk.length !== 0) {
        store.setCache('selectedNode', item);
      }

      if (typeof onSelectEve === 'function' && pk.length !== 0) {
        if (treeType === "syncTree") {
          onSelectEve(item.refpk, item, isChange(), node);
        } else {
          onSelectEve(pk, item, isChange(), node);
        }

        _this.lastData[0] = pk[0];
      }

      store.setStateEve();
    };

    _this.onLoadData = function (treeNode) {
      var loadTreeData = _this.props.loadTreeData;

      if (Object(index_["isFunction"])(loadTreeData)) {
        return new Promise(function (resolve) {
          loadTreeData(treeNode.props.eventKey, treeNode);
          resolve();
        });
      }
    };

    _this.onMouseLeave = function () {
      var store = _this.props.store;
      store.setCache("isHover", '');
    };

    _this.onMouseEnter = function (e) {
      var _this$props5 = _this.props,
          store = _this$props5.store,
          onMouseEnterEve = _this$props5.onMouseEnterEve;
      store.setCache("isHover", e.node.props.eventKey);

      if (onMouseEnterEve && typeof onMouseEnterEve === 'function') {
        /* iuap没给当前节点的所有数据，先自己获取，可能会有效率问题——wangshhj */
        onMouseEnterEve(e.node.props.eventKey, e.node.props);
      }
    };

    _this.onCheck = function (checkedKeys, _ref) {
      var checked = _ref.checked,
          checkedNodes = _ref.checkedNodes,
          node = _ref.node,
          event = _ref.event;
      var _this$props6 = _this.props,
          store = _this$props6.store,
          onCheckEve = _this$props6.onCheckEve,
          pageOutput = _this$props6.pageOutput;
      store.setStore("checkedKeys", checkedKeys);
      var saveCheckedKeys = store.getCache("saveCheckedKeys");
      var refpk = node.props.id || node.props.key || node.props.refpk;

      if (checked) {
        saveCheckedKeys = Tree_toConsumableArray(new Set([].concat(Tree_toConsumableArray(saveCheckedKeys), Tree_toConsumableArray(checkedKeys))));
      } else {
        var treeData = store.getStore('treeData');
        var allTreeKeys = getAllTreeKeys(treeData, []);
        var notRemoveKeys = saveCheckedKeys.filter(function (x) {
          return !allTreeKeys.includes(x);
        });
        saveCheckedKeys = Tree_toConsumableArray(new Set([].concat(Tree_toConsumableArray(checkedKeys), Tree_toConsumableArray(notRemoveKeys))));
      }

      store.setCache("saveCheckedKeys", saveCheckedKeys);
      typeof onCheckEve === 'function' && //TODO page参数
      onCheckEve(Tree_objectSpread(Tree_objectSpread({}, _this.props), pageOutput), checkedKeys, {
        checked: checked,
        checkedNodes: checkedNodes,
        node: node,
        event: event
      }, saveCheckedKeys);
      store.setStateEve();
    };

    _this.onDragOver = function (_ref2) {
      var event = _ref2.event;
      event.preventDefault();
      return false;
    };

    _this.onDragStart = function (_ref3) {
      var event = _ref3.event,
          node = _ref3.node;
      _this.dropped = false;
      var _this$props7 = _this.props,
          store = _this$props7.store,
          onDragStartEve = _this$props7.onDragStartEve;
      store.setCache("moveKey", node.props.eventKey);

      if (Object(index_["isFunction"])(onDragStartEve)) {
        onDragStartEve({
          event: event,
          node: node
        });
      }
    };

    _this.onDrop = function (info) {
      var store = _this.props.store;
      _this.dropped = true; // 如果正常拖动松手时，这个方法一定会执行，且在onDragEnd（如果也执行的话）之前执行。拖到外面时不执行。

      var dropKey = info.node.props.eventKey;
      var dragKey = info.dragNode.props.eventKey;

      var loop = function loop(data, key, callback) {
        data.forEach(function (item, index, arr) {
          if (item.key === key) {
            return callback(item, index, arr);
          }

          if (item.children) {
            return loop(item.children, key, callback);
          }
        });
      };

      var data = store.getStore('treeData');
      var dragObj;
      loop(data, dragKey, function (item, index, arr) {
        arr.splice(index, 1);
        dragObj = item;
      });

      if (info.dropToGap) {
        var ar;
        var i;
        loop(data, dropKey, function (item, index, arr) {
          ar = arr;
          i = index;
        });
        ar.splice(i, 0, dragObj);
      } else {
        loop(data, dropKey, function (item) {
          item.children = item.children || []; // where to insert 示例添加到尾部，可以是随意位置

          item.children.push(dragObj);
        });
      }

      store.setStore('treeData', data);
      store.setStateEve();
    };

    _this.onDragEnd = function () {
      if (!_this.dropped) {
        var store = _this.props.store;
        store.setStateEve();
      }
    };

    _this.getFloadIcon = function (item) {
      var _this$props8 = _this.props,
          store = _this$props8.store,
          _this$props8$hiddenDe = _this$props8.hiddenDefaultIcon,
          hiddenDefaultIcon = _this$props8$hiddenDe === void 0 ? false : _this$props8$hiddenDe;
      var expandedKeys = store.getStore('expandedKeys');
      var floadIcon = null;

      if (!hiddenDefaultIcon) {
        if (item.isleaf == false || item.children && item.children.length != 0) {
          floadIcon = expandedKeys.includes(item.refpk) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('icon iconfont  icon-wenjianjiadakai tree-wenjian', {
              'stop-node': item.iconBox && item.iconBox.stopUpIon === 'stop'
            })
          }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('icon iconfont  icon-wenjianjia tree-wenjian', {
              'stop-node': item.iconBox && item.iconBox.stopUpIon === 'stop'
            })
          });
        } else {
          floadIcon = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: classnames_default()('tree-dian', {
              'stop-node-dian': item.iconBox && item.iconBox.stopUpIon === 'stop'
            })
          });
        }
      }

      return floadIcon;
    };

    _this.getEditIcon = function (item) {
      var langJson = _this.state.langJson;
      var _this$props$nodeIconT = _this.props.nodeIconTooltips,
          nodeIconTooltips = _this$props$nodeIconT === void 0 ? {} : _this$props$nodeIconT;

      if (item && item.iconBox && item.iconBox.editIcon) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: nodeIconTooltips.edit || langJson['tree-node-icon-edit'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-bianji edit-icon",
          onClick: function onClick(e) {
            return item.disabled !== true && _this.editRender.call(Tree_assertThisInitialized(_this), item, e);
          }
        }));
      }

      return null;
    };

    _this.getAddIcon = function (item) {
      var langJson = _this.state.langJson;
      var _this$props$nodeIconT2 = _this.props.nodeIconTooltips,
          nodeIconTooltips = _this$props$nodeIconT2 === void 0 ? {} : _this$props$nodeIconT2;

      if (item && item.iconBox && item.iconBox.addIcon) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: nodeIconTooltips.add || langJson['tree-node-icon-add'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-zengjia add-icon",
          onClick: function onClick(e) {
            return item.disabled !== true && _this.addRender(item, e);
          }
        }));
      }

      return null;
    };

    _this.getDelIcon = function (item) {
      var langJson = _this.state.langJson;
      var _this$props$nodeIconT3 = _this.props.nodeIconTooltips,
          nodeIconTooltips = _this$props$nodeIconT3 === void 0 ? {} : _this$props$nodeIconT3;

      if (item && item.iconBox && item.iconBox.delIcon) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: nodeIconTooltips["delete"] || langJson['tree-node-icon-delete'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-shanchu delete-icon",
          onClick: function onClick(e) {
            return item.disabled !== true && _this.delRender.call(Tree_assertThisInitialized(_this), item, e);
          }
        }));
      }

      return null;
    };

    _this.getStopUpIcon = function (item) {
      var langJson = _this.state.langJson;
      var _this$props$nodeIconT4 = _this.props.nodeIconTooltips,
          nodeIconTooltips = _this$props$nodeIconT4 === void 0 ? {} : _this$props$nodeIconT4;

      if (item && item.iconBox && item.iconBox.stopUpIon) {
        return item.iconBox.stopUpIon === 'up' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: nodeIconTooltips.unlock || langJson['tree-node-icon-lock'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-shu_qiyong",
          onClick: function onClick(e) {
            item.disabled !== true && _this.handleStopAndUp(item, 'up', e);
          }
        })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          placement: "top",
          overlay: nodeIconTooltips.lock || langJson['tree-node-icon-unlock'],
          delayHide: 1,
          delayShow: 1000
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-shu_tingyong",
          onClick: function onClick(e) {
            item.disabled !== true && _this.handleStopAndUp(item, 'stop', e);
          }
        }));
      }

      return null;
    };

    _this.handleStopAndUp = function (item, type, e) {
      var _this$props9 = _this.props,
          clickStopIconEve = _this$props9.clickStopIconEve,
          clickUpIconEve = _this$props9.clickUpIconEve,
          store = _this$props9.store;
      e.stopPropagation(); //let getStopUpStatus = item.iconBox;

      switch (type) {
        case 'stop':
          if (Object(index_["isFunction"])(clickStopIconEve)) {
            clickStopIconEve(item);
          } // getStopUpStatus.stopUpIon = 'up';


          break;

        case 'up':
          if (Object(index_["isFunction"])(clickUpIconEve)) {
            clickUpIconEve(item);
          } //getStopUpStatus.stopUpIon = 'stop';


          break;
      }

      store.setStateEve();
    };

    _this.getRightIcon = function (item) {
      var nodeRightOpt = _this.props.nodeRightOpt;

      if (nodeRightOpt && item.isdrag) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "NC_iconBox node_right_opt",
          onClick: nodeRightOpt.callback
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
          type: nodeRightOpt.icon
        }));
      }

      return null;
    };

    _this.getTitleInfo = function (item, name, searchValue, index, nodeLevel, beforeName, afterName) {
      var _this$props10 = _this.props,
          store = _this$props10.store,
          _this$props10$tooltip = _this$props10.tooltipLevels,
          tooltipLevels = _this$props10$tooltip === void 0 ? [] : _this$props10$tooltip,
          tooltipField = _this$props10.tooltipField;
      var beforeStr = name.substr(0, index);
      var searchFromName = name.substr(index, searchValue.length);
      var afterStr = name.substr(index + searchValue.length);
      var titleInfo = null;

      if (index > -1) {
        titleInfo = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: classnames_default()('title-middle', {
            'stop-node-title': item.iconBox && item.iconBox.stopUpIon === 'stop'
          })
        }, beforeStr, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "u-tree-searchable-filter"
        }, searchFromName), afterStr);
      } else {
        titleInfo = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: classnames_default()('title-middle', {
            'stop-node-title': item.iconBox && item.iconBox.stopUpIon === 'stop'
          })
        }, beforeName && typeof beforeName === 'string' ? item.beforeName : '', item.refname, afterName && typeof afterName === 'string' ? item.afterName : '');
      } // 新需求: 节点根据设置的字段和层级显示 tooltip


      if (Array.isArray(tooltipLevels) && tooltipLevels.includes(nodeLevel) && tooltipField && item[tooltipField]) {
        titleInfo = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
          className: "tooltip-word-color",
          placement: "top",
          delayShow: 300,
          delay: 1,
          inverse: true,
          overlay: item[tooltipField]
        }, titleInfo);
      }

      return titleInfo;
    };

    _this.createCustomerTreeIcon = function (item) {
      var _this$props11 = _this.props,
          store = _this$props11.store,
          customizeIconClick = _this$props11.customizeIconClick;
      var treeData = store.getStore('treeData');
      var customerIcons = item.customerIcons;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "NC_iconBox"
      }, customerIcons.map(function (value, index) {
        if (typeof value === "string") {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            key: index,
            className: "icon iconfont icon-".concat(value, " customer-icon"),
            onClick: function onClick(e) {
              if (Object(index_["isFunction"])(customizeIconClick)) {
                customizeIconClick({
                  e: e,
                  iconType: value,
                  item: item,
                  treeData: treeData
                });
              }
            }
          });
        } else if (Tree_typeof(value) === "object") {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
            placement: "top",
            overlay: value.title,
            delayHide: 1,
            delayShow: 1000
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            key: index,
            className: "icon iconfont icon-".concat(value.icon, " customer-icon"),
            onClick: function onClick(e) {
              if (Object(index_["isFunction"])(customizeIconClick)) {
                customizeIconClick({
                  e: e,
                  iconType: value.icon,
                  item: item,
                  treeData: treeData
                });
              }
            }
          }));
        }
      }));
    };

    _this.renderTreeTitle = function (item, nodeLevel) {
      var _this$props12 = _this.props,
          store = _this$props12.store,
          treeType = _this$props12.treeType;
      var searchValue = store.getStore('searchValue');
      var noDisableId = store.getStore('noDisableId');
      var needEdit = store.getStore('needEdit');
      var editIcon, addIcon, delIcon, stopUpIon, rightIcon, iconBox;
      var beforeName = item.beforeName ? item.beforeName : '';
      var afterName = item.afterName ? item.afterName : '';
      var name = item.refname ? item.refname : '';

      if (typeof beforeName === 'string') {
        name = beforeName + name;
      }

      if (typeof afterName === 'string') {
        name = name + afterName;
      }

      var index = name.toLocaleLowerCase().indexOf(searchValue.toLocaleLowerCase());

      var floadIcon = _this.getFloadIcon(item);

      var titleInfo = null;

      if (treeType === 'asyncTree') {
        titleInfo = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "title-middle"
        }, item.refname);
      } else {
        titleInfo = _this.getTitleInfo(item, name, searchValue, index, nodeLevel, beforeName, afterName);
      } //  设置树的编辑性


      if (needEdit) {
        editIcon = _this.getEditIcon(item);
        addIcon = _this.getAddIcon(item);
        delIcon = _this.getDelIcon(item);
        stopUpIon = _this.getStopUpIcon(item);
      } //右侧Icon


      rightIcon = _this.getRightIcon(item);

      if (item.customerIcons && item.customerIcons.length > 0) {
        iconBox = _this.createCustomerTreeIcon(item);
      } else {
        if (treeType === 'asyncTree') {
          iconBox = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "NC_iconBox"
          }, editIcon, " ", addIcon, " ", delIcon);
        } else {
          iconBox = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "NC_iconBox"
          }, editIcon, " ", addIcon, " ", delIcon, " ", stopUpIon);
        }
      }

      if (treeType === 'asyncTree') {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: "title-con"
        }, floadIcon, beforeName, titleInfo, afterName, iconBox);
      }

      if (beforeName && typeof beforeName === 'string' || afterName && typeof afterName === 'string') {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: classnames_default()("title-con ".concat(item.className ? item.className : ''), {
            'active-nodisable': noDisableId === item.refpk,
            'title-con-disabled': item && item.disabled
          })
        }, floadIcon, titleInfo, iconBox, rightIcon);
      } else {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
          className: classnames_default()("title-con ".concat(item.className ? item.className : ''), {
            'active-nodisable': noDisableId === item.refpk,
            'title-con-disabled': item && item.disabled
          })
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "title-single"
        }, floadIcon, beforeName, titleInfo, afterName), iconBox, rightIcon);
      }
    };

    _this.getTreeNodesLazy = function (treeData) {
      //这里去tinper的treeData有bug  tinper给的treeData是上一次的bee-tree的state数据
      //传给tinper的treeData引用相同 数据未改变时 没有更新 因为tinper内部对比的引用
      // let { store } = this.props;
      // let treeData = store.getStore('treeData');
      //更新treeData时 目前给的新数据
      return _this.loopLazy(treeData, 0);
    };

    _this.loopLazy = function (data, nodeLevel) {
      var _this$props13 = _this.props,
          store = _this$props13.store,
          _this$props13$neverDi = _this$props13.neverDisable,
          neverDisable = _this$props13$neverDi === void 0 ? false : _this$props13$neverDi,
          switcherClass = _this$props13.switcherClass,
          _this$props13$mustExp = _this$props13.mustExpandable,
          mustExpandable = _this$props13$mustExp === void 0 ? false : _this$props13$mustExp;
      var expandedKeys = store.getStore('expandedKeys');
      var selectedKeys = store.getStore('selectedKeys');
      var newData = data || [];
      return newData.map(function (item) {
        item.key = item.refpk;

        if (item.key === undefined) {
          console.error('树组件，数据格式错误， 缺少refpk字段，请检查数据格式');
          return false;
        }

        var fieldid = '';

        if (item.attrcode) {
          fieldid = "".concat(item.attrcode, "_node");
        } else if (item.beforeName && typeof item.beforeName === 'string') {
          fieldid = "".concat(item.beforeName.trim(), "_node");
        } else if (item.refname) {
          if (typeof item.refname === "string") {
            var refnameArr = item.refname.split(' ');
            var refname = refnameArr[0];

            if (!refname && refnameArr[1]) {
              refname = refnameArr[1];
            }

            fieldid = "".concat(refname, "_node");
          } else {
            fieldid = "".concat(item.refpk || item.key || item.id, "_node");
          }
        }

        if (Array.isArray(item.children) && item.children.length) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeNode, Tree_extends({
            liAttr: {
              fieldid: Object(index_["getSysFieldid"])(fieldid),
              key: fieldid
            }
          }, item, {
            className: classnames_default()("node-item ".concat(item.className || ''), {
              isexpend: expandedKeys.includes(item.key)
            }, {
              disabledSelected: selectedKeys[0] === item.refpk
            }) // className={item.isdrag === false ? 'noDrag' : null}
            ,
            key: item.key,
            title: _this.renderTreeTitle(item, nodeLevel),
            disabled: neverDisable ? false : item.disabled,
            switcherClass: item.switcherClass || switcherClass,
            mustExpandable: item.mustExpandable || mustExpandable,
            isLeaf: item.isLeaf
          }), _this.loop(item.children, nodeLevel + 1));
        } else {
          if (item.isleaf === false) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeNode, Tree_extends({
              liAttr: {
                fieldid: Object(index_["getSysFieldid"])(fieldid),
                key: fieldid
              }
            }, item, {
              className: classnames_default()("node-item ".concat(item.className || ''), {
                isexpend: expandedKeys.includes(item.key)
              }, {
                disabledSelected: selectedKeys[0] === item.refpk
              }),
              key: item.key,
              title: _this.renderTreeTitle(item, nodeLevel),
              disabled: neverDisable ? false : item.disabled,
              switcherClass: item.switcherClass || switcherClass,
              children: [],
              mustExpandable: item.mustExpandable || mustExpandable,
              isLeaf: false
            }));
          } else {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeNode, Tree_extends({
              liAttr: {
                fieldid: Object(index_["getSysFieldid"])(fieldid),
                key: fieldid
              }
            }, item, {
              className: classnames_default()("node-item ".concat(item.className || ''), {
                isexpend: expandedKeys.includes(item.key)
              }, {
                disabledSelected: selectedKeys[0] === item.refpk
              }),
              key: item.key,
              title: _this.renderTreeTitle(item, nodeLevel),
              disabled: neverDisable ? false : item.disabled,
              switcherClass: item.switcherClass || switcherClass,
              children: null,
              mustExpandable: item.mustExpandable || mustExpandable,
              isLeaf: true
            }));
          }
        }
      });
    };

    _this.getTreeNodes = function (treeData) {
      //这里去tinper的treeData有bug  tinper给的treeData是上一次的bee-tree的state数据
      //传给tinper的treeData引用相同 数据未改变时 没有更新 因为tinper内部对比的引用
      // let { store } = this.props;
      // let treeData = store.getStore('treeData');
      //更新treeData时 目前给的新数据
      return _this.loop(treeData, 0);
    };

    _this.loop = function (data, nodeLevel) {
      var _this$props14 = _this.props,
          store = _this$props14.store,
          _this$props14$neverDi = _this$props14.neverDisable,
          neverDisable = _this$props14$neverDi === void 0 ? false : _this$props14$neverDi,
          switcherClass = _this$props14.switcherClass,
          _this$props14$mustExp = _this$props14.mustExpandable,
          mustExpandable = _this$props14$mustExp === void 0 ? false : _this$props14$mustExp;
      var expandedKeys = store.getStore('expandedKeys');
      var selectedKeys = store.getStore('selectedKeys');
      var newData = data || [];
      return newData.map(function (item) {
        item.key = item.refpk;

        if (item.key === undefined) {
          console.error('树组件，数据格式错误， 缺少refpk字段，请检查数据格式');
          return false;
        }

        var fieldid = '';

        if (item.attrcode) {
          fieldid = "".concat(item.attrcode, "_node");
        } else if (item.beforeName && typeof item.beforeName === 'string') {
          fieldid = "".concat(item.beforeName.trim(), "_node");
        } else if (item.refname) {
          if (typeof item.refname === "string") {
            var refnameArr = item.refname.split(' ');
            var refname = refnameArr[0];

            if (!refname && refnameArr[1]) {
              refname = refnameArr[1];
            }

            fieldid = "".concat(refname, "_node");
          } else {
            fieldid = "".concat(item.refpk || item.key || item.id, "_node");
          }
        }

        if (Array.isArray(item.children) && (item.children.length || _this.props.treeType === "asyncTree")) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeNode, Tree_extends({
            liAttr: {
              fieldid: Object(index_["getSysFieldid"])(fieldid),
              key: fieldid
            }
          }, item, {
            className: classnames_default()("node-item ".concat(item.className || ''), {
              isexpend: expandedKeys.includes(item.key)
            }, {
              disabledSelected: selectedKeys[0] === item.refpk
            }) // className={item.isdrag === false ? 'noDrag' : null}
            ,
            key: item.key,
            title: _this.renderTreeTitle(item, nodeLevel),
            disabled: neverDisable ? false : item.disabled,
            switcherClass: item.switcherClass || switcherClass,
            mustExpandable: item.mustExpandable || mustExpandable
          }), _this.loop(item.children, nodeLevel + 1));
        } else {
          if (item.isleaf === false) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeNode, Tree_extends({
              liAttr: {
                fieldid: Object(index_["getSysFieldid"])(fieldid),
                key: fieldid
              }
            }, item, {
              className: classnames_default()("node-item ".concat(item.className || ''), {
                isexpend: expandedKeys.includes(item.key)
              }, {
                disabledSelected: selectedKeys[0] === item.refpk
              }),
              key: item.key,
              title: _this.renderTreeTitle(item, nodeLevel),
              disabled: neverDisable ? false : item.disabled,
              switcherClass: item.switcherClass || switcherClass,
              mustExpandable: item.mustExpandable || mustExpandable,
              children: [],
              isLeaf: item.isleaf
            }));
          } else {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeNode, Tree_extends({
              liAttr: {
                fieldid: Object(index_["getSysFieldid"])(fieldid),
                key: fieldid
              }
            }, item, {
              className: classnames_default()("node-item ".concat(item.className || ''), {
                isexpend: expandedKeys.includes(item.key)
              }, {
                disabledSelected: selectedKeys[0] === item.refpk
              }),
              key: item.key,
              title: _this.renderTreeTitle(item, nodeLevel),
              disabled: neverDisable ? false : item.disabled,
              switcherClass: item.switcherClass || switcherClass,
              mustExpandable: item.mustExpandable || mustExpandable,
              children: null,
              isLeaf: true
            }));
          }
        }
      });
    };

    _this.addNodeEve = function () {
      var _this$props15 = _this.props,
          _this$props15$verifyM = _this$props15.verifyModalForm,
          verifyModalForm = _this$props15$verifyM === void 0 ? false : _this$props15$verifyM,
          addNodeCallBack = _this$props15.addNodeCallBack,
          store = _this$props15.store;
      var currentNode = store.getCache('currentNode');
      var formStore = store.getStore('formStore');

      if (!verifyModalForm) {
        formStore.setStatus('browse');
      }

      var data = formStore.getAllFormValue();

      if (Object(index_["isFunction"])(addNodeCallBack)) {
        var verify = addNodeCallBack(data, currentNode.refpk, currentNode); // 如果有回调 并且进行了校验

        if (verifyModalForm && verify) {
          store.setStore('showEditModal', false);
          store.setStateEve();
        }
      }
    };

    _this.addRender = function (item, e) {
      e.stopPropagation();
      var _this$props16 = _this.props,
          _this$props16$showMod = _this$props16.showModal,
          showModal = _this$props16$showMod === void 0 ? true : _this$props16$showMod,
          store = _this$props16.store,
          clickAddIconEve = _this$props16.clickAddIconEve,
          addNodeCallBack = _this$props16.addNodeCallBack,
          treeType = _this$props16.treeType;
      store.setCache('selectedNode', item);
      store.setCache('currentNode', item);

      if (showModal) {
        var formStore = store.getStore('formStore');
        formStore.emptyAllFormValue();
        formStore.setStatus('edit');
        store.setCache('treeNodeOperation', 'add');
        store.setStore('showEditModal', true);
        store.setStateEve();
      } else if (treeType === 'asyncTree') {
        if (Object(index_["isFunction"])(addNodeCallBack)) {
          addNodeCallBack(item);
        }
      }

      if (treeType === 'asyncTree') {
        store.setStore('selectedKeys', [item.refpk]);
      }

      if (Object(index_["isFunction"])(clickAddIconEve)) {
        clickAddIconEve(item);
      }

      store.setStateEve();
    };

    _this.editRender = function (item, e) {
      var _this$props17 = _this.props,
          _this$props17$showMod = _this$props17.showModal,
          showModal = _this$props17$showMod === void 0 ? true : _this$props17$showMod,
          store = _this$props17.store,
          clickEditIconEve = _this$props17.clickEditIconEve,
          treeType = _this$props17.treeType,
          editNodeCallBack = _this$props17.editNodeCallBack;
      e.stopPropagation();
      store.setCache('currentNode', item);

      if (showModal) {
        var formStore = store.getStore('formStore');
        formStore.emptyAllFormValue();
        formStore.setStatus('edit');
        store.setCache('treeNodeOperation', 'edit');
        store.setStore('showEditModal', true);
      } else if (treeType === 'asyncTree') {
        if (Object(index_["isFunction"])(editNodeCallBack)) {
          editNodeCallBack(item);
        }
      }

      if (Object(index_["isFunction"])(clickEditIconEve)) {
        clickEditIconEve(item);
      }

      store.setStore('selectedKeys', [item.refpk]);
      store.setStateEve();
    };

    _this.delNodeEve = function () {
      var _this$props18 = _this.props,
          delNodeCallBack = _this$props18.delNodeCallBack,
          store = _this$props18.store;
      var currentNode = store.getCache('currentNode');
      Object(index_["isFunction"])(delNodeCallBack) && delNodeCallBack(currentNode);
    };

    _this.delRender = function (item, e) {
      var _this$props19 = _this.props,
          _this$props19$showMod = _this$props19.showModal,
          showModal = _this$props19$showMod === void 0 ? true : _this$props19$showMod,
          store = _this$props19.store,
          clickDelIconEve = _this$props19.clickDelIconEve,
          treeType = _this$props19.treeType,
          delNodeCallBack = _this$props19.delNodeCallBack;
      e.stopPropagation();
      store.setCache('currentNode', item);

      if (showModal) {
        store.setCache('treeNodeOperation', 'del');
        store.setStore('showEditModal', true);
      } else if (treeType === 'asyncTree') {
        if (Object(index_["isFunction"])(delNodeCallBack)) {
          delNodeCallBack(item);
        }
      }

      if (treeType === 'asyncTree') {
        store.setStore('selectedKeys', [item.refpk]);
      }

      if (Object(index_["isFunction"])(clickDelIconEve)) {
        clickDelIconEve(item);
      }

      store.setStateEve();
    };

    _this.editNodeEve = function () {
      var _this$props20 = _this.props,
          _this$props20$verifyM = _this$props20.verifyModalForm,
          verifyModalForm = _this$props20$verifyM === void 0 ? false : _this$props20$verifyM,
          editNodeCallBack = _this$props20.editNodeCallBack,
          store = _this$props20.store,
          modal = _this$props20.modal;
      var currentNode = store.getCache('currentNode');
      var formStore = store.getStore('formStore');

      if (!verifyModalForm) {
        formStore.setStatus('browse');
      }

      var data = formStore.getAllFormValue();

      if (Object(index_["isFunction"])(editNodeCallBack)) {
        var verify = editNodeCallBack(data, currentNode.refpk, currentNode); // 如果有回调 并且进行了校验

        if (verifyModalForm && verify) {
          store.setStore('showEditModal', false);
          store.setStateEve();
        }
      }
    };

    _this.beSureBtnClick = function () {
      var _this$props21 = _this.props,
          treeType = _this$props21.treeType,
          store = _this$props21.store;
      var status = store.getCache('treeNodeOperation');

      if (treeType === 'asyncTree') {
        store.setStore('showEditModal', false);

        if (Object(index_["isFunction"])(_this.props["".concat(status, "NodeCallBack")])) {
          var currentNode = store.getCache('currentNode');
          var formStore = store.getStore('formStore');

          _this.props["".concat(status, "NodeCallBack")](currentNode, formStore.getAllFormValue());
        }
      } else if (treeType === 'syncTree') {
        _this["".concat(status, "NodeEve")]();
      }
    };

    _this.cancelBtnClick = function () {
      var _this$props22 = _this.props,
          verifyModalForm = _this$props22.verifyModalForm,
          store = _this$props22.store;
      var formStore = store.getStore('formStore');

      if (!verifyModalForm) {
        formStore.setStatus("browse");
      }

      formStore.cancel();
      store.setStore('showEditModal', false);
      store.setStateEve();
    };

    _this.getScrollContainer = function () {
      // if (this.treeDiv) {
      //   return this.treeDiv;
      // } else {
      //   let treeDiv = document.querySelector(`#${this.props.treeId.trim()}`);
      //   if (treeDiv) {
      //     this.treeDiv = treeDiv.querySelector('.tree-hotkeys-wrapper');
      //   } else {
      //     this.treeDiv = document.querySelector('.tree-hotkeys-wrapper');
      //   }
      //   return this.treeDiv;
      // }
      return document.querySelector(".tree-hotkeys-wrapper");
    };

    _this.searchInputRef = null;
    _this.ncc_automated = "0";
    _this.dropped = false;
    _this.state = {
      langJson: {},
      _: ""
    };
    _this.ncc_automated = Object(index_["getGlobalStorage"])("localStorage", "_ncc_automated_"); //业务初始化数据 存store

    var _this$props23 = _this.props,
        _store = _this$props23.store,
        meta = _this$props23.meta,
        metaId = _this$props23.metaId,
        _treeType = _this$props23.treeType,
        _formStore = _this$props23.formStore;

    _store.setCache('treeType', _treeType);

    _store.setStore('formStore', _formStore);

    if (meta[metaId]) {
      _formStore.setMeta(meta, metaId);
    }

    _this.transerDefaultConfigToStore(_props);

    return _this;
  }

  Tree_createClass(SyncTree, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      //调用多语
      var callback = function callback(json) {
        _this2.setState({
          langJson: json
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: "containers_tree",
        callback: callback
      });
    }
  }, {
    key: "componentWillUpdate",
    value: function componentWillUpdate(newProps, newState) {
      var store = newProps.store,
          _newProps$defaultExpa = newProps.defaultExpandAll,
          defaultExpandAll = _newProps$defaultExpa === void 0 ? false : _newProps$defaultExpa,
          treeType = newProps.treeType;

      if (treeType === 'syncTree') {
        var firstTime = store.getStore("firstTime");
        var treeData = store.getStore("treeData");

        if (firstTime) {
          this.generateList(treeData, this.dataList);
          store.setCache("dataList", this.dataList);
          store.setStore("firstTime", false);

          if (defaultExpandAll) {
            store.setStore("expandedKeys", this.getAllNodeKeys(treeData));
          }
        }
      }
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var meta = nextProps.meta,
          store = nextProps.store,
          metaId = nextProps.metaId;
      var formStore = store.getStore('formStore');

      if (meta[metaId]) {
        formStore.setMeta(meta, metaId);
      }

      this.transerDefaultConfigToStore(nextProps);
    }
  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$props24 = this.props,
          treeId = _this$props24.treeId,
          userDefine = _this$props24.userDefine,
          _this$props24$needSea = _this$props24.needSearch,
          needSearch = _this$props24$needSea === void 0 ? true : _this$props24$needSea,
          getSearchVal = _this$props24.getSearchVal,
          _this$props24$disable = _this$props24.disabledSearch,
          disabledSearch = _this$props24$disable === void 0 ? false : _this$props24$disable,
          _this$props24$checkab = _this$props24.checkable,
          checkable = _this$props24$checkab === void 0 ? false : _this$props24$checkab,
          _this$props24$checkSt = _this$props24.checkStrictly,
          checkStrictly = _this$props24$checkSt === void 0 ? true : _this$props24$checkSt,
          _this$props24$showMod = _this$props24.showModal,
          showModal = _this$props24$showMod === void 0 ? true : _this$props24$showMod,
          _this$props24$verifyM = _this$props24.verifyModalForm,
          verifyModalForm = _this$props24$verifyM === void 0 ? false : _this$props24$verifyM,
          modalSize = _this$props24.modalSize,
          openIcon = _this$props24.openIcon,
          closeIcon = _this$props24.closeIcon,
          _this$props24$draggab = _this$props24.draggable,
          draggable = _this$props24$draggab === void 0 ? false : _this$props24$draggab,
          store = _this$props24.store,
          modal = _this$props24.modal,
          _this$props24$mustExp = _this$props24.mustExpandable,
          mustExpandable = _this$props24$mustExp === void 0 ? false : _this$props24$mustExp,
          _this$props24$lazyLoa = _this$props24.lazyLoad,
          lazyLoad = _this$props24$lazyLoa === void 0 ? false : _this$props24$lazyLoa,
          expandWhenDoubleClick = _this$props24.expandWhenDoubleClick,
          _this$props24$showLin = _this$props24.showLine,
          showLine = _this$props24$showLin === void 0 ? false : _this$props24$showLin,
          treeType = _this$props24.treeType,
          metaId = _this$props24.metaId,
          _this$props24$otherAr = _this$props24.otherAreaHeight,
          otherAreaHeight = _this$props24$otherAr === void 0 ? 0 : _this$props24$otherAr,
          _this$props24$canClos = _this$props24.canCloseFreely,
          canCloseFreely = _this$props24$canClos === void 0 ? true : _this$props24$canClos;
      var langJson = this.state.langJson;
      var searchValue = store.getStore('searchValue');
      var focusable = store.getStore('focusable');
      var selectedKeys = store.getStore('selectedKeys');
      var expandedKeys = store.getStore('expandedKeys');
      var autoExpandParent = store.getStore('autoExpandParent');
      var checkedKeys = store.getStore('checkedKeys');
      var treeData = store.getStore('treeData');
      var showEditModal = store.getStore('showEditModal');
      var status = store.getCache('treeNodeOperation');
      var editModalTitle = this.props["".concat(status, "ModalTitle")] || langJson["containers-tree-".concat(status)];
      var formStore = store.getStore('formStore');
      var needEdit = store.getStore('needEdit'); // if (treeData && treeData.length === 0) {
      //   return false;
      // }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        fieldid: Object(index_["getSysFieldid"])("".concat(treeId, "_tree-area")),
        className: "syncTreeCom",
        id: treeId
      }, Object(index_["isFunction"])(userDefine) && userDefine(), needSearch && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "NC_syncTreeSearch"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("input", {
        ref: function ref(_ref4) {
          return _this3.searchInputRef = _ref4;
        },
        className: "u-form-control",
        fieldid: "search",
        style: {
          width: "100%",
          height: 30,
          "padding-right": "50px"
        },
        placeholder: langJson["containers-tree-001"],
        onClick: function onClick() {
          if (_this3.ncc_automated === "1") {
            if (searchValue == "") return;
            store.searchChange(searchValue);
            store.setStateEve();
          }
        },
        onChange: function onChange(event) {
          var value = event.target.value;

          if (value == "") {
            // 处理清空状态
            _this3.handleClearState();
          }

          if (_this3.ncc_automated != "1") {
            // 处理搜索空值
            _this3.interval = new Date().getTime();
            var s = setTimeout(function () {
              if (new Date().getTime() - _this3.interval >= 500) {
                store.searchChange(value);
              }

              if (Object(index_["isFunction"])(getSearchVal)) {
                getSearchVal(value);
              }

              clearTimeout(s);
            }, 500);
          }

          searchValue = value;
          store.setStore('searchValue', searchValue);
          store.setStateEve();
        },
        onFocus: this.focusEve.bind(this),
        disabled: disabledSearch,
        onBlur: this.blurEve
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        className: "icon iconfont icon-sousuo syncTreeSearchIcon"
      }), searchValue !== "" && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
        style: disabledSearch ? {
          display: "none"
        } : null,
        className: "icon iconfont qingkong syncTreeSearchIcon icon-qingkong",
        onClick: this.handleClearSearchVal
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        fieldid: Object(index_["getSysFieldid"])("".concat(treeId, "_tree")),
        className: "synctree-area"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tree"], {
        lazyLoad: lazyLoad,
        renderTreeNodes: lazyLoad ? this.getTreeNodes : null // renderTreeNodes={this.getTreeNodes}
        ,
        treeId: treeId,
        treeData: treeData,
        focusable: focusable,
        mustExpandable: mustExpandable,
        onDoubleClick: this.onDoubleClickHandler,
        selectedKeys: selectedKeys,
        onSelect: this.onSelect,
        onExpand: this.onExpand // 节点展开事件
        ,
        expandedKeys: expandedKeys //搜索节点关键字后要展开的父节点
        ,
        autoExpandParent: autoExpandParent //是否展开所有节点
        ,
        onMouseLeave: this.onMouseLeave //鼠标离开节点事件
        ,
        onMouseEnter: this.onMouseEnter // 鼠标进入节点事件
        ,
        onCheck: this.onCheck,
        checkable: checkable,
        checkStrictly: checkStrictly,
        checkedKeys: checkedKeys || [],
        draggable: draggable,
        debounceDuration: 5,
        onDragOver: this.onDragOver.bind(this),
        onDragStart: this.onDragStart.bind(this),
        onDrop: this.onDrop,
        onDragEnd: this.onDragEnd,
        getScrollContainer: this.getScrollContainer,
        otherAreaHeight: otherAreaHeight,
        openIcon: Object(index_["isFunction"])(openIcon) ? openIcon() : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-shu_zk tree-swich"
        }),
        closeIcon: Object(index_["isFunction"])(closeIcon) ? closeIcon() : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont icon-shushouqi tree-swich"
        }) //异步树API
        ,
        expandWhenDoubleClick: expandWhenDoubleClick,
        loadData: treeType === 'asyncTree' ? this.onLoadData : null,
        showLine: showLine,
        canCloseFreely: canCloseFreely //解决层层收起失效问题

      }, lazyLoad ? null : this.getTreeNodes(treeData))), needEdit && showModal && Object.keys(langJson).length > 0 && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], {
        fieldid: "".concat(status, "Node"),
        show: showEditModal,
        backdrop: "static",
        size: status !== 'del' && modalSize,
        userControl: status !== 'del' && verifyModalForm
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Header, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Title, {
        fieldid: editModalTitle
      }, editModalTitle)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Body, null, status === 'del' ? langJson["containers-tree-003"] : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "addModal"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(form_index_default.a, {
        name: metaId,
        config: {},
        store: formStore
      }))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"].Footer, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.beSureBtnClick,
        colors: "primary",
        style: {
          marginRight: 8
        }
      }, langJson['containers-tree-sure-btn']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        onClick: this.cancelBtnClick,
        bordered: true
      }, langJson['containers-tree-cancel-btn']))));
    }
  }]);

  return SyncTree;
}(template_index_["BaseComponent"]);


// CONCATENATED MODULE: ./src/platform/components/Tree/AsyncTree/compatible.js
function compatible_createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = compatible_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function compatible_toConsumableArray(arr) { return compatible_arrayWithoutHoles(arr) || compatible_iterableToArray(arr) || compatible_unsupportedIterableToArray(arr) || compatible_nonIterableSpread(); }

function compatible_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function compatible_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return compatible_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return compatible_arrayLikeToArray(o, minLen); }

function compatible_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function compatible_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return compatible_arrayLikeToArray(arr); }

function compatible_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function compatible_extends() { compatible_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return compatible_extends.apply(this, arguments); }

function compatible_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = compatible_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function compatible_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

/**
 * 使用异步树的节点：数据权限 节点， 使用权限页签-授权规则(选择新增规则，资源实体选'客户基本信息')
 * 
 * 异步树使用了同步树API    hideIcon
 */





var compatible_existenceCheck = function existenceCheck(id) {
  var store = this.asyncTreeDataSource[id];

  if (!store) {
    store = Tree_store();
    this.asyncTreeDataSource[id] = store;
    console.warn("\u6240\u64CD\u4F5C\u7684\u8868\u683C\u4E2D\u65E0ID\u4E3A".concat(id, "\u7684\u6570\u636E"));
    return;
  }

  return store;
}; // 创建组件


function createAsyncTree() {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var newConfig = Object.assign({}, config);

  var treeId = newConfig.treeId,
      _newConfig$expandWhen = newConfig.expandWhenDoubleClick,
      expandWhenDoubleClick = _newConfig$expandWhen === void 0 ? true : _newConfig$expandWhen,
      editType = newConfig.editType,
      doubleClickEve = newConfig.doubleClickEve,
      _newConfig$showModal = newConfig.showModal,
      showModal = _newConfig$showModal === void 0 ? true : _newConfig$showModal,
      metaId = newConfig.metaId,
      others = compatible_objectWithoutProperties(newConfig, ["treeId", "expandWhenDoubleClick", "editType", "doubleClickEve", "showModal", "metaId"]); // this.register("treeTable"); // 生成 this.treeTableDataSource[id]


  var pageScope = this,
      store = pageScope.asyncTreeDataSource[treeId];

  if (!store) {
    store = Tree_store();
    pageScope.asyncTreeDataSource[treeId] = store;
  }

  if (!pageScope.formDataSource[metaId] && showModal) {
    pageScope.use.form(metaId);
  }

  return /*#__PURE__*/React.createElement(Tree_SyncTree, compatible_extends({
    meta: this.state.meta,
    store: store,
    treeId: treeId,
    needSearch: false,
    expandWhenDoubleClick: expandWhenDoubleClick,
    onDoubleClickEve: doubleClickEve,
    needEdit: editType
  }, others, {
    showModal: showModal,
    metaId: metaId,
    formStore: pageScope.formDataSource[metaId],
    pageOutput: pageScope.output,
    treeType: 'asyncTree'
  }));
}
/*
*   生成树 需要的数据结构
*   @ data: 数组
* */

function compatible_createTreeData(data) {
  createTreeData(data);
}
/*====================================================================================*/
// 设置树 数据

function setTreeData(id, newData, treeNode) {
  if (!Object(index_["isArray"])(newData)) {
    return;
  }

  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  if (!treeNode) {
    //判断是否是根节点; 不是根节点要去找对应的父节点插入child
    var treeData = compatible_createNewData(newData);
    store.setStore('treeData', treeData);
    store.setStore('selectedKeys', []); // 清空之前的选择项
  } else {
    var key = '';

    if (treeNode.props && treeNode.props.eventKey) {
      key = treeNode.props.eventKey;
    } else if (treeNode.key) {
      key = treeNode.key;
    }

    if (key) {
      var data = compatible_createNewData(newData);

      var _treeData = store.getStore('treeData');

      getNewTreeData(_treeData, key, data);
      store.setStore('treeData', compatible_toConsumableArray(_treeData));
    } else {
      console.warn('异步树setTreeData方法，treeNode参数不正确');
      return;
    }
  }

  store.setStateEve();
  var onSelectedChange = store.getListener('onSelectedChange');

  if (Object(index_["isFunction"])(onSelectedChange && !treeNode)) {
    onSelectedChange(null);
  }
}
/*
 *   设置节点勾选
 *   @ pk： 目前为字符串
 */

function setNodeChecked(id, pk) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.setNodeChecked(pk);
} //  添加树节点

function addTreeData(id, datas) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var data = compatible_createNewData(datas);
  var treeData = store.getStore('treeData');

  if (Object(index_["isArray"])(data)) {
    addIconBox(data);
    data.forEach(function (item) {
      return addTreeNode(treeData, item);
    });
  } else {
    addIconBox([data]);
    addTreeNode(treeData, data);
  }

  store.setStore('treeData', compatible_toConsumableArray(treeData));
  store.setStateEve();
} //  获取树某个节点或整个树信息

function getAsyncTreeValue(id, pk) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');
  return getItem(treeData, pk);
} // 删除树节点

function delTreeData(id, pk) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.delNodeSuceess(pk);
} // 编辑树节点

function editTreeData(id, newItem) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.editNodeSuccess(newItem);
} //  设置节点不可用

function setAsyncNodeDisable(id, disable, pk) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData'); //let deepData = store.getCache('deepData'); 

  setNodeDisableEve(treeData, disable, pk); // // 同步deepData禁用状态
  // if (deepData) {
  //     TreeUtil.setNodeDisableEve(deepData, disable, pk);
  // }
  // 如果是整体禁用模式，则禁用快捷键功能

  if (!pk) {
    if (disable) {
      // 全被禁用
      store.setStore('focusable', false);
    } else {
      store.setStore('focusable', true);
    }
  }

  store.setStore('treeData', compatible_toConsumableArray(treeData));
  store.setStateEve();
}
/*
 *   设置树的编辑性
 *   @ status: true/false
 * */

function setTreeEdit(id, status) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var needEdit = store.getStore('needEdit');

  if (needEdit !== status) {
    var onTreeStatusChange = store.getListener('onTreeStatusChange');

    if (onTreeStatusChange) {
      onTreeStatusChange();
    }
  }

  store.setStore('needEdit', status);
  store.setStateEve();
}
/*
*   获取当前选中节点信息
* */

function getSelectNodeAsync(id) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  return store.getCache('selectedNode');
}
/*
*   展开节点方法
* */

function openNodeByPkAsync(id, pk, reset) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var expandedKeys = store.getStore('expandedKeys');

  if (reset) {
    expandedKeys = Object.prototype.toString.call(pk) === '[object Array]' ? pk : pk ? [pk] : [];
  } else if (Object.prototype.toString.call(pk) === '[object Array]') {
    var _expandedKeys;

    (_expandedKeys = expandedKeys).push.apply(_expandedKeys, compatible_toConsumableArray(pk));
  } else if (Object.prototype.toString.call(pk) === '[object String]') {
    if (expandedKeys.indexOf(pk) === -1) {
      expandedKeys.push(pk);
    }
  } else {
    console.warn("openNodeByPk方法，参数pk,类型为数组或字符串");
    return;
  }

  store.setStore('autoExpandParent', true);
  store.setStore('expandedKeys', expandedKeys);
  store.setStateEve();
  var loadTreeData = store.getListener('loadTreeData');
  var treeData = store.getStore('treeData');

  if (Object(index_["isFunction"])(loadTreeData)) {
    if (Object(index_["isString"])(pk)) {
      loadTreeData(pk, getItem(treeData, pk));
    } else if (Object(index_["isArray"])(pk)) {
      pk.forEach(function (item) {
        loadTreeData(item, getItem(treeData, item));
      });
    }
  }
}
/*
*   关闭节点方法
* */

function closeNodeByPkAsync(id, pk) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.closeNodeByPk(pk);
}
/*
*   设置图标显示隐藏
*   @ key 节点key值
*   @data 对象，描述图标是否显示  示例：{ editIcon:true, delIcon:false, addIcon:false }
*   true: 显示；  false：隐藏
* */

function hideIconAsync(id, key, data) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.hideIcon(key, data);
}
/*
*   新增兄弟节点
* */

function addBrotherNodeAsync(id, data) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.addBrotherNode(data);
}
/*
*   设置节点选中
*   @pk： 目前为字符串
*/

function setNodeSelectedAsync(id, pk) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.setNodeSelected(pk);
}
/* 取消当前选中所有节点 */

function cancelSelectedNodeAsync(id) {
  var store = compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.cancelSelectedNode();
} // 组装树组件需要的结构

function compatible_createNewData(val) {
  if (Object(index_["isArray"])(val)) {
    val.map(function (item, index) {
      item.key = item.refpk;

      if (!item.iconBox) {
        if (item.key) {
          item.iconBox = {
            addIcon: true,
            delIcon: true,
            editIcon: true
          };
        }
      }

      if (item.key === undefined) {
        console.error('createNewData方法报错，异步树的数据中缺少refpk字段，请检查数据格式');
        return false;
      }
    });
  } else if (val.refpk) {
    val.key = val.refpk;

    if (!val.iconBox) {
      val.iconBox = {
        addIcon: true,
        delIcon: true,
        editIcon: true
      };
    }
  } else {
    console.error('createNewData, 异步树，数据格式不正确');
  }

  return val;
}

; //  插入对应的 树 子节点数据

function getNewTreeData(treeData, parentKey, child) {
  if (!child || !Object(index_["isArray"])(child) || child.length === 0) {
    return false;
  }

  var loop = function loop(data) {
    if (!data || data.length === 0) {
      return false;
    }

    var _iterator = compatible_createForOfIteratorHelper(data),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var item = _step.value;

        if (item.key === child[0].pid) {
          item.children = child;
          return;
        }

        if (item.children) {
          loop(item.children);
        }
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }
  };

  loop(treeData);
  return treeData;
} // 新增节点，插入节点


function addTreeNode(treeData, data) {
  var pid = data.pid;

  if (pid) {
    var len = treeData.length;

    for (var i = 0; i < len; i++) {
      var node = treeData[i];

      if (node.refpk === pid) {
        if (node.children) {
          node.children.push(data);
        } else {
          node.children = [data];
        }

        return true;
      } else if (Array.isArray(node.children)) {
        var res = addTreeNode(node.children, data);

        if (res) {
          return false;
        }
      }
    }
  } else {
    if (data.refpk) {
      treeData.push(data);
    } else {
      console.warn('addTreeNode方法，参数data格式不正确');
    }
  }
}
// CONCATENATED MODULE: ./src/platform/components/Tree/AsyncTree/output.js

/* harmony default export */ var AsyncTree_output = (compatible_namespaceObject);
// CONCATENATED MODULE: ./src/platform/components/Tree/SyncTree/compatible.js
function SyncTree_compatible_toConsumableArray(arr) { return SyncTree_compatible_arrayWithoutHoles(arr) || SyncTree_compatible_iterableToArray(arr) || SyncTree_compatible_unsupportedIterableToArray(arr) || SyncTree_compatible_nonIterableSpread(); }

function SyncTree_compatible_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function SyncTree_compatible_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return SyncTree_compatible_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return SyncTree_compatible_arrayLikeToArray(o, minLen); }

function SyncTree_compatible_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function SyncTree_compatible_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return SyncTree_compatible_arrayLikeToArray(arr); }

function SyncTree_compatible_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function SyncTree_compatible_extends() { SyncTree_compatible_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return SyncTree_compatible_extends.apply(this, arguments); }

function SyncTree_compatible_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = SyncTree_compatible_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function SyncTree_compatible_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

/**
 * 预警消息查询 树显示不正确 是由于业务根节点 isleaf是true导致
 * 账户期初余额  所有层级数据里都没有key
 * 计划周期  根节点给了 pid 没给key  子节点没有pid
 * 设置： 根节点pid=refpk  没有key   tinper用的是key 业务用的唯一标识是refpk 看tinper能否使用refpk作为唯一标识
 * 查询区---图标显示问题------------平台问题
 * 交易类型管理-无法搜索 多跟树 无pid 搜索---------平台问题
 * 单据类型 出库调整单 搜索不到 业务的pid 重复
 */




/**
 * 检测组件对象是否存在 
 * @param {*} id 
 */

var SyncTree_compatible_existenceCheck = function existenceCheck(id) {
  var store = this.syncTreeDataSource[id];

  if (!store) {
    store = Tree_store();
    this.syncTreeDataSource[id] = store;
    console.warn("\u6240\u64CD\u4F5C\u7684\u8868\u683C\u4E2D\u65E0ID\u4E3A".concat(id, "\u7684\u6570\u636E"));
    return;
  }

  return store;
}; // 创建组件


function createSyncTree() {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var newConfig = Object.assign({}, config);

  var treeId = newConfig.treeId,
      _newConfig$expandWhen = newConfig.expandWhenDoubleClick,
      expandWhenDoubleClick = _newConfig$expandWhen === void 0 ? false : _newConfig$expandWhen,
      onDoubleClickEve = newConfig.onDoubleClickEve,
      _delNodeCallBack = newConfig.delNodeCallBack,
      _newConfig$showModal = newConfig.showModal,
      showModal = _newConfig$showModal === void 0 ? true : _newConfig$showModal,
      metaId = newConfig.metaId,
      others = SyncTree_compatible_objectWithoutProperties(newConfig, ["treeId", "expandWhenDoubleClick", "onDoubleClickEve", "delNodeCallBack", "showModal", "metaId"]); // this.register("treeTable"); // 生成 this.treeTableDataSource[id]


  var pageScope = this,
      store = pageScope.syncTreeDataSource[treeId];

  if (!store) {
    store = Tree_store();
    pageScope.syncTreeDataSource[treeId] = store;
  }

  if (!pageScope.formDataSource[metaId] && showModal) {
    pageScope.use.form(metaId);
  }

  return /*#__PURE__*/React.createElement(Tree_SyncTree, SyncTree_compatible_extends({
    key: treeId,
    meta: this.state.meta,
    store: store,
    treeId: treeId,
    onDoubleClickEve: onDoubleClickEve,
    expandWhenDoubleClick: expandWhenDoubleClick,
    delNodeCallBack: function delNodeCallBack(currentNode) {
      if (Object(index_["isFunction"])(_delNodeCallBack)) {
        _delNodeCallBack(currentNode.refpk);
      }
    },
    formStore: pageScope.formDataSource[metaId],
    showModal: showModal,
    metaId: metaId
  }, others, {
    pageOutput: pageScope.output,
    treeType: 'syncTree'
  }));
} // 设置树 数据

function setSyncTreeData(id, treeData, iconBoxData) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.setStore('firstTime', true);
  store.setStore('searchValue', '');

  if (!Object(index_["isArray"])(treeData)) {
    console.warn('setSyncTreeData方法data参数为数组');
    return false;
  }

  !store.getCache('userControlIcon') && addIconBox(treeData);
  store.setStore('treeData', SyncTree_compatible_toConsumableArray(treeData));
  store.setStore('expandedKeys', []);
  store.setStore('selectedKeys', []);
  store.setCache('deepData', SyncTree_compatible_toConsumableArray(treeData)); // 对功能区按钮初始化

  if (iconBoxData) {
    if (Object.prototype.toString.call(iconBoxData) === '[object Array]') {
      setIconVisible.call(this, id, iconBoxData);
    } else {
      console.error('iconBoxData is not a Array');
    }
  }

  var selectedForInit = store.getListener('selectedForInit');
  var onSelectEve = store.getListener('onSelectEve'); // 进行默认选中处理

  if (treeData && treeData.length != 0 && selectedForInit) {
    var dataLength = treeData.length;
    var firstRoot = treeData[0];
    var selectedNode; // 如果多根，选中第一个根节点

    if (dataLength > 1) {
      selectedNode = firstRoot;
    } // 如果单根，首先查看单根是否为实根，如果不是选中并且展开第一个子节点


    if (dataLength == 1) {
      // 有实根的情况
      if (firstRoot.needSelect) {
        selectedNode = firstRoot;
      } else {
        // 虚根情况
        if (firstRoot.children && firstRoot.children != 0) {
          selectedNode = firstRoot.children[0];
        } else {
          selectedNode = firstRoot;
        }
      }

      store.setStore('expandedKeys', [firstRoot.refpk]);
    } //当前选中的树节点


    store.setCache('selectedNode', getItem(treeData, selectedNode.refpk)); //获取选中的

    store.setStore('selectedKeys', [selectedNode.refpk]);

    if (Object(index_["isFunction"])(selectedForInit)) {
      selectedForInit(selectedNode.refpk, selectedNode, true);
    } else {
      if (Object(index_["isFunction"])(onSelectEve)) {
        onSelectEve(selectedNode.refpk, selectedNode, true);
      }
    }
  }

  store.setStateEve();
  var onSelectedChange = store.getListener('onSelectedChange');

  if (Object(index_["isFunction"])(onSelectedChange)) {
    onSelectedChange(null);
  }
} // 编辑成功调用方法

function editNodeSuccess(id, newItem) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.editNodeSuccess(newItem);
} // 编辑禁用函数

function handleEidAddDisbale(id, pk) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.setCache('disabledSearch', true);
  store.setStore('noDisableId', pk);
  store.setStore('selectedKeys', [pk]);
  setNodeDisable(id, true);
  store.setStateEve();
} // 还原状态

function handleEidAddNoDisbale(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  setNodeDisable(id, false);
  store.setCache('disabledSearch', false);
  store.setStore('selectedKeys', [store.getStore('noDisableId')]);
  store.setStore('noDisableId', '');
  store.setStateEve();
} // 新增节点成功调用方法

function addNodeSuccess(id, data, isBefore) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');
  var deepData = store.getCache('deepData');
  var userControlIcon = store.getCache('userControlIcon');
  var list = treeToList(treeData);
  treeData = createTreeData(list) || [];

  if (Object(index_["isArray"])(data)) {
    !userControlIcon && addIconBox(data);
    data.forEach(function (item) {
      addNodeFun(treeData, item, isBefore); // if (thisTree.searchValue.length != 0) {

      addNodeFun(deepData, item, isBefore); // }
    });
  } else {
    !userControlIcon && addIconBox([data]);
    addNodeFun(treeData, data, isBefore); // if (thisTree.searchValue.length != 0) {

    addNodeFun(deepData, data, isBefore); // }
  }

  store.setStore('treeData', SyncTree_compatible_toConsumableArray(treeData));
  store.setStore('firstTime', true);
  store.setStateEve();
} // 删除节点成功调用

function delNodeSuceess(id, pk) {
  var noneChangeLeaf = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.delNodeSuceess(pk, noneChangeLeaf);
} //  获取树某个节点或整个树信息

function getSyncTreeValue(id, pk) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var deepData = store.getCache('deepData'); // 更改获取节点数据

  return getItem(deepData, pk);
}
/*
 *   设置某个节点或整个树不可点击
 *   disable:true 不可用； false:可用
 *   pk:不传，设置整个树不可用。
 * */

function setNodeDisable(id, disable, pk) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');
  var deepData = store.getCache('deepData');
  setNodeDisableEve(treeData, disable, pk); // 同步deepData禁用状态

  if (deepData) {
    setNodeDisableEve(deepData, disable, pk);
  } // 如果是整体禁用模式，则禁用快捷键功能


  if (!pk) {
    if (disable) {
      // 全被禁用
      store.setStore('focusable', false);
    } else {
      store.setStore('focusable', true);
    }
  }

  store.setStore('treeData', SyncTree_compatible_toConsumableArray(treeData));
  store.setStateEve();
}
/*
 *   设置树的编辑性
 *   @ status: true/false
 * */

function compatible_setTreeEdit(id, status) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var needEdit = store.getStore('needEdit');

  if (needEdit !== status) {
    var onTreeStatusChange = store.getListener('onTreeStatusChange');

    if (onTreeStatusChange) {
      onTreeStatusChange();
    }
  }

  store.setStore('needEdit', status);
  store.setStateEve();
}
/*
 *   获取当前选中节点信息
 * */

function getSelectNode(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  return store.getCache('selectedNode');
}
/*
 *   展开节点方法
 * */

function openNodeByPk(id, pk) {
  var autoExpandParent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var expandedKeys = store.getStore('expandedKeys');

  if (Object.prototype.toString.call(pk) === '[object Array]') {
    expandedKeys.push.apply(expandedKeys, SyncTree_compatible_toConsumableArray(pk));
  } else if (Object.prototype.toString.call(pk) === '[object String]') {
    if (expandedKeys.indexOf(pk) === -1) {
      expandedKeys.push(pk);
    }
  } else {
    console.warn('openNodeByPk方法，参数pk,类型为数组或字符串');
    return;
  }

  store.setStore('expandedKeys', SyncTree_compatible_toConsumableArray(expandedKeys));
  store.setStore('autoExpandParent', autoExpandParent);
  store.setStateEve();
}
/*
 *   关闭节点方法
 * */

function closeNodeByPk(id, key) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.closeNodeByPk(key);
}
/*
 *   生成树 需要的数据结构
 *   @ data: 数组
 * */

function SyncTree_compatible_createTreeData(data, resetInfo) {
  return createTreeData(data, resetInfo);
} // 获取树的数据

function getTreeData(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');
  return JSON.parse(JSON.stringify(treeData || [], function (key, value) {
    if (key == 'beforeName' || key == 'afterName') {
      return undefined;
    }

    return value;
  }));
}
/*
 *   设置图标显示隐藏
 *   @ key 节点key值
 *   @ data 对象，描述图标是否显示  示例：{ editIcon:true, delIcon:false, addIcon:false }
 *   true: 显示；  false：隐藏
 * */

function hideIcon(id, key, data) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.hideIcon(key, data);
}
/*
 *   批量设置节点图标的显隐性
 *   @ data: 数组或对象
 * */

function setIconVisible(id, data) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');

  if (Object(index_["isObj"])(data)) {
    hideIconEve(treeData, data.key, data.value);
  } else if (Object(index_["isArray"])(data)) {
    data.map(function (item) {
      return hideIconEve(treeData, item.key, item.value);
    });
  }

  store.setStateEve();
}
/*
 *   新增兄弟节点
 * */

function addBrotherNode(id, data) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.addBrotherNode(data);
}
/*
 *   设置节点选中
 *   @ pk： 目前为字符串
 */

function setNodeSelected(id, pk) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.setNodeSelected(pk);
}
/*
 *   设置节点勾选
 *   @ pk： 目前为字符串
 */

function compatible_setNodeChecked(id, pk) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.setNodeChecked(pk);
}
/**
 *获取所有被勾选的数据 pks
 *
 * @export
 * @param {*} id
 * @returns
 */

function getCheckedKeys(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  return store.getStore('checkedKeys');
}
/* 取消当前选中所有节点 */

function cancelSelectedNode(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  store.cancelSelectedNode();
}
/* 设置叶子节点不可编辑/可编辑，父节点可以编辑  */

function setLeafNodeEdit(id, status) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');
  setLeafEdit(treeData, status);
  store.setStateEve();
}
/*
 *  移动节点 （先获取要移动的节点对象，删除该节点，将节点放到目标节点children中）
 *  @ pk: 要移动的节点pk
 *  @ targetPk: 目标节点pk
 * */

function moveNode(id, pk, targetPk) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  var treeData = store.getStore('treeData');
  var thisNode = getItem(treeData, pk);
  util_delNode(treeData, pk);
  moveNodeEve(treeData, thisNode, targetPk);
  store.setStateEve();
}
/* 获取拖拽的节点key */

function getMoveNodeKey(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  ;
  var treeData = store.getStore('treeData');
  var moveKey = store.getCache('moveKey');
  return getItem(treeData, moveKey);
}
/* 获取hover的节点key */

function getHoverNodeKey(id) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  ;
  var treeData = store.getStore('treeData');
  var isHover = store.getCache('isHover');
  return getItem(treeData, isHover);
}
/* 暴露搜索功能方法 */

function getSearchChangeEven(value, treeId) {
  var store = SyncTree_compatible_existenceCheck.call(this, treeId);

  if (!store) {
    return;
  }

  ;

  if (Object.prototype.toString.call(value) !== '[object String]') {
    console.warn('搜索参数为字符串类型');
  } // let defSource;
  // try {
  //     defSource = store.getStore('treeData');
  // } catch (e) {
  //     console.warn(e);
  // }


  store.searchChange(value);
}
/**
 * @desc 设置树节点的图标
 * @param id {string} 区域Id
 * @param items {array} [{ key: 'refpk', icons: ['uf-search'] }]
 */

function setTreeItemIcons(_ref) {
  var id = _ref.id,
      items = _ref.items;
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  ;
  var treeData = store.getStore('treeData');
  items.map(function (item) {
    setCustomerIcons({
      treeData: treeData,
      item: item
    });
  });
  store.setStateEve();
}
/* 根据key获取子树 */

function compatible_getItem(treeData, key) {
  if (!key) {
    return treeData;
  }

  var length = treeData.length;

  for (var i = 0; i < length; i++) {
    var item = treeData[i];

    if (item.key == key) {
      return item;
    } else if (Array.isArray(item.children)) {
      var res = compatible_getItem(item.children, key);

      if (res) {
        return res;
      }
    }
  }
}
;
/**
 * @desc 根据用户传入的items 遍历树节点，寻找到具体节点后在此节点中添加 customerIcons 字段
 * @param treeData {array}
 * @param item {object}
 */

function setCustomerIcons(_ref2) {
  var treeData = _ref2.treeData,
      item = _ref2.item;
  var i = treeData.length;

  while (i--) {
    var data = treeData[i];

    if (data.key === item.key) {
      data.customerIcons = item.icons;
      return true;
    } else {
      if (Array.isArray(data.children)) {
        var res = setCustomerIcons({
          treeData: data.children,
          item: item
        });

        if (res) {
          return false;
        }
      }
    }
  }
}
/**
 * @desc 打开添加树节点模态框，与createSyncTree 内部的 addRender方法相同
 * @param item {object} 树节点信息
 * @param e {object} 事件信息
 * @param treeId {string}
 */


function showAddTreeItemModal(_ref3) {
  var item = _ref3.item,
      e = _ref3.e,
      treeId = _ref3.treeId;
  var store = SyncTree_compatible_existenceCheck.call(this, treeId);

  if (!store) {
    return;
  }

  ;
  var showModal = store.getCache('showModal');
  var metaId = store.getCache('metaId');
  var clickAddIconEve = store.getListener('clickAddIconEve');
  var _this$form = this.form,
      setFormStatus = _this$form.setFormStatus,
      EmptyAllFormValue = _this$form.EmptyAllFormValue;
  e.stopPropagation();
  setFormStatus(metaId, 'edit');
  store.setCache('currentNode', item);
  EmptyAllFormValue(metaId);

  if (showModal) {
    store.setStore('showEditModal', true);
    store.setCache('treeNodeOperation', 'add');
  }

  if (Object(index_["isFunction"])(clickAddIconEve)) {
    clickAddIconEve(item);
  }

  store.setStateEve();
}
/**
 * @desc 打开修改树节点模态框，与createSyncTree 内部的 editRender方法相同
 * @param item {object} 树节点信息
 * @param e {object} 事件信息
 * @param treeId {string}
 */

function showEditTreeItemModal(_ref4) {
  var item = _ref4.item,
      e = _ref4.e,
      treeId = _ref4.treeId;
  var store = SyncTree_compatible_existenceCheck.call(this, treeId);

  if (!store) {
    return;
  }

  ;
  var showModal = store.getCache('showModal');
  var metaId = store.getCache('metaId');
  var clickEditIconEve = store.getListener('clickEditIconEve');
  var setFormStatus = this.form.setFormStatus;
  e.stopPropagation();
  store.setCache('currentNode', item);

  if (showModal) {
    setFormStatus(metaId, 'edit');
    store.setStore('showEditModal', true);
    store.setCache('treeNodeOperation', 'edit');
  }

  if (Object(index_["isFunction"])(clickEditIconEve)) {
    clickEditIconEve(item);
  }

  store.setStore('selectedKeys', [item.refpk]);
  store.setStateEve();
}
/**
 * @desc 打开删除树节点模态框，与createSyncTree 内部的 delRender方法相同
 * @param item {object} 树节点信息
 * @param e {object} 事件信息
 * @param treeId {string}
 */

function showDeleteTreeItemModal(_ref5) {
  var item = _ref5.item,
      e = _ref5.e,
      treeId = _ref5.treeId;
  var store = SyncTree_compatible_existenceCheck.call(this, treeId);

  if (!store) {
    return;
  }

  ;
  var showModal = store.getCache('showModal');
  var clickDelIconEve = store.getListener('clickDelIconEve');
  e.stopPropagation();
  store.setCache('currentNode', item);

  if (showModal) {
    store.setStore('showEditModal', true);
    store.setCache('treeNodeOperation', 'del');
  }

  if (Object(index_["isFunction"])(clickDelIconEve)) {
    clickDelIconEve(item);
  }
}
function updataDataSource(id, callBack) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  ;
  var treeData = store.getStore('treeData');

  if (callBack) {
    var newDataSource = callBack(JSON.parse(JSON.stringify(treeData)));

    if (Array.isArray(newDataSource)) {
      store.getCache('deepData', newDataSource);
      store.setStore('treeData', newDataSource);
    }

    store.setStateEve();
  } else {
    console.warn('请传回调参数，并且返回新的数据源');
  }
}
/**
 * 更新某个树节点
 * @param {*} id  树id
 * @param {*} updataNode 将要更新的节点
 */

function updataTreeNode(id, updataNode) {
  var store = SyncTree_compatible_existenceCheck.call(this, id);

  if (!store) {
    return;
  }

  ;
  var treeData = store.getStore('treeData');
  var deepData = store.getCache('deepData');

  function findEditNode(nodes) {
    for (var i = 0; i < nodes.length; i++) {
      var node = nodes[i];

      if (node.refpk == updataNode.pid) {
        node.children = node.children.map(function (child) {
          if (child.refpk == updataNode.refpk) return updataNode;
          return child;
        });
        return true;
      }
    }

    nodes.map(function (node) {
      if (node.children) {
        findEditNode(node.children);
      }
    });
  }

  findEditNode(treeData);
  findEditNode(deepData);
}
// CONCATENATED MODULE: ./src/platform/components/Tree/SyncTree/output.js

/* harmony default export */ var SyncTree_output = (SyncTree_compatible_namespaceObject);
// CONCATENATED MODULE: ./src/platform/components/Transfer/ListToListTransfer/index.js
function ListToListTransfer_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { ListToListTransfer_typeof = function _typeof(obj) { return typeof obj; }; } else { ListToListTransfer_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return ListToListTransfer_typeof(obj); }

function ListToListTransfer_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function ListToListTransfer_toConsumableArray(arr) { return ListToListTransfer_arrayWithoutHoles(arr) || ListToListTransfer_iterableToArray(arr) || ListToListTransfer_unsupportedIterableToArray(arr) || ListToListTransfer_nonIterableSpread(); }

function ListToListTransfer_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function ListToListTransfer_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return ListToListTransfer_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return ListToListTransfer_arrayLikeToArray(o, minLen); }

function ListToListTransfer_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function ListToListTransfer_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return ListToListTransfer_arrayLikeToArray(arr); }

function ListToListTransfer_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function ListToListTransfer_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function ListToListTransfer_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function ListToListTransfer_createClass(Constructor, protoProps, staticProps) { if (protoProps) ListToListTransfer_defineProperties(Constructor.prototype, protoProps); if (staticProps) ListToListTransfer_defineProperties(Constructor, staticProps); return Constructor; }

function ListToListTransfer_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) ListToListTransfer_setPrototypeOf(subClass, superClass); }

function ListToListTransfer_setPrototypeOf(o, p) { ListToListTransfer_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return ListToListTransfer_setPrototypeOf(o, p); }

function ListToListTransfer_createSuper(Derived) { var hasNativeReflectConstruct = ListToListTransfer_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = ListToListTransfer_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = ListToListTransfer_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return ListToListTransfer_possibleConstructorReturn(this, result); }; }

function ListToListTransfer_possibleConstructorReturn(self, call) { if (call && (ListToListTransfer_typeof(call) === "object" || typeof call === "function")) { return call; } return ListToListTransfer_assertThisInitialized(self); }

function ListToListTransfer_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function ListToListTransfer_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function ListToListTransfer_getPrototypeOf(o) { ListToListTransfer_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return ListToListTransfer_getPrototypeOf(o); }






__webpack_require__(1908);

var ListToListTransfer_ListToListTransfer = /*#__PURE__*/function (_Component) {
  ListToListTransfer_inherits(ListToListTransfer, _Component);

  var _super = ListToListTransfer_createSuper(ListToListTransfer);

  function ListToListTransfer() {
    var _this;

    ListToListTransfer_classCallCheck(this, ListToListTransfer);

    _this = _super.call(this);

    _this.handleTransfer = function (targetKeys, direction, moveKeys) {
      if (direction === 'right') {
        // 让新移动到右边的项添加到右边已有项的底部
        targetKeys = _this.props.targetKeys.concat(moveKeys);
      }

      _this.props.onTargetKeysChange(targetKeys);
    };

    _this.onCheck = function (sourceSelectedKeys, targetSelectedKeys) {
      _this.setState({
        targetSelectedKeys: targetSelectedKeys
      }, _this.changeDisabled);
    };

    _this.changeDisabled = function () {
      var targetKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.props.targetKeys;
      // 找到选中的targetSelectedKeys中每一项在targetKeys 对应的索引,组成indexAry
      // 对indexAry从小到大排序, 如果相邻两项的差都为1, 说明选中的是连续的节点, 否则不不连续
      var targetSelectedKeys = _this.state.targetSelectedKeys;
      var indexAry = targetSelectedKeys.map(function (item) {
        return targetKeys.indexOf(item);
      }).sort(function (a, b) {
        return a - b;
      });

      var continuous = function continuous() {
        if (indexAry.length > 1) {
          for (var i = 0; i < indexAry.length - 1; i++) {
            if (indexAry[i + 1] - indexAry[i] != 1) {
              return false;
            }
          }
        } else if (indexAry.length == 0) {
          return false;
        }

        return true;
      };

      var continuousFlag = continuous(); // console.log(indexAry, continuousFlag, 99);

      if (continuousFlag) {
        // 选中的是连续的
        // 选中的包含了目标框中的第一个元素，不能上移
        if (indexAry[0] === 0) {
          _this.setState({
            upDisabled: true
          });
        } else {
          _this.setState({
            upDisabled: false
          });
        } // 选中的包含了目标框中的最后一个元素，不能下移


        if (indexAry[indexAry.length - 1] === targetKeys.length - 1) {
          _this.setState({
            downDisabled: true
          });
        } else {
          _this.setState({
            downDisabled: false
          });
        }
      } else {
        _this.setState({
          upDisabled: true,
          downDisabled: true
        });
      }
    };

    _this.handleMove = function (direction) {
      var targetKeys = _this.props.targetKeys;
      var targetSelectedKeys = _this.state.targetSelectedKeys;
      var temp = JSON.parse(JSON.stringify(targetKeys));
      var indexAry = targetSelectedKeys.map(function (item) {
        return targetKeys.indexOf(item);
      }).sort(function (a, b) {
        return a - b;
      });
      var before = targetKeys.slice(0, indexAry[0]);
      var selected = targetSelectedKeys;
      var after = targetKeys.slice(indexAry[indexAry.length - 1] + 1, targetKeys.length);

      switch (direction) {
        case 'up':
          if (before.length > 0) {
            var lastBeforeItem = before[before.length - 1];
            before.splice(before.length - 1, 1);
            temp = [].concat(ListToListTransfer_toConsumableArray(before), ListToListTransfer_toConsumableArray(selected), [lastBeforeItem], ListToListTransfer_toConsumableArray(after));
          }

          break;

        case 'down':
          if (after.length > 0) {
            var firstAfterItem = after[0];
            after.splice(0, 1);
            temp = [].concat(ListToListTransfer_toConsumableArray(before), [firstAfterItem], ListToListTransfer_toConsumableArray(selected), ListToListTransfer_toConsumableArray(after));
          }

          break;

        case 'top':
          temp = [].concat(ListToListTransfer_toConsumableArray(selected), ListToListTransfer_toConsumableArray(before), ListToListTransfer_toConsumableArray(after));
          break;

        case 'bottom':
          temp = [].concat(ListToListTransfer_toConsumableArray(before), ListToListTransfer_toConsumableArray(after), ListToListTransfer_toConsumableArray(selected));
          break;

        default:
          break;
      }

      _this.handleTransfer(temp);

      _this.getRightSelectEle();

      _this.changeDisabled(temp);
    };

    _this.handleFilterOption = function (inputValue, option) {
      return option.title.indexOf(inputValue) > -1;
    };

    _this.getRightSelectEle = function () {
      var el = document.querySelector('li.u-transfer-list-content-item > label.is-checked > input[type="checkbox"]');
      setTimeout(function () {
        el && el.focus();
      }, 20);
    };

    _this.state = {
      serachKeyword: '',
      //搜索框的查询关键词
      upDisabled: true,
      //上移和置顶按钮的禁用状态
      downDisabled: true,
      //下移和置底按钮的禁用状态
      targetSelectedKeys: [],
      //目标框中选中的元素的key集合
      // 多语
      LangData: null,
      json: {}
    };
    return _this;
  }

  ListToListTransfer_createClass(ListToListTransfer, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      // 初始化调用getPlatformLang方法获取多语
      var callback = function callback(json, bool, LangData) {
        _this2.setState({
          json: json,
          LangData: LangData
        }, function () {//  在这里进行之前组件willMount的操作，比如加载缓存之类的
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'container_transfer',
        callback: callback
      }); // moduleId为所需加载json文件夹名称前缀
    } // 点击向左向右穿梭按钮

  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$props = this.props,
          className = _this$props.className,
          dataSource = _this$props.dataSource,
          targetKeys = _this$props.targetKeys,
          showSearch = _this$props.showSearch,
          listRender = _this$props.listRender,
          titles = _this$props.titles,
          operations = _this$props.operations,
          searchPlaceholder = _this$props.searchPlaceholder,
          notFoundContent = _this$props.notFoundContent,
          showMoveBtn = _this$props.showMoveBtn;
      titles = titles || [this.state.json['container-transfer-0001'], this.state.json['container-transfer-0002']];
      notFoundContent = notFoundContent || this.state.json['container-transfer-0003'];
      searchPlaceholder = searchPlaceholder || this.state.json['container-transfer-0004'];
      var _this$state = this.state,
          upDisabled = _this$state.upDisabled,
          downDisabled = _this$state.downDisabled;
      var transferClass = classnames_default()(ListToListTransfer_defineProperty({
        'transfer-wrap': true
      }, className, !!className));
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "list-to-list"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: transferClass,
        fieldid: Object(index_["getSysFieldid"])('transfer_area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Transfer"], {
        lazy: this.props.lazy,
        dataSource: dataSource,
        targetKeys: targetKeys,
        onChange: this.handleTransfer,
        onSelectChange: this.onCheck,
        filterOption: this.handleFilterOption,
        showSearch: showSearch,
        render: listRender,
        titles: titles,
        operations: operations,
        searchPlaceholder: searchPlaceholder,
        notFoundContent: notFoundContent
      }), showMoveBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "move-btns"
      }, upDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-top",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this3.handleMove('top');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-up"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-up-top'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-top",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this3.handleMove('top');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-up"
      }))), upDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-up",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this3.handleMove('up');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-up"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-up'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-up",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this3.handleMove('up');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-up"
      }))), downDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-down",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this3.handleMove('down');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-down"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-down'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-down",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this3.handleMove('down');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-down"
      }))), downDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-bottom",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this3.handleMove('bottom');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-down"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-down-bottom'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-bottom",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this3.handleMove('bottom');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-down"
      })))), this.props.children));
    }
  }]);

  return ListToListTransfer;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


ListToListTransfer_ListToListTransfer.defaultProps = {
  showSearch: false,
  // 是否显示搜索框
  showMoveBtn: false,
  //是否显示上移下移，置顶置底按钮
  // titles: [ '来源', '目标' ], // 两侧框的顶部标题
  operations: ['', ''],
  // 穿梭按钮的文字
  // searchPlaceholder: '请输入内容', // 搜索框的提示文字
  // notFoundContent: '暂无数据', // 列表为空时显示的内容
  dataSource: [],
  // 数据源
  targetKeys: [],
  // 目标框数据的 keys
  listRender: function listRender(_ref) {
    var title = _ref.title;
    return title;
  } // 列表渲染的字段内容

};
// EXTERNAL MODULE: ./node_modules/prop-types/index.js
var prop_types = __webpack_require__(2);
var prop_types_default = /*#__PURE__*/__webpack_require__.n(prop_types);

// EXTERNAL MODULE: ./node_modules/lodash/difference.js
var difference = __webpack_require__(766);
var difference_default = /*#__PURE__*/__webpack_require__.n(difference);

// CONCATENATED MODULE: ./src/platform/components/Transfer/TreeToListTransfer/methods.js
function TreeToListTransfer_methods_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { TreeToListTransfer_methods_typeof = function _typeof(obj) { return typeof obj; }; } else { TreeToListTransfer_methods_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return TreeToListTransfer_methods_typeof(obj); }

var hasUnLoadNode = function hasUnLoadNode(node) {
  var status = false;

  var loop = function loop(data) {
    return data.forEach(function (item) {
      if (item.props.children && !status) {
        if (item.props.children.length === 0) {
          status = true;
          return;
        } else {
          loop(item.props.children);
        }
      }
    });
  };

  loop(node);
  return status;
}; // ary数组中没有ele这个元素有则增加，有则删除，要求 ele 为基本数据类型

var toggle = function toggle(ary, ele) {
  if (TreeToListTransfer_methods_typeof(ele) === 'object') {
    console.error('参数错误,要求传入的元素是基本数据类型');
    return;
  }

  ary = JSON.parse(JSON.stringify(ary));
  var index = ary.indexOf(ele);

  if (index == -1) {
    ary.push(ele);
  } else {
    ary.splice(index, 1);
  }

  return ary;
};
// CONCATENATED MODULE: ./src/platform/components/Transfer/TreeToListTransfer/index.js
function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || TreeToListTransfer_unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function TreeToListTransfer_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function TreeToListTransfer_toConsumableArray(arr) { return TreeToListTransfer_arrayWithoutHoles(arr) || TreeToListTransfer_iterableToArray(arr) || TreeToListTransfer_unsupportedIterableToArray(arr) || TreeToListTransfer_nonIterableSpread(); }

function TreeToListTransfer_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function TreeToListTransfer_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return TreeToListTransfer_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return TreeToListTransfer_arrayLikeToArray(o, minLen); }

function TreeToListTransfer_iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function TreeToListTransfer_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return TreeToListTransfer_arrayLikeToArray(arr); }

function TreeToListTransfer_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function TreeToListTransfer_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { TreeToListTransfer_typeof = function _typeof(obj) { return typeof obj; }; } else { TreeToListTransfer_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return TreeToListTransfer_typeof(obj); }

function TreeToListTransfer_extends() { TreeToListTransfer_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return TreeToListTransfer_extends.apply(this, arguments); }

function TreeToListTransfer_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = TreeToListTransfer_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function TreeToListTransfer_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return TreeToListTransfer_typeof(key) === "symbol" ? key : String(key); }

function _toPrimitive(input, hint) { if (TreeToListTransfer_typeof(input) !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (TreeToListTransfer_typeof(res) !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }

function TreeToListTransfer_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function TreeToListTransfer_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function TreeToListTransfer_createClass(Constructor, protoProps, staticProps) { if (protoProps) TreeToListTransfer_defineProperties(Constructor.prototype, protoProps); if (staticProps) TreeToListTransfer_defineProperties(Constructor, staticProps); return Constructor; }

function TreeToListTransfer_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) TreeToListTransfer_setPrototypeOf(subClass, superClass); }

function TreeToListTransfer_setPrototypeOf(o, p) { TreeToListTransfer_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return TreeToListTransfer_setPrototypeOf(o, p); }

function TreeToListTransfer_createSuper(Derived) { var hasNativeReflectConstruct = TreeToListTransfer_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = TreeToListTransfer_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = TreeToListTransfer_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return TreeToListTransfer_possibleConstructorReturn(this, result); }; }

function TreeToListTransfer_possibleConstructorReturn(self, call) { if (call && (TreeToListTransfer_typeof(call) === "object" || typeof call === "function")) { return call; } return TreeToListTransfer_assertThisInitialized(self); }

function TreeToListTransfer_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function TreeToListTransfer_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function TreeToListTransfer_getPrototypeOf(o) { TreeToListTransfer_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return TreeToListTransfer_getPrototypeOf(o); }

/**
 * Todo
 * 异步树处理
 * 搜索点击 X 号清除搜索数据
 * 勾选相邻的实现排序
 * 带着子级穿梭
 */

/**
 * 逻辑说明：
 * props.checkable 为 true 时，树带复选框，只有叶子节点可以穿梭到右边，勾选复选框选中实现穿梭；
 * props.checkable 为 false 时，树不带复选框，所有节点都可以穿梭到右边，通过点击树节点选中实现穿梭
*/








__webpack_require__(1907);

var TreeToListTransfer_TreeNode = base_index_["Tree"].TreeNode;

var TreeToListTransfer_TreeToListTransfer = /*#__PURE__*/function (_Component) {
  TreeToListTransfer_inherits(TreeToListTransfer, _Component);

  var _super = TreeToListTransfer_createSuper(TreeToListTransfer);

  function TreeToListTransfer(_props) {
    var _this;

    TreeToListTransfer_classCallCheck(this, TreeToListTransfer);

    _this = _super.call(this, _props);

    _this.generate = function (props) {
      var state = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var dataSource = props.dataSource,
          targetKeys = props.targetKeys,
          rowKey = props.rowKey,
          rowTitle = props.rowTitle,
          rowChildren = props.rowChildren,
          showSearch = props.showSearch,
          showListSearch = props.showListSearch,
          listRender = props.listRender;
      var treeSearchKey = state.treeSearchKey;
      var leafKeys = []; // 叶子节点 key 的集合

      var listData = []; // 列表数据

      var expandedKeys = []; // 搜索时 展开的节点

      var leafNodes = []; // 叶子节点集合

      var treeData = []; // 所有节点集合
      // title 前icon 通过 jsx  HTML和content

      var getIcon = function getIcon(el) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "iconfont"
        }), el);
      };

      var loop = function loop(data) {
        return data.map(function (item) {
          var children = item[rowChildren],
              key = item[rowKey],
              title = item[rowTitle],
              otherProps = TreeToListTransfer_objectWithoutProperties(item, [rowChildren, rowKey, rowTitle].map(_toPropertyKey));

          treeData.push({
            key: key,
            title: title
          });

          if (Object.prototype.toString.call(children) !== '[object Array]') {
            leafKeys.push(key);
            var nodeTitle = listRender(item);

            if (showSearch && treeSearchKey && treeSearchKey.length > 0) {
              // if tree searching
              if (title.indexOf(treeSearchKey) > -1) {
                expandedKeys.push(key);
                var idx = nodeTitle.indexOf(treeSearchKey);
                nodeTitle = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, nodeTitle.substr(0, idx), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                  style: {
                    color: '#f50'
                  }
                }, treeSearchKey), nodeTitle.substr(idx + treeSearchKey.length));
              }
            }

            leafNodes.push({
              key: key,
              title: nodeTitle
            });
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeToListTransfer_TreeNode, TreeToListTransfer_extends({}, otherProps, {
              className: "node-item",
              key: key,
              title: getIcon(nodeTitle),
              disableCheckbox: _this.props.disable,
              isLeaf: true
            }));
          } else {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeToListTransfer_TreeNode, TreeToListTransfer_extends({}, otherProps, {
              className: "node-item",
              key: key,
              title: getIcon(listRender(item)),
              disableCheckbox: _this.props.disable
            }), loop(item.children));
          }
        });
      };

      var treeNode = loop(dataSource);
      targetKeys.map(function (key) {
        var listItem = treeData.find(function (cur) {
          return cur.key == key;
        });
        listItem && listData.push(listItem);
      });
      return {
        treeNode: treeNode,
        leafKeys: leafKeys,
        listData: listData,
        expandedKeys: expandedKeys,
        treeData: treeData
      };
    };

    _this.onTreeCheck = function (checkedKeys, e) {
      var checked = TreeToListTransfer_typeof(e) === 'object' ? e.checked : e;

      if (checked) {
        if (_this.props.onLoadData && hasUnLoadNode([e.node])) {
          _this.setState({
            unLoadAlert: true
          });
        } else {
          _this.setState({
            treeCheckedKeys: checkedKeys.filter(function (key) {
              return _this.state.leafKeys.indexOf(key) > -1;
            }),
            unLoadAlert: false
          });
        }
      } else {
        _this.setState({
          treeCheckedKeys: checkedKeys.filter(function (key) {
            return _this.state.leafKeys.indexOf(key) > -1;
          }),
          unLoadAlert: false
        });
      }
    };

    _this.onListCheck = function (value, checkedKeys) {
      var keys = _this.props.checkable ? 'listCheckedKeys' : 'listSelectedKeys';

      if (value) {
        _this.setState(TreeToListTransfer_defineProperty({}, keys, TreeToListTransfer_toConsumableArray(new Set([].concat(TreeToListTransfer_toConsumableArray(_this.state[keys]), TreeToListTransfer_toConsumableArray(checkedKeys))))), _this.changeDisabled);
      } else {
        _this.setState(TreeToListTransfer_defineProperty({}, keys, _this.state[keys].filter(function (key) {
          return checkedKeys.indexOf(key) < 0;
        })), _this.changeDisabled);
      }
    };

    _this.onTreeSelect = function (treeSelectedKeys, info) {
      if (_this.props.checkable) return false; // 如果有复选框，就不能点击选中树节点

      _this.setState({
        treeSelectedKeys: treeSelectedKeys
      });
    };

    _this.onListSelect = function (key) {
      // console.log('点击列表项 ', key);
      var keys = _this.props.checkable ? 'listCheckedKeys' : 'listSelectedKeys';

      _this.setState(TreeToListTransfer_defineProperty({}, keys, toggle(_this.state[keys], key)), _this.changeDisabled);
    };

    _this.onTreeSearch = function (value) {
      _this.setState({
        treeSearchKey: value
      }, function () {
        if (_this.props.onLoadData && _this.props.onTreeSearch) {
          // async search
          _this.props.onTreeSearch(value);
        } else {
          var _this$generate = _this.generate(_this.props, _this.state),
              treeNode = _this$generate.treeNode,
              listData = _this$generate.listData,
              leafKeys = _this$generate.leafKeys,
              expandedKeys = _this$generate.expandedKeys;

          var treeCheckedKeys = listData.map(function (_ref) {
            var key = _ref.key;
            return key;
          });

          _this.setState({
            treeNode: treeNode,
            listData: listData,
            leafKeys: leafKeys,
            treeCheckedKeys: treeCheckedKeys,
            treeExpandedKeys: TreeToListTransfer_toConsumableArray(new Set([].concat(TreeToListTransfer_toConsumableArray(treeCheckedKeys), TreeToListTransfer_toConsumableArray(expandedKeys)))),
            treeAutoExpandParent: true // 搜索的时候 自动展开父节点设为true

          });
        }
      });
    };

    _this.onListSearch = function (value) {
      _this.setState({
        listSearchKey: value
      });
    };

    _this.changeDisabled = function () {
      var targetKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.props.targetKeys;
      // 找到选中的targetSelectedKeys中每一项在targetKeys 对应的索引,组成indexAry
      // 对indexAry从小到大排序, 如果相邻两项的差都为1, 说明选中的是连续的节点, 否则不不连续
      var _this$state = _this.state,
          listCheckedKeys = _this$state.listCheckedKeys,
          listSelectedKeys = _this$state.listSelectedKeys;
      var keysAry = _this.props.checkable ? listCheckedKeys : listSelectedKeys;
      var indexAry = keysAry.map(function (item) {
        return targetKeys.indexOf(item);
      }).sort(function (a, b) {
        return a - b;
      });

      var continuous = function continuous() {
        if (indexAry.length > 1) {
          for (var i = 0; i < indexAry.length - 1; i++) {
            if (indexAry[i + 1] - indexAry[i] != 1) {
              return false;
            }
          }
        } else if (indexAry.length == 0) {
          return false;
        }

        return true;
      };

      var continuousFlag = continuous();

      if (continuousFlag) {
        // 选中的是连续的
        // 选中的包含了目标框中的第一个元素，不能上移
        if (indexAry[0] === 0) {
          _this.setState({
            upDisabled: true
          });
        } else {
          _this.setState({
            upDisabled: false
          });
        } // 选中的包含了目标框中的最后一个元素，不能下移


        if (indexAry[indexAry.length - 1] === targetKeys.length - 1) {
          _this.setState({
            downDisabled: true
          });
        } else {
          _this.setState({
            downDisabled: false
          });
        }
      } else {
        _this.setState({
          upDisabled: true,
          downDisabled: true
        });
      }
    };

    _this.handleMove = function (direction) {
      var _this$props = _this.props,
          targetKeys = _this$props.targetKeys,
          checkable = _this$props.checkable;
      var _this$state2 = _this.state,
          listCheckedKeys = _this$state2.listCheckedKeys,
          listSelectedKeys = _this$state2.listSelectedKeys;
      var temp = JSON.parse(JSON.stringify(targetKeys));
      var keysAry = checkable ? listCheckedKeys : listSelectedKeys;
      var indexAry = keysAry.map(function (item) {
        return targetKeys.indexOf(item);
      }).sort(function (a, b) {
        return a - b;
      });
      var before = targetKeys.slice(0, indexAry[0]);
      var selected = keysAry;
      var after = targetKeys.slice(indexAry[indexAry.length - 1] + 1, targetKeys.length);

      switch (direction) {
        case 'up':
          if (before.length > 0) {
            var lastBeforeItem = before[before.length - 1];
            before.splice(before.length - 1, 1);
            temp = [].concat(TreeToListTransfer_toConsumableArray(before), TreeToListTransfer_toConsumableArray(selected), [lastBeforeItem], TreeToListTransfer_toConsumableArray(after));
          }

          break;

        case 'down':
          if (after.length > 0) {
            var firstAfterItem = after[0];
            after.splice(0, 1);
            temp = [].concat(TreeToListTransfer_toConsumableArray(before), [firstAfterItem], TreeToListTransfer_toConsumableArray(selected), TreeToListTransfer_toConsumableArray(after));
          }

          break;

        case 'top':
          temp = [].concat(TreeToListTransfer_toConsumableArray(selected), TreeToListTransfer_toConsumableArray(before), TreeToListTransfer_toConsumableArray(after));
          break;

        case 'bottom':
          temp = [].concat(TreeToListTransfer_toConsumableArray(before), TreeToListTransfer_toConsumableArray(after), TreeToListTransfer_toConsumableArray(selected));
          break;

        default:
          break;
      }

      _this.props.onTargetKeysChange(temp);

      _this.getRightSelectEle();

      _this.changeDisabled(temp);
    };

    _this.getRightSelectEle = function () {
      var el = document.querySelector('li.u-transfer-list-content-item > label.is-checked > input[type="checkbox"]');
      setTimeout(function () {
        el && el.focus();
      }, 20);
    };

    var _this$generate2 = _this.generate(_props),
        _treeNode = _this$generate2.treeNode,
        _listData = _this$generate2.listData,
        _leafKeys = _this$generate2.leafKeys,
        _treeData = _this$generate2.treeData;

    var _treeCheckedKeys = [];
    var _treeSelectedKeys = [];

    var _targetKeys = _listData.map(function (_ref2) {
      var key = _ref2.key;
      return key;
    });

    _props.checkable ? _treeCheckedKeys = _targetKeys : _treeSelectedKeys = _targetKeys;
    _this.state = {
      treeNode: _treeNode,
      // 树的树型数据
      treeData: _treeData,
      // 树所有的扁平数据
      listData: _listData,
      // 列表的扁平数据
      leafKeys: _leafKeys,
      // 树的叶子节点的 key 集合
      treeCheckedKeys: _treeCheckedKeys,
      // 树复选框选中的 key 集合
      treeSelectedKeys: _treeSelectedKeys,
      // 树节点选中的 key 集合
      treeExpandedKeys: _treeCheckedKeys,
      // 树展开的节点的 key集合
      treeAutoExpandParent: true,
      // 自动展开父节点 初始为true 有展开操作的时候为false
      listCheckedKeys: [],
      // 目标框列表勾选中的 key 集合
      listSelectedKeys: [],
      // 目标框列表点击选中的 key 集合
      treeSearchKey: '',
      // 树的搜索关键词
      listSearchKey: '',
      // 列表的搜索关键词
      unLoadAlert: false,
      // 异步加载提示显示状态
      upDisabled: true,
      // 上移禁用状态
      downDisabled: true,
      //下移禁用状态
      // 多语
      LangData: null,
      json: {}
    };
    return _this;
  }

  TreeToListTransfer_createClass(TreeToListTransfer, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var _this$setState4,
          _this2 = this;

      var _this$generate3 = this.generate(nextProps, this.state),
          treeNode = _this$generate3.treeNode,
          listData = _this$generate3.listData,
          leafKeys = _this$generate3.leafKeys,
          expandedKeys = _this$generate3.expandedKeys;

      var keys = this.props.checkable ? 'treeCheckedKeys' : 'treeSelectedKeys'; // 根据 checkable 来决定是修改树的 checked 还是 selected keys 的值；

      var selected = listData.map(function (_ref3) {
        var key = _ref3.key;
        return key;
      });
      var _this$state3 = this.state,
          treeSearchKey = _this$state3.treeSearchKey,
          treeExpandedKeys = _this$state3.treeExpandedKeys;
      var searching = !!(nextProps.showSearch && treeSearchKey && treeSearchKey.length > 0);
      this.setState((_this$setState4 = {
        treeNode: treeNode,
        listData: listData,
        leafKeys: leafKeys
      }, TreeToListTransfer_defineProperty(_this$setState4, keys, selected), TreeToListTransfer_defineProperty(_this$setState4, "treeExpandedKeys", searching ? TreeToListTransfer_toConsumableArray(new Set([keys].concat(TreeToListTransfer_toConsumableArray(expandedKeys)))) : treeExpandedKeys), TreeToListTransfer_defineProperty(_this$setState4, "treeAutoExpandParent", searching), _this$setState4), function () {
        return _this2.changeDisabled(nextProps.targetKeys);
      });
    }
  }, {
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this3 = this;

      // 初始化调用getPlatformLang方法获取多语
      var callback = function callback(json, bool, LangData) {
        _this3.setState({
          json: json,
          LangData: LangData
        }, function () {//  在这里进行之前组件willMount的操作，比如加载缓存之类的
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'container_transfer',
        callback: callback
      }); // moduleId为所需加载json文件夹名称前缀
    } // 根据传进来的 props 数据生成本页面需要的各种数据

  }, {
    key: "render",
    value: function render() {
      var _this4 = this;

      var _this$props2 = this.props,
          className = _this$props2.className,
          treeLoading = _this$props2.treeLoading,
          titles = _this$props2.titles,
          showSearch = _this$props2.showSearch,
          showListSearch = _this$props2.showListSearch,
          onLoadData = _this$props2.onLoadData,
          operations = _this$props2.operations,
          searchPlaceholder = _this$props2.searchPlaceholder,
          notFoundContent = _this$props2.notFoundContent,
          showMoveBtn = _this$props2.showMoveBtn,
          style = _this$props2.style,
          checkable = _this$props2.checkable,
          disable = _this$props2.disable;
      titles = titles || [this.state.json['container-transfer-0001'], this.state.json['container-transfer-0002']];
      notFoundContent = notFoundContent || this.state.json['container-transfer-0003'];
      searchPlaceholder = searchPlaceholder || this.state.json['container-transfer-0004'];

      var _titles = titles,
          _titles2 = _slicedToArray(_titles, 2),
          sourceTitle = _titles2[0],
          targetTitle = _titles2[1];

      var _this$state4 = this.state,
          treeNode = _this$state4.treeNode,
          treeData = _this$state4.treeData,
          listData = _this$state4.listData,
          leafKeys = _this$state4.leafKeys,
          treeCheckedKeys = _this$state4.treeCheckedKeys,
          treeSelectedKeys = _this$state4.treeSelectedKeys,
          listCheckedKeys = _this$state4.listCheckedKeys,
          listSelectedKeys = _this$state4.listSelectedKeys,
          treeExpandedKeys = _this$state4.treeExpandedKeys,
          treeAutoExpandParent = _this$state4.treeAutoExpandParent,
          listSearchKey = _this$state4.listSearchKey,
          unLoadAlert = _this$state4.unLoadAlert,
          upDisabled = _this$state4.upDisabled,
          downDisabled = _this$state4.downDisabled;
      var leftTemp = checkable ? treeCheckedKeys : treeSelectedKeys; // 左边选中的 key 集合

      var validTreeNum = checkable ? leafKeys.length : treeData.length; // 树中可以穿梭到列表中有效的数据的总数

      var rightTemp = checkable ? listCheckedKeys : listSelectedKeys; // 右边选中的 key 集合

      var treeTransferClass = classnames_default()(TreeToListTransfer_defineProperty({
        'transfer-wrap': true
      }, className, !!className));
      var treeTransferlistBodyClass = classnames_default()({
        'u-transfer-list-body': true,
        'u-transfer-list-body-with-search': showSearch
      });
      var treeTransferlistBodyClassRight = classnames_default()({
        'u-transfer-list-body': true,
        'u-transfer-list-body-with-search': showListSearch
      });
      var openIcon = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf-reduce-s-o"
      });
      var closeIcon = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf-add-s-o"
      });
      var treeProps = {
        checkable: checkable,
        multiple: !checkable,
        showLine: false,
        checkedKeys: treeCheckedKeys,
        selectedKeys: treeSelectedKeys,
        onSelect: this.onTreeSelect,
        onCheck: this.onTreeCheck,
        expandedKeys: treeExpandedKeys,
        autoExpandParent: treeAutoExpandParent,
        onExpand: function onExpand(expandedKeys) {
          _this4.setState({
            treeAutoExpandParent: false,
            treeExpandedKeys: expandedKeys
          });
        },
        loadData: onLoadData,
        openIcon: openIcon,
        closeIcon: closeIcon
      };
      var sourceHeaderCheckProps = {
        checked: treeCheckedKeys.length > 0 && treeCheckedKeys.length === leafKeys.length,
        indeterminate: treeCheckedKeys.length > 0 && treeCheckedKeys.length < leafKeys.length,
        onChange: function onChange(value) {
          var checkedKeys = value ? leafKeys : [];

          _this4.onTreeCheck(checkedKeys, value);
        }
      };
      var keys = checkable ? 'listCheckedKeys' : 'listSelectedKeys';
      var listHeaderCheckProps = {
        checked: this.state[keys].length > 0 && this.state[keys].length === listData.length,
        indeterminate: this.state[keys].length > 0 && this.state[keys].length < listData.length,
        onChange: function onChange(value) {
          return _this4.onListCheck(value, listData.map(function (_ref4) {
            var key = _ref4.key;
            return key;
          }));
        }
      };
      var operaRightButtonProps = {
        className: 'btn-primary',
        size: 'sm',
        disabled: difference_default()(leftTemp, listData.map(function (_ref5) {
          var key = _ref5.key;
          return key;
        })).length === 0 && difference_default()(listData.map(function (_ref6) {
          var key = _ref6.key;
          return key;
        }), leftTemp).length === 0,
        onClick: function onClick() {
          _this4.setState({
            unLoadAlert: false
          });

          _this4.props.onTargetKeysChange && _this4.props.onTargetKeysChange(leftTemp);
        }
      };
      var operaLeftButtonProps = {
        className: 'btn-primary',
        size: 'sm',
        disabled: rightTemp.length === 0,
        onClick: function onClick() {
          _this4.setState({
            listCheckedKeys: [],
            listSelectedKeys: [],
            unLoadAlert: false
          });

          var restTargetKeys = _this4.state.listData.map(function (_ref7) {
            var key = _ref7.key;
            return key;
          }).filter(function (key) {
            return rightTemp.indexOf(key) < 0;
          }); //剩下的目标项


          _this4.props.onTargetKeysChange && _this4.props.onTargetKeysChange(restTargetKeys);
        }
      }; // all to right

      var operaAllRightButtonProps = {
        className: 'btn-primary',
        size: 'sm',
        disabled: disable || false,
        onClick: function onClick() {
          _this4.setState({
            unLoadAlert: false
          });

          _this4.props.onTargetKeysChange && _this4.props.onTargetKeysChange(leafKeys, 'allToRight');
        }
      }; // all to left

      var operaAllLeftButtonProps = {
        className: 'btn-primary',
        size: 'sm',
        disabled: this.state.listData.length === 0,
        onClick: function onClick() {
          _this4.setState({
            listCheckedKeys: [],
            listSelectedKeys: [],
            unLoadAlert: false
          });

          _this4.props.onTargetKeysChange && _this4.props.onTargetKeysChange([], 'allToLeft');
        }
      };
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: treeTransferClass
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer",
        fieldid: Object(index_["getSysFieldid"])('transfer_area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list u-transfer-list-left",
        fieldid: Object(index_["getSysFieldid"])('left_area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list-header"
      }, checkable && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], TreeToListTransfer_extends({
        disabled: disable
      }, sourceHeaderCheckProps)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "u-transfer-list-header-selected"
      }, "".concat(leftTemp.length > 0 ? "".concat(leftTemp.length, "/") : '').concat(validTreeNum, " "), this.state.json['container-transfer-0005']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "u-transfer-list-header-title"
      }, sourceTitle)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: treeTransferlistBodyClass
      }, showSearch ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list-body-search-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        type: "search",
        placeholder: searchPlaceholder,
        onChange: this.onTreeSearch,
        value: this.state.treeSearchKey
      })) : null, unLoadAlert ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "tree-transfer-panel-body-alert"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Alert"], {
        dark: true,
        onDismiss: function onDismiss() {
          return _this4.setState({
            unLoadAlert: false
          });
        },
        closeLabel: "\u5173\u95ED"
      }, "\u65E0\u6CD5\u9009\u4E2D\uFF0C\u539F\u56E0\uFF1A\u5B50\u8282\u70B9\u672A\u5B8C\u5168\u52A0\u8F7D")) : null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list-content"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tree"], treeProps, treeNode)), this.props.dataSource.length === 0 && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        style: {
          display: 'block'
        },
        className: "u-transfer-list-body-not-found"
      }, notFoundContent))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-operation"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-right'] || 'ssss',
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], operaRightButtonProps, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, operations[0], /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        className: "uf uf-arrow-right"
      })))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-right-all'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], operaAllRightButtonProps, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        className: "uf uf-2arrow-right"
      })))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-left-all'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], operaAllLeftButtonProps, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        className: "uf uf-2arrow-left"
      })))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-left'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], operaLeftButtonProps, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        className: "uf uf-arrow-left"
      }), operations[1])))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list u-transfer-list-right",
        fieldid: Object(index_["getSysFieldid"])('right_area')
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list-header"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], listHeaderCheckProps), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "u-transfer-list-header-select"
      }, "".concat(rightTemp.length > 0 ? "".concat(rightTemp.length, "/") : '').concat(listData.length, " "), this.state.json['container-transfer-0005']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "u-transfer-list-header-title"
      }, targetTitle)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: treeTransferlistBodyClassRight
      }, showListSearch ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "u-transfer-list-body-search-wrapper"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        type: "search",
        placeholder: searchPlaceholder,
        onChange: this.onListSearch,
        value: this.state.listSearchKey
      })) : null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", {
        className: "u-transfer-list-content"
      }, listData.map(function (item) {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
          className: listSelectedKeys.indexOf(item.key) == -1 ? 'u-transfer-list-content-item' : 'u-transfer-list-content-item u-transfer-list-content-item-selected',
          key: item.key,
          title: item.title,
          onClick: function onClick() {
            return _this4.onListSelect(item.key);
          }
        }, checkable && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
          checked: listCheckedKeys.indexOf(item.key) > -1,
          onChange: function onChange(value) {
            return _this4.onListCheck(value, [item.key]);
          }
        }), showSearch && listSearchKey && listSearchKey.length > 0 && item.title.indexOf(listSearchKey) > -1 ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          style: {
            verticalAlign: 'top'
          }
        }, item.title.substr(0, item.title.indexOf(listSearchKey)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          style: {
            color: '#f50'
          }
        }, listSearchKey), item.title.substr(item.title.indexOf(listSearchKey) + listSearchKey.length)) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, item.title));
      }), listData.length === 0 && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        style: {
          display: 'block'
        },
        className: "u-transfer-list-body-not-found"
      }, notFoundContent))))), showMoveBtn && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "move-btns"
      }, upDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-up",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this4.handleMove('up');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-up"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-up'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-up",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this4.handleMove('up');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-up"
      }))), downDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-down",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this4.handleMove('down');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-down"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-down'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-down",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this4.handleMove('down');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-arrow-down"
      }))), upDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-top",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this4.handleMove('top');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-up"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-up-top'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-top",
        disabled: upDisabled,
        onClick: function onClick() {
          return _this4.handleMove('top');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-up"
      }))), downDisabled ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-bottom",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this4.handleMove('bottom');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-down"
      })) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tooltip"], {
        placement: "top",
        overlay: this.state.json['container-transfer-down-bottom'],
        delayHide: 1,
        delayShow: 1000
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        className: "move-btn move-bottom",
        disabled: downDisabled,
        onClick: function onClick() {
          return _this4.handleMove('bottom');
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Icon"], {
        type: "uf uf-2arrow-down"
      })))), this.props.children);
    }
  }]);

  return TreeToListTransfer;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


TreeToListTransfer_TreeToListTransfer.propTypes = {
  style: prop_types_default.a.object,
  showSearch: prop_types_default.a.bool,
  showListSearch: prop_types_default.a.bool,
  // 右侧列表搜索框
  showMoveBtn: prop_types_default.a.bool,
  checkable: prop_types_default.a.bool,
  // titles: PropTypes.array,
  treeLoading: prop_types_default.a.bool,
  className: prop_types_default.a.string,
  rowKey: prop_types_default.a.string,
  rowTitle: prop_types_default.a.string,
  rowChildren: prop_types_default.a.string,
  // searchPlaceholder: PropTypes.string,
  // notFoundContent: PropTypes.string,
  operations: prop_types_default.a.array,
  dataSource: prop_types_default.a.array,
  targetKeys: prop_types_default.a.array,
  listRender: prop_types_default.a.func,
  onTargetKeysChange: prop_types_default.a.func,
  onLoadData: prop_types_default.a.func,
  onTreeSearch: prop_types_default.a.func,
  disable: prop_types_default.a.bool
};
TreeToListTransfer_TreeToListTransfer.defaultProps = {
  // 显示tree search
  showSearch: true,
  showListSearch: false,
  showMoveBtn: false,
  checkable: true,
  disable: false,
  // titles: [ '来源', '目标' ],
  operations: ['', ''],
  rowKey: 'key',
  rowTitle: 'title',
  rowChildren: 'children',
  dataSource: [],
  targetKeys: [],
  treeLoading: false,
  // searchPlaceholder: '提示词', // 搜索框的提示文字
  // notFoundContent: '暂无数据', // 列表为空时显示的内容
  listRender: function listRender(_ref8) {
    var title = _ref8.title;
    return title;
  } // 列表渲染的字段内容

};
// CONCATENATED MODULE: ./src/platform/components/Transfer/index.js
function Transfer_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { Transfer_typeof = function _typeof(obj) { return typeof obj; }; } else { Transfer_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return Transfer_typeof(obj); }

function Transfer_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = Transfer_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function Transfer_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function Transfer_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function Transfer_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function Transfer_createClass(Constructor, protoProps, staticProps) { if (protoProps) Transfer_defineProperties(Constructor.prototype, protoProps); if (staticProps) Transfer_defineProperties(Constructor, staticProps); return Constructor; }

function Transfer_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) Transfer_setPrototypeOf(subClass, superClass); }

function Transfer_setPrototypeOf(o, p) { Transfer_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return Transfer_setPrototypeOf(o, p); }

function Transfer_createSuper(Derived) { var hasNativeReflectConstruct = Transfer_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = Transfer_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = Transfer_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return Transfer_possibleConstructorReturn(this, result); }; }

function Transfer_possibleConstructorReturn(self, call) { if (call && (Transfer_typeof(call) === "object" || typeof call === "function")) { return call; } return Transfer_assertThisInitialized(self); }

function Transfer_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function Transfer_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function Transfer_getPrototypeOf(o) { Transfer_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return Transfer_getPrototypeOf(o); }

/*
 * @Author: hufei 
 * @PageInfo: 两种穿梭框合并后的外壳
 * @Date: 2018-04-13 15:38:49 
 * @Last Modified by: hufei
 * @Last Modified time: 2018-06-07 17:11:46
 */




var Transfer_Transfer = /*#__PURE__*/function (_Component) {
  Transfer_inherits(Transfer, _Component);

  var _super = Transfer_createSuper(Transfer);

  function Transfer() {
    Transfer_classCallCheck(this, Transfer);

    return _super.apply(this, arguments);
  }

  Transfer_createClass(Transfer, [{
    key: "render",
    value: function render() {
      var _this$props = this.props,
          treeType = _this$props.treeType,
          others = Transfer_objectWithoutProperties(_this$props, ["treeType"]);

      return treeType ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeToListTransfer_TreeToListTransfer, others) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(ListToListTransfer_ListToListTransfer, others);
    }
  }]);

  return Transfer;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// EXTERNAL MODULE: ./src/platform/components/TreeTable/index.js + 7 modules
var TreeTable = __webpack_require__(422);

// EXTERNAL MODULE: ./src/platform/components/WithAutoFocus/index.js
var components_WithAutoFocus = __webpack_require__(745);

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/index.js
var WithKeyboardChange = __webpack_require__(746);

// EXTERNAL MODULE: external {"root":"axios","var":"axios","commonjs":"axios","commonjs2":"axios","amd":"axios"}
var external_root_axios_var_axios_commonjs_axios_commonjs2_axios_amd_axios_ = __webpack_require__(62);
var external_root_axios_var_axios_commonjs_axios_commonjs2_axios_amd_axios_default = /*#__PURE__*/__webpack_require__.n(external_root_axios_var_axios_commonjs_axios_commonjs2_axios_amd_axios_);

// CONCATENATED MODULE: ./src/platform/components/MutiInit/index.js
//import intl from 'react-intl-universal';


var localeLang = Object(index_["getLangCode"])() || 'simpchn';
function MutiInit_init(moduleId, callback, domainName) {
  var _this = this;

  var domainPath = domainName ? "../../../../".concat(domainName, "/public/lang/") : '../../../public/lang/';

  var _dir = NODE_ENV == 'development' ? '../src/platform/public/lang/' : domainPath;

  if (moduleId) {
    // axios.get(`${_dir}customer/${localeLang}/${moduleId}.json`)
    external_root_axios_var_axios_commonjs_axios_commonjs2_axios_amd_axios_default.a.get("".concat(_dir, "standard/").concat(localeLang, "/").concat(moduleId, ".json")).then(function (res) {
      if (res) {
        setRes.call(_this, moduleId, res.data, callback);
      }
    })["catch"](function (error) {
      //  加载industry
      external_root_axios_var_axios_commonjs_axios_commonjs2_axios_amd_axios_default.a.get("".concat(_dir, "industry/").concat(localeLang, "/").concat(moduleId, ".json")).then(function (res) {
        if (res) {
          setRes.call(_this, moduleId, res.data, callback);
        }
      })["catch"](function (error) {
        //  加载standard
        // axios.get(`${_dir}standard/${localeLang}/${moduleId}.json`)
        external_root_axios_var_axios_commonjs_axios_commonjs2_axios_amd_axios_default.a.get("".concat(_dir, "customer/").concat(localeLang, "/").concat(moduleId, ".json")).then(function (res) {
          // console.log(moduleId, '------')
          if (res) {
            setRes.call(_this, moduleId, res.data, callback);
          }
        })["catch"](function (res) {
          callback && callback(res.data, false, {});
        });
      });
    });
  }
}

function setRes(moduleId, data, callback) {
  if (this.state.intl) {
    this.state.intl = {};
  }

  if (!this.state.intl[moduleId]) this.state.intl[moduleId] = {};
  this.state.intl[moduleId][localeLang] = data;
  this.setState({
    intl: this.state.intl
  }, function () {
    callback && callback(data, true, {});
  });
} // 获取多语插件 


function getIntl(moduleId) {
  var _this2 = this;

  if (!moduleId) {
    return;
  }

  return {
    get: function get(code, valMap) {
      if (_this2.state.intl[moduleId] && _this2.state.intl[moduleId][localeLang]) {
        var langJson = _this2.state.intl[moduleId][localeLang][code];

        if (Object(index_["isObj"])(valMap)) {
          for (var pop in valMap) {
            if (langJson.includes("{".concat(pop, "}"))) {
              var reg = new RegExp('{\\s*' + pop + '\\s*}', 'g');
              langJson = langJson.replace(reg, valMap[pop]);
            }
          }
        }

        return langJson;
      }
    }
  };
}
// CONCATENATED MODULE: ./src/platform/components/FormulaEditor/components/metaattr.jsx
function metaattr_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { metaattr_typeof = function _typeof(obj) { return typeof obj; }; } else { metaattr_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return metaattr_typeof(obj); }

function metaattr_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function metaattr_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function metaattr_createClass(Constructor, protoProps, staticProps) { if (protoProps) metaattr_defineProperties(Constructor.prototype, protoProps); if (staticProps) metaattr_defineProperties(Constructor, staticProps); return Constructor; }

function metaattr_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) metaattr_setPrototypeOf(subClass, superClass); }

function metaattr_setPrototypeOf(o, p) { metaattr_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return metaattr_setPrototypeOf(o, p); }

function metaattr_createSuper(Derived) { var hasNativeReflectConstruct = metaattr_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = metaattr_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = metaattr_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return metaattr_possibleConstructorReturn(this, result); }; }

function metaattr_possibleConstructorReturn(self, call) { if (call && (metaattr_typeof(call) === "object" || typeof call === "function")) { return call; } return metaattr_assertThisInitialized(self); }

function metaattr_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function metaattr_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function metaattr_getPrototypeOf(o) { metaattr_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return metaattr_getPrototypeOf(o); }

/**
 * zhanghengh
 * 18/5/31
 * 公式编辑器的搜索树部分，用的包装后的钉耙Tree和Input，如有问题，可以参考钉耙的搜索树的例子
 * 后端是汪建伟
 */


var metaattr_TreeNode = base_index_["Tree"].TreeNode;


__webpack_require__(1910);

var metaattr_dataList = []; //自己得到的key和title的数组   这里以后有时间优化一下，这个dataList

var pathList = []; //已经加载过得节点路径，记录下来，再次展开就不再发请求

var metaattr_MetaAttr = /*#__PURE__*/function (_Component) {
  metaattr_inherits(MetaAttr, _Component);

  var _super = metaattr_createSuper(MetaAttr);

  function MetaAttr(_props) {
    var _this2;

    metaattr_classCallCheck(this, MetaAttr);

    _this2 = _super.call(this, _props);

    _this2.getParentKey = function (key, tree) {
      var parentKey;

      for (var i = 0; i < tree.length; i++) {
        var node = tree[i];

        if (node.children) {
          if (node.children.some(function (item) {
            return item.inputSig === key;
          })) {
            parentKey = node.inputSig;
          } else if (_this2.getParentKey(key, node.children)) {
            parentKey = _this2.getParentKey(key, node.children);
          }
        }
      }

      return parentKey;
    };

    _this2.generateList = function (data) {
      var isAsync = _this2.state.isAsync;

      for (var i = 0; i < data.length; i++) {
        var node = data[i];
        var inputSig = node.inputSig,
            displayName = node.displayName,
            refcode = node.refcode,
            refname = node.refname;

        if (isAsync) {
          displayName = refname + ' ' + refcode;
          inputSig = refcode;
        }

        metaattr_dataList.push({
          displayName: displayName,
          inputSig: inputSig
        });

        if (node.children) {
          _this2.generateList(node.children);
        }
      }
    };

    _this2.handleExpand = function (expandedKeys) {
      _this2.setState({
        expandedKeys: expandedKeys,
        autoExpandParent: false
      });
    };

    _this2.handleInput = function (value) {
      var _this = metaattr_assertThisInitialized(_this2);

      var _this2$state = _this2.state,
          treeData = _this2$state.treeData,
          isAsync = _this2$state.isAsync;
      var expandedKeys = [];
      metaattr_dataList.forEach(function (item) {
        var displayName = item.displayName,
            inputSig = item.inputSig;

        if (value && displayName.indexOf(value) > -1) {
          if (isAsync) {
            expandedKeys.push(inputSig);
          } else {
            expandedKeys.push(_this.getParentKey(inputSig, treeData));
          }
        }
      });
      var uniqueExpandedKeys = [];
      expandedKeys.forEach(function (item) {
        if (item && uniqueExpandedKeys.indexOf(item) === -1) {
          uniqueExpandedKeys.push(item);
        }
      });

      _this2.setState({
        expandedKeys: uniqueExpandedKeys,
        searchValue: value,
        autoExpandParent: true
      });
    };

    _this2.handleDoubleClick = function (value) {
      // 添加判断让树的根节点不可以双击赋值 罗敏让加的，说的和nc保持一致
      if (!value.includes('$$formulaTreeRootFlag$$')) {
        _this2.props.setName(value);
      }
    };

    _this2.handleSelect = function (value, event) {
      _this2.props.setExplain(event.node.props.explain);
    };

    _this2.loadData = function (node) {
      var _this2$props = _this2.props,
          metaParam = _this2$props.metaParam,
          metaUrl = _this2$props.metaUrl;
      var _metaParam$queryCondi = metaParam.queryCondition,
          queryCondition = _metaParam$queryCondi === void 0 ? {} : _metaParam$queryCondi;
      var _node$props = node.props,
          props = _node$props === void 0 ? {} : _node$props;
      var pos = props.pos;
      return new Promise(function (resolve) {
        if (pathList.includes(pos)) {
          resolve();
          return;
        }

        Object(index_["ajax"])({
          url: metaUrl,
          loading: false,
          data: {
            queryCondition: {
              mdclass: queryCondition.mdclass,
              pid: props.refpk
            }
          },
          success: function success(res) {
            var treeData = _this2.state.treeData;
            var path = pos.split('-');
            pathList.push(pos);

            var set = function set(data, path) {
              path.shift();

              if (path.length) {
                if (!data[path[0]].children) {
                  data[path[0]].children = res.data.rows;
                } else {
                  var children = data[path[0]].children;
                  set(children, path);
                }
              }
            };

            set(treeData, path);

            _this2.setState(treeData);

            _this2.generateList(treeData);

            resolve();
          },
          error: function error() {
            Object(index_["toast"])({
              color: 'danger',
              content: "".concat(_this2.state.json['formula0010'])
            });
            resolve();
          }
        });
      });
    };

    _this2.createAsyncTree = function () {
      var _this2$state2 = _this2.state,
          searchValue = _this2$state2.searchValue,
          expandedKeys = _this2$state2.expandedKeys,
          autoExpandParent = _this2$state2.autoExpandParent,
          treeData = _this2$state2.treeData; // 只给根节点设置一次标记的标志
      // let callNumFlag = true;
      // 需要给根节点加的标记
      // let rootFlag = '';

      var loop = function loop(data) {
        return data.map(function (item) {
          var refcode = item.refcode,
              refname = item.refname,
              refpk = item.refpk,
              children = item.children,
              isleaf = item.isleaf;
          var displayName = refname + ' ' + refcode;
          var index = displayName.search(searchValue);
          var beforeStr = displayName.substr(0, index);
          var afterStr = displayName.substr(index + searchValue.length);
          var title = index > -1 ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, beforeStr, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "u-tree-searchable-filter"
          }, searchValue), afterStr) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, displayName); // if (!isleaf) {
          //     // 只对根节点设置一次，其他下级节点不生效
          //     // 添加判断让树的根节点不可以双击赋值 罗敏让加的，说的和nc保持一致
          //     rootFlag = '$$formulaTreeRootFlag$$';
          //     // callNumFlag = false;
          // } else {
          //     rootFlag = '';
          // }

          if (Array.isArray(children) && children[0]) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(metaattr_TreeNode, {
              key: refcode,
              title: title,
              explain: refname,
              isLeaf: isleaf,
              refpk: refpk
            }, loop(children));
          }

          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(metaattr_TreeNode, {
            key: refcode,
            title: title,
            explain: refname,
            isLeaf: isleaf,
            refpk: refpk
          });
        });
      };

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tree"], {
        onDoubleClick: _this2.handleDoubleClick,
        onSelect: _this2.handleSelect,
        onExpand: _this2.handleExpand,
        expandedKeys: expandedKeys,
        autoExpandParent: autoExpandParent,
        loadData: _this2.loadData
      }, loop(treeData, []));
    };

    _this2.createSyncTree = function () {
      var _this2$state3 = _this2.state,
          searchValue = _this2$state3.searchValue,
          expandedKeys = _this2$state3.expandedKeys,
          autoExpandParent = _this2$state3.autoExpandParent,
          treeData = _this2$state3.treeData; // 只给根节点设置一次标记的标志

      var callNumFlag = true; // 需要给根节点加的标记

      var rootFlag = '';

      var loop = function loop(data) {
        return data.map(function (item, dataIndex) {
          var displayName = item.displayName,
              inputSig = item.inputSig,
              children = item.children,
              hintMsg = item.hintMsg;
          var index = displayName.search(searchValue);
          var beforeStr = displayName.substr(0, index);
          var afterStr = displayName.substr(index + searchValue.length);
          var title = index > -1 ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, beforeStr, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "u-tree-searchable-filter"
          }, searchValue), afterStr) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, displayName);

          if (callNumFlag && dataIndex === 0) {
            // 只对根节点设置一次，其他下级节点不生效
            // 添加判断让树的根节点不可以双击赋值 罗敏让加的，说的和nc保持一致
            rootFlag = '$$formulaTreeRootFlag$$';
            callNumFlag = false;
          } else {
            rootFlag = '';
          }

          if (Array.isArray(children) && children[0]) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(metaattr_TreeNode, {
              key: inputSig + rootFlag,
              title: title,
              explain: hintMsg
            }, loop(children));
          }

          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(metaattr_TreeNode, {
            key: inputSig,
            title: title,
            explain: hintMsg
          });
        });
      };

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tree"], {
        onDoubleClick: _this2.handleDoubleClick,
        onSelect: _this2.handleSelect,
        onExpand: _this2.handleExpand,
        expandedKeys: expandedKeys,
        autoExpandParent: autoExpandParent
      }, loop(treeData));
    };

    _this2._createAll = function () {
      var _this2$state4 = _this2.state,
          json = _this2$state4.json,
          isAsync = _this2$state4.isAsync,
          searchValue = _this2$state4.searchValue;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "search-tree-area formulaeditor-search-tree-area"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        style: {
          width: '100%'
        },
        placeholder: json['formula0017'],
        value: searchValue,
        onChange: _this2.handleInput
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "tree-content"
      }, isAsync ? _this2.createAsyncTree() : _this2.createSyncTree()));
    };

    _this2.state = {
      expandedKeys: [],
      //指定展开的节点
      treeData: [],
      //树数据
      isAsync: false,
      searchValue: "",
      //输入input 的值
      autoExpandParent: true,
      //是否自定展开父节点
      json: {} //多语

    };
    return _this2;
  }
  /**
   * 得需要打开的TreeNode的key得需要打开的TreeNode的key
   * @param {*} key
   * @param {*} tree
   */


  metaattr_createClass(MetaAttr, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this3 = this;

      var _this$props = this.props,
          metaParam = _this$props.metaParam,
          metaUrl = _this$props.metaUrl; // 初始化调用getMultiLang方法获取多语

      var callback = function callback(json, bool, LangData) {
        _this3.setState({
          json: json,
          LangData: LangData
        }, function () {
          Object(index_["ajax"])({
            url: Object(index_["isString"])(metaUrl) ? metaUrl : '/nccloud/formula/web/formulaentitytree.do',
            loading: false,
            data: Object(index_["isObj"])(metaParam) ? metaParam : {},
            success: function success(res) {
              if (metaUrl && metaUrl === '/nccloud/riart/print/mdtree.do') {
                var treeData = res.data.rows || [];

                _this3.setState({
                  treeData: treeData,
                  isAsync: true
                });

                _this3.generateList(treeData);
              } else {
                _this3.setState({
                  treeData: [res.data],
                  isAsync: false
                });

                _this3.generateList([res.data]);
              }
            },
            error: function error() {
              Object(index_["toast"])({
                color: 'danger',
                content: "".concat(_this3.state.json['formula0010'])
              });
            }
          });
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'container_formulaEditor',
        callback: callback
      }); // moduleId为所需加载json文件夹名称前缀
    }
    /**
     * zhanghengh 18/5/31
     * 当打开或关闭树节点触发的方法
     */

  }, {
    key: "render",
    value: function render() {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, this._createAll());
    }
  }]);

  return MetaAttr;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/FormulaEditor/components/surface.jsx
function surface_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { surface_typeof = function _typeof(obj) { return typeof obj; }; } else { surface_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return surface_typeof(obj); }

function surface_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function surface_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function surface_createClass(Constructor, protoProps, staticProps) { if (protoProps) surface_defineProperties(Constructor.prototype, protoProps); if (staticProps) surface_defineProperties(Constructor, staticProps); return Constructor; }

function surface_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) surface_setPrototypeOf(subClass, superClass); }

function surface_setPrototypeOf(o, p) { surface_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return surface_setPrototypeOf(o, p); }

function surface_createSuper(Derived) { var hasNativeReflectConstruct = surface_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = surface_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = surface_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return surface_possibleConstructorReturn(this, result); }; }

function surface_possibleConstructorReturn(self, call) { if (call && (surface_typeof(call) === "object" || typeof call === "function")) { return call; } return surface_assertThisInitialized(self); }

function surface_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function surface_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function surface_getPrototypeOf(o) { surface_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return surface_getPrototypeOf(o); }

/**
 * zhanghengh
 * 18/5/31
 * 公式编辑器的表和数据部分，用的包装后的钉耙的组件，如有问题，可以参考钉耙的的例子
 * 后端是汪建伟
 */




__webpack_require__(1911);

var surface_Surface = /*#__PURE__*/function (_Component) {
  surface_inherits(Surface, _Component);

  var _super = surface_createSuper(Surface);

  function Surface(props) {
    var _this;

    surface_classCallCheck(this, Surface);

    _this = _super.call(this, props);

    _this.handleRefresh = function () {
      var cacheData = _this.state.cacheData;

      if (cacheData) {
        _this.setState({
          surfaceData: cacheData,
          inputValue: ''
        }, function () {
          _this._getFieldData(cacheData[0].displayName);
        });
      }
    };

    _this.handleCheckbox = function () {
      _this.setState({
        checked: !_this.state.checked
      });
    };

    _this.handleInput = function (value) {
      var cacheData = _this.state.cacheData;

      if (cacheData) {
        var newData = cacheData.filter(function (eve) {
          if (eve.displayName.includes(value)) {
            return true;
          }
        });

        _this.setState({
          surfaceData: newData,
          inputValue: value
        }, function () {
          if (newData.length > 0) {
            _this._getFieldData(newData[0].displayName);
          } else {
            _this.setState({
              fieldData: []
            });
          }
        });
      }
    };

    _this._getFieldData = function (title) {
      var json = _this.state.json;
      Object(index_["ajax"])({
        url: '/nccloud/formula/web/formulatabfield.do',
        loading: false,
        data: {
          tablename: title
        },
        success: function success(res) {
          _this.setState({
            fieldData: res.data
          });
        },
        error: function error() {
          Object(index_["toast"])({
            color: 'danger',
            content: "".concat(json['formula0011'])
          });
        }
      });
    };

    _this.handleSurfaceList = function (e) {
      var surfaceData = _this.state.surfaceData;
      var setExplain = _this.props.setExplain;
      var _e$target$dataset = e.target.dataset,
          explain = _e$target$dataset.explain,
          title = _e$target$dataset.title;

      if (surfaceData.length && title) {
        setExplain(explain);

        _this._getFieldData(title);
      }
    };

    _this.handleFieldList = function (e) {
      _this.props.setExplain(e.target.dataset.explain);
    };

    _this.handleDbList = function (e) {
      var surfaceData = _this.state.surfaceData;

      if (surfaceData.length) {
        var name = e.target.dataset.name;

        _this.props.setName(name);
      }
    };

    _this._createAll = function () {
      var _this$state = _this.state,
          checked = _this$state.checked,
          surfaceData = _this$state.surfaceData,
          fieldData = _this$state.fieldData,
          inputValue = _this$state.inputValue,
          json = _this$state.json;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Row"], null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
        md: 6,
        xs: 6,
        sm: 6
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "surface-left-title"
      }, json['formula0018']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", {
        className: "surface-left",
        onClick: _this.handleSurfaceList
      }, _this._createContent(surfaceData)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "input-area"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Checkbox"], {
        className: "checkbox",
        colors: "info",
        checked: checked,
        onChange: _this.handleCheckbox
      }, json['formula001']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Input"], {
        value: inputValue,
        disabled: !checked,
        style: {
          width: '100%',
          display: 'block'
        },
        placeholder: "Search",
        onChange: _this.handleInput
      })), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
        disabled: !checked,
        style: {
          width: '100%',
          margin: 0,
          display: 'block',
          background: '#1e88e5'
        },
        onClick: _this.handleRefresh
      }, json['formula002']))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
        md: 6,
        xs: 6,
        sm: 6
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "surface-right-title"
      }, json['formula0019']), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", {
        className: "surface-right",
        onClick: _this.handleFieldList
      }, _this._createContent(fieldData))));
    };

    _this.state = {
      checked: false,
      //控制checkbox的状态
      surfaceData: [],
      //表的数据
      fieldData: [],
      //字段的数据
      inputValue: '',
      // input 的值
      json: {}
    };
    return _this;
  }

  surface_createClass(Surface, [{
    key: "componentWillMount",
    value: function componentWillMount() {
      var _this2 = this;

      var surfaceUrl = this.props.surfaceUrl; // 初始化调用getPlatformLang方法获取多语

      var callback = function callback(json, bool, LangData) {
        _this2.setState({
          json: json,
          LangData: LangData
        });
      };

      Object(index_["getMultiLang"])({
        moduleId: 'container_formulaEditor',
        callback: callback
      }); // moduleId为所需加载json文件夹名称前缀

      Object(index_["ajax"])({
        //初始加载数据
        url: Object(index_["isString"])(surfaceUrl) ? surfaceUrl : '/nccloud/formula/web/formulatab.do',
        loading: false,
        success: function success(res) {
          _this2.setState({
            surfaceData: res.data,
            //当前数据
            cacheData: res.data //初始数据

          });
        },
        error: function error(e) {
          Object(index_["toast"])({
            color: 'danger',
            content: e.message
          });
        }
      });
    } // componentWillReceiveProps(nextProps) {  //暂时注释不要删除，可能会有用
    //   const { surfaceUrl } = nextProps;  //最新的props
    //   const { surfaceUrl: oldSurfaceUrl } = this.props;  //上一次的props
    //   if(surfaceUrl !== oldSurfaceUrl) {  //当传入的路径变化时才重新请求，做到优化作用
    //     ajax({
    //       url: isString(surfaceUrl) ? surfaceUrl : '/nccloud/formula/web/formulatab.do',
    //       loading: false,
    //       success: (res) => {
    //         this.setState({
    //           surfaceData: res.data,//当前数据
    //           cacheData: res.data//初始数据
    //         });
    //       },
    //       error: (e) => {
    //         toast({ color: 'danger', content: e.message });
    //       }
    //     });
    //   }
    // }

    /**
     * zhanghengh
     * 18/5/30
     * 点击刷新回调
     */

  }, {
    key: "_createContent",

    /**
     * zhanghengh
     * 18/5/30
     * 创建列表内容
     */
    value: function _createContent(data) {
      var _this3 = this;

      return data.map(function (eve, index) {
        var displayName = eve.displayName,
            inputSig = eve.inputSig,
            hintMsg = eve.hintMsg;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
          key: index,
          "data-name": inputSig,
          "data-explain": hintMsg,
          "data-title": displayName,
          onDoubleClick: _this3.handleDbList
        }, displayName);
      });
    }
    /**
     * 获取字段的数据
     * zhanghengh
     */

  }, {
    key: "render",
    value: function render() {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "surface-area"
      }, this._createAll());
    }
  }]);

  return Surface;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


// CONCATENATED MODULE: ./src/platform/components/FormulaEditor/index.jsx
function FormulaEditor_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { FormulaEditor_typeof = function _typeof(obj) { return typeof obj; }; } else { FormulaEditor_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return FormulaEditor_typeof(obj); }

function FormulaEditor_asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function FormulaEditor_asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { FormulaEditor_asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { FormulaEditor_asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function FormulaEditor_extends() { FormulaEditor_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return FormulaEditor_extends.apply(this, arguments); }

function FormulaEditor_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function FormulaEditor_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { FormulaEditor_ownKeys(Object(source), true).forEach(function (key) { FormulaEditor_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { FormulaEditor_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function FormulaEditor_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function FormulaEditor_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function FormulaEditor_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function FormulaEditor_createClass(Constructor, protoProps, staticProps) { if (protoProps) FormulaEditor_defineProperties(Constructor.prototype, protoProps); if (staticProps) FormulaEditor_defineProperties(Constructor, staticProps); return Constructor; }

function FormulaEditor_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) FormulaEditor_setPrototypeOf(subClass, superClass); }

function FormulaEditor_setPrototypeOf(o, p) { FormulaEditor_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return FormulaEditor_setPrototypeOf(o, p); }

function FormulaEditor_createSuper(Derived) { var hasNativeReflectConstruct = FormulaEditor_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = FormulaEditor_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = FormulaEditor_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return FormulaEditor_possibleConstructorReturn(this, result); }; }

function FormulaEditor_possibleConstructorReturn(self, call) { if (call && (FormulaEditor_typeof(call) === "object" || typeof call === "function")) { return call; } return FormulaEditor_assertThisInitialized(self); }

function FormulaEditor_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function FormulaEditor_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function FormulaEditor_getPrototypeOf(o) { FormulaEditor_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return FormulaEditor_getPrototypeOf(o); }

/**
 * 公式编辑器  zhanghengh
 * 2014/4
 * 主要用于资产、财务、供应链等
 *
 */







var TabPane = base_index_["Tabs"].TabPane;
var FormulaEditor_Header = base_index_["Modal"].Header,
    FormulaEditor_Title = base_index_["Modal"].Title,
    FormulaEditor_Body = base_index_["Modal"].Body;

__webpack_require__(1909);

var FormulaEditor_FormulaEditor = /*#__PURE__*/function (_Component) {
  FormulaEditor_inherits(FormulaEditor, _Component);

  var _super = FormulaEditor_createSuper(FormulaEditor);

  function FormulaEditor(props) {
    var _this;

    FormulaEditor_classCallCheck(this, FormulaEditor);

    _this = _super.call(this, props); // textarea 中的文本是否被全选

    _this.getControlBtnsConfig = function () {
      var json = _this.state.json;
      return [//操作按钮配置
      {
        key: 'ok',
        name: json['formula003'],
        onClick: _this.handleOk
      }, {
        key: 'cancel',
        name: json['formula004'],
        onClick: _this.handleCancel
      }, {
        key: 'validate',
        name: json['formula005'],
        onClick: _this.handleValidate
      }, {
        key: 'checkAll',
        name: json['formula006'],
        onClick: _this.handleCheckAll
      }, {
        key: 'clear',
        name: json['formula007'],
        onClick: _this.handleClear
      }];
    };

    _this.handleTextAreaChange = function (value) {
      _this.setState({
        showData: value
      });
    };

    _this.handelSetName = function (e) {
      var name = e.target.dataset.name;

      _this.handlePushStr(name);
    };

    _this.handleClickTabItem = function (e) {
      var explain = e.target.dataset.explain;

      _this.setExplain(explain);
    };

    _this.handleClear = function () {
      _this.setState({
        showData: ''
      });

      _this.textArea.querySelectorAll('textarea')[0].focus();
    };

    _this.handleCheckAll = function () {
      // 全选的时候将状态设置成true
      _this.selected = true;

      _this.textArea.querySelectorAll('textarea')[0].select(); //实现全选

    };

    _this.handleValidate = function () {
      var _this$state = _this.state,
          showData = _this$state.showData,
          json = _this$state.json;
      var _this$props = _this.props,
          validateUrl = _this$props.validateUrl,
          _this$props$validateD = _this$props.validateData,
          validateData = _this$props$validateD === void 0 ? {} : _this$props$validateD;
      Object(index_["ajax"])({
        url: Object(index_["isString"])(validateUrl) ? validateUrl : '/nccloud/formula/web/formulaverfify.do',
        loading: false,
        data: FormulaEditor_objectSpread({
          formulastr: showData
        }, validateData),
        success: function success(res) {
          if (res.data.status === 'Y') {
            Object(index_["toast"])({
              color: 'success',
              content: "".concat(json['formula0013'])
            });
          } else if (res.data.status === 'N') {
            Object(index_["toast"])({
              color: 'danger',
              content: res.data.error ? res.data.error : "".concat(json['formula0014'])
            });
          }
        },
        error: function error() {
          Object(index_["toast"])({
            color: 'danger',
            content: "".concat(json['formula0015'])
          });
        }
      });
    };

    _this.handleCancel = function () {
      var onCancel = _this.props.onCancel;

      if (onCancel && Object(index_["isFunction"])(onCancel)) {
        onCancel();
      }
    };

    _this.setShow = function (value) {
      _this.setState({
        isShow: value
      });
    };

    _this.setExplain = function (data) {
      _this.setState({
        explainData: data
      });
    };

    _this.handleOk = function () {
      var _this$state2 = _this.state,
          showData = _this$state2.showData,
          json = _this$state2.json;
      var _this$props2 = _this.props,
          onOk = _this$props2.onOk,
          _this$props2$isValida = _this$props2.isValidateOnOK,
          isValidateOnOK = _this$props2$isValida === void 0 ? true : _this$props2$isValida,
          validateUrl = _this$props2.validateUrl,
          _this$props2$validate = _this$props2.validateData,
          validateData = _this$props2$validate === void 0 ? {} : _this$props2$validate;

      if (isValidateOnOK) {
        //判断确定的时候是否需要校验
        Object(index_["ajax"])({
          url: Object(index_["isString"])(validateUrl) ? validateUrl : '/nccloud/formula/web/formulaverfify.do',
          loading: false,
          data: FormulaEditor_objectSpread({
            formulastr: showData
          }, validateData),
          success: function success(res) {
            if (res.data.status === 'Y') {
              if (onOk && Object(index_["isFunction"])(onOk)) {
                onOk(showData);
              }
            } else if (res.data.status === 'N') {
              Object(index_["toast"])({
                color: 'danger',
                content: res.data.error ? res.data.error : "".concat(json['formula0014'])
              });
            }
          },
          error: function error() {
            Object(index_["toast"])({
              color: 'danger',
              content: "".concat(json['formula0015'])
            });
          }
        });
      } else {
        if (onOk && Object(index_["isFunction"])(onOk)) {
          onOk(showData);
        }
      }
    };

    _this.handlePushStr = function (btnContent) {
      var textArea = _this.textArea.querySelectorAll('textarea')[0];

      if (_this.selected) {
        // 全选后,在选择的值,直接覆盖之前的值解决  CLOUD-166749 这个bug, 财务 杨龙,和测试周崚 让改
        _this.selected = false;

        _this.setState({
          showData: btnContent
        }, function () {
          _this.setCursorPosition(textArea, btnContent.length);
        });
      } else {
        var textAreaLen = textArea.value.length;
        var textAreaValue = textArea.value;
        var selectionStart = textArea.selectionStart;
        var finalRange = (textAreaValue.substr(0, selectionStart) + btnContent).length;
        var finalValue = textAreaValue.substr(0, selectionStart) + btnContent + textAreaValue.substring(selectionStart, textAreaLen);

        _this.setState({
          showData: finalValue
        }, function () {
          _this.setCursorPosition(textArea, finalRange);
        });
      }
    };

    _this.setCursorPosition = function (elem, index) {
      var val = elem.value;
      var len = val.length; // 超过文本长度直接返回

      if (len < index) return;
      setTimeout(function () {
        elem.focus();

        if (elem.setSelectionRange) {
          // 标准浏览器
          elem.setSelectionRange(index, index);
        } else {
          // IE9- 这个里面有问题在看
          var range = elem.createTextRange();
          range.moveStart('character', -len);
          range.moveEnd('character', -len);
          range.moveStart('character', index);
          range.moveEnd('character', 0);
          range.select();
        }
      }, 10);
    };

    _this._createWorkStation = function () {
      var _this$state3 = _this.state,
          showData = _this$state3.showData,
          optBtnsConfig = _this$state3.optBtnsConfig,
          computedBtnconfig = _this$state3.computedBtnconfig;
      var noControlBtns = _this.props.noControlBtns;

      if (Array.isArray(noControlBtns) && noControlBtns.length > 0) {
        //进行操作按钮可配置判断
        noControlBtns.forEach(function (eve) {
          _this.getControlBtnsConfig().filter(function (item) {
            var key = item.key;
            return key !== eve;
          });
        });
      }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Row"], null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
        md: 8,
        xs: 8,
        sm: 8
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "editor-submit-area"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["TextArea"], {
        ref: function ref(dom) {
          _this.textArea = Object(external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_["findDOMNode"])(dom);
        },
        selfRangControl: false,
        onBlur: function onBlur() {
          // 全选的时候让textarea里面的文本一直处于全选的状态
          _this.selected && _this.textArea.querySelectorAll('textarea')[0].select();
        },
        value: showData,
        className: "editor-show-area",
        onChange: _this.handleTextAreaChange,
        onEnter: function onEnter() {} //为了ctrl+enter换行
        ,
        fieldid: "editor"
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "editor-control-btns"
      }, _this._createControlBtns(_this.getControlBtnsConfig())))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
        md: 4,
        xs: 4,
        sm: 4
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "centerWrap"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "editor-opt-btns"
      }, _this._createOptBtns(optBtnsConfig)), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "editor-comp-btns"
      }, _this._createOptBtns(computedBtnconfig)))));
    };

    _this._createTabs = function () {
      var _this$props3 = _this.props,
          _this$props3$formulaC = _this$props3.formulaConfig,
          formulaConfig = _this$props3$formulaC === void 0 ? [] : _this$props3$formulaC,
          _this$props3$attrConf = _this$props3.attrConfig,
          attrConfig = _this$props3$attrConf === void 0 ? [] : _this$props3$attrConf,
          noShowFormula = _this$props3.noShowFormula,
          noShowAttr = _this$props3.noShowAttr,
          defaultFormulaKey = _this$props3.defaultFormulaKey,
          tabActiveKey = _this$props3.tabActiveKey,
          defaultAttrKey = _this$props3.defaultAttrKey,
          onTabChange = _this$props3.onTabChange;
      var json = _this.state.json;
      var defaultFormulaObj = Object(index_["isString"])(defaultFormulaKey) ? {
        defaultActiveKey: defaultFormulaKey
      } : {}; //  公式tab的默认展示tab

      var defaultAttrObj = Object(index_["isString"])(defaultAttrKey) ? {
        defaultActiveKey: defaultAttrKey
      } : {}; //  属性tab的默认展示tab

      var tabActiveKeyObj = Object(index_["isString"])(tabActiveKey) ? {
        activeKey: tabActiveKey
      } : {};
      var formulaData = _this.state.formulaData;
      var tabAttrConfig = [];

      if (json['formula008']) {
        tabAttrConfig = [//右侧tabPane配置数据
        {
          tab: "".concat(json['formula008']),
          key: "".concat(json['formula008']),
          TabPaneContent: metaattr_MetaAttr
        }, {
          tab: "".concat(json['formula009']),
          key: "".concat(json['formula009']),
          TabPaneContent: surface_Surface
        }];
      }

      var tabFormulaConfig = formulaData.map(function (eve) {
        //左侧侧tabPane配置数据
        return {
          tab: eve.typeName,
          key: eve.typeName,
          TabPaneContent: _this._createFormulaTabPane(eve.name2FormItemMap)
        };
      });
      Array.isArray(attrConfig) && (tabAttrConfig = tabAttrConfig.concat(attrConfig)); //判断右侧tabs配置

      if (Array.isArray(noShowAttr) && noShowAttr.length > 0) {
        //对用户不需要tab属性的进行筛选
        if (noShowAttr.length === 1 && noShowAttr[0] === 'all') {
          //  隐藏所有tab页签
          tabAttrConfig = [];
        } else if (noShowAttr.length === 1 && noShowAttr[0] === 'allBuiltIn') {
          tabAttrConfig = attrConfig;
        } else {
          tabAttrConfig = tabAttrConfig.filter(function (eve) {
            var isChange = true;
            noShowAttr.forEach(function (attr) {
              if (attr === eve.key || eve.key && eve.key.includes(attr)) {
                // 这是实现有些问题，暂时兼容一下
                isChange = false;
              }
            });
            return isChange;
          });
        }
      }

      if (Array.isArray(noShowFormula) && noShowFormula.length > 0) {
        //对用户不需要的tab公式进行筛选
        if (noShowFormula.length === 1 && noShowFormula[0] === 'all') {
          //  隐藏所有tab页签
          tabFormulaConfig = [];
          formulaConfig = [];
        } else if (noShowFormula.length === 1 && noShowFormula[0] === 'allBuiltIn') {
          //  隐藏所有内置tab页签
          tabFormulaConfig = [];
        } else {
          tabFormulaConfig = tabFormulaConfig.filter(function (eve) {
            //内置的
            var isChange = true;
            noShowFormula.forEach(function (attr) {
              if (attr === eve.key) {
                isChange = false;
              }
            });
            return isChange;
          });
          formulaConfig = formulaConfig.filter(function (eve) {
            //用户传入的
            var isChange = true;
            noShowFormula.forEach(function (attr) {
              if (attr === eve.key) {
                isChange = false;
              }
            });
            return isChange;
          });
        }
      }

      var originalTabs = _this._createFormulaTabPanes(tabFormulaConfig); //左侧初始Tabs


      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "detailInfoWrap",
        style: {
          height: _this.state.footerHeight || 359,
          overflow: 'auto'
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Row"], null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
        md: 6,
        xs: 6,
        sm: 6
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "tabs-left"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tabs"], FormulaEditor_extends({
        tabBarStyle: "primary"
      }, defaultFormulaObj, {
        onChange: function onChange(key) {
          Object(index_["isFunction"])(onTabChange) && onTabChange(key);
        }
      }), _this._createFormulaAllTabPanes(originalTabs, formulaConfig)))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Col"], {
        md: 6,
        xs: 6,
        sm: 6
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "tabs-right"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Tabs"], FormulaEditor_extends({
        tabBarStyle: "primary"
      }, defaultAttrObj, {
        onChange: function onChange(key) {
          Object(index_["isFunction"])(onTabChange) && onTabChange(key);
        }
      }, tabActiveKeyObj), _this._createAttrTabPanes(tabAttrConfig))))));
    };

    _this._createFormulaTabPane = function (TabPaneContent) {
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("ul", {
        className: "tab-content",
        onClick: _this.handleClickTabItem,
        onDoubleClick: _this.handelSetName
      }, _this._createTabPaneContent(TabPaneContent));
    };

    _this._createFormulaTabPanes = function (tabPaneConfig) {
      return tabPaneConfig.map(function (eve) {
        var TabPaneContent = eve.TabPaneContent,
            tab = eve.tab,
            key = eve.key;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TabPane, {
          tab: tab,
          style: {
            overflow: 'auto',
            height: '283px'
          },
          key: key
        }, TabPaneContent);
      });
    };

    _this._createFormulaAllTabPanes = function (originalTabs, introTabConfig) {
      return originalTabs.concat(introTabConfig.map(function (eve) {
        var TabPaneContent = eve.TabPaneContent,
            tab = eve.tab,
            _eve$params = eve.params,
            params = _eve$params === void 0 ? {} : _eve$params,
            key = eve.key;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TabPane, {
          tab: tab,
          style: {
            overflow: 'auto',
            height: '283px'
          },
          key: key
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TabPaneContent, FormulaEditor_extends({
          setExplain: _this.setExplain,
          setName: _this.handlePushStr
        }, params)));
      }));
    };

    _this._createAttrTabPanes = function (tabPaneConfig) {
      var _this$props4 = _this.props,
          metaParam = _this$props4.metaParam,
          metaUrl = _this$props4.metaUrl,
          surfaceUrl = _this$props4.surfaceUrl;
      return tabPaneConfig.map(function (eve) {
        var TabPaneContent = eve.TabPaneContent,
            tab = eve.tab,
            _eve$params2 = eve.params,
            params = _eve$params2 === void 0 ? {} : _eve$params2,
            key = eve.key;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TabPane, {
          tab: tab,
          style: {
            overflow: 'auto',
            height: '283px'
          },
          key: key
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TabPaneContent, FormulaEditor_extends({
          setExplain: _this.setExplain,
          setName: _this.handlePushStr,
          metaParam: metaParam,
          metaUrl: metaUrl,
          surfaceUrl: surfaceUrl
        }, params)));
      });
    };

    _this._createTabPaneContent = function (TabPaneContent) {
      return TabPaneContent.map(function (eve) {
        var inputSig = eve.inputSig,
            displayName = eve.displayName,
            hintMsg = eve.hintMsg;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
          className: "tab-content-item",
          "data-name": inputSig,
          "data-explain": hintMsg
        }, displayName);
      });
    };

    _this._createOptBtns = function (btnConfig) {
      return btnConfig.map(function (eve, index) {
        var name = eve.name;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
          onClick: _this.handelSetName,
          key: index,
          "data-name": name,
          className: "opt-btn"
        }, name);
      });
    };

    _this._createControlBtns = function (btnConfig) {
      return btnConfig.map(function (eve, index) {
        var name = eve.name,
            onClick = eve.onClick,
            key = eve.key;
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Button"], {
          key: index,
          onClick: onClick,
          className: "opt-btn",
          fieldid: key
        }, name);
      });
    };

    _this.selected = false;
    _this.state = {
      formulaData: [],
      //公式的数据
      showData: '',
      //展示出来的数据,
      isShow: false,
      //控制model展示隐藏
      explainData: '',
      //解释数据
      optBtnsConfig: [//选项按钮配置
      {
        name: 7
      }, {
        name: 8
      }, {
        name: 9
      }, {
        name: 0
      }, {
        name: 4
      }, {
        name: 5
      }, {
        name: 6
      }, {
        name: '.'
      }, {
        name: 1
      }, {
        name: 2
      }, {
        name: 3
      }, {
        name: '00'
      }],
      computedBtnconfig: [{
        name: '+'
      }, {
        name: '-'
      }, {
        name: '*'
      }, {
        name: '/'
      }, {
        name: '->'
      }, {
        name: '=='
      }, {
        name: '('
      }, {
        name: ')'
      }, {
        name: '<'
      }, {
        name: '>'
      }, {
        name: '<='
      }, {
        name: '>='
      }],
      json: {}
    };
    return _this;
  }

  FormulaEditor_createClass(FormulaEditor, [{
    key: "componentWillMount",
    value: function () {
      var _componentWillMount = FormulaEditor_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
        var _this2 = this;

        var callback, _this$props5, _this$props5$value, value, _this$props5$show, show, noShowFormula, formulaUrl, json;

        return regeneratorRuntime.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                // 初始化调用getPlatformLang方法获取多语
                callback = function callback(json, bool, LangData) {
                  _this2.setState({
                    json: json,
                    LangData: LangData
                  });
                };

                _context.next = 3;
                return Object(index_["getMultiLang"])({
                  moduleId: 'container_formulaEditor',
                  callback: callback
                });

              case 3:
                // moduleId为所需加载json文件夹名称前缀
                _this$props5 = this.props, _this$props5$value = _this$props5.value, value = _this$props5$value === void 0 ? '' : _this$props5$value, _this$props5$show = _this$props5.show, show = _this$props5$show === void 0 ? false : _this$props5$show, noShowFormula = _this$props5.noShowFormula, formulaUrl = _this$props5.formulaUrl;
                json = this.state.json;
                this.setShow(show); // 设置modal展示和隐藏

                this.handleTextAreaChange(value); // 设置编辑器初始值

                Array.isArray(noShowFormula) && noShowFormula.length === 1 && noShowFormula[0] === 'all' || Object(index_["ajax"])({
                  url: Object(index_["isString"])(formulaUrl) ? formulaUrl : '/nccloud/formula/web/formulatype.do',
                  loading: false,
                  success: function success(res) {
                    _this2.setState({
                      formulaData: res.data
                    });
                  },
                  error: function error() {
                    Object(index_["toast"])({
                      color: 'danger',
                      content: "".concat(json['formula0012'])
                    });
                  }
                });

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function componentWillMount() {
        return _componentWillMount.apply(this, arguments);
      }

      return componentWillMount;
    }()
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var _this3 = this;

      var _nextProps$value = nextProps.value,
          value = _nextProps$value === void 0 ? '' : _nextProps$value,
          _nextProps$show = nextProps.show,
          show = _nextProps$show === void 0 ? false : _nextProps$show,
          noShowFormula = nextProps.noShowFormula,
          formulaUrl = nextProps.formulaUrl; //最新的props

      var oldFormulaUrl = this.props.formulaUrl; //上一次的props

      var json = this.state.json;
      this.handleTextAreaChange(value); // 设置编辑器初始值
      // textarea 中的文本全选状态变成false

      this.selected && (this.selected = false);
      this.setShow(show); // 设置modal展示和隐藏

      if (formulaUrl !== oldFormulaUrl) {
        ////当传入的路径变化时才重新请求，做到优化作用
        Array.isArray(noShowFormula) && noShowFormula.length === 1 && noShowFormula[0] === 'all' || Object(index_["ajax"])({
          url: Object(index_["isString"])(formulaUrl) ? formulaUrl : '/nccloud/formula/web/formulatype.do',
          loading: false,
          success: function success(res) {
            _this3.setState({
              formulaData: res.data
            });
          },
          error: function error() {
            Object(index_["toast"])({
              color: 'danger',
              content: "".concat(json['formula0012'])
            });
          }
        });
      }
    }
  }, {
    key: "componentDidUpdate",
    value: function componentDidUpdate(prevProps, prevState) {
      //打开默认就获取焦点
      var prevIsShow = prevState.isShow;
      var isShow = this.state.isShow;

      if (this.textArea && isShow !== prevIsShow) {
        var textArea = this.textArea.querySelectorAll('textarea')[0];

        if (textArea) {
          this.setCursorPosition(textArea, textArea.value.length); // 兼容其他火狐浏览器,火狐浏览器默认光标在第一位，而chrome默认在最后一位
        }
      }
    }
  }, {
    key: "render",
    value: function render() {
      var _this4 = this;

      // 解释区域显示文字
      var _this$state4 = this.state,
          isShow = _this$state4.isShow,
          json = _this$state4.json,
          explainData = _this$state4.explainData;
      var _this$props6 = this.props,
          _this$props6$onHide = _this$props6.onHide,
          onHide = _this$props6$onHide === void 0 ? function () {} : _this$props6$onHide,
          _this$props6$classNam = _this$props6.className,
          className = _this$props6$classNam === void 0 ? '' : _this$props6$classNam,
          _this$props6$message = _this$props6.message,
          message = _this$props6$message === void 0 ? '' : _this$props6$message,
          zIndex = _this$props6.zIndex;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(base_index_["Modal"], {
        className: "".concat(className, " FormulaEditorWrap"),
        size: "lg",
        show: isShow && !this.exiting,
        backdrop: "static" //是否展示遮罩层
        ,
        onHide: onHide,
        onExit: function onExit() {
          // 隐藏开始
          _this4.exiting = true;
        },
        onExited: function onExited() {
          // 隐藏结束  为了解决input focus 弹出面板时  关闭弹窗触发focus事件  特此延时以让一定时间内不会二次弹出
          setTimeout(function () {
            _this4.exiting = false; // 不确定这里是否会产生 内存问题  可以考虑把这个变量放到全局去  应该也不会产生问题
          }, 0);
        },
        onEntered: function onEntered(dom) {
          var modalbody = dom.querySelector('.u-modal-body');

          if (modalbody) {
            if (modalbody.offsetHeight > 0) {
              var footerHeight = modalbody.offsetHeight - 226;

              _this4.setState({
                footerHeight: footerHeight
              });
            }
          }
        },
        zIndex: zIndex,
        fieldid: "formulaEditor"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(FormulaEditor_Header, {
        closeButton: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(FormulaEditor_Title, {
        fieldid: "".concat(json['formula0016'])
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", null, json['formula0016'], " "), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        style: {
          marginLeft: '20px'
        }
      }, message))), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(FormulaEditor_Body, null, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "editor-containers"
      }, this._createWorkStation(), this._createTabs()), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "explain-area"
      }, explainData))));
    }
  }]);

  return FormulaEditor;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);


FormulaEditor_FormulaEditor.defaultProps = {
  formulaConfig: [],
  //左侧tab配置
  attrConfig: [],
  //右侧tab配置
  onOk: function onOk() {} //点击确定回调

};
FormulaEditor_FormulaEditor.propTypes = {
  formulaConfig: prop_types_default.a.array,
  //左侧tab配置
  attrConfig: prop_types_default.a.array,
  //右侧tab配置
  metaParam: prop_types_default.a.object,
  //元素与属性请求参数
  metaUrl: prop_types_default.a.string,
  //元素与属性的请求路径
  surfaceUrl: prop_types_default.a.string,
  //表和字段的请求路径
  formulaUrl: prop_types_default.a.string,
  //公式的的请求路径
  validateUrl: prop_types_default.a.string,
  //自定义的验证接口
  onOk: prop_types_default.a.func,
  //点击确定回调
  value: prop_types_default.a.string,
  //设置编辑器的值
  show: prop_types_default.a.bool,
  //控制模态框展示和隐藏
  noShowFormula: prop_types_default.a.array,
  //公式tab不展示那些项
  noShowAttr: prop_types_default.a.array,
  //属性tab不展示那些项
  onHide: prop_types_default.a.func,
  //点击x按钮的回调
  noControlBtns: prop_types_default.a.array,
  //不需要展示的操作按钮
  isValidateOnOK: prop_types_default.a.bool,
  //点击确定后是否需要验证
  defaultAttrKey: prop_types_default.a.string,
  //属性tabs默认展示的页签
  defaultFormulaKey: prop_types_default.a.string,
  //公式tabs默认展示的页签
  tabActiveKey: prop_types_default.a.string //公式tabs当前展示的页签

};
// CONCATENATED MODULE: ./src/platform/components/index.js
/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: liyxt
 * @LastEditTime: 2020-06-15 16:32:51
 * @Description: file content
 */
//export { default as ApproveDown } from './ApproveDown';
// export { default as BillErrorTrack } from './BillErrorTrack';
 // export { default as BillTrack } from './BillTrack';



 // export { default as CreateAdvSearch } from './CreateAdvSearch';









 // export { default as DagreChart } from './DagreChart';


 // export { default as InsertEditTable } from './InsertEditTable';

 // export { default as InsertTable } from './InsertTable';
// export { default as MultiCardTable } from './MultiCardTable';





 // export { default as SyncTree } from './SyncTree';
// export { default as AsyncTree } from './AsyncTree';



 // export { default as transferField } from './transferField';
// export { default as TransferTable } from './TransferTable';







 // export { default as ErrorPop } from './ErrorPop';



/***/ }),

/***/ 2:
/***/ (function(module, exports, __webpack_require__) {

/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

if (false) { var throwOnDirectAccess, ReactIs; } else {
  // By explicitly using `prop-types` you are opting into new production behavior.
  // http://fb.me/prop-types-in-prod
  module.exports = __webpack_require__(75)();
}


/***/ }),

/***/ 20:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return findNextFocusItemInTable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return executeAutoFocus; });
/* harmony import */ var _getCellIdentity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(18);
/* harmony import */ var _findNextFocusItemInForm__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(54);
/* harmony import */ var _handleSpecialCase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(37);
/* harmony import */ var _createKeyMap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(9);
/* harmony import */ var _config_moduleType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(15);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_5__);






/**
 * @desc 查找下一个可聚焦元素
 * @param target {dom} 事件源
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 当前区域Id
 * @param orderOfHotKey {array} 区域显示顺序配置
 */

function findNextFocusItemInTable(_ref) {
  var eventTarget = _ref.eventTarget,
      ViewModel = _ref.ViewModel,
      moduleId = _ref.moduleId,
      orderOfHotKey = _ref.orderOfHotKey;
  var parentTd = eventTarget.tagName === 'TD' ? eventTarget : findParentTd(eventTarget);

  if (!parentTd) {
    // 这里报错的原因是因为某些事件（下拉的keydown）执行了两次
    console.warn('not find parentTd, next hotkey invalid');
    return;
  }

  var nextTd = parentTd.nextElementSibling;
  var currentTr = parentTd.parentElement;
  var lastTd = findLastTdInRow(currentTr);
  var div = nextTd && nextTd.querySelector('[tabindex="0"]'); //如果是最后一个元素就需要判断跳到下一行还是跳到下一个区域

  if (lastTd === parentTd) {
    var lastTr = currentTr.parentElement.lastElementChild;
    currentTr === lastTr ? perceptionHotKeyConfig({
      currentModuleId: moduleId,
      ViewModel: ViewModel,
      orderOfHotKey: orderOfHotKey
    }) : findNextRowTd({
      tr: currentTr,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } // 如果下一个元素没有找到就继续查找


  if (div === null || Object(_handleSpecialCase__WEBPACK_IMPORTED_MODULE_2__[/* checkboxInTable */ "a"])(div)) {
    findNextSiblings({
      td: nextTd,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } // 解决table 设值后重新渲染导致焦点缺失的问题,在这里保留一下id


  var cellIdentity = Object(_getCellIdentity__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"])(nextTd);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  executeAutoFocus({
    div: div,
    ViewModel: ViewModel
  });
}

function findParentTd(el) {
  while (el.parentElement) {
    el = el.parentElement;

    if (el.tagName === 'TD') {
      return el;
    }
  }

  return null;
}
/**
 * @desc 查找当前行里的最后一个td，需要排除操作列
 * @param tr {dom}
 * @return td {dom}
 */


function findLastTdInRow(tr) {
  var td = tr.lastElementChild.className.includes('fixed') ? tr.lastElementChild.previousElementSibling : tr.lastElementChild;
  return td;
}
/**
 * @desc 递归查找下一个可聚焦元素
 * @param td {dom} 上一个td
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 当前区域的Id
 * @param orderOfHotKey
 */


function findNextSiblings(_ref2) {
  var td = _ref2.td,
      ViewModel = _ref2.ViewModel,
      moduleId = _ref2.moduleId,
      orderOfHotKey = _ref2.orderOfHotKey;
  var nextTd = td.nextElementSibling;
  var currentTr = nextTd && nextTd.parentElement;
  var lastTd = currentTr && findLastTdInRow(currentTr);
  var currentDiv = td.querySelector('[tabindex="0"]');
  var div = nextTd && nextTd.querySelector('[tabindex="0"]'); //如果下个需要聚焦的单元格与最后一个单元相同并且没有可聚焦元素就在下一行查找

  if (lastTd === nextTd && div === null || lastTd === td && currentDiv === null) {
    findNextRowTd({
      tr: currentTr,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  if (div === null || Object(_handleSpecialCase__WEBPACK_IMPORTED_MODULE_2__[/* checkboxInTable */ "a"])(div)) {
    findNextSiblings({
      td: nextTd,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  var cellIdentity = Object(_getCellIdentity__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"])(nextTd);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  executeAutoFocus({
    div: div,
    ViewModel: ViewModel
  });
} //查找下一行可聚焦元素


function findNextRowTd(_ref3) {
  var tr = _ref3.tr,
      ViewModel = _ref3.ViewModel,
      moduleId = _ref3.moduleId,
      orderOfHotKey = _ref3.orderOfHotKey;
  var nextTr = tr && tr.nextElementSibling; //如果是最后一行就查找下个区域的第一个可聚焦元素

  if (nextTr === null) {
    orderOfHotKey && jumpToNextModuleFocusItem({
      currentModuleId: moduleId,
      ViewModel: ViewModel,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  if (nextTr.getAttribute('tabindex') === '-1') {
    findNextRowTd({
      tr: nextTr,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  var div = nextTr.querySelector('td [tabindex="0"]');
  var td = findParentTd(div);
  var cellIdentity = Object(_getCellIdentity__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"])(td);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  executeAutoFocus({
    div: div,
    ViewModel: ViewModel
  });
}
/**
 * @desc 判断业务组是否配置快捷键，如果没有就在本区域内循环 反之根据orderOfHotKey跳转下个区域
 * @param currentModuleId {string} 当前的区域ID
 * @param ViewModel 全局变量
 * @param orderOfHotKey {array} 区域展示顺序
 */


function perceptionHotKeyConfig(_ref4) {
  var currentModuleId = _ref4.currentModuleId,
      ViewModel = _ref4.ViewModel,
      orderOfHotKey = _ref4.orderOfHotKey;

  if (orderOfHotKey && orderOfHotKey.length === 0) {
    findFirstFocusItemInCurrentModule({
      currentModuleId: currentModuleId,
      ViewModel: ViewModel
    });
  } else {
    orderOfHotKey && jumpToNextModuleFocusItem({
      currentModuleId: currentModuleId,
      ViewModel: ViewModel,
      orderOfHotKey: orderOfHotKey
    });
  }
}

function findFirstFocusItemInCurrentModule(_ref5) {
  var currentModuleId = _ref5.currentModuleId,
      ViewModel = _ref5.ViewModel;
  var id = "".concat(_platform_api__WEBPACK_IMPORTED_MODULE_5__["config"].hotKeyModuleIdPrefix, "-").concat(currentModuleId);
  var tableTr = document.querySelector("#".concat(id, " table tbody tr"));
  var tds = tableTr.querySelectorAll('td');
  var firstFocusItem = Array.prototype.find.call(tds, function (td) {
    return td.querySelector('[tabindex="0"]') !== null;
  });
  var cellIdentity = Object(_getCellIdentity__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"])(firstFocusItem);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  var div = firstFocusItem.querySelector('[tabindex="0"]');
  div && executeAutoFocus({
    div: div,
    ViewModel: ViewModel
  });
}

function jumpToNextModuleFocusItem(_ref6) {
  var currentModuleId = _ref6.currentModuleId,
      ViewModel = _ref6.ViewModel,
      orderOfHotKey = _ref6.orderOfHotKey;
  var nextModuleId = calculateNextModuleId(currentModuleId, orderOfHotKey);
  var nextModuleKeyMap = _createKeyMap__WEBPACK_IMPORTED_MODULE_3__[/* keyByModuleId */ "d"][nextModuleId];
  if (nextModuleKeyMap === undefined) return;
  var type = nextModuleKeyMap.type;

  if (type === _config_moduleType__WEBPACK_IMPORTED_MODULE_4__[/* MODULE_TYPE */ "a"].cardTable || type === _config_moduleType__WEBPACK_IMPORTED_MODULE_4__[/* MODULE_TYPE */ "a"].editTable) {
    //如果是table类型就获取当前table显示的页签
    var activeTableKeyMap = _createKeyMap__WEBPACK_IMPORTED_MODULE_3__[/* keyByModuleId */ "d"][nextModuleKeyMap.activeTable];
    var firstItemDom = document.querySelector("div[".concat(activeTableKeyMap.firstItem, "]"));
    var div = firstItemDom.querySelector('[tabindex="0"]');

    if (div === null) {
      var td = firstItemDom.parentElement;
      findNextSiblings({
        td: td,
        ViewModel: ViewModel,
        moduleId: activeTableKeyMap.moduleId,
        orderOfHotKey: orderOfHotKey
      });
    } else {
      var _td = findParentTd(div);
      /**
      * @desc 表格编辑后会导致页面重新渲染导致聚焦状态丢失，因此enter键跳转的需要在全局记录一下，为操作的连续性渲染完成后重新聚焦做标识
      * @type {string}
      */


      var cellIdentity = Object(_getCellIdentity__WEBPACK_IMPORTED_MODULE_0__[/* default */ "a"])(_td);
      cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
      executeAutoFocus({
        div: div,
        ViewModel: ViewModel
      });
    }
  } else {
    Object(_findNextFocusItemInForm__WEBPACK_IMPORTED_MODULE_1__[/* findNextFocusItemInForm */ "b"])(nextModuleKeyMap, nextModuleId);
  }
}

function calculateNextModuleId(currentModuleId, orderOfHotKey) {
  var orderOfHotKeyLen = orderOfHotKey.length;
  var nextModuleIndex = orderOfHotKey.indexOf(currentModuleId) + 1 === orderOfHotKeyLen ? 0 : orderOfHotKey.indexOf(currentModuleId) + 1;
  return orderOfHotKey[nextModuleIndex];
}

function executeAutoFocus(_ref7) {
  var div = _ref7.div,
      ViewModel = _ref7.ViewModel;

  if (div !== null) {
    ViewModel.shouldAutoFocus = true;
    div.ncExecuteFocus = true;
    div.focus();
    delete div.ncExecuteFocus;
  }
}



/***/ }),

/***/ 22:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return matchItemFocus; });
/* unused harmony export cellFocusAfterTabChange */
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _WithKeyboardChange_createKeyMap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(9);



/**
 * @desc 根据不同的formItem类型获取可聚焦的input元素
 * @types {
 *     1: refer,
 *     2: input, select, timepicker, dateTimePicker, datePicker, number,
 *     3: textarea
 * }
 * @matchItemFocus{
 *     refer: func
 * }
 */

var matchItemFocus = {
  refer: setReferItemFocus,
  input: setNormalItemFocus,
  textarea: setTextAreaFocus,
  select: setSelectItemFocus,
  "switch": setSwitchItemFocus,
  switch_browse: setSwitchItemFocus,
  normal: setNormalItemFocus
};

function setReferItemFocus(selector) {
  // let dom = ReactDOM.findDOMNode(component);
  var dom = selector && document.querySelector(selector);
  var inputEl = dom && dom.querySelector("input[tabindex='0']");
  var spanEl = dom && dom.querySelector("span[tabindex='0']");

  if (inputEl) {
    //元素存在就让它聚焦
    inputEl.focus();
    dom = null;
  } else if (spanEl) {
    spanEl.focus();
    dom = null;
  } else {
    dom && dom.addEventListener('DOMSubtreeModified', //autoFocusInTricky.bind(null, dom)
    function wrap(e) {
      autoFocusInTricky(dom, wrap, e);
    });
  } // dom = null;


  inputEl = null;
  spanEl = null;
}
/**
 * todo: 由于refer组件是异步加载，input获取焦点时无法得到dom元素，因此在这儿监听dom更改事件, 希望在refer内部触发一个告诉外部，组件一渲染完成
 */


function autoFocusInTricky(dom, fn, e) {
  var inputEl = e.target.querySelector("input[tabindex='0']"); // inputEl = null

  if (inputEl) {
    setTimeout(function () {
      inputEl.focus();
      dom && dom.removeEventListener('DOMSubtreeModified', fn);
      inputEl = null;
      dom = null;
    });
  }
}

function setNormalItemFocus(selector) {
  // let dom = ReactDOM.findDOMNode(component);
  var dom = selector && document.querySelector(selector);
  var inputEl = dom && dom.querySelector('input');
  inputEl && inputEl.focus();
  dom = null;
  inputEl = null;
}

function setTextAreaFocus(selector) {
  // let dom = ReactDOM.findDOMNode(component);
  var dom = selector && document.querySelector(selector);
  var textEl = dom && dom.querySelector('textarea');
  textEl && textEl.focus();
  dom = null;
  textEl = null;
}

function setSelectItemFocus(selector) {
  // let dom = ReactDOM.findDOMNode(component);
  var dom = selector && document.querySelector(selector);
  var focusDom = dom && dom.querySelector('.u-select-selection[tabindex]') || dom.querySelector('input');
  focusDom && focusDom.focus();
  dom = null;
  focusDom = null;
}

function setSwitchItemFocus(selector) {
  // let dom = ReactDOM.findDOMNode(component);
  var dom = selector && document.querySelector(selector);
  var switchEl = dom && dom.querySelector('span[tabindex]');
  switchEl && switchEl.focus();
  dom = null;
  switchEl = null;
} //标签切换时首个自动聚焦


function cellFocusAfterTabChange(item) {
  if (_WithKeyboardChange_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* keyByModuleId */ "d"][item]) {
    var focusItem = _WithKeyboardChange_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* keyByModuleId */ "d"][item].firstItem;
    var moduleId = _WithKeyboardChange_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* keyByModuleId */ "d"][item] && _WithKeyboardChange_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* keyByModuleId */ "d"][item]['parent'] ? _WithKeyboardChange_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* keyByModuleId */ "d"][item]['parent'] : item;
    focusItem && _platform_api__WEBPACK_IMPORTED_MODULE_0__["PubSub"].publish('autoFocus', {
      data: focusItem,
      force: true,
      moduleId: moduleId
    });
  }
}



/***/ }),

/***/ 23:
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, module) {/**
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright JS Foundation and other contributors <https://js.foundation/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */

/** Used as the size to enable large array optimizations. */
var LARGE_ARRAY_SIZE = 200;

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/** Used to compose bitmasks for value comparisons. */
var COMPARE_PARTIAL_FLAG = 1,
    COMPARE_UNORDERED_FLAG = 2;

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/** `Object#toString` result references. */
var argsTag = '[object Arguments]',
    arrayTag = '[object Array]',
    asyncTag = '[object AsyncFunction]',
    boolTag = '[object Boolean]',
    dateTag = '[object Date]',
    errorTag = '[object Error]',
    funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    mapTag = '[object Map]',
    numberTag = '[object Number]',
    nullTag = '[object Null]',
    objectTag = '[object Object]',
    promiseTag = '[object Promise]',
    proxyTag = '[object Proxy]',
    regexpTag = '[object RegExp]',
    setTag = '[object Set]',
    stringTag = '[object String]',
    symbolTag = '[object Symbol]',
    undefinedTag = '[object Undefined]',
    weakMapTag = '[object WeakMap]';

var arrayBufferTag = '[object ArrayBuffer]',
    dataViewTag = '[object DataView]',
    float32Tag = '[object Float32Array]',
    float64Tag = '[object Float64Array]',
    int8Tag = '[object Int8Array]',
    int16Tag = '[object Int16Array]',
    int32Tag = '[object Int32Array]',
    uint8Tag = '[object Uint8Array]',
    uint8ClampedTag = '[object Uint8ClampedArray]',
    uint16Tag = '[object Uint16Array]',
    uint32Tag = '[object Uint32Array]';

/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */
var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

/** Used to detect host constructors (Safari). */
var reIsHostCtor = /^\[object .+?Constructor\]$/;

/** Used to detect unsigned integer values. */
var reIsUint = /^(?:0|[1-9]\d*)$/;

/** Used to identify `toStringTag` values of typed arrays. */
var typedArrayTags = {};
typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
typedArrayTags[uint32Tag] = true;
typedArrayTags[argsTag] = typedArrayTags[arrayTag] =
typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
typedArrayTags[errorTag] = typedArrayTags[funcTag] =
typedArrayTags[mapTag] = typedArrayTags[numberTag] =
typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
typedArrayTags[setTag] = typedArrayTags[stringTag] =
typedArrayTags[weakMapTag] = false;

/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

/** Detect free variable `exports`. */
var freeExports =  true && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Detect free variable `process` from Node.js. */
var freeProcess = moduleExports && freeGlobal.process;

/** Used to access faster Node.js helpers. */
var nodeUtil = (function() {
  try {
    return freeProcess && freeProcess.binding && freeProcess.binding('util');
  } catch (e) {}
}());

/* Node.js helper references. */
var nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;

/**
 * A specialized version of `_.filter` for arrays without support for
 * iteratee shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {Array} Returns the new filtered array.
 */
function arrayFilter(array, predicate) {
  var index = -1,
      length = array == null ? 0 : array.length,
      resIndex = 0,
      result = [];

  while (++index < length) {
    var value = array[index];
    if (predicate(value, index, array)) {
      result[resIndex++] = value;
    }
  }
  return result;
}

/**
 * Appends the elements of `values` to `array`.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {Array} values The values to append.
 * @returns {Array} Returns `array`.
 */
function arrayPush(array, values) {
  var index = -1,
      length = values.length,
      offset = array.length;

  while (++index < length) {
    array[offset + index] = values[index];
  }
  return array;
}

/**
 * A specialized version of `_.some` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {boolean} Returns `true` if any element passes the predicate check,
 *  else `false`.
 */
function arraySome(array, predicate) {
  var index = -1,
      length = array == null ? 0 : array.length;

  while (++index < length) {
    if (predicate(array[index], index, array)) {
      return true;
    }
  }
  return false;
}

/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */
function baseTimes(n, iteratee) {
  var index = -1,
      result = Array(n);

  while (++index < n) {
    result[index] = iteratee(index);
  }
  return result;
}

/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */
function baseUnary(func) {
  return function(value) {
    return func(value);
  };
}

/**
 * Checks if a `cache` value for `key` exists.
 *
 * @private
 * @param {Object} cache The cache to query.
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function cacheHas(cache, key) {
  return cache.has(key);
}

/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function getValue(object, key) {
  return object == null ? undefined : object[key];
}

/**
 * Converts `map` to its key-value pairs.
 *
 * @private
 * @param {Object} map The map to convert.
 * @returns {Array} Returns the key-value pairs.
 */
function mapToArray(map) {
  var index = -1,
      result = Array(map.size);

  map.forEach(function(value, key) {
    result[++index] = [key, value];
  });
  return result;
}

/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

/**
 * Converts `set` to an array of its values.
 *
 * @private
 * @param {Object} set The set to convert.
 * @returns {Array} Returns the values.
 */
function setToArray(set) {
  var index = -1,
      result = Array(set.size);

  set.forEach(function(value) {
    result[++index] = value;
  });
  return result;
}

/** Used for built-in method references. */
var arrayProto = Array.prototype,
    funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to detect overreaching core-js shims. */
var coreJsData = root['__core-js_shared__'];

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to detect methods masquerading as native. */
var maskSrcKey = (function() {
  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
  return uid ? ('Symbol(src)_1.' + uid) : '';
}());

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/** Used to detect if a method is native. */
var reIsNative = RegExp('^' +
  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
  .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
);

/** Built-in value references. */
var Buffer = moduleExports ? root.Buffer : undefined,
    Symbol = root.Symbol,
    Uint8Array = root.Uint8Array,
    propertyIsEnumerable = objectProto.propertyIsEnumerable,
    splice = arrayProto.splice,
    symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeGetSymbols = Object.getOwnPropertySymbols,
    nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,
    nativeKeys = overArg(Object.keys, Object);

/* Built-in method references that are verified to be native. */
var DataView = getNative(root, 'DataView'),
    Map = getNative(root, 'Map'),
    Promise = getNative(root, 'Promise'),
    Set = getNative(root, 'Set'),
    WeakMap = getNative(root, 'WeakMap'),
    nativeCreate = getNative(Object, 'create');

/** Used to detect maps, sets, and weakmaps. */
var dataViewCtorString = toSource(DataView),
    mapCtorString = toSource(Map),
    promiseCtorString = toSource(Promise),
    setCtorString = toSource(Set),
    weakMapCtorString = toSource(WeakMap);

/** Used to convert symbols to primitives and strings. */
var symbolProto = Symbol ? Symbol.prototype : undefined,
    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;

/**
 * Creates a hash object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Hash(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

/**
 * Removes all key-value entries from the hash.
 *
 * @private
 * @name clear
 * @memberOf Hash
 */
function hashClear() {
  this.__data__ = nativeCreate ? nativeCreate(null) : {};
  this.size = 0;
}

/**
 * Removes `key` and its value from the hash.
 *
 * @private
 * @name delete
 * @memberOf Hash
 * @param {Object} hash The hash to modify.
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function hashDelete(key) {
  var result = this.has(key) && delete this.__data__[key];
  this.size -= result ? 1 : 0;
  return result;
}

/**
 * Gets the hash value for `key`.
 *
 * @private
 * @name get
 * @memberOf Hash
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function hashGet(key) {
  var data = this.__data__;
  if (nativeCreate) {
    var result = data[key];
    return result === HASH_UNDEFINED ? undefined : result;
  }
  return hasOwnProperty.call(data, key) ? data[key] : undefined;
}

/**
 * Checks if a hash value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Hash
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function hashHas(key) {
  var data = this.__data__;
  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);
}

/**
 * Sets the hash `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Hash
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the hash instance.
 */
function hashSet(key, value) {
  var data = this.__data__;
  this.size += this.has(key) ? 0 : 1;
  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;
  return this;
}

// Add methods to `Hash`.
Hash.prototype.clear = hashClear;
Hash.prototype['delete'] = hashDelete;
Hash.prototype.get = hashGet;
Hash.prototype.has = hashHas;
Hash.prototype.set = hashSet;

/**
 * Creates an list cache object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function ListCache(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

/**
 * Removes all key-value entries from the list cache.
 *
 * @private
 * @name clear
 * @memberOf ListCache
 */
function listCacheClear() {
  this.__data__ = [];
  this.size = 0;
}

/**
 * Removes `key` and its value from the list cache.
 *
 * @private
 * @name delete
 * @memberOf ListCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function listCacheDelete(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    return false;
  }
  var lastIndex = data.length - 1;
  if (index == lastIndex) {
    data.pop();
  } else {
    splice.call(data, index, 1);
  }
  --this.size;
  return true;
}

/**
 * Gets the list cache value for `key`.
 *
 * @private
 * @name get
 * @memberOf ListCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function listCacheGet(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  return index < 0 ? undefined : data[index][1];
}

/**
 * Checks if a list cache value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf ListCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function listCacheHas(key) {
  return assocIndexOf(this.__data__, key) > -1;
}

/**
 * Sets the list cache `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf ListCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the list cache instance.
 */
function listCacheSet(key, value) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    ++this.size;
    data.push([key, value]);
  } else {
    data[index][1] = value;
  }
  return this;
}

// Add methods to `ListCache`.
ListCache.prototype.clear = listCacheClear;
ListCache.prototype['delete'] = listCacheDelete;
ListCache.prototype.get = listCacheGet;
ListCache.prototype.has = listCacheHas;
ListCache.prototype.set = listCacheSet;

/**
 * Creates a map cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function MapCache(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

/**
 * Removes all key-value entries from the map.
 *
 * @private
 * @name clear
 * @memberOf MapCache
 */
function mapCacheClear() {
  this.size = 0;
  this.__data__ = {
    'hash': new Hash,
    'map': new (Map || ListCache),
    'string': new Hash
  };
}

/**
 * Removes `key` and its value from the map.
 *
 * @private
 * @name delete
 * @memberOf MapCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function mapCacheDelete(key) {
  var result = getMapData(this, key)['delete'](key);
  this.size -= result ? 1 : 0;
  return result;
}

/**
 * Gets the map value for `key`.
 *
 * @private
 * @name get
 * @memberOf MapCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function mapCacheGet(key) {
  return getMapData(this, key).get(key);
}

/**
 * Checks if a map value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf MapCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function mapCacheHas(key) {
  return getMapData(this, key).has(key);
}

/**
 * Sets the map `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf MapCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the map cache instance.
 */
function mapCacheSet(key, value) {
  var data = getMapData(this, key),
      size = data.size;

  data.set(key, value);
  this.size += data.size == size ? 0 : 1;
  return this;
}

// Add methods to `MapCache`.
MapCache.prototype.clear = mapCacheClear;
MapCache.prototype['delete'] = mapCacheDelete;
MapCache.prototype.get = mapCacheGet;
MapCache.prototype.has = mapCacheHas;
MapCache.prototype.set = mapCacheSet;

/**
 *
 * Creates an array cache object to store unique values.
 *
 * @private
 * @constructor
 * @param {Array} [values] The values to cache.
 */
function SetCache(values) {
  var index = -1,
      length = values == null ? 0 : values.length;

  this.__data__ = new MapCache;
  while (++index < length) {
    this.add(values[index]);
  }
}

/**
 * Adds `value` to the array cache.
 *
 * @private
 * @name add
 * @memberOf SetCache
 * @alias push
 * @param {*} value The value to cache.
 * @returns {Object} Returns the cache instance.
 */
function setCacheAdd(value) {
  this.__data__.set(value, HASH_UNDEFINED);
  return this;
}

/**
 * Checks if `value` is in the array cache.
 *
 * @private
 * @name has
 * @memberOf SetCache
 * @param {*} value The value to search for.
 * @returns {number} Returns `true` if `value` is found, else `false`.
 */
function setCacheHas(value) {
  return this.__data__.has(value);
}

// Add methods to `SetCache`.
SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;
SetCache.prototype.has = setCacheHas;

/**
 * Creates a stack cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Stack(entries) {
  var data = this.__data__ = new ListCache(entries);
  this.size = data.size;
}

/**
 * Removes all key-value entries from the stack.
 *
 * @private
 * @name clear
 * @memberOf Stack
 */
function stackClear() {
  this.__data__ = new ListCache;
  this.size = 0;
}

/**
 * Removes `key` and its value from the stack.
 *
 * @private
 * @name delete
 * @memberOf Stack
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function stackDelete(key) {
  var data = this.__data__,
      result = data['delete'](key);

  this.size = data.size;
  return result;
}

/**
 * Gets the stack value for `key`.
 *
 * @private
 * @name get
 * @memberOf Stack
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function stackGet(key) {
  return this.__data__.get(key);
}

/**
 * Checks if a stack value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Stack
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function stackHas(key) {
  return this.__data__.has(key);
}

/**
 * Sets the stack `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Stack
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the stack cache instance.
 */
function stackSet(key, value) {
  var data = this.__data__;
  if (data instanceof ListCache) {
    var pairs = data.__data__;
    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {
      pairs.push([key, value]);
      this.size = ++data.size;
      return this;
    }
    data = this.__data__ = new MapCache(pairs);
  }
  data.set(key, value);
  this.size = data.size;
  return this;
}

// Add methods to `Stack`.
Stack.prototype.clear = stackClear;
Stack.prototype['delete'] = stackDelete;
Stack.prototype.get = stackGet;
Stack.prototype.has = stackHas;
Stack.prototype.set = stackSet;

/**
 * Creates an array of the enumerable property names of the array-like `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @param {boolean} inherited Specify returning inherited property names.
 * @returns {Array} Returns the array of property names.
 */
function arrayLikeKeys(value, inherited) {
  var isArr = isArray(value),
      isArg = !isArr && isArguments(value),
      isBuff = !isArr && !isArg && isBuffer(value),
      isType = !isArr && !isArg && !isBuff && isTypedArray(value),
      skipIndexes = isArr || isArg || isBuff || isType,
      result = skipIndexes ? baseTimes(value.length, String) : [],
      length = result.length;

  for (var key in value) {
    if ((inherited || hasOwnProperty.call(value, key)) &&
        !(skipIndexes && (
           // Safari 9 has enumerable `arguments.length` in strict mode.
           key == 'length' ||
           // Node.js 0.10 has enumerable non-index properties on buffers.
           (isBuff && (key == 'offset' || key == 'parent')) ||
           // PhantomJS 2 has enumerable non-index properties on typed arrays.
           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||
           // Skip index properties.
           isIndex(key, length)
        ))) {
      result.push(key);
    }
  }
  return result;
}

/**
 * Gets the index at which the `key` is found in `array` of key-value pairs.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} key The key to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function assocIndexOf(array, key) {
  var length = array.length;
  while (length--) {
    if (eq(array[length][0], key)) {
      return length;
    }
  }
  return -1;
}

/**
 * The base implementation of `getAllKeys` and `getAllKeysIn` which uses
 * `keysFunc` and `symbolsFunc` to get the enumerable property names and
 * symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Function} keysFunc The function to get the keys of `object`.
 * @param {Function} symbolsFunc The function to get the symbols of `object`.
 * @returns {Array} Returns the array of property names and symbols.
 */
function baseGetAllKeys(object, keysFunc, symbolsFunc) {
  var result = keysFunc(object);
  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));
}

/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  if (value == null) {
    return value === undefined ? undefinedTag : nullTag;
  }
  return (symToStringTag && symToStringTag in Object(value))
    ? getRawTag(value)
    : objectToString(value);
}

/**
 * The base implementation of `_.isArguments`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 */
function baseIsArguments(value) {
  return isObjectLike(value) && baseGetTag(value) == argsTag;
}

/**
 * The base implementation of `_.isEqual` which supports partial comparisons
 * and tracks traversed objects.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @param {boolean} bitmask The bitmask flags.
 *  1 - Unordered comparison
 *  2 - Partial comparison
 * @param {Function} [customizer] The function to customize comparisons.
 * @param {Object} [stack] Tracks traversed `value` and `other` objects.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 */
function baseIsEqual(value, other, bitmask, customizer, stack) {
  if (value === other) {
    return true;
  }
  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {
    return value !== value && other !== other;
  }
  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);
}

/**
 * A specialized version of `baseIsEqual` for arrays and objects which performs
 * deep comparisons and tracks traversed objects enabling objects with circular
 * references to be compared.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} [stack] Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */
function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {
  var objIsArr = isArray(object),
      othIsArr = isArray(other),
      objTag = objIsArr ? arrayTag : getTag(object),
      othTag = othIsArr ? arrayTag : getTag(other);

  objTag = objTag == argsTag ? objectTag : objTag;
  othTag = othTag == argsTag ? objectTag : othTag;

  var objIsObj = objTag == objectTag,
      othIsObj = othTag == objectTag,
      isSameTag = objTag == othTag;

  if (isSameTag && isBuffer(object)) {
    if (!isBuffer(other)) {
      return false;
    }
    objIsArr = true;
    objIsObj = false;
  }
  if (isSameTag && !objIsObj) {
    stack || (stack = new Stack);
    return (objIsArr || isTypedArray(object))
      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)
      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);
  }
  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {
    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),
        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');

    if (objIsWrapped || othIsWrapped) {
      var objUnwrapped = objIsWrapped ? object.value() : object,
          othUnwrapped = othIsWrapped ? other.value() : other;

      stack || (stack = new Stack);
      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);
    }
  }
  if (!isSameTag) {
    return false;
  }
  stack || (stack = new Stack);
  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);
}

/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */
function baseIsNative(value) {
  if (!isObject(value) || isMasked(value)) {
    return false;
  }
  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;
  return pattern.test(toSource(value));
}

/**
 * The base implementation of `_.isTypedArray` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 */
function baseIsTypedArray(value) {
  return isObjectLike(value) &&
    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];
}

/**
 * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function baseKeys(object) {
  if (!isPrototype(object)) {
    return nativeKeys(object);
  }
  var result = [];
  for (var key in Object(object)) {
    if (hasOwnProperty.call(object, key) && key != 'constructor') {
      result.push(key);
    }
  }
  return result;
}

/**
 * A specialized version of `baseIsEqualDeep` for arrays with support for
 * partial deep comparisons.
 *
 * @private
 * @param {Array} array The array to compare.
 * @param {Array} other The other array to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} stack Tracks traversed `array` and `other` objects.
 * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.
 */
function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {
  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,
      arrLength = array.length,
      othLength = other.length;

  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {
    return false;
  }
  // Assume cyclic values are equal.
  var stacked = stack.get(array);
  if (stacked && stack.get(other)) {
    return stacked == other;
  }
  var index = -1,
      result = true,
      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;

  stack.set(array, other);
  stack.set(other, array);

  // Ignore non-index properties.
  while (++index < arrLength) {
    var arrValue = array[index],
        othValue = other[index];

    if (customizer) {
      var compared = isPartial
        ? customizer(othValue, arrValue, index, other, array, stack)
        : customizer(arrValue, othValue, index, array, other, stack);
    }
    if (compared !== undefined) {
      if (compared) {
        continue;
      }
      result = false;
      break;
    }
    // Recursively compare arrays (susceptible to call stack limits).
    if (seen) {
      if (!arraySome(other, function(othValue, othIndex) {
            if (!cacheHas(seen, othIndex) &&
                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {
              return seen.push(othIndex);
            }
          })) {
        result = false;
        break;
      }
    } else if (!(
          arrValue === othValue ||
            equalFunc(arrValue, othValue, bitmask, customizer, stack)
        )) {
      result = false;
      break;
    }
  }
  stack['delete'](array);
  stack['delete'](other);
  return result;
}

/**
 * A specialized version of `baseIsEqualDeep` for comparing objects of
 * the same `toStringTag`.
 *
 * **Note:** This function only supports comparing values with tags of
 * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {string} tag The `toStringTag` of the objects to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} stack Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */
function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {
  switch (tag) {
    case dataViewTag:
      if ((object.byteLength != other.byteLength) ||
          (object.byteOffset != other.byteOffset)) {
        return false;
      }
      object = object.buffer;
      other = other.buffer;

    case arrayBufferTag:
      if ((object.byteLength != other.byteLength) ||
          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {
        return false;
      }
      return true;

    case boolTag:
    case dateTag:
    case numberTag:
      // Coerce booleans to `1` or `0` and dates to milliseconds.
      // Invalid dates are coerced to `NaN`.
      return eq(+object, +other);

    case errorTag:
      return object.name == other.name && object.message == other.message;

    case regexpTag:
    case stringTag:
      // Coerce regexes to strings and treat strings, primitives and objects,
      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring
      // for more details.
      return object == (other + '');

    case mapTag:
      var convert = mapToArray;

    case setTag:
      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;
      convert || (convert = setToArray);

      if (object.size != other.size && !isPartial) {
        return false;
      }
      // Assume cyclic values are equal.
      var stacked = stack.get(object);
      if (stacked) {
        return stacked == other;
      }
      bitmask |= COMPARE_UNORDERED_FLAG;

      // Recursively compare objects (susceptible to call stack limits).
      stack.set(object, other);
      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);
      stack['delete'](object);
      return result;

    case symbolTag:
      if (symbolValueOf) {
        return symbolValueOf.call(object) == symbolValueOf.call(other);
      }
  }
  return false;
}

/**
 * A specialized version of `baseIsEqualDeep` for objects with support for
 * partial deep comparisons.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.
 * @param {Function} customizer The function to customize comparisons.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Object} stack Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */
function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {
  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,
      objProps = getAllKeys(object),
      objLength = objProps.length,
      othProps = getAllKeys(other),
      othLength = othProps.length;

  if (objLength != othLength && !isPartial) {
    return false;
  }
  var index = objLength;
  while (index--) {
    var key = objProps[index];
    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {
      return false;
    }
  }
  // Assume cyclic values are equal.
  var stacked = stack.get(object);
  if (stacked && stack.get(other)) {
    return stacked == other;
  }
  var result = true;
  stack.set(object, other);
  stack.set(other, object);

  var skipCtor = isPartial;
  while (++index < objLength) {
    key = objProps[index];
    var objValue = object[key],
        othValue = other[key];

    if (customizer) {
      var compared = isPartial
        ? customizer(othValue, objValue, key, other, object, stack)
        : customizer(objValue, othValue, key, object, other, stack);
    }
    // Recursively compare objects (susceptible to call stack limits).
    if (!(compared === undefined
          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))
          : compared
        )) {
      result = false;
      break;
    }
    skipCtor || (skipCtor = key == 'constructor');
  }
  if (result && !skipCtor) {
    var objCtor = object.constructor,
        othCtor = other.constructor;

    // Non `Object` object instances with different constructors are not equal.
    if (objCtor != othCtor &&
        ('constructor' in object && 'constructor' in other) &&
        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&
          typeof othCtor == 'function' && othCtor instanceof othCtor)) {
      result = false;
    }
  }
  stack['delete'](object);
  stack['delete'](other);
  return result;
}

/**
 * Creates an array of own enumerable property names and symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names and symbols.
 */
function getAllKeys(object) {
  return baseGetAllKeys(object, keys, getSymbols);
}

/**
 * Gets the data for `map`.
 *
 * @private
 * @param {Object} map The map to query.
 * @param {string} key The reference key.
 * @returns {*} Returns the map data.
 */
function getMapData(map, key) {
  var data = map.__data__;
  return isKeyable(key)
    ? data[typeof key == 'string' ? 'string' : 'hash']
    : data.map;
}

/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */
function getNative(object, key) {
  var value = getValue(object, key);
  return baseIsNative(value) ? value : undefined;
}

/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */
function getRawTag(value) {
  var isOwn = hasOwnProperty.call(value, symToStringTag),
      tag = value[symToStringTag];

  try {
    value[symToStringTag] = undefined;
    var unmasked = true;
  } catch (e) {}

  var result = nativeObjectToString.call(value);
  if (unmasked) {
    if (isOwn) {
      value[symToStringTag] = tag;
    } else {
      delete value[symToStringTag];
    }
  }
  return result;
}

/**
 * Creates an array of the own enumerable symbols of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of symbols.
 */
var getSymbols = !nativeGetSymbols ? stubArray : function(object) {
  if (object == null) {
    return [];
  }
  object = Object(object);
  return arrayFilter(nativeGetSymbols(object), function(symbol) {
    return propertyIsEnumerable.call(object, symbol);
  });
};

/**
 * Gets the `toStringTag` of `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
var getTag = baseGetTag;

// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.
if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||
    (Map && getTag(new Map) != mapTag) ||
    (Promise && getTag(Promise.resolve()) != promiseTag) ||
    (Set && getTag(new Set) != setTag) ||
    (WeakMap && getTag(new WeakMap) != weakMapTag)) {
  getTag = function(value) {
    var result = baseGetTag(value),
        Ctor = result == objectTag ? value.constructor : undefined,
        ctorString = Ctor ? toSource(Ctor) : '';

    if (ctorString) {
      switch (ctorString) {
        case dataViewCtorString: return dataViewTag;
        case mapCtorString: return mapTag;
        case promiseCtorString: return promiseTag;
        case setCtorString: return setTag;
        case weakMapCtorString: return weakMapTag;
      }
    }
    return result;
  };
}

/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */
function isIndex(value, length) {
  length = length == null ? MAX_SAFE_INTEGER : length;
  return !!length &&
    (typeof value == 'number' || reIsUint.test(value)) &&
    (value > -1 && value % 1 == 0 && value < length);
}

/**
 * Checks if `value` is suitable for use as unique object key.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
 */
function isKeyable(value) {
  var type = typeof value;
  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')
    ? (value !== '__proto__')
    : (value === null);
}

/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */
function isMasked(func) {
  return !!maskSrcKey && (maskSrcKey in func);
}

/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */
function isPrototype(value) {
  var Ctor = value && value.constructor,
      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;

  return value === proto;
}

/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */
function objectToString(value) {
  return nativeObjectToString.call(value);
}

/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to convert.
 * @returns {string} Returns the source code.
 */
function toSource(func) {
  if (func != null) {
    try {
      return funcToString.call(func);
    } catch (e) {}
    try {
      return (func + '');
    } catch (e) {}
  }
  return '';
}

/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */
function eq(value, other) {
  return value === other || (value !== value && other !== other);
}

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {
  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&
    !propertyIsEnumerable.call(value, 'callee');
};

/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

/**
 * Checks if `value` is a buffer.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
 * @example
 *
 * _.isBuffer(new Buffer(2));
 * // => true
 *
 * _.isBuffer(new Uint8Array(2));
 * // => false
 */
var isBuffer = nativeIsBuffer || stubFalse;

/**
 * Performs a deep comparison between two values to determine if they are
 * equivalent.
 *
 * **Note:** This method supports comparing arrays, array buffers, booleans,
 * date objects, error objects, maps, numbers, `Object` objects, regexes,
 * sets, strings, symbols, and typed arrays. `Object` objects are compared
 * by their own, not inherited, enumerable properties. Functions and DOM
 * nodes are compared by strict equality, i.e. `===`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.isEqual(object, other);
 * // => true
 *
 * object === other;
 * // => false
 */
function isEqual(value, other) {
  return baseIsEqual(value, other);
}

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  if (!isObject(value)) {
    return false;
  }
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 9 which returns 'object' for typed arrays and other constructors.
  var tag = baseGetTag(value);
  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
}

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return value != null && typeof value == 'object';
}

/**
 * Checks if `value` is classified as a typed array.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 * @example
 *
 * _.isTypedArray(new Uint8Array);
 * // => true
 *
 * _.isTypedArray([]);
 * // => false
 */
var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;

/**
 * Creates an array of the own enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects. See the
 * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * for more details.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keys(new Foo);
 * // => ['a', 'b'] (iteration order is not guaranteed)
 *
 * _.keys('hi');
 * // => ['0', '1']
 */
function keys(object) {
  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);
}

/**
 * This method returns a new empty array.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {Array} Returns the new empty array.
 * @example
 *
 * var arrays = _.times(2, _.stubArray);
 *
 * console.log(arrays);
 * // => [[], []]
 *
 * console.log(arrays[0] === arrays[1]);
 * // => false
 */
function stubArray() {
  return [];
}

/**
 * This method returns `false`.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {boolean} Returns `false`.
 * @example
 *
 * _.times(2, _.stubFalse);
 * // => [false, false]
 */
function stubFalse() {
  return false;
}

module.exports = isEqual;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(36), __webpack_require__(52)(module)))

/***/ }),

/***/ 24:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__24__;

/***/ }),

/***/ 25:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


if (true) {
  module.exports = __webpack_require__(117);
} else {}


/***/ }),

/***/ 3:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__3__;

/***/ }),

/***/ 328:
/***/ (function(module, exports, __webpack_require__) {

var Symbol = __webpack_require__(93);

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/** Built-in value references. */
var symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */
function getRawTag(value) {
  var isOwn = hasOwnProperty.call(value, symToStringTag),
      tag = value[symToStringTag];

  try {
    value[symToStringTag] = undefined;
    var unmasked = true;
  } catch (e) {}

  var result = nativeObjectToString.call(value);
  if (unmasked) {
    if (isOwn) {
      value[symToStringTag] = tag;
    } else {
      delete value[symToStringTag];
    }
  }
  return result;
}

module.exports = getRawTag;


/***/ }),

/***/ 329:
/***/ (function(module, exports) {

/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */
function objectToString(value) {
  return nativeObjectToString.call(value);
}

module.exports = objectToString;


/***/ }),

/***/ 33:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(25);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_hotkeys__WEBPACK_IMPORTED_MODULE_2__);
function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof2(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _typeof2(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof2(obj); }





__webpack_require__(690);
/**
 * 通用的组合键
 */


var USUAL_KEYS = {
  // 新增
  ADD: ['Ctrl+/'],
  // 刪除
  DELETE: ['Del'],
  // 保存
  SAVE: ['Ctrl+S'],
  // 保存新增
  SAVE_ADD: ['Alt+S'],
  // 編輯
  EDIT: ['Ctrl+E'],
  // 保存提交
  SAVE_SUBMIT: ['Ctrl+T'],
  // 取消
  CAEL: ['Alt+Q'],
  // 暂存
  STORAGE: ['Ctrl+Alt+S'],
  // 刪除行
  DELETE_ROW: ['Alt+Del'],
  // 窗口取消按钮
  MODAL_CALCEL: ['Alt+N'],
  // 窗口确定按钮
  MODAL_CONFIRM: ['Alt+Y'],
  // CardPagination
  // 卡片分页末页按钮
  CARDPAGE_END: ['Alt+End'],
  // 卡片分页上一页按钮
  CARDPAGE_UP: ['Alt+Pageup'],
  // 卡片分页下一页按钮
  CARDPAGE_DOWN: ['Alt+Pagedown'],
  // 卡片分页首页按钮
  CARDPAGE_HOME: ['Alt+Home'],
  // 常用按钮
  BTN_PRINT: ['Ctrl+P'],
  // 窗口的x
  ICON_CLOSE: ['Esc']
};
var defaultProps = {
  // 事件key集合  {addData: ['ctrl+s']}
  keyMap: {},
  // 处理方法集合  {addData: ()=> {}}  注意键的配置和处理逻辑的配置对应
  handlers: {},
  // 是否启用
  enabled: true,
  // 触发事件的目标
  attach: document.body,
  // 如果为flase 则聚焦到当前包裹区域时才触发
  // focused: false, // 是否默认聚焦  设置true 不聚焦到区域也可以触发
  display: 'block',
  // 是否清理 弹窗
  clearOpenPanel: true // 可以是方法回调

};
/**
 * 首字母大写
 * @param {*} str
 */

function firstToUpperCase(str) {
  str = str.replace(/ /g, '');
  return str.toLowerCase().replace(/( |^)[a-z]/g, function (L) {
    return L.toUpperCase();
  });
}
/**
 * 转换为小写
 * @param {*} str
 */


function toLowerCase(str) {
  str = str.replace(/ /g, '');
  return str.toLowerCase();
}

function _typeof(obj) {
  if (obj == null) {
    return String(obj);
  }

  return _typeof2(obj) === 'object' || typeof obj === 'function' ? Object.prototype.toString.call(obj).replace(/object|\[|\]| /g, '') || 'object' : _typeof2(obj);
}
/**
 * 二次封装了  hotkeys 组件
 */


var HotKeys = /*#__PURE__*/function (_Component) {
  _inherits(HotKeys, _Component);

  var _super = _createSuper(HotKeys);

  function HotKeys(props) {
    var _this;

    _classCallCheck(this, HotKeys);

    _this = _super.call(this, props);
    _this.state = {
      enabled: _this.props.enabled
    };
    return _this;
  }

  _createClass(HotKeys, [{
    key: "UNSAFE_componentWillReceiveProps",
    value: function UNSAFE_componentWillReceiveProps(nextProps) {
      if (!!nextProps.enabled && nextProps.enabled !== this.state.enabled) {
        this.setState({
          enabled: nextProps.enabled
        });
      }
    }
  }, {
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      // 在iframe中使用时会导致  聚焦不到iframe内部
      var attach = this.props.attach; // if (attach === document.body) {
      //     document.body.tabindex = "0";
      //     document.body.setAttribute('tabindex', 0);
      // }
    }
  }, {
    key: "componentDidMount",
    value: function componentDidMount() {// HotKeys.USUAL_KEYS.EDIT = ['ctrl+g'];
      // TODO 未来可以请求数据  然后设置数据
    }
    /**
     * 获取翻译之后的keys
     * @param {*} keys
     */

  }, {
    key: "getTranslateKeys",
    value: function getTranslateKeys(keys) {
      var type = _typeof(keys);

      if (type === 'string') {
        keys = toLowerCase(USUAL_KEYS[keys] ? USUAL_KEYS[keys][0] : keys);
      } else if (type === 'Array') {
        // 翻译
        keys = keys.map(function (item, index) {
          return toLowerCase(USUAL_KEYS[item] ? USUAL_KEYS[item][0] : item);
        }); // 去重

        keys = _toConsumableArray(new Set(keys));
      } else if (type === 'Object' && keys.sequence && keys.action) {
        keys = {
          sequence: keys.sequence,
          action: keys.action
        };
      } else {
        keys = ['up+down+left+right+b+a+b+a'];
      }

      return keys;
    }
    /**
     * 清理頁面的彈出面板
     * TODO: 后续要考虑下其他方案  目前这个方案太low了
     */

  }, {
    key: "clearOpenPanel",
    value: function clearOpenPanel(keyCode) {
      // 特殊键处理
      if (keyCode === 'enter' || keyCode[0] === 'enter') {
        return false;
      } // 日期和时间太复杂  特殊处理下


      var d = document.querySelector('.rc-calendar-picker') || document.querySelector('.u-time-picker-panel');

      if (d) {
        _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].publish('clearOpenPanel', {
          type: 'picker'
        });
      } // 这里没有考虑多个展开的问题 而且 有多个展开时应该如何处理
      // 也没有考虑到 组件本身用了 hotkeys 操作的问题


      if (document && (document.querySelector('.u-dropdown:not(.u-dropdown-hidden)') || document.querySelector('.u-select-dropdown:not(.u-select-dropdown-hidden)') || document.querySelector('.mores-list-wrapper:not(.mores-list-hide-wrapper)'))) {
        // 这一坨我也是醉了  要判断  非隐藏的情况下显示了
        console.log('use hotkeys and clear panel');
        document.activeElement.click();
        console.log(document.activeElement);
      }
    }
  }, {
    key: "triggerEventHandle",
    value: function triggerEventHandle(k, e, sequence) {
      var _this$props = this.props,
          _this$props$handlers = _this$props.handlers,
          handlers = _this$props$handlers === void 0 ? {} : _this$props$handlers,
          _this$props$clearOpen = _this$props.clearOpenPanel,
          clearOpenPanel = _this$props$clearOpen === void 0 ? true : _this$props$clearOpen; // console.log(k, e, sequence);

      if (Object.prototype.toString.call(clearOpenPanel) === '[object Function]') {
        clearOpenPanel();
      }

      if (clearOpenPanel === true) {
        this.clearOpenPanel(sequence);
      }

      e.preventDefault();
      handlers[k] && handlers[k](e, sequence);
    }
    /**
     * 獲取KeyMapsAndHandlers
     */

  }, {
    key: "getKeyMapsAndHandlers",
    value: function getKeyMapsAndHandlers() {
      var _this$props2 = this.props,
          _this$props2$keyMap = _this$props2.keyMap,
          keyMap = _this$props2$keyMap === void 0 ? {} : _this$props2$keyMap,
          _this$props2$handlers = _this$props2.handlers,
          handlers = _this$props2$handlers === void 0 ? {} : _this$props2$handlers,
          _this$props2$keyMapX = _this$props2.keyMapX,
          keyMapX = _this$props2$keyMapX === void 0 ? {} : _this$props2$keyMapX,
          _this$props2$handlers2 = _this$props2.handlersX,
          handlersX = _this$props2$handlers2 === void 0 ? {} : _this$props2$handlers2;

      for (var k in keyMap) {
        keyMapX[k] = this.getTranslateKeys(keyMap[k]); // handlersX[k] = function (e) {
        //     this.clearOpenPanel(keyMapX[k]);
        //     e.preventDefault();
        //     handlers[k] && handlers[k](e, keyMapX[k]);
        // };
        // handlersX[k] = ((k, handlers, keyMapX, self) => {
        //     // 包装
        //     return function (e) {
        //         self.clearOpenPanel(keyMapX[k]);
        //         e.preventDefault();
        //         handlers[k] && handlers[k](e, keyMapX[k]);
        //     };
        // })(k, handlers, keyMapX, this);

        handlersX[k] = this.triggerEventHandle.bind(this, k);
      }

      keyMapX = Object.assign({}, keyMapX);
      handlersX = Object.assign({}, handlersX); // 过滤一些空的hotkeys

      if (Object.keys(keyMapX).length === 0 || Object.keys(handlersX).length === 0) {
        return false;
      }

      return {
        keyMapX: keyMapX,
        handlersX: handlersX
      };
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props3 = this.props,
          enabled = _this$props3.enabled,
          keyMap = _this$props3.keyMap,
          handlers = _this$props3.handlers,
          _this$props3$children = _this$props3.children,
          children = _this$props3$children === void 0 ? null : _this$props3$children,
          _this$props3$classNam = _this$props3.className,
          className = _this$props3$classNam === void 0 ? '' : _this$props3$classNam,
          display = _this$props3.display,
          clearOpenPanel = _this$props3.clearOpenPanel,
          others = _objectWithoutProperties(_this$props3, ["enabled", "keyMap", "handlers", "children", "className", "display", "clearOpenPanel"]);

      var assignResult = this.getKeyMapsAndHandlers(); // 處理一下 合并結果

      return assignResult && enabled ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_hotkeys__WEBPACK_IMPORTED_MODULE_2__["HotKeys"], _extends({
        keyMap: assignResult.keyMapX,
        handlers: assignResult.handlersX,
        ref: function ref(dom) {
          return _this2.hotkeyWrapped = dom;
        },
        className: 'nc-hotkeys-wrapper ' + className,
        style: {
          display: display
        }
      }, others), children) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: className,
        style: {
          display: display
        }
      }, children);
    }
  }]);

  return HotKeys;
}(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);

HotKeys.USUAL_KEYS = USUAL_KEYS;
HotKeys.defaultProps = defaultProps;
/* harmony default export */ __webpack_exports__["a"] = (HotKeys);

/***/ }),

/***/ 330:
/***/ (function(module, exports, __webpack_require__) {

var Hash = __webpack_require__(331),
    ListCache = __webpack_require__(342),
    Map = __webpack_require__(348);

/**
 * Removes all key-value entries from the map.
 *
 * @private
 * @name clear
 * @memberOf MapCache
 */
function mapCacheClear() {
  this.size = 0;
  this.__data__ = {
    'hash': new Hash,
    'map': new (Map || ListCache),
    'string': new Hash
  };
}

module.exports = mapCacheClear;


/***/ }),

/***/ 331:
/***/ (function(module, exports, __webpack_require__) {

var hashClear = __webpack_require__(332),
    hashDelete = __webpack_require__(338),
    hashGet = __webpack_require__(339),
    hashHas = __webpack_require__(340),
    hashSet = __webpack_require__(341);

/**
 * Creates a hash object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Hash(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

// Add methods to `Hash`.
Hash.prototype.clear = hashClear;
Hash.prototype['delete'] = hashDelete;
Hash.prototype.get = hashGet;
Hash.prototype.has = hashHas;
Hash.prototype.set = hashSet;

module.exports = Hash;


/***/ }),

/***/ 332:
/***/ (function(module, exports, __webpack_require__) {

var nativeCreate = __webpack_require__(65);

/**
 * Removes all key-value entries from the hash.
 *
 * @private
 * @name clear
 * @memberOf Hash
 */
function hashClear() {
  this.__data__ = nativeCreate ? nativeCreate(null) : {};
  this.size = 0;
}

module.exports = hashClear;


/***/ }),

/***/ 333:
/***/ (function(module, exports, __webpack_require__) {

var isFunction = __webpack_require__(146),
    isMasked = __webpack_require__(334),
    isObject = __webpack_require__(87),
    toSource = __webpack_require__(336);

/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */
var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

/** Used to detect host constructors (Safari). */
var reIsHostCtor = /^\[object .+?Constructor\]$/;

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to detect if a method is native. */
var reIsNative = RegExp('^' +
  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
  .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
);

/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */
function baseIsNative(value) {
  if (!isObject(value) || isMasked(value)) {
    return false;
  }
  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;
  return pattern.test(toSource(value));
}

module.exports = baseIsNative;


/***/ }),

/***/ 334:
/***/ (function(module, exports, __webpack_require__) {

var coreJsData = __webpack_require__(335);

/** Used to detect methods masquerading as native. */
var maskSrcKey = (function() {
  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
  return uid ? ('Symbol(src)_1.' + uid) : '';
}());

/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */
function isMasked(func) {
  return !!maskSrcKey && (maskSrcKey in func);
}

module.exports = isMasked;


/***/ }),

/***/ 335:
/***/ (function(module, exports, __webpack_require__) {

var root = __webpack_require__(64);

/** Used to detect overreaching core-js shims. */
var coreJsData = root['__core-js_shared__'];

module.exports = coreJsData;


/***/ }),

/***/ 336:
/***/ (function(module, exports) {

/** Used for built-in method references. */
var funcProto = Function.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to convert.
 * @returns {string} Returns the source code.
 */
function toSource(func) {
  if (func != null) {
    try {
      return funcToString.call(func);
    } catch (e) {}
    try {
      return (func + '');
    } catch (e) {}
  }
  return '';
}

module.exports = toSource;


/***/ }),

/***/ 337:
/***/ (function(module, exports) {

/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function getValue(object, key) {
  return object == null ? undefined : object[key];
}

module.exports = getValue;


/***/ }),

/***/ 338:
/***/ (function(module, exports) {

/**
 * Removes `key` and its value from the hash.
 *
 * @private
 * @name delete
 * @memberOf Hash
 * @param {Object} hash The hash to modify.
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function hashDelete(key) {
  var result = this.has(key) && delete this.__data__[key];
  this.size -= result ? 1 : 0;
  return result;
}

module.exports = hashDelete;


/***/ }),

/***/ 339:
/***/ (function(module, exports, __webpack_require__) {

var nativeCreate = __webpack_require__(65);

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Gets the hash value for `key`.
 *
 * @private
 * @name get
 * @memberOf Hash
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function hashGet(key) {
  var data = this.__data__;
  if (nativeCreate) {
    var result = data[key];
    return result === HASH_UNDEFINED ? undefined : result;
  }
  return hasOwnProperty.call(data, key) ? data[key] : undefined;
}

module.exports = hashGet;


/***/ }),

/***/ 340:
/***/ (function(module, exports, __webpack_require__) {

var nativeCreate = __webpack_require__(65);

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Checks if a hash value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Hash
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function hashHas(key) {
  var data = this.__data__;
  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);
}

module.exports = hashHas;


/***/ }),

/***/ 341:
/***/ (function(module, exports, __webpack_require__) {

var nativeCreate = __webpack_require__(65);

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/**
 * Sets the hash `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Hash
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the hash instance.
 */
function hashSet(key, value) {
  var data = this.__data__;
  this.size += this.has(key) ? 0 : 1;
  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;
  return this;
}

module.exports = hashSet;


/***/ }),

/***/ 342:
/***/ (function(module, exports, __webpack_require__) {

var listCacheClear = __webpack_require__(343),
    listCacheDelete = __webpack_require__(344),
    listCacheGet = __webpack_require__(345),
    listCacheHas = __webpack_require__(346),
    listCacheSet = __webpack_require__(347);

/**
 * Creates an list cache object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function ListCache(entries) {
  var index = -1,
      length = entries == null ? 0 : entries.length;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

// Add methods to `ListCache`.
ListCache.prototype.clear = listCacheClear;
ListCache.prototype['delete'] = listCacheDelete;
ListCache.prototype.get = listCacheGet;
ListCache.prototype.has = listCacheHas;
ListCache.prototype.set = listCacheSet;

module.exports = ListCache;


/***/ }),

/***/ 343:
/***/ (function(module, exports) {

/**
 * Removes all key-value entries from the list cache.
 *
 * @private
 * @name clear
 * @memberOf ListCache
 */
function listCacheClear() {
  this.__data__ = [];
  this.size = 0;
}

module.exports = listCacheClear;


/***/ }),

/***/ 344:
/***/ (function(module, exports, __webpack_require__) {

var assocIndexOf = __webpack_require__(66);

/** Used for built-in method references. */
var arrayProto = Array.prototype;

/** Built-in value references. */
var splice = arrayProto.splice;

/**
 * Removes `key` and its value from the list cache.
 *
 * @private
 * @name delete
 * @memberOf ListCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function listCacheDelete(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    return false;
  }
  var lastIndex = data.length - 1;
  if (index == lastIndex) {
    data.pop();
  } else {
    splice.call(data, index, 1);
  }
  --this.size;
  return true;
}

module.exports = listCacheDelete;


/***/ }),

/***/ 345:
/***/ (function(module, exports, __webpack_require__) {

var assocIndexOf = __webpack_require__(66);

/**
 * Gets the list cache value for `key`.
 *
 * @private
 * @name get
 * @memberOf ListCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function listCacheGet(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  return index < 0 ? undefined : data[index][1];
}

module.exports = listCacheGet;


/***/ }),

/***/ 346:
/***/ (function(module, exports, __webpack_require__) {

var assocIndexOf = __webpack_require__(66);

/**
 * Checks if a list cache value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf ListCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function listCacheHas(key) {
  return assocIndexOf(this.__data__, key) > -1;
}

module.exports = listCacheHas;


/***/ }),

/***/ 347:
/***/ (function(module, exports, __webpack_require__) {

var assocIndexOf = __webpack_require__(66);

/**
 * Sets the list cache `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf ListCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the list cache instance.
 */
function listCacheSet(key, value) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    ++this.size;
    data.push([key, value]);
  } else {
    data[index][1] = value;
  }
  return this;
}

module.exports = listCacheSet;


/***/ }),

/***/ 348:
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(86),
    root = __webpack_require__(64);

/* Built-in method references that are verified to be native. */
var Map = getNative(root, 'Map');

module.exports = Map;


/***/ }),

/***/ 349:
/***/ (function(module, exports, __webpack_require__) {

var getMapData = __webpack_require__(67);

/**
 * Removes `key` and its value from the map.
 *
 * @private
 * @name delete
 * @memberOf MapCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function mapCacheDelete(key) {
  var result = getMapData(this, key)['delete'](key);
  this.size -= result ? 1 : 0;
  return result;
}

module.exports = mapCacheDelete;


/***/ }),

/***/ 350:
/***/ (function(module, exports) {

/**
 * Checks if `value` is suitable for use as unique object key.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
 */
function isKeyable(value) {
  var type = typeof value;
  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')
    ? (value !== '__proto__')
    : (value === null);
}

module.exports = isKeyable;


/***/ }),

/***/ 351:
/***/ (function(module, exports, __webpack_require__) {

var getMapData = __webpack_require__(67);

/**
 * Gets the map value for `key`.
 *
 * @private
 * @name get
 * @memberOf MapCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function mapCacheGet(key) {
  return getMapData(this, key).get(key);
}

module.exports = mapCacheGet;


/***/ }),

/***/ 352:
/***/ (function(module, exports, __webpack_require__) {

var getMapData = __webpack_require__(67);

/**
 * Checks if a map value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf MapCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function mapCacheHas(key) {
  return getMapData(this, key).has(key);
}

module.exports = mapCacheHas;


/***/ }),

/***/ 353:
/***/ (function(module, exports, __webpack_require__) {

var getMapData = __webpack_require__(67);

/**
 * Sets the map `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf MapCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the map cache instance.
 */
function mapCacheSet(key, value) {
  var data = getMapData(this, key),
      size = data.size;

  data.set(key, value);
  this.size += data.size == size ? 0 : 1;
  return this;
}

module.exports = mapCacheSet;


/***/ }),

/***/ 354:
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(86);

var defineProperty = (function() {
  try {
    var func = getNative(Object, 'defineProperty');
    func({}, '', {});
    return func;
  } catch (e) {}
}());

module.exports = defineProperty;


/***/ }),

/***/ 36:
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ 367:
/***/ (function(module, exports, __webpack_require__) {

var MapCache = __webpack_require__(171),
    setCacheAdd = __webpack_require__(723),
    setCacheHas = __webpack_require__(724);

/**
 *
 * Creates an array cache object to store unique values.
 *
 * @private
 * @constructor
 * @param {Array} [values] The values to cache.
 */
function SetCache(values) {
  var index = -1,
      length = values == null ? 0 : values.length;

  this.__data__ = new MapCache;
  while (++index < length) {
    this.add(values[index]);
  }
}

// Add methods to `SetCache`.
SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;
SetCache.prototype.has = setCacheHas;

module.exports = SetCache;


/***/ }),

/***/ 368:
/***/ (function(module, exports, __webpack_require__) {

var baseIndexOf = __webpack_require__(725);

/**
 * A specialized version of `_.includes` for arrays without support for
 * specifying an index to search from.
 *
 * @private
 * @param {Array} [array] The array to inspect.
 * @param {*} target The value to search for.
 * @returns {boolean} Returns `true` if `target` is found, else `false`.
 */
function arrayIncludes(array, value) {
  var length = array == null ? 0 : array.length;
  return !!length && baseIndexOf(array, value, 0) > -1;
}

module.exports = arrayIncludes;


/***/ }),

/***/ 369:
/***/ (function(module, exports) {

/**
 * This function is like `arrayIncludes` except that it accepts a comparator.
 *
 * @private
 * @param {Array} [array] The array to inspect.
 * @param {*} target The value to search for.
 * @param {Function} comparator The comparator invoked per element.
 * @returns {boolean} Returns `true` if `target` is found, else `false`.
 */
function arrayIncludesWith(array, value, comparator) {
  var index = -1,
      length = array == null ? 0 : array.length;

  while (++index < length) {
    if (comparator(value, array[index])) {
      return true;
    }
  }
  return false;
}

module.exports = arrayIncludesWith;


/***/ }),

/***/ 37:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return checkboxInTable; });
/**
 * @desc 表格可编辑的状态下checkbox类型的单元格没有浏览态与编辑态之分, 因此需要在checkbox的属性上去判断此单元格是否可编辑
 */
function checkboxInTable(dom) {
  if (dom.tagName !== 'INPUT') return false; //如果是不可编辑的checkbox就继续查找下一个可聚焦元素

  if (dom && dom.disabled === true) {
    return true;
  }
}

/***/ }),

/***/ 370:
/***/ (function(module, exports) {

/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */
function baseUnary(func) {
  return function(value) {
    return func(value);
  };
}

module.exports = baseUnary;


/***/ }),

/***/ 371:
/***/ (function(module, exports) {

/**
 * Checks if a `cache` value for `key` exists.
 *
 * @private
 * @param {Object} cache The cache to query.
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function cacheHas(cache, key) {
  return cache.has(key);
}

module.exports = cacheHas;


/***/ }),

/***/ 372:
/***/ (function(module, exports) {

/**
 * This method returns the first argument it receives.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {*} value Any value.
 * @returns {*} Returns `value`.
 * @example
 *
 * var object = { 'a': 1 };
 *
 * console.log(_.identity(object) === object);
 * // => true
 */
function identity(value) {
  return value;
}

module.exports = identity;


/***/ }),

/***/ 373:
/***/ (function(module, exports, __webpack_require__) {

var isFunction = __webpack_require__(146),
    isLength = __webpack_require__(416);

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

module.exports = isArrayLike;


/***/ }),

/***/ 374:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 38:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, "b", function() { return /* binding */ keyDownOfShiftUp; });
__webpack_require__.d(__webpack_exports__, "a", function() { return /* binding */ handleArrowKeyDown; });

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/createKeyMap.js + 1 modules
var createKeyMap = __webpack_require__(9);

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/config/moduleType.js
var moduleType = __webpack_require__(15);

// EXTERNAL MODULE: external "@platform/api/index"
var index_ = __webpack_require__(1);

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/util/findNextFocusItemInTable.js
var findNextFocusItemInTable = __webpack_require__(20);

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/util/getCellIdentity.js
var getCellIdentity = __webpack_require__(18);

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/util/handleSpecialCase.js
var handleSpecialCase = __webpack_require__(37);

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/util/findNextFocusItemInForm.js
var findNextFocusItemInForm = __webpack_require__(54);

// CONCATENATED MODULE: ./src/platform/components/WithKeyboardChange/util/findPrevFoucsItemInTable.js








/**
 * @desc 查找下一个可聚焦元素
 * @param target {dom} 事件源
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 当前区域Id
 * @param orderOfHotKey {array} 区域显示顺序配置
 */

function findPrevFocusItemInTable(_ref) {
  var eventTarget = _ref.eventTarget,
      ViewModel = _ref.ViewModel,
      moduleId = _ref.moduleId,
      orderOfHotKey = _ref.orderOfHotKey;
  var parentTd = eventTarget.tagName === 'TD' ? eventTarget : Object(index_["findParentTd"])(eventTarget);

  if (!parentTd) {
    // 这里报错的原因是因为某些事件（下拉的keydown）执行了两次
    console.warn('not find parentTd, prev hotkey invalid');
    return;
  }

  var prevTd = parentTd.previousElementSibling;
  var currentTr = parentTd.parentElement;
  var firstTd = findFirstTdInRow(currentTr);
  var div = prevTd && prevTd.querySelector('[tabindex="0"]'); //如果是第一一个元素就需要判断跳到上一行还是跳到上一个区域

  if (firstTd === parentTd) {
    var lastTr = currentTr.parentElement.lastElementChild;
    currentTr === lastTr ? perceptionHotKeyConfig({
      currentModuleId: moduleId,
      ViewModel: ViewModel,
      orderOfHotKey: orderOfHotKey
    }) : findPrevRowTd({
      tr: currentTr,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } // 如果下一个元素没有找到就继续查找


  if (div === null || Object(handleSpecialCase["a" /* checkboxInTable */])(div)) {
    findPrevSiblings({
      td: prevTd,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } // 解决table 设值后重新渲染导致焦点缺失的问题,在这里保留一下id


  var cellIdentity = Object(getCellIdentity["a" /* default */])(prevTd);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
    div: div,
    ViewModel: ViewModel
  });
}
/**
 * @desc 查找当前行里的第一个td，需要排除操作列
 * @param tr {dom}
 * @return td {dom}
 */


function findFirstTdInRow(tr) {
  var tds = tr.querySelectorAll('td');
  var td = Array.prototype.find.call(tds, function (td) {
    return !td.className.includes('fixed');
  });
  return td;
}
/**
 * @desc 判断业务组是否配置快捷键，如果没有就在本区域内循环 反之根据orderOfHotKey跳转上个区域
 * @param currentModuleId {string} 当前的区域ID
 * @param ViewModel 全局变量
 * @param orderOfHotKey {array} 区域展示顺序
 */


function perceptionHotKeyConfig(_ref2) {
  var currentModuleId = _ref2.currentModuleId,
      ViewModel = _ref2.ViewModel,
      orderOfHotKey = _ref2.orderOfHotKey;

  if (orderOfHotKey && orderOfHotKey.length === 0) {
    findLastFocusItemInCurrentModule({
      currentModuleId: currentModuleId,
      ViewModel: ViewModel
    });
  } else {
    orderOfHotKey && jumpToPrevModuleFocusItem({
      currentModuleId: currentModuleId,
      ViewModel: ViewModel,
      orderOfHotKey: orderOfHotKey
    });
  }
}

function findLastFocusItemInCurrentModule(_ref3) {
  var currentModuleId = _ref3.currentModuleId,
      ViewModel = _ref3.ViewModel;
  var id = "".concat(index_["config"].hotKeyModuleIdPrefix, "-").concat(currentModuleId);
  var tableTr = document.querySelectorAll("#".concat(id, " table tbody tr.u-table-row"));
  var lastOneIndex = tableTr[tableTr.length - 1];
  var tds = tableTr[lastOneIndex].querySelectorAll('td');
  var lastFocusItem = findLastChild(tds);
  var cellIdentity = Object(getCellIdentity["a" /* default */])(lastFocusItem);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  var div = lastFocusItem.querySelector('[tabindex="0"]');
  div && Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
    div: div,
    ViewModel: ViewModel
  });
}
/**
 * @desc 寻找最后一个可编辑啊元素
 * @param tds {nodeList}
 */


function findLastChild(tds) {
  // eslint-disable-next-line no-empty
  for (var i = tds.length; i > -1; i--) {
    if (tds[i].querySelector('[tabindex="0"]') !== null) {
      return tds[i];
    }
  }
}

function jumpToPrevModuleFocusItem(_ref4) {
  var currentModuleId = _ref4.currentModuleId,
      ViewModel = _ref4.ViewModel,
      orderOfHotKey = _ref4.orderOfHotKey;
  var prevModuleId = calculatePrevModuleId(currentModuleId, orderOfHotKey);
  var prevModuleKeyMap = createKeyMap["d" /* keyByModuleId */][prevModuleId];
  if (prevModuleKeyMap === undefined) return;
  var type = prevModuleKeyMap.type;

  if (type === moduleType["a" /* MODULE_TYPE */].cardTable || type === moduleType["a" /* MODULE_TYPE */].editTable) {
    //如果是table类型就获取当前table显示的页签
    var activeTableKeyMap = createKeyMap["d" /* keyByModuleId */][prevModuleKeyMap.activeTable];
    var lastItemDom = document.querySelector("div[".concat(activeTableKeyMap.lastItem, "]"));
    var div = lastItemDom.querySelector('[tabindex="0"]');

    if (div === null) {
      var td = lastItemDom.parentElement;
      findPrevSiblings({
        td: td,
        ViewModel: ViewModel,
        moduleId: activeTableKeyMap.moduleId,
        orderOfHotKey: orderOfHotKey
      });
    } else {
      var _td = Object(index_["findParentTd"])(div);
      /**
       * @desc 表格编辑后会导致页面重新渲染导致聚焦状态丢失，因此enter键跳转的需要在全局记录一下，为操作的连续性渲染完成后重新聚焦做标识
       * @type {string}
       */


      var cellIdentity = Object(getCellIdentity["a" /* default */])(_td);
      cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
      Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
        div: div,
        ViewModel: ViewModel
      });
    }
  } else {
    Object(findNextFocusItemInForm["a" /* findLastFocusItemInForm */])(prevModuleKeyMap, prevModuleId);
  }
}
/**
 * @desc 递归查找上一个可聚焦元素
 * @param td {dom} 前一个td
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 当前区域的Id
 * @param orderOfHotKey
 */


function findPrevSiblings(_ref5) {
  var td = _ref5.td,
      ViewModel = _ref5.ViewModel,
      moduleId = _ref5.moduleId,
      orderOfHotKey = _ref5.orderOfHotKey;
  var prevTd = td.previousElementSibling;
  var currentTr = prevTd && prevTd.parentElement;
  var firstTd = currentTr && findFirstTdInRow(currentTr);
  var currentDiv = td.querySelector('[tabindex="0"]');
  var div = prevTd && prevTd.querySelector('[tabindex="0"]'); //如果下个需要聚焦的单元格与最后一个单元相同并且没有可聚焦元素就在下一行查找

  if (firstTd === prevTd && div === null || firstTd === td && currentDiv === null) {
    findPrevRowTd({
      tr: currentTr,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  if (div === null || Object(handleSpecialCase["a" /* checkboxInTable */])(div)) {
    findPrevSiblings({
      td: prevTd,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  var cellIdentity = Object(getCellIdentity["a" /* default */])(prevTd);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
    div: div,
    ViewModel: ViewModel
  });
}

function calculatePrevModuleId(currentModuleId, orderOfHotKey) {
  var orderOfHotKeyLen = orderOfHotKey.length;
  var currentModuleIndex = orderOfHotKey.indexOf(currentModuleId);
  var prevModuleIndex = currentModuleIndex - 1 < -1 ? orderOfHotKey[orderOfHotKeyLen - 1] : currentModuleIndex - 1;
  return orderOfHotKey[prevModuleIndex];
} //查找上一行可聚焦元素


function findPrevRowTd(_ref6) {
  var tr = _ref6.tr,
      ViewModel = _ref6.ViewModel,
      moduleId = _ref6.moduleId,
      orderOfHotKey = _ref6.orderOfHotKey;
  var prevTr = tr && tr.previousElementSibling; //如果是最后一行就查找下个区域的第一个可聚焦元素

  if (prevTr === null) {
    orderOfHotKey && jumpToPrevModuleFocusItem({
      currentModuleId: moduleId,
      ViewModel: ViewModel,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  if (prevTr.getAttribute('tabindex') === '-1') {
    findPrevRowTd({
      tr: prevTr,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  }

  var divs = prevTr.querySelectorAll('td [tabindex="0"]');
  var lastDiv = divs[divs.length - 1];
  var td = Object(index_["findParentTd"])(lastDiv);
  var cellIdentity = Object(getCellIdentity["a" /* default */])(td);
  cellIdentity ? ViewModel.enterTriggerCellId = cellIdentity : '';
  Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
    div: lastDiv,
    ViewModel: ViewModel
  });
}


// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/util/calculateNeedJumpTimes.js
var calculateNeedJumpTimes = __webpack_require__(55);

// CONCATENATED MODULE: ./src/platform/components/WithKeyboardChange/util/findUpStairsFocusItemInTable.js
/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2021-02-20 09:37:22
 */




/**
 * @desc 查找上一行元素
 * @param target {dom} 事件源
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 当前区域Id
 * @param orderOfHotKey {array} 区域显示顺序配置
 */

function findUpStairsFocusItemInTable(_ref) {
  var eventTarget = _ref.eventTarget,
      ViewModel = _ref.ViewModel,
      moduleId = _ref.moduleId,
      orderOfHotKey = _ref.orderOfHotKey;
  var parentTd = eventTarget.tagName === 'TD' ? eventTarget : Object(index_["findParentTd"])(eventTarget);
  var upStairTr = parentTd.parentElement.previousElementSibling;
  var jumpedLines = 1; //向上跳跃的行数

  if (upStairTr === null) return;

  if (upStairTr.getAttribute('tabindex') === '-1') {
    jumpedLines = Object(calculateNeedJumpTimes["a" /* default */])(upStairTr, jumpedLines, 'up');
  }

  var cellIdentity = Object(getCellIdentity["a" /* default */])(parentTd);

  if (!cellIdentity) {
    return console.warn('not find cell identity!');
  }

  var cellIdentityArray = cellIdentity && cellIdentity.split('-');
  var upStairsLine = Number(cellIdentityArray.pop()) - jumpedLines;

  if (upStairsLine > -1) {
    cellIdentityArray.push(upStairsLine);
    var upStairsCellIdentity = cellIdentityArray.join('-');
    ViewModel.upStairsCellIdentity = cellIdentityArray;
    var div = document.querySelector("div[".concat(upStairsCellIdentity, "=\"").concat(upStairsCellIdentity, "\"] [tabindex=\"0\"], div[").concat(upStairsCellIdentity, "=\"").concat(upStairsCellIdentity, "\"][tabindex=\"0\"]"));
    Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
      div: div,
      ViewModel: ViewModel
    });
  }
}


// CONCATENATED MODULE: ./src/platform/components/WithKeyboardChange/util/findDownStairsFocusItemInTable.js
/*
 * @Author: liyxt
 * @Date: 2020-05-19 15:47:39
 * @LastEditors: bbq
 * @LastEditTime: 2021-02-20 09:37:12
 * @Description: file content
 */





/**
 * @desc 查找上一行元素
 * @param target {dom} 事件源
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 当前区域Id
 * @param orderOfHotKey {array} 区域显示顺序配置
 */

function findDownStairsFocusItemInTable(_ref) {
  var eventTarget = _ref.eventTarget,
      ViewModel = _ref.ViewModel,
      moduleId = _ref.moduleId;
  // debugger;
  var parentTd = eventTarget.tagName === 'TD' ? eventTarget : Object(index_["findParentTd"])(eventTarget);
  var downStairTr = parentTd.parentElement.nextElementSibling;
  var jumpedLines = 1; //向下跳跃的行数

  if (downStairTr === null) return;

  if (downStairTr.getAttribute('tabindex') === '-1') {
    jumpedLines = Object(calculateNeedJumpTimes["a" /* default */])(downStairTr, jumpedLines, 'down');
  }

  var cellIdentity = Object(getCellIdentity["a" /* default */])(parentTd);

  if (!cellIdentity) {
    return console.warn('not find cell identity!');
  }

  var cellIdentityArray = cellIdentity && cellIdentity.split('-');
  var downStairsLine = Number(cellIdentityArray.pop()) + jumpedLines;
  var id = "".concat(index_["config"].hotKeyModuleIdPrefix, "-").concat(moduleId); // let tableTr = document.querySelectorAll(`#${id} table tbody tr.u-table-row`);
  // if (downStairsLine < tableTr.length) {

  cellIdentityArray.push(downStairsLine);
  var upStairsCellIdentity = cellIdentityArray.join('-');
  ViewModel.upStairsCellIdentity = upStairsCellIdentity;
  var div = document.querySelector("div[".concat(upStairsCellIdentity, "=\"").concat(upStairsCellIdentity, "\"] [tabindex=\"0\"], div[").concat(upStairsCellIdentity, "=\"").concat(upStairsCellIdentity, "\"][tabindex=\"0\"]"));
  Object(findNextFocusItemInTable["a" /* executeAutoFocus */])({
    div: div,
    ViewModel: ViewModel
  }); // }
}


// CONCATENATED MODULE: ./src/platform/components/WithKeyboardChange/handleKeyDown.js







var ARROW_KEY = {
  37: handleLeftArrow,
  38: handleUpArrow,
  39: handleRightArrow,
  40: handleDownArrow
};
/**
 *
 * @param moduleId { String } 事件触发时得到的当前moduleId
 * @param e { Object } 事件源
 * @param key  { String } 触发的按钮
 */

function keyDownOfShiftUp(moduleId, e, key) {
  var nextFocus = key === 'shift+down' ? +1 : -1;
  var nextFocusModuleIdIndex = createKeyMap["e" /* orderOfHotKey */].indexOf(moduleId) + nextFocus;
  var nextFocusModuleId = createKeyMap["e" /* orderOfHotKey */][nextFocusModuleIdIndex];

  if (e.target) {
    // 逻辑修正
    var code = null; // item 根本没有item
    // if (keyByModuleId[moduleId][item]) {
    //     code = keyByModuleId[moduleId][item];
    // }

    if (!isLastModule(nextFocusModuleId) && createKeyMap["d" /* keyByModuleId */][nextFocusModuleId].firstItem) {
      code = createKeyMap["d" /* keyByModuleId */][nextFocusModuleId].firstItem;
    }

    var wrapperDom = document.querySelector("div[field=".concat(code, "]"));

    if (!wrapperDom || !(wrapperDom && wrapperDom.contains(e.target))) {
      e.target.blur();
    }
  }

  if (isLastModule(nextFocusModuleId)) {
    focusInSelfModule({
      key: key,
      moduleId: moduleId
    });
    return;
  } //如果下一个聚焦区域没有数据就跳过


  if (nextItemNotHaveData(this.props, moduleId, nextFocusModuleId)) {
    keyDownOfShiftUp.call(this, nextFocusModuleId, e, key);
    return;
  }

  index_["PubSub"].publish('autoFocus', {
    data: createKeyMap["d" /* keyByModuleId */][nextFocusModuleId].firstItem,
    moduleId: moduleId
  });
}
/**
 * @desc 如果在keyByModuleId中没有找到 nextFocusModuleId 就在当前moduleId中来回跳，从第一个可聚焦点跳到最后一个可聚焦点
 * @param nextFocusModuleId {string}
 * @return {boolean}
 */


function isLastModule(nextFocusModuleId) {
  return createKeyMap["d" /* keyByModuleId */][nextFocusModuleId] === undefined;
}

function focusInSelfModule(_ref) {
  var key = _ref.key,
      moduleId = _ref.moduleId;
  var item = key === 'shift+down' ? 'lastItem' : 'firstItem'; //判断是否有关联tab标签

  if (hasTabRelation(moduleId)) {
    activeItemFocus(moduleId, item);
    return;
  }

  index_["PubSub"].publish('autoFocus', {
    data: createKeyMap["d" /* keyByModuleId */][moduleId][item],
    moduleId: moduleId
  });
} // 判断是否有关联表


function hasTabRelation(moduleId) {
  var moduleInfo = createKeyMap["d" /* keyByModuleId */][moduleId];
  return moduleInfo && (moduleInfo.parent || moduleInfo.children);
}
/**
 * @desc: 当前活跃的标签获取焦点
 * @param: moduleId {string} 当前区域Id
 * @param: item {string} 表格里的聚焦项
 */


function activeItemFocus(moduleId, item) {
  //如果当前活跃的标签是undefined 就用区域ID
  var activeKey = index_["ViewModel"].tableActiveKey || moduleId;
  index_["PubSub"].publish('autoFocus', {
    data: createKeyMap["d" /* keyByModuleId */][activeKey][item],
    moduleId: moduleId
  });
}
/**
 * @desc 判断下一个需要聚焦的moduleId是否有数据,如果没有就再次keyDownOfShiftUp,
 * @param props {object}
 * @param currentModuleId {string} 当前聚焦的区域ID
 * @param nextModuleId {string} 下个聚焦的区域ID
 */


function nextItemNotHaveData(props, currentModuleId, nextModuleId) {
  var currentModuleType = createKeyMap["d" /* keyByModuleId */][currentModuleId].type;
  var nextModuleType = createKeyMap["d" /* keyByModuleId */][nextModuleId].type;
  var data = []; //type: {form, cardTable, editTable}

  if (currentModuleType === moduleType["a" /* MODULE_TYPE */].form) {
    data = getDataByFormDataStructure(props, nextModuleType, nextModuleId);
  } else if (currentModuleType === moduleType["a" /* MODULE_TYPE */].cardTable) {
    data = getDataByCardTableDataStructure(props, nextModuleType, nextModuleId);
  } else if (currentModuleType === moduleType["a" /* MODULE_TYPE */].editTable) {
    data = getDataByCardTableDataStructure(props, nextModuleType, nextModuleId);
  }

  return data.length === 0;
}
/**
 * 
 * TODO
 * @desc 由于form, table 类型的数据存放于不同的地方
 * @param props
 * @param nextModuleType
 * @param nextModuleId
 */


function getDataByFormDataStructure(props, nextModuleType, nextModuleId) {
  var data;
  var myTable = props._this.myTable;

  if (nextModuleType === moduleType["a" /* MODULE_TYPE */].cardTable) {
    data = myTable[nextModuleId].state.table.rows;
  } else if (nextModuleType === moduleType["a" /* MODULE_TYPE */].editTable) {
    data = myTable.myEditTable[nextModuleId].state.table.rows;
  } else {
    data = props._this.state.meta[nextModuleId].items;
  }

  return data;
} // TODO


function getDataByCardTableDataStructure(props, nextModuleType, nextModuleId) {
  var data;
  var myTable = props.pageScope.myTable;

  if (nextModuleType === moduleType["a" /* MODULE_TYPE */].cardTable) {
    data = myTable[nextModuleId].state.table.rows;
  } else if (nextModuleType === moduleType["a" /* MODULE_TYPE */].editTable) {
    data = myTable.myEditTable[nextModuleId].state.table.rows;
  } else {
    data = props.pageScope.state.meta[nextModuleId].items;
  }

  return data;
}
/**
 * @desc: 处理上下左右键
 * @param eventTarget {dom} 事件源
 * @param ViewModel {object} 全局变量
 * @param moduleId {string} 区域ID
 * @param orderOfHotKey {array} 区域显示顺序
 * @param itemType {string} 基础组件类型 input/datePicker
 * @param keyCode {number} 按键号
 */


function handleArrowKeyDown(_ref2) {
  var eventTarget = _ref2.eventTarget,
      ViewModel = _ref2.ViewModel,
      moduleId = _ref2.moduleId,
      orderOfHotKey = _ref2.orderOfHotKey,
      itemType = _ref2.itemType,
      keyCode = _ref2.keyCode;
  ARROW_KEY[keyCode]({
    eventTarget: eventTarget,
    ViewModel: ViewModel,
    moduleId: moduleId,
    orderOfHotKey: orderOfHotKey,
    itemType: itemType
  });
}
/**
 * @desc 处理按左方向键
 * @param eventTarget
 * @param ViewModel
 * @param moduleId
 * @param orderOfHotKey
 * @param itemType
 */


function handleLeftArrow(_ref3) {
  var eventTarget = _ref3.eventTarget,
      ViewModel = _ref3.ViewModel,
      moduleId = _ref3.moduleId,
      orderOfHotKey = _ref3.orderOfHotKey,
      itemType = _ref3.itemType;

  //日期类型延迟执行时eventTarget已被移出document导致寻找不到父元素td,所以日期类型立即执行
  if (itemType === index_["config"].hotKeyDatePicker) {
    findPrevFocusItemInTable({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } //CLOUD-147579 中文输入法下会带进冒号空格等符号，原因是因为输入法的enter比我们的enter后执行导致


  var timer = setTimeout(function () {
    findPrevFocusItemInTable({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId
    });
    clearTimeout(timer);
  });
}

function handleUpArrow(_ref4) {
  var eventTarget = _ref4.eventTarget,
      ViewModel = _ref4.ViewModel,
      moduleId = _ref4.moduleId,
      orderOfHotKey = _ref4.orderOfHotKey,
      itemType = _ref4.itemType;

  //日期类型延迟执行时eventTarget已被移出document导致寻找不到父元素td,所以日期类型立即执行
  if (itemType === index_["config"].hotKeyDatePicker) {
    findUpStairsFocusItemInTable({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } //CLOUD-147579 中文输入法下会带进冒号空格等符号，原因是因为输入法的enter比我们的enter后执行导致


  var timer = setTimeout(function () {
    findUpStairsFocusItemInTable({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    clearTimeout(timer);
  });
}

function handleRightArrow(_ref5) {
  var eventTarget = _ref5.eventTarget,
      ViewModel = _ref5.ViewModel,
      moduleId = _ref5.moduleId,
      orderOfHotKey = _ref5.orderOfHotKey,
      itemType = _ref5.itemType;

  //日期类型延迟执行时eventTarget已被移出document导致寻找不到父元素td,所以日期类型立即执行
  if (itemType === index_["config"].hotKeyDatePicker) {
    Object(findNextFocusItemInTable["b" /* findNextFocusItemInTable */])({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } //CLOUD-147579 中文输入法下会带进冒号空格等符号，原因是因为输入法的enter比我们的enter后执行导致


  var timer = setTimeout(function () {
    Object(findNextFocusItemInTable["b" /* findNextFocusItemInTable */])({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId
    });
    clearTimeout(timer);
  });
}

function handleDownArrow(_ref6) {
  var eventTarget = _ref6.eventTarget,
      ViewModel = _ref6.ViewModel,
      moduleId = _ref6.moduleId,
      orderOfHotKey = _ref6.orderOfHotKey,
      itemType = _ref6.itemType;

  //日期类型延迟执行时eventTarget已被移出document导致寻找不到父元素td,所以日期类型立即执行
  if (itemType === index_["config"].hotKeyDatePicker) {
    findDownStairsFocusItemInTable({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    return;
  } //CLOUD-147579 中文输入法下会带进冒号空格等符号，原因是因为输入法的enter比我们的enter后执行导致


  var timer = setTimeout(function () {
    findDownStairsFocusItemInTable({
      eventTarget: eventTarget,
      ViewModel: ViewModel,
      moduleId: moduleId,
      orderOfHotKey: orderOfHotKey
    });
    clearTimeout(timer);
  });
}



/***/ }),

/***/ 382:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DragWidthCom; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

 // import PropTypes from 'prop-types';

__webpack_require__(716);

var DragWidthCom = /*#__PURE__*/function (_Component) {
  _inherits(DragWidthCom, _Component);

  var _super = _createSuper(DragWidthCom);

  function DragWidthCom(props) {
    var _this;

    _classCallCheck(this, DragWidthCom);

    _this = _super.call(this, props);
    _this.mouseDown = false;
    return _this;
  }

  _createClass(DragWidthCom, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      if (this.divDom) {
        this.clientWid = this.divDom.clientWidth;
      }

      this.onMouseDown.call(this);
    }
  }, {
    key: "onMouseDown",
    value: function onMouseDown() {
      var that = this;
      document.addEventListener('mousemove', function (e) {
        //e.stopPropagation();
        if (that.mouseDown && that.divDom) {
          // fix bug  IE  e.x !== e.clientx  ie  
          var wid = that.clientWid + (e.clientX - that.beginX);

          if (wid >= that.box.clientWidth - 20 || wid <= 50) {
            that.divDom.style.width = that.divDom.clientWidth + 'px';
          } else {
            that.divDom.style.width = wid + 'px';
          }
        }
      });
      /*document.documentElement.onmousemove = e => {
      // e.preventDefault();
      };*/

      document.addEventListener('mouseup', function () {
        that.mouseDown = false;

        if (that.divDom) {
          that.clientWid = that.divDom.clientWidth;
        }

        that.maskRightDom && (that.maskRightDom.style.display = 'none');
        that.maskLeftDom && (that.maskLeftDom.style.display = 'none');
        typeof that.props.onDragStop === 'function' && that.props.onDragStop();
      });
      /*document.documentElement.onmouseup = e => {
      };*/

      this.spanDom.addEventListener('mousedown', function (e) {
        that.beginX = e.clientX;
        that.mouseDown = true; // 加个遮罩 应对  iframe的情况

        that.maskRightDom && (that.maskRightDom.style.display = 'block');
        that.maskLeftDom && (that.maskLeftDom.style.display = 'block');
      });
      /*this.spanDom.onmousedown = e => {
        };*/
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var lefWid = this.props.defLeftWid || '150px';
      var leftMinWid = this.props.leftMinWid || '50px',
          rightOverflow = this.props.rightOverflow || "auto";
      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: "dragWidthCom",
        ref: function ref(box) {
          _this2.box = box;
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: "dragWidthCom_left",
        style: {
          width: lefWid,
          minWidth: leftMinWid
        },
        ref: function ref(div) {
          _this2.divDom = div;
        }
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: "dragWidthCom_mask",
        ref: function ref(mask) {
          _this2.maskLeftDom = mask;
        }
      }), this.props.leftDom), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        ref: function ref(span) {
          _this2.spanDom = span;
        },
        className: "dragWidthCom_line"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: "dragWidthCom_lines"
      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: "dragWidthCom_right",
        id: "scroll_container"
      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
        className: "dragWidthCom_mask",
        ref: function ref(mask) {
          _this2.maskRightDom = mask;
        }
      }), this.props.rightDom));
    }
  }]);

  return DragWidthCom;
}(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);



/***/ }),

/***/ 383:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(25);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_hotkeys__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _createKeyMap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(9);
/* harmony import */ var _config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(47);
/* harmony import */ var _handleKeyDown__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(38);
/* harmony import */ var _config_tableKeyboardMap__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(72);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _hotKey_less__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(722);
/* harmony import */ var _hotKey_less__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_hotKey_less__WEBPACK_IMPORTED_MODULE_7__);
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

/*
 * @Descripttion: 
 * @version: 
 * @Author: jinfjk
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2021-02-01 14:04:57
 */









function FormWithKeyboardChange(WrappedComponent) {
  return /*#__PURE__*/function (_Component) {
    _inherits(WithHotKey, _Component);

    var _super = _createSuper(WithHotKey);

    function WithHotKey(props) {
      var _this;

      _classCallCheck(this, WithHotKey);

      _this = _super.call(this, props);
      _this.formStatusChanged = _this.formStatusChanged.bind(_assertThisInitialized(_this));
      return _this;
    }

    _createClass(WithHotKey, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        var _this2 = this;

        //监听业务组手动执行的聚焦事件
        this.autoFocusToken = _platform_api__WEBPACK_IMPORTED_MODULE_6__["PubSub"].subscribe('autoFocus-IoC', function () {
          //form的状态， 浏览态， add, edit
          var status = _this2.props.store.getStatus(); //如果是业务组控制执行 autoFocusDeferred 设为false；


          var autoFocusDeferred = false;
          if (Object(_config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_3__[/* stopFormHotKeyChange */ "c"])({
            props: _this2.props,
            autoFocusDeferred: autoFocusDeferred,
            status: status
          }) || status === 'browse') return;
          _createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* createByModuleType */ "a"]['form'](_this2.props, true);
        });
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        // 部分情况下KeyByModuleId 没有清除  导致创建不能直接聚焦
        Object(_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* deleteKeyByModuleId */ "b"])(this.props.moduleId || this.props.name);
        this.autoFocusToken && _platform_api__WEBPACK_IMPORTED_MODULE_6__["PubSub"].subscribe(this.autoFocusToken);
      }
    }, {
      key: "formStatusChanged",
      value: function formStatusChanged(props, status) {
        if (status === 'browse') {
          Object(_createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* deleteKeyByModuleId */ "b"])(props.moduleId || props.name);
        } else {
          this.judgeCreateKeyMap(props, status);
        }
      }
    }, {
      key: "judgeCreateKeyMap",
      value: function judgeCreateKeyMap(props, status) {
        var _ref = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
            _ref$autoFocusDeferre = _ref.autoFocusDeferred,
            autoFocusDeferred = _ref$autoFocusDeferre === void 0 ? false : _ref$autoFocusDeferre;

        if (Object(_config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_3__[/* stopFormHotKeyChange */ "c"])({
          props: props,
          autoFocusDeferred: autoFocusDeferred,
          status: status
        })) return;
        _createKeyMap__WEBPACK_IMPORTED_MODULE_2__[/* createByModuleType */ "a"]['form'](props);
      }
    }, {
      key: "render",
      value: function render() {
        var moduleId = this.props.name;
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_hotkeys__WEBPACK_IMPORTED_MODULE_1__["HotKeys"], {
          keyMap: _config_tableKeyboardMap__WEBPACK_IMPORTED_MODULE_5__[/* keyMap */ "a"],
          handlers: {
            shiftUp: _handleKeyDown__WEBPACK_IMPORTED_MODULE_4__[/* keyDownOfShiftUp */ "b"].bind(this, moduleId),
            shiftDown: _handleKeyDown__WEBPACK_IMPORTED_MODULE_4__[/* keyDownOfShiftUp */ "b"].bind(this, moduleId)
          },
          id: "".concat(_platform_api__WEBPACK_IMPORTED_MODULE_6__["config"].hotKeyModuleIdPrefix, "-").concat(moduleId)
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent, _extends({}, this.props, {
          formStatusChanged: this.formStatusChanged
        })));
      }
    }]);

    return WithHotKey;
  }(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);
}

/* harmony default export */ __webpack_exports__["a"] = (FormWithKeyboardChange);

/***/ }),

/***/ 384:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(22);
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

/*
 * @Descripttion: 
 * @version: 
 * @Author: jinfjk
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2021-01-25 19:25:48
 */




function FormWithAutoFocus(WrappedComponent) {
  return /*#__PURE__*/function (_Component) {
    _inherits(WithAutoFocus, _Component);

    var _super = _createSuper(WithAutoFocus);

    function WithAutoFocus() {
      _classCallCheck(this, WithAutoFocus);

      return _super.apply(this, arguments);
    }

    _createClass(WithAutoFocus, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        var _this$props = this.props,
            name = _this$props.name,
            form = _this$props.form;
        this.autoFocusToken = _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].subscribe('autoFocus', function (msg, _ref) {
          var data = _ref.data,
              id = _ref.id;
          var selector = "[hotkeytag=\"".concat(name, "-").concat(data, "\"]");
          var itemtype = 'normal';

          if (form && data) {
            form.setItemAttribute(data, 'autoFocus', true);
            itemtype = form.getItemAttribute(data, 'itemtype');
          }

          console.log(selector, form, id, data, itemtype); // 表单

          if (id) {
            if (name === id) {
              console.log(id); // 如果没有获取到对应的itemtype 就统一用normal来处理， 如果碰到特殊的就在往matchItemFocus里加

              _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__[/* matchItemFocus */ "a"][itemtype] === undefined ? _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__[/* matchItemFocus */ "a"]['normal'](selector) : _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__[/* matchItemFocus */ "a"][itemtype](selector);
            }
          } else {
            if (data) {
              // 如果没有获取到对应的itemtype 就统一用normal来处理， 如果碰到特殊的就在往matchItemFocus里加
              _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__[/* matchItemFocus */ "a"][itemtype] === undefined ? _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__[/* matchItemFocus */ "a"]['normal'](selector) : _executeAutoFocus__WEBPACK_IMPORTED_MODULE_2__[/* matchItemFocus */ "a"][itemtype](selector);
            }
          }
        });
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        // this.dom = null;
        this.autoFocusToken && _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].subscribe(this.autoFocusToken);
      }
    }, {
      key: "render",
      value: function render() {
        // console.log(this.props.children);
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent // ref={dom => {
        //     console.log(dom);
        //     this.dom = dom;
        // }}
        , this.props);
      }
    }]);

    return WithAutoFocus;
  }(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);
}

/* harmony default export */ __webpack_exports__["a"] = (FormWithAutoFocus);

/***/ }),

/***/ 411:
/***/ (function(module, exports) {

module.exports = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA5CAYAAABqMUjBAAAAAXNSR0IArs4c6QAADJlJREFUaAXtWgtwFdUZPufs7t17Q0KAoIAVBEWtZtQASlTQ5kUoYgekBludIuJUnLFqndrpTAXntj6wdcbR2taWojJTLTYpteKDlmc6is+EVK2xFApaH1AgISEkubt795x+/8JN7t279+Z1MzLT/gzZ3bPn/Od853+c///3MvY/Rvxkx1tby7SFY40SjamvMMYvlIqfyhWTjKv9XLBG4YptvMr6Z39xnLSA215iowvyjBrF2I1MsZmayXRcmfef0J1YuYyzDqXYBlfyB80qu7kv4Ccd4JZX2MgC01imCXab0NlUyJK5ceAksAEkgECYjAF4q3LZ9/RKZ21At56mkwqwtTVUYwi1kuvsAgaQcbdnnX3eaBo2hTPlOuzO0Bzn8UwDTgrAanNkkqvFfyoEu44WFAfYwRDGQ9zMkVJ9zaiI/yWIxxcOOLZJu8owxC+Fwc5wY70mGrTY/rTpBjbMYR/qtnMpv4od9Y/R/Q1Bz0fKSkbxkHlWXLLThWIRpsnOuFSf8jxzzykbdnQEjelPm7vVuBUSeRR2aMYBNhcEsEw32XkOM77BmLPazzOrhFurSmdzJpcpxiskUxMNzqE1aIGrdCRzBVcfM843S1c+NXZbw9t+5tme7S3GLZDGE3A0QsIx5ZL0EKBa7K/GDqeCR8nt9VIg4ENzpp2mKWMVXl5vCK7bEgcf3GSyo6SBGucsBPHYUlqK87VWzFk54dWmQ73sg+/srcZMOJntWEpersHSjGTL4NumS6OYV3d9nrwKMvMUOlQxYzrAbjMFX+IqpXe7EKUPLA0g8HG0d3nvmRnmfLkZMjYfrpp+XgpD34PaznQEDg9hUcMClqajTYQsCpnuTPRNDwtKopbK0vM1rr2gc34uAUmWaFK3tFvq14n+0IaLBNM3HKieOSWt04kGN67Nxfla7tqZeuSmHec4h58Z6efWA/jQrFkFUNy1WPTp1iD1LIZxUPGpmiuf3FdWFvZPRs9K8FsEnZlBL3PYBiskSnOFPYB52Lo9oolLaNFDITKBiKaVj9CO3ezn043zFtFBmRxm6VL0BRjd0Kb9/jV4gPfPm3YKPPF3rBPb4u800GeoEmxIfJe0Jnms4O5l8KAjczRNMuuUe9Ig0G7zqPXvlBd48AAbjjEP0p1AzikX5IBPiLOpPGJVJPPDZNNTvUby2xzee9EFf4EvZmm65AFWSs3J4XQeKzg+HGXcx1eeNdzGS0eSa7HWuCOeCsIkamtqSAHOJzXMJZG2wJSKU3nyMalhQOrbXDwhRCX7vT8yL/ZRED9xZfuuMNY2ZmiuKp017R/4jlVlZb3hK2fHrSu9+5BbKBDSI4iwYuy3hp45WxLCHsOJhjxjAANwFayjo5e34l2JxD2g+6CbdGyphnASycca44iznJdTchlM+ik4q1qYOkox8gDSz2BuSa20hZBwG2ts7Jkc6ernuQJMtooAxqt8IB7fLR22Csn/00lLCLwVvL4eSRDbQ3FxLon44TzcRbgTfJVUzUMBTCApMUA2REyPuK56EdWQpfyYU9ofsLSOhH3VY3HXJBaWuyuv9/F6EyElChMowfleZHqkIIIcEW0Uxra5Ln8NcP/kKG1LpCL2caZxmdo9wFLjL3ZLeR+Y5yQoIOki4joomUipOuhj4k3xNmM3MqVz3Cz24wPZ7sYBUqkXHKFtjpTHPjoOBonvIMg7h8dvensfvOozYdKZHFAYK8a/NeO2vvWfZHb8YtYF+dZxkpiPCGRCXTG4HZLcCLtc7sS1aXqFfTVU9je9YH2DB/CYUGlmKf1BTcavRvIwyRnCmYy0klLGXSHGHwlaR1yKJ7nl3oa9HUWGmKSuRyHJ1zmHJKW2KVwV23t8/OAkGTQ3tWFfe6mlorRaaOp5LCSPct2BEioihKHdduX8cdsbdmQa72wJ/UjPV/e6XawDEn+Da7BJV2wKV1r/yjSm7Oml4Y6CjouERHiq2BlYOeIH3omgfS9qJjvzi1rery+v7zkRMvFJAUydDlaWXotS6ZMa4yMHkiaSOSC6Oozqx5JTtzVszDQhtavNlJwbCyHfHbzc2pOt74zamkJEKzcjO18KoMUiRHZHyyaB4ArBSAe6wflO3K/RuXjmjcV13Zl4pgGmji2VMy+DZj4G9b6EQkRS8SB502D0QXTBGRKGV7uZvPNLWxqaMk1G7fOiLSM3Rseg8Ne3o55ZW1OhuHqU6+IC5WINdIAGERbCKePHWpQrX3dtfsfOG+oaM3QNambs3eoLR0xU4W8hsVgGtCWmEKSxPURm7ihpoakBeNcc1o+sO3vjHqunQ9LN/FVqdJfqugJbs1DTQ2Wu3X3PthX565K6pN3O+P3XbxSCPwGVjWQEmjYKOhPCVygpW7BBSxquW/+Kv0sSBP+r488UC7eZXcUI1kokZ5Mh8DzsY6cQYp/ibtPoyxuaeTQ9JZi9qm10yDVmo865AHo3hwltkkBohA3EZxFrj3TsS+qjo9uCZp2+btE1mqE9h3QrhGAlqEvWNpI25mwH8PkN1/0xxZf0CTgrZ9/LsuiRUXo4MgugFlLKyYV2BoGUFG3I3oNXM/IQRHTevm1Fwc99LBjUeArGvoEwbRzU0/+638/cEEw58h+GELNg062JgT3HUqJhoNeqh1oLXZk3CzXqBVhoNZLCyUIzANLxPvS4uPpJ4csXVPWm4ugHqz+IFqck6a6U92qmNk5avRvkH9+fZ4BlIqx/Od7t3oX+KxNjBiXheVE10jaty6Gf8LSqGuo65bgkAZLA9EkISzh3XWlfWr9iVEOi+8W1NeeCwU7sRh54J5oHffWcmFQHXCEubFpc59XL+y3hsqjK18PWLHyoWmCz7rlwD2cKRPGeukKKQZLMvFKFgCOiSVtegT49gOFoFmphLW+o0k3MS/YPJzZexb2Kzu+ovU/ApLJShW/lzLoJm36ulgAJSbr9kmZi+tQr1B9SZtOSWxFlXZnu/pJ7DOKedNiVZfjbN+DyH7eXKmb+CiBLZJwcDyQ5BJApy1VwSEpNTrRN/dk8JH3sTHjWRFNOriRlqPY5CWYZs4WK+zoqRCj8MudaCTyqBzYxKBdXRYAZL6ypVV7ZJ3+iGYEwCgIjnKFMCFcAbRpVU+vV7oKLpnPui53NdO1ZuJYinJlDma6vsWLvlkZv001zhP97XV9j+/0eG+nWNRd7XjBNwjU1tZrL449oWng8OaThIkogYcSdjatneG49EvmM6l2tVCbJJVG5DhwPsWjUs5U0wIdLrirjuj7fdbpyOW86L8oBlNwP1N7Oe5mOYh/SUZJTwjSIEN9P8EwDjIYlQuC7wTATPsUAsPi7b5pNvuchP+JIIrewJcEoBXD1wwdG4PXs4VTlxMQUiXGlUuJc25QvSds9kCspI8tCnCCbeZv9amLeFMB2PDIBKjZBoe45nMS9+Nr5BMHKm8nzvLfo+YPwqL/gRm7q9bRxQqiHG5e/2GOfKYAFPiBDl82cHw3JqHBPERq+PP0hKFsKd8Ufk3b8HUrzhkLC1Ji05MvyyNhnk/mkAOZMh8bnPNZJng+OGWrmxI5qUj2R8uLEw46bN3RoXCyF7X0iBilp2izpyPcdmy9vXL46JXtJAWwzjgBbdQzTlxcPEmJoBALxxzevLNwdBJja3lpc14zUcIF01YfCRPTbXxeKIwgZEtJC903UPxa8e2PdZ/45UgCP/1veQQzZRTY2HER5sLS7XrP02E/64t/wzfVNynIrle0+DQE4pKJcA3I/eGpCwn98Y3gnzOERycVX315cty9oDv9wVvFAxz1aKP9+CidzSVoIYOPWO65Qi+p/kPfpQHiXPrfoUik4JS+VgDcJwA0POEIJxN4W7vfCVv4sHbV25/Xr38vGOw1wVbR1kgyZO2FrRclVimxMsr0jmxV6GL+IjW3QDffbm75fcDBb/2zvympr8lH9m6IJfhqixYiUohOu7TOo6b5slcpknmmA6WXFg8fuhvo97No93jx5TL/vCSgKAl045la1F+X9pHE5T3Eg/WaUw46BxtpeNOKxwsPHSqHa1w5GtTlKPCRZpZztrmv/sH5FYcp5m8P1D5hVitNKjCZJWHr+MsTTdeRoUIxLvMp6FfgqTV4YSJuljN/UtveDuScTWFp8oEonUKGso3Oj8y6h6XcLzTyVfn1NNSuqVnhEmQjZKICeCEebwPHXx2Kd696KFqX9dDfB94u8ZgWcWBjKr5OFGb4Bec18xCXnAC5+0qegs7wbiD/FsfEa9m59aIS5feMdfFgT6MSaBnvtF+Be5orPfaBrvGJ6kYMfZZrKaI9Z7EB9lKf9xK93zP/vvtAd+C+AsxTG0OZc1QAAAABJRU5ErkJggg=="

/***/ }),

/***/ 415:
/***/ (function(module, exports, __webpack_require__) {

var SetCache = __webpack_require__(367),
    arrayIncludes = __webpack_require__(368),
    arrayIncludesWith = __webpack_require__(369),
    arrayMap = __webpack_require__(147),
    baseUnary = __webpack_require__(370),
    cacheHas = __webpack_require__(371);

/** Used as the size to enable large array optimizations. */
var LARGE_ARRAY_SIZE = 200;

/**
 * The base implementation of methods like `_.difference` without support
 * for excluding multiple arrays or iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Array} values The values to exclude.
 * @param {Function} [iteratee] The iteratee invoked per element.
 * @param {Function} [comparator] The comparator invoked per element.
 * @returns {Array} Returns the new array of filtered values.
 */
function baseDifference(array, values, iteratee, comparator) {
  var index = -1,
      includes = arrayIncludes,
      isCommon = true,
      length = array.length,
      result = [],
      valuesLength = values.length;

  if (!length) {
    return result;
  }
  if (iteratee) {
    values = arrayMap(values, baseUnary(iteratee));
  }
  if (comparator) {
    includes = arrayIncludesWith;
    isCommon = false;
  }
  else if (values.length >= LARGE_ARRAY_SIZE) {
    includes = cacheHas;
    isCommon = false;
    values = new SetCache(values);
  }
  outer:
  while (++index < length) {
    var value = array[index],
        computed = iteratee == null ? value : iteratee(value);

    value = (comparator || value !== 0) ? value : 0;
    if (isCommon && computed === computed) {
      var valuesIndex = valuesLength;
      while (valuesIndex--) {
        if (values[valuesIndex] === computed) {
          continue outer;
        }
      }
      result.push(value);
    }
    else if (!includes(values, computed, comparator)) {
      result.push(value);
    }
  }
  return result;
}

module.exports = baseDifference;


/***/ }),

/***/ 416:
/***/ (function(module, exports) {

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

module.exports = isLength;


/***/ }),

/***/ 418:
/***/ (function(module, exports, __webpack_require__) {

var arrayPush = __webpack_require__(735),
    isFlattenable = __webpack_require__(736);

/**
 * The base implementation of `_.flatten` with support for restricting flattening.
 *
 * @private
 * @param {Array} array The array to flatten.
 * @param {number} depth The maximum recursion depth.
 * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.
 * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.
 * @param {Array} [result=[]] The initial result value.
 * @returns {Array} Returns the new flattened array.
 */
function baseFlatten(array, depth, predicate, isStrict, result) {
  var index = -1,
      length = array.length;

  predicate || (predicate = isFlattenable);
  result || (result = []);

  while (++index < length) {
    var value = array[index];
    if (depth > 0 && predicate(value)) {
      if (depth > 1) {
        // Recursively flatten arrays (susceptible to call stack limits).
        baseFlatten(value, depth - 1, predicate, isStrict, result);
      } else {
        arrayPush(result, value);
      }
    } else if (!isStrict) {
      result[result.length] = value;
    }
  }
  return result;
}

module.exports = baseFlatten;


/***/ }),

/***/ 419:
/***/ (function(module, exports, __webpack_require__) {

var baseIsArguments = __webpack_require__(737),
    isObjectLike = __webpack_require__(94);

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Built-in value references. */
var propertyIsEnumerable = objectProto.propertyIsEnumerable;

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {
  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&
    !propertyIsEnumerable.call(value, 'callee');
};

module.exports = isArguments;


/***/ }),

/***/ 422:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, "default", function() { return /* binding */ treeTableCompatible; });

// EXTERNAL MODULE: external {"root":"React","var":"React","commonjs":"react","commonjs2":"react","amd":"react"}
var external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_ = __webpack_require__(0);
var external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default = /*#__PURE__*/__webpack_require__.n(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_);

// EXTERNAL MODULE: external {"root":"ReactDOM","var":"ReactDOM","commonjs":"react-dom","commonjs2":"react-dom","amd":"react-dom"}
var external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_ = __webpack_require__(6);
var external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default = /*#__PURE__*/__webpack_require__.n(external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_);

// EXTERNAL MODULE: ./node_modules/classnames/index.js
var classnames = __webpack_require__(5);
var classnames_default = /*#__PURE__*/__webpack_require__.n(classnames);

// EXTERNAL MODULE: external "@platform/base/index"
var index_ = __webpack_require__(3);

// EXTERNAL MODULE: external "@platform/api/index"
var api_index_ = __webpack_require__(1);

// CONCATENATED MODULE: ./src/platform/components/TreeTable/Cell.js
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }







var Cell_Cell = /*#__PURE__*/function (_Component) {
  _inherits(Cell, _Component);

  var _super = _createSuper(Cell);

  function Cell(props) {
    var _this;

    _classCallCheck(this, Cell);

    _this = _super.call(this, props);

    _this.handleMouseOver = function () {
      if (_this.cellDom) {
        var tipStatus = _this.state.tipStatus;

        var firstCol = _this.cellDom.parentNode.getAttribute('class').includes('first-col');

        var tipNode = null;
        var cellParent = _this.cellDom.parentNode;

        var realNode = _this.cellDom.querySelector('.cell-context');

        if (cellParent) {
          tipNode = firstCol ? cellParent.parentNode && cellParent.parentNode.parentNode : cellParent;
        }

        if (tipNode) {
          if (realNode.offsetWidth > tipNode.clientWidth && tipStatus === false) {
            _this.setState({
              tipStatus: true
            });
          }

          if (realNode.offsetWidth <= tipNode.clientWidth && tipStatus === true) {
            _this.setState({
              tipStatus: false
            });
          }
        }
      }
    };

    _this.state = {
      tipStatus: false
    };
    return _this;
  }

  _createClass(Cell, [{
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      this.cellDom = null;
    }
  }, {
    key: "render",
    value: function render() {
      var _this2 = this;

      var _this$props = this.props,
          item = _this$props.item,
          fixedStyle = _this$props.fixedStyle,
          context = _this$props.context,
          multipleRowCell = _this$props.multipleRowCell,
          searchValue = _this$props.searchValue,
          beforeStr = _this$props.beforeStr,
          index = _this$props.index,
          afterStr = _this$props.afterStr,
          record = _this$props.record,
          onCellMouseDown = _this$props.onCellMouseDown,
          isEllipsis = _this$props.isEllipsis;
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        fieldid: Object(api_index_["getSysFieldid"])(item.attrcode),
        className: classnames_default()('dobule-text', {
          'dobule-text-fixed': !!(item.fixed && item.fixed === 'left')
        }),
        style: fixedStyle,
        ref: function ref(dom) {
          _this2.cellDom = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(dom);
        },
        onMouseOver: this.handleMouseOver,
        onMouseDown: function onMouseDown(e) {
          onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Tooltip"], {
        placement: "top",
        overlay: this.state.tipStatus ? context : '',
        className: "tooltip-word-color",
        delay: 1,
        inverse: true
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: classnames_default()({
          'single-line-and-ellipsis': !multipleRowCell && isEllipsis,
          'three-line-and-ellipsis': !isEllipsis
        })
      }, beforeStr || afterStr || searchValue ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "cell-context"
      }, beforeStr, index !== -1 && !!searchValue ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "u-table-searchable-filter"
      }, searchValue) : '', afterStr) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "cell-context"
      }, "\xA0"), "  ")));
    }
  }]);

  return Cell;
}(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Component"]);

/* harmony default export */ var TreeTable_Cell = (Cell_Cell);
// CONCATENATED MODULE: ./src/platform/components/TreeTable/containers.js
var SAVE_MULTI = {};
var STOP_CHECK_ELEMENT = 'stop-check-element';
var STOP_CHECK_OPERATION_ELEMENT = 'stop-check-operation-element';
// EXTERNAL MODULE: external "@platform/template/index"
var template_index_ = __webpack_require__(12);

// EXTERNAL MODULE: external "@platform/form/index"
var form_index_ = __webpack_require__(24);
var form_index_default = /*#__PURE__*/__webpack_require__.n(form_index_);

// CONCATENATED MODULE: ./src/platform/components/TreeTable/utils.js


/*
 * @Descripttion:
 * @version:
 * @Author: bbq
 * @Date: 2020-12-08 16:04:10
 * @LastEditors: bbq
 * @LastEditTime: 2020-12-11 14:38:00
 */

var getVarType = function getVarType(v) {
  return Object.prototype.toString.call(v).slice(8, -1);
};
/**
 * 判断是否为对象
 * @param {*object} obj 
 */


function isObject(obj) {
  return getVarType(obj) === 'Object';
}
/* 检测类型是否为数组 */

function isArray(param) {
  return getVarType(param) === 'Array' || Array.isArray(param);
}
/* 检测类型是否为字符串 */

function isString(param) {
  return getVarType(param) === 'String';
}
/* 检测类型是否为方法 */

function isFunction(param) {
  return getVarType(param) === 'Function';
}
/* 检测类型是否为Promise对象 */

function isPromise(param) {
  return getVarType(param) === 'Promise';
}
/* 检测类型是否为数字 */

function isNumber(param) {
  return getVarType(param) === 'Number' && !Number.isNaN(param);
}
/*
 * @method   检测是否是需要是boolean类型
 */

function isBoolean(param) {
  return getVarType(param) === 'Boolean';
}
/*
 * @method   是否是undefined
 */

function isUndefined(origin) {
  return typeof origin === 'undefined' || origin === void 0;
}
/*
 * @method   if条件下为false   除去NaN、0、-0、false   剩余undefined、null、""
 */

function isWrong(param) {
  return typeof param === 'undefined' || param === null || param === '';
}
function isNullOrVoid(param) {
  return typeof param === 'undefined' || param === null;
}
/*
 * @method   if条件下为false   除去NaN、0、-0、false   剩余undefined、null、""
 */

function isWrongFalse(param) {
  return typeof param === 'undefined' || param === null || param === '' || param === false;
}
/**
 * 生成唯一标识
 */

function uuidv4() {
  return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
    var r = Object(api_index_["getSafeRandom"])() * 16 | 0,
        v = c == 'x' ? r : r & 0x3 | 0x8;
    return v.toString(16);
  });
}
function getLists(source) {
  var lists = [];

  var handleLists = function handleLists(node) {
    lists.push(node);

    if (node.children) {
      node.children.map(function (n, i) {
        handleLists(n);
      });
    } else {
      return;
    }
  };

  source.map(function (node) {
    return handleLists(node);
  });
  return lists;
} //   获取最深树层级 数

function countDeep(source) {
  if (!source) return; // 铺平数据

  var lists = getLists(source); // 找到孙子  没有自己的儿子的都是孙子  所以我要加油找女朋友

  var sunLists = [];
  lists.map(function (v, i) {
    if (!v.children || v.children.length == 0) sunLists.push(v);
  }); // 现在查找孙子的层级

  var count = function count(node) {
    var count = 0;

    var findFather = function findFather(child) {
      count++;
      lists.map(function (node) {
        if (node.key === child.pid) {
          findFather(node);
        } else {
          return;
        }
      });
    };

    findFather(node);
    return count;
  };

  var saveCount = [];
  sunLists.forEach(function (node) {
    saveCount.push(count(node));
  }); // 获取数组最大值 得到最深树层数

  if (saveCount.length === 0) {
    return 0;
  } else {
    return Math.max.apply(null, saveCount);
  }
}

function findParentTd(el) {
  while (el.parentElement) {
    el = el.parentElement;

    if (el.tagName === "TD") {
      return el;
    }
  }

  return null;
}
/**
 * @desc 如果点击的是操作列，展开图标，文本夹图标就不执行选中事件。 选中文本时也不执行
 * @param e {object} 事件源
 * @param checkOnRowClick {boolean} 配置是否需要勾选功能
 */


function stopCheckBoxChange(e, checkOnRowClick) {
  //业务组配置不需要勾选功能
  if (checkOnRowClick === false) {
    return true;
  } //点击的是展开图标


  if (e.target.className.includes("u-table-row-expand-icon")) {
    return true;
  } //点击阻止选中按钮元素（文本夹图）


  if (e.target.className.includes(STOP_CHECK_ELEMENT)) {
    return true;
  } //点击操作列元素


  var td = findParentTd(e.target);

  if (td) {
    var operationContainer = td.querySelector(".".concat(STOP_CHECK_OPERATION_ELEMENT));

    if (operationContainer && operationContainer.contains(e.target)) {
      td = operationContainer = null;
      return true;
    }
  } //选中文本后触发click事件


  if (document.getSelection().toString()) {
    return true;
  }
}
function getChildren(data, parentKey) {
  if (data == null || data.length == 0) return false;
  var children = [];

  for (var i = 0; i < data.length; i++) {
    if (data[i].key == parentKey) {
      return data[i].children;
    } else if (Array.isArray(data[i].children) && data[i].children.length > 0) {
      children = children.concat(data[i].children);
    }
  }

  return getChildren(children, parentKey);
}
// CONCATENATED MODULE: ./src/platform/components/TreeTable/store.js
function store_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { store_typeof = function _typeof(obj) { return typeof obj; }; } else { store_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return store_typeof(obj); }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function store_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function store_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function store_createClass(Constructor, protoProps, staticProps) { if (protoProps) store_defineProperties(Constructor.prototype, protoProps); if (staticProps) store_defineProperties(Constructor, staticProps); return Constructor; }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = store_getPrototypeOf(object); if (object === null) break; } return object; }

function store_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) store_setPrototypeOf(subClass, superClass); }

function store_setPrototypeOf(o, p) { store_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return store_setPrototypeOf(o, p); }

function store_createSuper(Derived) { var hasNativeReflectConstruct = store_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = store_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = store_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return store_possibleConstructorReturn(this, result); }; }

function store_possibleConstructorReturn(self, call) { if (call && (store_typeof(call) === "object" || typeof call === "function")) { return call; } return store_assertThisInitialized(self); }

function store_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function store_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function store_getPrototypeOf(o) { store_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return store_getPrototypeOf(o); }

/*
 * @Descripttion:
 * @version:
 * @Author: bbq
 * @Date: 2020-12-08 14:51:21
 * @LastEditors: bbq
 * @LastEditTime: 2020-12-24 15:08:59
 */




var store_Store = /*#__PURE__*/function (_BaseStore) {
  store_inherits(Store, _BaseStore);

  var _super = store_createSuper(Store);

  function Store(props) {
    var _this;

    store_classCallCheck(this, Store);

    _this = _super.call(this, props);
    _this.store = {
      // 表单组件对象
      formStore: form_index_default.a.useForm(),
      // 表格数据
      data: [],
      // 对象模式数据
      fullDataObject: {},
      // 列模板
      meta: {},
      // 表格属性
      async: false,
      rowId: 'rowId',
      // 是否子
      isCheckedHasChild: false,
      // 展开项
      expandedKeys: [],
      // 选中项
      checkedKeys: {},
      // 半选
      indeterminateKeys: {},
      currentSelectedRow: null,
      currentRow: null,
      // 弹窗类型
      modalType: null,
      // 折行
      isEllipsis: true,
      // 搜索结果
      searchValue: ''
    };
    _this.cache = {
      cacheData: [],
      langJson: {}
    };

    _this.getMeta = function () {
      var meta = _this.getStore("meta");

      return meta;
    };

    _this.getHooks = function () {
      // 这样处理的一下 才能报错  方法内部的this 永远指向 实例  否则会指向下面的 {} 对象
      _this.getMeta = _this.getMeta.bind(store_assertThisInitialized(_this));
      _this.setMeta = _this.setMeta.bind(store_assertThisInitialized(_this));
      return {
        // 按路径索引 给内部使用
        getStore: _this.getStore.bind(store_assertThisInitialized(_this)),
        setStore: _this.setStore.bind(store_assertThisInitialized(_this)),

        /*-------------------上面的部分------------------*/
        //模板
        getMeta: _this.getMeta.bind(store_assertThisInitialized(_this)),
        setMeta: _this.setMeta.bind(store_assertThisInitialized(_this)),
        getViewMeta: _this.getViewMeta.bind(store_assertThisInitialized(_this)),
        // 缓存
        getCache: _this.getCache.bind(store_assertThisInitialized(_this)),
        setCache: _this.setCache.bind(store_assertThisInitialized(_this)),
        //
        setData: _this.setData.bind(store_assertThisInitialized(_this)),
        getData: _this.getData.bind(store_assertThisInitialized(_this)),
        // 刷新
        refresh: _this.refresh
      };
    };

    _this.name = "treeTableStore";
    _this.refresh = _this.refresh.bind(store_assertThisInitialized(_this));
    _this.uuid = _this.store.uuid = uuidv4();
    return _this;
  } // 数据源


  store_createClass(Store, [{
    key: "getStore",

    /**
     * @description: 复写
     * @param {type}
     * @return:
     */
    value: function getStore(paths) {
      return _get(store_getPrototypeOf(Store.prototype), "get", this).call(this, paths);
    }
    /**
     * @description: 复写
     * @param {type}
     * @return:
     */

  }, {
    key: "setStore",
    value: function setStore(paths, value) {
      var shouldForceUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var callback = arguments.length > 3 ? arguments[3] : undefined;

      var res = _get(store_getPrototypeOf(Store.prototype), "set", this).call(this, paths, value);

      shouldForceUpdate && this.forceUpdate(callback);
      return res;
    }
    /*-------------缓存-------------*/

    /**
     * @description: 设置缓存
     * @param {type}
     * @return:
     */

  }, {
    key: "setCache",
    value: function setCache(path, value) {
      if (!path) {
        console.warn("invalid params <path> to setting");
        return;
      }

      if (!isArray(path)) {
        path = [path];
      }

      var current = this.cache;
      var len = path.length;
      path.forEach(function (item, index) {
        if (!current[item]) {
          current[item] = {};
        }

        if (index === len - 1) {
          current[item] = value;
        } else {
          current = current[item];
        }
      });
    }
    /**
     * @description: 获取缓存
     * @param {type}
     * @return:
     */

  }, {
    key: "getCache",
    value: function getCache(paths) {
      if (isUndefined(paths)) {
        console.warn("invalid params <paths> to setting");
        return;
      }

      if (!isArray(paths)) {
        paths = [paths];
      }

      var current = this.cache;
      paths.some(function (item) {
        if (isUndefined(item) || isNullOrVoid(current)) {
          isUndefined(item) && console.warn("paths has empty item[%s]", paths);
          return;
        }

        if (!current[item]) {
          current = null;
          return;
        }

        current = current[item];
        return true;
      }); // console.log(this.cache);

      return current;
    }
    /*-------------私有-------------*/

    /*-------------列-------------*/

    /**
     * @description: 设置所有meta
     * @param {type}
     * @return:
     */

  }, {
    key: "setMeta",
    value: function setMeta(meta, id) {
      var shouldForceUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;
      var name = this.getStore("name");
      id && this.setStore("name", id || name, false); // 我觉得这里应该 考虑page上的meta更新

      this.setStore("meta", meta, shouldForceUpdate); // 更新表单的meta

      var formStore = this.getStore('formStore');

      if (formStore && meta[id] && isArray(meta[id].items)) {
        var formColumns = [];
        meta[id].items.map(function (item) {
          if (item.itemtype !== 'customer') {
            // item 内部东西太复杂 直接给会导致一些问题
            var nItem = JSON.parse(JSON.stringify(item || {}, function (key, value) {
              if (key == 'render' || key == 'title') {
                // title 和 value 是react对象  会导致问题
                return undefined;
              }

              return value;
            }));
            delete nItem.render;
            delete nItem.title;
            formColumns.push(nItem);
          }
        });
        console.log(formColumns);
        formStore.setMeta(_defineProperty({}, this.uuid, {
          status: 'edit',
          items: formColumns,
          moduletype: "form",
          isunfold: false
        }), this.uuid);
      }
    }
    /**
     * @description: 获取所有meta
     * @param {type}
     * @return:
     */

  }, {
    key: "_hasMeta",

    /**
     * @description: 是否包含当前meta
     * @param {type}
     * @return:
     */
    value: function _hasMeta(id) {
      var meta = this.getStore("meta") || {};

      if (!id || !isObject(meta[id]) || !meta[id].items) {
        console.warn('not find meta');
        return [];
      }

      return meta[id].items;
    }
    /**
     * @description: 获取id所在视图的meta
     * @param {type}
     * @return:
     */

  }, {
    key: "getViewMeta",
    value: function getViewMeta(id) {
      var viewMeta = this._hasMeta(id);

      return viewMeta;
    }
    /**
     * @description: 设置数据
     * @param {type}
     * @return:
     */

  }, {
    key: "setData",
    value: function setData(_ref) {
      var _ref$data = _ref.data,
          data = _ref$data === void 0 ? [] : _ref$data,
          _ref$shouldForceUpdat = _ref.shouldForceUpdate,
          shouldForceUpdate = _ref$shouldForceUpdat === void 0 ? true : _ref$shouldForceUpdat,
          callback = _ref.callback;
      var res = isArray(data) ? data : this.getData(); // console.log(res);
      // 格式化data

      this.setStore(["data"], res, shouldForceUpdate, callback);
    }
    /**
     * regexp 可以是方法 也可以是参数
     * @description: 获取数据
     * @param {type}
     * @return:
     */
    // @infoLog

  }, {
    key: "getData",
    value: function getData() {
      var regexp = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var data = this.getStore("data"); // console.log(data);
      // 添加规则什么的  比如删除 

      data = data.filter(function (item) {
        return !regexp.includes(item.status);
      });
      return data || [];
    } // 刷新整个绑定对象

  }, {
    key: "refresh",
    value: function refresh(callback) {
      this.forceUpdate && this.forceUpdate(callback);
    }
  }]);

  return Store;
}(template_index_["BaseStore"]);

/* harmony default export */ var TreeTable_store = (Object(template_index_["hookFactory"])(store_Store));
// CONCATENATED MODULE: ./src/platform/components/TreeTable/treeTable.js
function treeTable_typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { treeTable_typeof = function _typeof(obj) { return typeof obj; }; } else { treeTable_typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return treeTable_typeof(obj); }

function treeTable_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function treeTable_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function treeTable_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function treeTable_createClass(Constructor, protoProps, staticProps) { if (protoProps) treeTable_defineProperties(Constructor.prototype, protoProps); if (staticProps) treeTable_defineProperties(Constructor, staticProps); return Constructor; }

function treeTable_inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) treeTable_setPrototypeOf(subClass, superClass); }

function treeTable_setPrototypeOf(o, p) { treeTable_setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return treeTable_setPrototypeOf(o, p); }

function treeTable_createSuper(Derived) { var hasNativeReflectConstruct = treeTable_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = treeTable_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = treeTable_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return treeTable_possibleConstructorReturn(this, result); }; }

function treeTable_possibleConstructorReturn(self, call) { if (call && (treeTable_typeof(call) === "object" || typeof call === "function")) { return call; } return treeTable_assertThisInitialized(self); }

function treeTable_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function treeTable_isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function treeTable_getPrototypeOf(o) { treeTable_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return treeTable_getPrototypeOf(o); }

/*
 * @Descripttion:树状表组件
 * @version:
 * @Author: bbq
 * @Date: 2020-12-07 17:01:56
 * @LastEditors: bbq
 * @LastEditTime: 2021-02-26 14:01:42
 */












__webpack_require__(374);

var defaultColor = ['#111111', '#555555', '#111', '#555'];

var treeTable_TreeTable = /*#__PURE__*/function (_BaseComponent) {
  treeTable_inherits(TreeTable, _BaseComponent);

  var _super = treeTable_createSuper(TreeTable);

  function TreeTable(props) {
    var _this;

    treeTable_classCallCheck(this, TreeTable);

    _this = _super.call(this, props);

    _this.setStateEve = function () {
      _this.forceUpdate();
    };

    _this.checkDataType = function (field) {
      var _this$props = _this.props,
          store = _this$props.store,
          id = _this$props.id;
      var meta = store.getMeta();
      var columns = meta[id];
      var data = columns.items.find(function (item) {
        return item.attrcode === field;
      });

      if (data) {
        return data.itemtype;
      }
    };

    _this.createNewData = function (data) {
      var fullDataObject = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var childKeyRecord = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
      var dataSource = data.map(function (item, index) {
        item.key = item.rowId; // 记录一下行顺序给 框选使用

        item.rowIndex = index;
        fullDataObject[item.key] = fullDataObject[item.key] || {};

        if (item.values.pid) {
          item.pid = item.values.pid.value;
        }

        if (Array.isArray(item.children)) {
          var childrenKeys = [];

          _this.createNewData(item.children, fullDataObject, childrenKeys);

          fullDataObject[item.key].childrenKeys = childrenKeys;
        }

        fullDataObject[item.key].item = item; // 取值给父级

        childKeyRecord.push(item.key);
        return item;
      });
      return dataSource;
    };

    _this.itemCheckBoxChange = function (data, key) {
      var _this$props2 = _this.props,
          store = _this$props2.store,
          showContextMenu = _this$props2.showContextMenu;
      var checkedKeys = store.getStore('checkedKeys');
      var indeterminateKeys = store.getStore('indeterminateKeys');
      checkedKeys[key] = !checkedKeys[key];
      var isCheckedHasChild = store.getStore('isCheckedHasChild');

      function setChecked(children) {
        if (Array.isArray(children)) {
          children.forEach(function (item) {
            checkedKeys[item.key] = checkedKeys[key];

            if (Array.isArray(item.children)) {
              setChecked(item.children);
            }
          });
        }
      } //包含下级时，全部选中


      if (isCheckedHasChild && showContextMenu) {
        var children = getChildren(data, key);
        console.log("设置children选中:  children", children);
        setChecked(children);
      } //只有在勾选下级选中情况下才会设置半选状态


      if (isCheckedHasChild) {
        var setPidCheckedStatus = function setPidCheckedStatus(pid) {
          function getAllChilrenList() {
            var children = getChildren([fullDataObject[pid].item], pid);
            var treeToList = getLists(children);
            return treeToList;
          }

          var allChilrenList = getAllChilrenList();
          var allLength = allChilrenList.length;
          var checkedLength = allChilrenList.filter(function (x) {
            return checkedKeys[x.key];
          }).length;

          if (allLength === checkedLength) {
            checkedKeys[pid] = true;
            indeterminateKeys[pid] = false;
          } else if (checkedLength) {
            checkedKeys[pid] = false;
            indeterminateKeys[pid] = true;
          } else {
            checkedKeys[pid] = false;
            indeterminateKeys[pid] = false;
          }
        };

        //设置半选状态
        indeterminateKeys[key] = false;
        var fullDataObject = store.getStore('fullDataObject') || {};
        var pid = fullDataObject[key] && fullDataObject[key].item.pid;

        while (pid) {
          //indeterminateKeys[pid] = true;
          if (fullDataObject[pid] && fullDataObject[pid].item) {
            setPidCheckedStatus(pid);
          }

          pid = fullDataObject[pid] && fullDataObject[pid].item && fullDataObject[pid].item.pid;
        }
        /*  let OriginFullDataObj = {...fullDataObject};
        delete OriginFullDataObj["all"];
        let OriginCheckedKeys = {...checkedKeys};
        delete OriginCheckedKeys["all"];
        let allKeysCount = Object.keys(OriginFullDataObj).length;
        let checkedCount = Object.values(OriginCheckedKeys).filter(x=>x).length;
        if(allKeysCount === checkedCount){
            checkedKeys["all"] = true;
            indeterminateKeys["all"] = false;
        }else if(checkedCount){
            checkedKeys["all"] = false;
            indeterminateKeys["all"] = true;
        }else{
            checkedKeys["all"] = false;
            indeterminateKeys["all"] = false;
        } */

      }

      store.setStore('checkedKeys', checkedKeys, false);
      store.setStore('indeterminateKeys', indeterminateKeys, true);
    };

    _this.selectAllChange = function (checked) {
      /*  let { store } = this.props;
      const fullDataObject = store.getStore('fullDataObject') || {};
      let checkedKeys = store.getStore('checkedKeys');
      let indeterminateKeys = store.getStore('indeterminateKeys');
      let allKeys = Object.keys(fullDataObject);
      checkedKeys["all"] = checked;
      indeterminateKeys["all"] = false;
      for (let key of allKeys) {
          checkedKeys[key] = checked;
          indeterminateKeys[key] = false;
      }
      store.setStore('checkedKeys', checkedKeys, false);
      store.setStore('indeterminateKeys', indeterminateKeys, true); */
    };

    _this.checkBoxChange_radio = function (data, key) {
      var store = _this.props.store;
      var checkedKeys = store.getStore('checkedKeys');

      if (checkedKeys[key]) {
        checkedKeys = {};
      } else {
        checkedKeys = treeTable_defineProperty({}, key, true);
      }

      store.setStore('checkedKeys', checkedKeys, false);
    };

    _this.onCheckboxChangeChild = function (text, record, index, e) {
      var _this$props3 = _this.props,
          store = _this$props3.store,
          checkboxChange = _this$props3.checkboxChange,
          checkedType = _this$props3.checkedType;
      var data = store.getData();
      e.stopPropagation();

      if (checkedType === 'radio') {
        //单选
        _this.checkBoxChange_radio(data, record.key);
      } else {
        //多选
        _this.itemCheckBoxChange(data, record.key);
      }

      if (Object(api_index_["isFunction"])(checkboxChange)) {
        checkboxChange(record, index, e);
      } // 更新


      _this.forceUpdate();
    };

    _this.findItem = function (data, key) {
      var res = null;

      var f = function f(data) {
        data.map(function (item) {
          if (item.rowId === key) {
            res = item;
            return true;
          } else if (Array.isArray(item.values.children)) {
            var r = f(item.values.children);

            if (r) {
              return false;
            }
          }
        });
      };

      f(data);
      return res;
    };

    _this.createNewCol = function (data, maxDeep) {
      var _this$props4 = _this.props,
          showCheckBox = _this$props4.showCheckBox,
          onCellMouseDown = _this$props4.onCellMouseDown,
          store = _this$props4.store,
          multipleRowCell = _this$props4.multipleRowCell;
      var langJson = _this.state.langJson;
      var expandedKeys = store.getStore('expandedKeys');
      var checkedKeys = store.getStore('checkedKeys');
      var indeterminateKeys = store.getStore('indeterminateKeys');
      var oldSearchValue = store.getStore('searchValue');
      var multiYes = langJson && langJson['insert-tree-table-009'];
      var multiNo = langJson && langJson['insert-tree-table-010'];
      var newArr = [];

      if (!Object(api_index_["isArray"])(data) || data.length < 1) {
        return [];
      }

      data.forEach(function (item) {
        if (item.visible) {
          item._width = item._width || item.width || 120;
          item.width = item.width || 120;
          item.title = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            fieldid: Object(api_index_["getSysFieldid"])(item.attrcode || 'opr'),
            style: {
              color: defaultColor.includes(item.color) ? '' : item.color
            }
          }, ' ', item.label, ' ');
          item.dataIndex = item.attrcode;

          if (item.itemtype !== 'customer' && item.itemtype !== 'numberindex') {
            if (!item.hasOwnProperty('render')) {
              item.render = function (text, record, index) {
                if (record && record.values.hasOwnProperty(item.attrcode)) {
                  if (item.itemtype === 'switch') {
                    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                      fieldid: Object(api_index_["getSysFieldid"])(item.attrcode),
                      onMouseDown: function onMouseDown(e) {
                        onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
                      }
                    }, record.values[item.attrcode].value ? multiYes : multiNo);
                  } else {
                    var langIndex;
                    var langAttrCode;
                    var context = '';

                    if (item.itemtype === 'residtxt') {
                      var LangCode = Object(api_index_["getLangCode"])();
                      var loginLang = item.languageMeta.filter(function (i) {
                        return i.languageCode == LangCode;
                      });

                      if (loginLang[0]) {
                        langIndex = loginLang[0].index == '1' ? '' : loginLang[0].index;
                        langAttrCode = item.attrcode + langIndex;
                      }
                    }

                    if (langAttrCode && record.values[langAttrCode] && (record.values[langAttrCode].display || record.values[langAttrCode].value)) {
                      context = record.values[langAttrCode].display || record.values[langAttrCode].value || '';
                    } else {
                      context = record.values[item.attrcode].display || record.values[item.attrcode].value || '';
                    } //格式化时间格式


                    switch (item.itemtype) {
                      case 'datetimepicker':
                      case 'NCTZDatePickClientTime':
                        context = Object(api_index_["changeTime"])(context, 'YYYY-MM-DD HH:mm:ss');
                        break;

                      case 'NCTZDatePickerStart':
                      case 'NCTZDatePickerEnd':
                      case 'NCTZDatePickClientHourTime':
                      case 'datepicker':
                        context = Object(api_index_["changeTime"])(context, 'YYYY-MM-DD');
                        break;
                    }

                    switch (item.itemtype) {
                      case 'NCTZDatePickerStart':
                      case 'NCTZDatePickerEnd':
                      case 'NCTZDatePickClientHourTime':
                      case 'datePickerNoTimeZone':
                      case 'datepicker':
                        context = Object(api_index_["formatDatetime"])(context, 'date');
                        break;

                      case 'timepicker':
                        context = Object(api_index_["formatDatetime"])(context, 'time');
                        break;

                      case 'datetimepicker':
                      case 'NCTZDatePickClientTime':
                        context = Object(api_index_["formatDatetime"])(context, 'datetime');
                        break;
                    }

                    var fixedStyle = {
                      display: ''
                    };

                    if (item.fixed && item.fixed === 'left') {
                      if (item.width) {
                        var _width = String(item.width).replace('px', '');

                        if (_width != '120' && showCheckBox) {
                          fixedStyle.width = item.width;
                        }
                      }
                    }

                    if (typeof context != 'string') {
                      context += '';
                    } // 添加高亮 by bbqin


                    var searchValue = oldSearchValue || '';
                    var searchValueLow = searchValue.toLocaleLowerCase();
                    var contextLow = context.toLocaleLowerCase();
                    var beforeStr = '';
                    var afterStr = context;

                    var _index = contextLow.indexOf(searchValueLow);

                    if (searchValue && _index !== -1) {
                      beforeStr = context.substr(0, _index);
                      afterStr = context.substr(_index + searchValue.length);
                      searchValue = context.substr(_index, searchValue.length);
                    }

                    var isEllipsis = _this.props.store.getStore('isEllipsis');

                    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeTable_Cell, {
                      item: item,
                      beforeStr: beforeStr,
                      afterStr: afterStr,
                      searchValue: searchValue,
                      fixedStyle: fixedStyle,
                      context: context,
                      isEllipsis: isEllipsis,
                      multipleRowCell: multipleRowCell,
                      index: _index,
                      record: record,
                      onCellMouseDown: onCellMouseDown
                    });
                  }
                } else {
                  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                    style: {
                      width: '100%',
                      height: '100%',
                      display: 'inline-block'
                    },
                    onMouseDown: function onMouseDown(e) {
                      onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
                    }
                  });
                }
              };
            }
          } else if (item.itemtype === 'customer' && item.hasOwnProperty('render') && item.alreadyAssignment === undefined) {
            var Irender = item.render;
            item.alreadyAssignment = true;

            item.render = function (text, record, index) {
              return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                fieldid: Object(api_index_["getSysFieldid"])('opr'),
                className: STOP_CHECK_OPERATION_ELEMENT,
                onMouseDown: function onMouseDown(e) {
                  onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
                }
              }, Irender(text, record, index));
            };
          }

          newArr.push(item);
        }
      });
      var defaultColumns = [{
        title: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          fieldid: Object(api_index_["getSysFieldid"])('firstcol')
        }),

        /*   title: showCheckBox ? (<Checkbox className="table-checkbox" fieldid={getSysFieldid('firstcol')}
            onChange={this.selectAllChange} checked={checkedKeys["all"]}
            indeterminate={indeterminateKeys["all"]} />) : <span fieldid={getSysFieldid('firstcol')} />, */
        attrcode: 'checkbox',
        dataIndex: 'checkbox',
        itemtype: 'customer',
        width: '100px',
        _width: '100px',
        render: function render(text, record, index) {
          // console.log(record, index);
          if (showCheckBox) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Checkbox"], {
              onMouseDown: function onMouseDown(e) {
                onCellMouseDown && onCellMouseDown(record, index, 'checkbox', {
                  attrcode: 'checkbox',
                  itemtype: 'customer'
                }, e);
              },
              className: "table-checkbox",
              checked: checkedKeys[record.key],
              indeterminate: indeterminateKeys[record.key],
              onClick: _this.onCheckboxChangeChild.bind(treeTable_assertThisInitialized(_this), text, record, index)
            });
          }
        }
      }];

      if (newArr[0].fixed && newArr[0].fixed == 'left') {
        defaultColumns[0].fixed = 'left';
      }

      var resArr = showCheckBox ? defaultColumns.concat(newArr) : newArr; // 给第一行增加图标

      var oldFirstColRender = resArr[0].render;
      resArr[0].render = null;

      resArr[0].render = function (text, record, index) {
        var expendSwich;

        if (Object.prototype.toString.call(record.isLeaf) == '[object Boolean]' && !record.isLeaf || Object.prototype.toString.call(record.isleaf) == '[object Boolean]' && !record.isleaf) {
          expendSwich = expandedKeys.includes(record.key) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: "icon iconfont  icon-wenjianjiadakai tree-wenjian treeTableIcon ".concat(STOP_CHECK_ELEMENT)
          }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: "icon iconfont  icon-wenjianjia tree-wenjian treeTableIcon ".concat(STOP_CHECK_ELEMENT)
          });
        } else {
          expendSwich = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
            className: "dian",
            style: {
              display: 'none'
            }
          });
        }

        var res = oldFirstColRender(text, record, index);

        if (res && res.props && res.props.children && res.props.children[0] && res.props.children[0].props && res.props.children[0].props.className === 'expend-switch') {
          return res;
        }

        if (res && res.props && res.props.className === 'table-checkbox') {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            fieldid: Object(api_index_["getSysFieldid"])('firstcol'),
            onMouseDown: function onMouseDown(e) {
              onCellMouseDown && onCellMouseDown(record, index, 'checkbox', {
                attrcode: 'checkbox',
                itemtype: 'customer'
              }, e);
            }
          }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "first-col"
          }, res), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
            className: "expend-switch"
          }, expendSwich));
        }

        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          fieldid: Object(api_index_["getSysFieldid"])('firstcol'),
          onMouseDown: function onMouseDown(e) {
            onCellMouseDown && onCellMouseDown(record, index, 'checkbox', {
              attrcode: 'checkbox',
              itemtype: 'customer'
            }, e);
          },
          className: classnames_default()({
            zaiyihang: showCheckBox
          })
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "expend-switch"
        }, expendSwich), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "first-col"
        }, res));
      }; // 给第一列追加宽度


      var width = resArr[0]._width;

      if (width) {
        if (typeof width === 'string') {
          if (width.includes('px')) {
            width = width.replace('px', '');
          }

          width = Number(width);
        }

        width += countDeep(maxDeep) * 16;
      }

      resArr[0].width = width;
      return resArr;
    };

    _this.onExpand = function (status, item, e) {
      var _this$props5 = _this.props,
          store = _this$props5.store,
          expandEve = _this$props5.expandEve,
          collapandEve = _this$props5.collapandEve;
      var isCheckedHasChild = store.getStore('isCheckedHasChild');

      if (status) {
        if (expandEve && typeof expandEve === 'function') {
          store.setStore('currentRow', item, false);
          expandEve(item, isCheckedHasChild);
        }
      } else {
        if (Object(api_index_["isFunction"])(collapandEve)) {
          collapandEve(item);
        }
      } // 更新


      _this.forceUpdate();
    };

    _this.modalContent = function () {
      var _this$props6 = _this.props,
          store = _this$props6.store,
          onAfterEvent = _this$props6.onAfterEvent,
          onBeforeEvent = _this$props6.onBeforeEvent;
      var formStore = store.getStore('formStore'); // console.log(this.uuid);

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        className: "addModal"
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(form_index_default.a, {
        name: _this.uuid,
        config: {
          onAfterEvent: onAfterEvent,
          onBeforeEvent: onBeforeEvent
        },
        store: formStore
      }));
    };

    _this.delNodeEve = function () {
      var delNodeCallBack = _this.props.delNodeCallBack;

      if (Object(api_index_["isFunction"])(delNodeCallBack)) {
        delNodeCallBack(_this.uuid);
      }
    };

    _this.beSureBtnClick = function () {
      var _this$props7 = _this.props,
          modal = _this$props7.modal,
          store = _this$props7.store,
          addNodeCallBack = _this$props7.addNodeCallBack,
          editNodeCallBack = _this$props7.editNodeCallBack;
      var modalType = store.getStore('modalType');
      var currentRow = store.getStore('currentRow');
      var formStore = store.getStore('formStore');
      var isValid = formStore.isCheckNow(); // console.log(isValid); TODO

      if (!isValid) {
        return false;
      }

      var data = {
        values: JSON.parse(JSON.stringify(formStore.getAllFormValue()))
      };

      if (modalType === 'add') {
        data.status = 2;

        if (Object(api_index_["isFunction"])(addNodeCallBack)) {
          addNodeCallBack(data, currentRow);
        }
      } else if (modalType === 'edit') {
        if (Object(api_index_["isFunction"])(editNodeCallBack)) {
          editNodeCallBack(data, currentRow);
        }
      }

      modal.close('treeTableManyColModal');
    };

    _this.onRowDoubleClick = function (record, index, event) {
      var ncOnRowDoubleClick = _this.props.ncOnRowDoubleClick;

      if (Object(api_index_["isFunction"])(ncOnRowDoubleClick)) {
        ncOnRowDoubleClick(record, index, event);
      }
    };

    _this.onRowClick = function (row, index, e) {
      var _this$props8 = _this.props,
          store = _this$props8.store,
          checkOnRowClick = _this$props8.checkOnRowClick,
          showCheckBox = _this$props8.showCheckBox,
          onRowClickEve = _this$props8.onRowClickEve;
      store.setStore('currentSelectedRow', row, false); // 为了避免和新开发的行框选点选区域选事件冲突

      if (e.ctrlKey || e.shiftKey || e.metaKey) {
        return;
      }

      if (showCheckBox && stopCheckBoxChange(e, checkOnRowClick)) return;

      if (Object(api_index_["isFunction"])(onRowClickEve)) {
        onRowClickEve(row, index, e);
      }

      _this.onCheckboxChangeChild(null, row, index, e);
    };

    _this.rowClassName = function (record, current) {
      var store = _this.props.store;
      var currentSelectedRow = store.getStore('currentSelectedRow');

      if (currentSelectedRow && currentSelectedRow.key == record.key) {
        return 'tree-table-col-selected';
      } else {
        return '';
      }
    };

    _this.createContextMenu = function () {
      var _this$props9 = _this.props,
          store = _this$props9.store,
          closeAllEve = _this$props9.closeAllEve,
          hideExpandAll = _this$props9.hideExpandAll,
          expandAllEve = _this$props9.expandAllEve,
          hideIncludeChild = _this$props9.hideIncludeChild,
          extendRightMenu = _this$props9.extendRightMenu;
      var langJson = _this.state.langJson;
      var data = store.getData();
      var isCheckedHasChild = store.getStore('isCheckedHasChild');
      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Fragment"], null, !hideExpandAll && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
        className: classnames_default()({
          'menu expand-all': true
        }),
        onClick: function onClick() {
          var expandedKeys = [];

          function getAllExpandKeys(data) {
            data.forEach(function (item) {
              expandedKeys.push(item.key);

              if (Array.isArray(item.children)) {
                getAllExpandKeys(item.children);
              }
            });
          }

          getAllExpandKeys(data); // 带更新

          store.setStore('expandedKeys', expandedKeys); //若为异步，调用业务全部展开回调

          Object(api_index_["isFunction"])(expandAllEve) && expandAllEve();
        }
      }, langJson['insert-tree-table-0013'] || '全部展开'), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
        className: classnames_default()({
          'menu close-all': true
        }),
        onClick: function onClick() {
          // 更新
          store.setStore('expandedKeys', []); //业务全部收起的回调

          Object(api_index_["isFunction"])(closeAllEve) && closeAllEve();
        }
      }, langJson['insert-tree-table-0014'] || '全部收起'), !hideIncludeChild && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
        className: classnames_default()({
          'menu include-child': true
        }),
        onClick: function onClick() {
          // 带更新
          store.setStore('isCheckedHasChild', !isCheckedHasChild);
        }
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Checkbox"], {
        className: 'include-child-checkbox',
        checked: isCheckedHasChild,
        onChange: function onChange() {
          store.setStore('isCheckedHasChild', !isCheckedHasChild);
        }
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: classnames_default()({
          'include-child-selected': isCheckedHasChild
        })
      }, " ", langJson['insert-tree-table-0015'] || '包含下级')), Object(api_index_["isFunction"])(extendRightMenu) && extendRightMenu());
    };

    _this.getColSetConfig = function () {
      //---by liuxis 鼠标不做列设置
      var _this$props10 = _this.props,
          id = _this$props10.id,
          store = _this$props10.store;
      var getMeta = store.getMeta;
      var meta = getMeta();
      var appcode = meta.appcode || meta.code || api_index_["pageTo"].getAppCode();
      var pagecode = meta.pagecode || api_index_["pageTo"].getPageCode();
      var areaCode = id; // return { appcode: '1', pagecode: '2', areaCode: '3' };

      return {
        appcode: appcode,
        pagecode: pagecode,
        areaCode: areaCode
      };
    };

    _this.state = {
      langJson: {},
      _: ''
    };
    var _store = props.store,
        _id = props.id,
        _isCheckedHasChild = props.isCheckedHasChild,
        async = props.async;

    _store.setStore('name', _id, false); // 表单


    _this.uuid = _store.getStore('uuid'); // 计算主表表体高度

    var tableHeight = 0;
    var screenHeight = window.screen.width;

    if (screenHeight <= 1919 > 1440) {
      tableHeight = 48 * 10 + 'px';
    } else if (screenHeight > 1919) {
      tableHeight = 56 * 10 + 'px';
    } else {
      tableHeight = 40 * 10 + 'px';
    }

    _store.setStore('tableHeight', tableHeight, false);

    _store.setStore('isCheckedHasChild', _isCheckedHasChild, false);

    _store.setStore('async', async, false);

    return _this;
  }

  treeTable_createClass(TreeTable, [{
    key: "componentDidMount",
    value: function componentDidMount() {}
  }, {
    key: "UNSAFE_componentWillMount",
    value: function UNSAFE_componentWillMount() {
      var _this2 = this;

      var store = this.props.store;
      var setCache = store.setCache; //加载多语

      var callback = function callback(json) {
        // this.setState({ json });
        setCache('langJson', json || {});

        _this2.setState({
          langJson: json
        });
      };

      Object(api_index_["getMultiLang"])({
        moduleId: "containers_insert_tree_table",
        callback: callback
      });
    }
  }, {
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var store = nextProps.store,
          isCheckedHasChild = nextProps.isCheckedHasChild,
          async = nextProps.async;
      Object(api_index_["isUndefined"])(isCheckedHasChild) && store.setStore('isCheckedHasChild', isCheckedHasChild, false);
      store.setStore('async', async, false);
    }
  }, {
    key: "componentWillUnMount",
    value: function componentWillUnMount() {}
    /* setState */

  }, {
    key: "render",
    value: function render() {
      var _this3 = this;

      var _this$props11 = this.props,
          modal = _this$props11.modal,
          id = _this$props11.id,
          store = _this$props11.store,
          _this$props11$showChe = _this$props11.showCheckBox,
          showCheckBox = _this$props11$showChe === void 0 ? false : _this$props11$showChe,
          _this$props11$checked = _this$props11.checkedType,
          checkedType = _this$props11$checked === void 0 ? 'checkbox' : _this$props11$checked,
          checkboxChange = _this$props11.checkboxChange,
          scrollConfig = _this$props11.scrollConfig,
          _this$props11$isDrag = _this$props11.isDrag,
          isDrag = _this$props11$isDrag === void 0 ? true : _this$props11$isDrag,
          _this$props11$adaptio = _this$props11.adaptionHeight,
          adaptionHeight = _this$props11$adaptio === void 0 ? true : _this$props11$adaptio,
          otherAreaHeight = _this$props11.otherAreaHeight,
          _this$props11$inModal = _this$props11.inModal,
          inModal = _this$props11$inModal === void 0 ? false : _this$props11$inModal,
          fieldid = _this$props11.fieldid,
          _this$props11$isLazyl = _this$props11.isLazyload,
          isLazyload = _this$props11$isLazyl === void 0 ? true : _this$props11$isLazyl,
          _this$props11$addBlan = _this$props11.addBlankCol,
          addBlankCol = _this$props11$addBlan === void 0 ? true : _this$props11$addBlan,
          _this$props11$showCon = _this$props11.showContextMenu,
          showContextMenu = _this$props11$showCon === void 0 ? false : _this$props11$showCon,
          extendRightMenu = _this$props11.extendRightMenu,
          _this$props11$showWid = _this$props11.showWidthAndHeightConfig,
          showWidthAndHeightConfig = _this$props11$showWid === void 0 ? true : _this$props11$showWid;
      var langJson = this.state.langJson;
      var getStore = store.getStore,
          getViewMeta = store.getViewMeta,
          getData = store.getData,
          setStore = store.setStore; // 模板

      var columns = getViewMeta(id); // 全数据对象

      var fullDataObject = {}; // 数据   this.createNewDataRes

      var data = getData();

      if (!columns || columns.length === 0 || !data) {
        // 没有列模板就不渲染  避免特殊情况导致 操作列等列显示展开符号
        return null;
      }

      var treeData = this.createNewData(data, fullDataObject); // 记录下给 checkbox 渲染用 用于渲染checkbox 父子集关系
      // console.log(fullDataObject);

      store.setStore('fullDataObject', fullDataObject, false); // 最大深度

      var maxDeep = JSON.parse(JSON.stringify(treeData)); // 展开项

      var expandedKeys = getStore('expandedKeys'); // 表格高度

      var tableHeight = getStore('tableHeight'); // console.log(store, columns);

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
        id: id,
        className: "treeTableManyCol",
        fieldid: Object(api_index_["getSysFieldid"])("".concat(fieldid || id, "_table"))
      }, showCheckBox && checkedType !== 'radio' && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Selectable"], {
        canvas: "#".concat(id) // 注意可以加下前后空格
        ,
        selector: " tbody tr ",
        unitKey: "key",
        disabled: checkedType === 'radio' || 'slide' // 可选值 true false 'shift' 'ctrl' 'slide'
        ,
        userSelect: true // 启用用户文字选中
        // unitsData={fullDataObject}  // 用dom做shift 操作 数据的问题是目前顺序不对 // 数组改为对象 给下面使用
        // 开始项  主要配合外部的 单选事件处理
        ,
        startItem: "",
        onSelect: function onSelect(selectedRowKeys, hotkey, _ref) {
          var currentKey = _ref.currentKey;
          // 树状数据不太好处理 需要一个拉平数据
          var rowLen = Object.keys(selectedRowKeys).length;

          if (rowLen > 0) {
            if (hotkey === 'ctrl') {
              setStore(['checkedKeys', currentKey], selectedRowKeys[currentKey], true, function () {
                var selectedRecord = fullDataObject[currentKey].item;
                console.log(fullDataObject, currentKey, selectedRecord, '数据的问题处理');

                if (Object(api_index_["isFunction"])(checkboxChange) && selectedRecord) {
                  checkboxChange(selectedRecord, selectedRecord.rowIndex, {});
                }
              });
            } else {
              setStore('checkedKeys', {});

              for (var key in selectedRowKeys) {
                if (selectedRowKeys.hasOwnProperty(key)) {
                  setStore(['checkedKeys', key], selectedRowKeys[key], false);
                }
              } // 更新


              store.refresh(function () {
                // TODO 先使用循环调用时间 如果不行的话  后面需要单独加一个回调
                for (var _key in selectedRowKeys) {
                  if (selectedRowKeys.hasOwnProperty(_key) && Object(api_index_["isFunction"])(checkboxChange)) {
                    var selectedRecord = fullDataObject[_key];
                    selectedRowKeys[_key] && checkboxChange(selectedRecord, selectedRecord.rowIndex, {});
                  }
                }
              });
            }
          }
        }
      }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Table"], {
        lazyload: isLazyload,
        className: classnames_default()("tree-table-manyCol-container", {
          'firstcol-ellipsis': this.props.store.getStore('isEllipsis')
        }),
        expandedRowKeys: expandedKeys //搜索节点关键字后要展开的父节点
        ,
        columns: this.createNewCol(columns, maxDeep),
        columnKey: "attrcode",
        data: treeData,
        onExpand: this.onExpand,
        onExpandedRowsChange: function onExpandedRowsChange(expandedRowKeys) {
          // 更新
          store.setStore('expandedKeys', expandedRowKeys);
        },
        bodyDisplayInRow: false //折行回调
        ,
        foldingRowChange: function foldingRowChange(isEllipsis) {
          store.setStore('isEllipsis', isEllipsis);
        },
        scroll: scrollConfig || {
          y: tableHeight
        },
        bodyStyle: {
          minHeight: scrollConfig && scrollConfig.y ? scrollConfig.y : 60
        },
        onRowDoubleClick: this.onRowDoubleClick,
        adaptionHeight: adaptionHeight,
        otherAreaHeight: otherAreaHeight,
        inModal: inModal,
        onRowClick: this.onRowClick,
        isDrag: isDrag,
        ref: function ref(dom) {
          _this3.dom = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(dom);
        },
        rowClassName: this.rowClassName,
        addBlankCol: addBlankCol,
        extendRightMenu: showContextMenu ? this.createContextMenu() : Object(api_index_["isFunction"])(extendRightMenu) ? extendRightMenu() : null,
        cancelCustomRightMenu: true,
        colsSettingParam: this.getColSetConfig(),
        showWidthAndHeightConfig: showWidthAndHeightConfig
      }), langJson ? modal.createModal('delNode', {
        title: langJson['insert-tree-table-001'],
        content: langJson['insert-tree-table-002'],
        beSureBtnClick: this.delNodeEve.bind(this),
        backdrop: 'static'
      }) : null, modal.createModal('treeTableManyColModal', {
        content: this.modalContent.call(this),
        beSureBtnClick: this.beSureBtnClick.bind(this),
        cancelBtnClick: function cancelBtnClick() {
          modal.close('treeTableManyColModal');
        },
        size: 'lg',
        userControl: true,
        backdrop: 'static'
      }));
    }
  }]);

  return TreeTable;
}(template_index_["BaseComponent"]);

treeTable_TreeTable.displayName = 'TreeTable';
treeTable_TreeTable.useTreeTable = TreeTable_store;
/* harmony default export */ var treeTable = (treeTable_TreeTable);
// CONCATENATED MODULE: ./src/platform/components/TreeTable/methods.js
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { methods_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function methods_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

/*
 *   create by wangshhj
 * */





var MODALNAME = {
  add: "新增节点",
  edit: "编辑节点"
};
/**
 * @desc 保存列的宽度
 * @type {{
 *   'attrCode': Number
 * }}
 */

var cellWidth = {};
var PID = "root";
/**
 * 检测组件对象是否存在 bbq
 * @param {*} id 
 */

var methods_existenceCheck = function existenceCheck(id) {
  var store = this.treeTableDataSource[id];

  if (!store) {
    store = TreeTable_store();
    this.treeTableDataSource[id] = store; // 同步模板

    store.setMeta(this.meta.getMeta());
    console.warn("\u6240\u64CD\u4F5C\u7684\u8868\u683C\u4E2D\u65E0ID\u4E3A".concat(id, "\u7684\u6570\u636E"));
    return;
  }

  return store;
}; // 创建组件


function treeTableCol(moduleId) {
  var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  // this.register("treeTable"); // 生成 this.treeTableDataSource[id]
  var pageScope = this,
      store = pageScope.treeTableDataSource[moduleId];

  if (!store) {
    store = TreeTable_store();
    pageScope.treeTableDataSource[moduleId] = store; // 同步模板

    store.setMeta(pageScope.meta.getMeta(), moduleId, false);
    console.log(pageScope);
  }

  var async = config.async,
      others = _objectWithoutProperties(config, ["async"]);

  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(treeTable, _extends({
    async: async,
    store: store,
    id: moduleId,
    modal: this.modal
  }, others));
}
/*
 *    插入子节点数据
 *    @ child 子表数据
 *    @ parent 当前行信息
 * */

function setChildNodeEve(tableData, child, parent) {
  var checkedKeys = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
  var expandedKeys = arguments.length > 4 ? arguments[4] : undefined;
  var isCheckedHasChild = arguments.length > 5 ? arguments[5] : undefined;
  child = JSON.parse(JSON.stringify(child)); // 清理 并拷贝对象

  var parentKey = parent.key;
  var len = tableData.length;

  for (var i = 0; i < len; i++) {
    var item = tableData[i];

    if (item.rowId === parentKey) {
      if (expandedKeys && expandedKeys.length) {
        clearExpandedKeys(tableData[i].children, expandedKeys);
      }

      tableData[i].children = child; //父级勾选 包含下级时，勾选所有子级

      if (isCheckedHasChild && checkedKeys[item.rowId]) {
        methods_setChecked(child, checkedKeys);
      }

      return true;
    } else if (Array.isArray(item.children)) {
      var res = setChildNodeEve(item.children, child, parent, checkedKeys, expandedKeys, isCheckedHasChild);

      if (res) {
        return false;
      }
    }
  }
}
/*
 *   添加rowId;
 *   field: rowId字段
 * */


function addRowId(data, field, expandedKeys) {
  if (!Array.isArray(data)) {
    console.warn("addRowId方法，第一个参数应为数组");
    return false;
  }

  if (data.length > 0 && !data[0].values[field]) {
    console.warn("addRowId\u65B9\u6CD5\uFF0C\u6CA1\u6709\u627E\u5230\u53C2\u6570".concat(field));
    return false;
  }

  data.forEach(function (item) {
    item.key = item.rowId = item.values[field].value;
    expandedKeys && expandedKeys.push(item.values[field].value);

    if (Array.isArray(item.children)) {
      addRowId(item.children, field, expandedKeys);
    }
  });
}
/*
 *   根据isleaf 添加children
 * */


function addChildren(data) {
  data.forEach(function (item) {
    if (item.hasOwnProperty("isleaf") && !item.isleaf) {
      item.children = item.children || [];
    }
  });
}
/*
 *   编辑行事件
 * */


function editRow(tableData, newItem) {
  newItem = JSON.parse(JSON.stringify(newItem));
  var i = tableData.length;

  while (i--) {
    var item = tableData[i];

    if (item.rowId === newItem.rowId) {
      tableData[i] = _objectSpread(_objectSpread({}, tableData[i]), newItem);
      return true;
    } else {
      if (Array.isArray(item.children)) {
        var res = editRow(item.children, newItem);

        if (res) {
          return false;
        }
      }
    }
  }
}
/*
 *   增加子节点事件
 * */


function addChildNode(tableData, newItem, parent, syncAddNode) {
  newItem = JSON.parse(JSON.stringify(newItem)); // 清理 并拷贝对象

  var pk = null;

  if (!parent) {
    if (!newItem.values.pid) {
      console.error("树状表添加子节点的方法没找到pid");
      return false;
    }

    pk = newItem.values.pid.value;
  } else {
    pk = parent.key;
  }

  var i = tableData.length;

  while (i--) {
    var item = tableData[i];

    if (item.rowId === pk) {
      if (!newItem.values.pid) {
        newItem.values.pid = {
          value: pk
        };
      } // addChildRowEve 补丁


      if (tableData[i] && syncAddNode) tableData[i].isleaf = false;

      if (Array.isArray(tableData[i].children)) {
        tableData[i].children.push(newItem);
      } else {
        if (syncAddNode) tableData[i].isleaf = false;
        tableData[i].children = [newItem];
      }

      return true;
    } else {
      if (Array.isArray(item.children)) {
        var res = addChildNode(item.children, newItem, parent, syncAddNode);

        if (res) {
          return false;
        }
      }
    }
  }
}
/*
 *   增加兄弟节点事件
 * */


function addBrother(tableData, newItem, brother) {
  newItem = JSON.parse(JSON.stringify(newItem)); // 清理 并拷贝对象

  var pk = brother.key;
  var len = tableData.length;

  for (var i = 0; i < len; i++) {
    var item = tableData[i];

    if (item.rowId === pk) {
      tableData.splice(i + 1, 0, newItem);
      return true;
    } else {
      if (Array.isArray(item.children)) {
        var res = addBrother(item.children, newItem, brother);

        if (res) {
          return false;
        }
      }
    }
  }
}
/*
 *   删除行
 * */


function delRow(tableData, key) {
  var len = tableData.length;

  for (var i = 0; i < len; i++) {
    var item = tableData[i];

    if (item.rowId === key) {
      tableData.splice(i, 1);
      return true;
    } else {
      if (Array.isArray(item.children)) {
        var res = delRow(item.children, key);

        if (res) {
          return false;
        }
      }
    }
  }
}
/*
 *   删除后检测节点是否还有子节点，若没有，删除children 。 只检测删除行的父元素
 * */


function checkHasChildren(tableData, parentRowId) {
  var i = tableData.length;

  while (i--) {
    var item = tableData[i];

    if (item.rowId === parentRowId) {
      if (Array.isArray(item.children) && item.children.length === 0) {
        delete item.children;
      }

      return true;
    } else {
      if (Array.isArray(item.children)) {
        var res = checkHasChildren(item.children);

        if (res) {
          return false;
        }
      }
    }
  }
}
/**
 * 根据rowid获取当前行数据
 */


function getValueByRowIdEve(tableData, rowId) {
  var i = tableData.length;

  while (i--) {
    var item = tableData[i];

    if (item.rowId === rowId) {
      return item;
    } else {
      if (Array.isArray(item.children)) {
        var res = getValueByRowIdEve(item.children, rowId);

        if (res) {
          return res;
        }
      }
    }
  }
}
/*  获取勾选项 */


function getSelectedRowEve(data, store) {
  var checkedKeys = store.getStore('checkedKeys');
  var res = [];

  var G = function G(data) {
    data.map(function (item) {
      if (checkedKeys[item.key]) {
        res.push(item);
      }

      if (Array.isArray(item.children)) {
        G(item.children);
      }
    });
  };

  G(data);
  return res;
}
/**
 * 设置勾选项
 * @param {*} moduleId
 * @param {*} checkedKeys
 * @param {*} merge
 */


function setCheckedKeys(moduleId, checkedKeys, merge) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var oldCheckedKeys = store.getStore('checkedKeys');

  if (merge) {
    checkedKeys = Object.assign(oldCheckedKeys, checkedKeys);
  } else {
    checkedKeys = Object.assign({}, checkedKeys);
  }

  store.setStore('checkedKeys', checkedKeys);
}
/**
 * 是否包含下级---未导出
 * @param {string} moduleId
 */

function isCheckHasChild(moduleId) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  return store.getStore('isCheckedHasChild');
}
/**
 * 设置选中行
 * @param {*} moduleId
 * @param {*} record
 */

function setSelectedRow(moduleId, record) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  store.setStore('currentSelectedRow', record);
}
/*==================================================================================*/

/*
 *   初始化树状表数据
 *   @ data 数据
 *   @ rowId  表示行id的字段名
 *   @ 默认展开所有行 defaultExpandAllRows
 * */

function initTreeTableData(moduleId, data, rowId, defaultExpandAllRows, expandedRowKeys) {
  if (rowId === undefined) {
    console.warn("树状表addRowId方法，第三个参数需要传表示行rowid 的字段");
    return false;
  }

  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var _store$getStore = store.getStore(),
      async = _store$getStore.async,
      isCheckedHasChild = _store$getStore.isCheckedHasChild,
      checkedKeys = _store$getStore.checkedKeys;

  if (async) {
    //异步时，需要添加children字段。
    addChildren(data);
  }

  var res,
      expandedKeys = [];

  if (defaultExpandAllRows) {
    res = addRowId(data, rowId, expandedKeys);

    if (isCheckedHasChild && checkedKeys) {
      data.map(function (item) {
        if (checkedKeys[item.key] && Array.isArray(item.children)) {
          methods_setChecked(item.children, checkedKeys);
        }
      });
    }
  } else {
    res = addRowId(data, rowId);
    expandedRowKeys && store.setStore('expandedKeys', expandedRowKeys, false);
  }

  if (res === false) {
    console.warn("\u6811\u72B6\u8868addRowId\u65B9\u6CD5\uFF0C\u6CA1\u6709\u627E\u5230\u8868\u793ArowId\u7684\u5B57\u6BB5\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u4E2D\u662F\u5426\u5B58\u5728".concat(rowId, "\u5B57\u6BB5"));
    return false;
  }

  store.setData({
    data: data,
    shouldForceUpdate: false
  });
  store.setStore('rowId', rowId, false);
  isCheckedHasChild && store.setStore('checkedKeys', checkedKeys, false);
  defaultExpandAllRows && store.setStore('expandedKeys', expandedKeys, false); // 缓存数据以用于  前端查找 --bbqin

  store.setCache('cacheData', JSON.parse(JSON.stringify(data)));
  store.setStore('searchValue', null, true);
} //设置子数据勾选

function methods_setChecked(children, checkedKeys) {
  if (Array.isArray(children)) {
    children.forEach(function (item) {
      checkedKeys[item.key] = true;

      if (Array.isArray(item.children)) {
        methods_setChecked(item.children);
      }
    });
  }
} //设置子数据勾选


function clearExpandedKeys(children, expandedKeys) {
  if (Array.isArray(children)) {
    children.forEach(function (item) {
      var index = expandedKeys.indexOf(item.key);

      if (index !== -1) {
        expandedKeys.splice(index, 1);
      }

      if (Array.isArray(item.children)) {
        clearExpandedKeys(item.children, expandedKeys);
      }
    });
  }
}

function updataDataSource(moduleId, callBack) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var data = store.getData();

  if (callBack) {
    var newDataSource = callBack(JSON.parse(JSON.stringify(data)));

    if (Array.isArray(newDataSource)) {
      store.setCache('cacheData', newDataSource); // 更新

      store.setData({
        data: newDataSource
      });
    }
  } else {
    console.warn("请传回调参数，并且返回新的数据源");
  }
}
/**
 * 查询树表
 * @param {String} moduleId 模块Id
 * @param {String} searchValue 查詢字符串
 * @param {Array} filters 过滤关键字
 */

function searchTreeTable(_ref) {
  var moduleId = _ref.moduleId,
      searchValue = _ref.searchValue,
      _ref$filters = _ref.filters,
      filters = _ref$filters === void 0 ? [] : _ref$filters,
      _ref$expanded = _ref.expanded,
      expanded = _ref$expanded === void 0 ? true : _ref$expanded,
      _ref$defaultExpandAll = _ref.defaultExpandAllRows,
      defaultExpandAllRows = _ref$defaultExpandAll === void 0 ? false : _ref$defaultExpandAll;
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  if (Object.prototype.toString.call(filters) !== "[object Array]") {
    // 如果不是数组
    filters = [String(filters)];
  } // 确定是不是检索所有字段


  var data = store.getCache('cacheData') || store.getData(),
      expandedKeys = [],
      expectData = []; // 清空 数据

  store.setStore('expandedKeys', [], false);
  var searchResult = findDataByValueFilters({
    data: data,
    searchValue: searchValue,
    filters: filters,
    expandedKeys: expandedKeys,
    expanded: expanded,
    defaultExpandAllRows: defaultExpandAllRows,
    expectData: expectData
  }); // 展开的键 expandedKeys 检索后是否展开 理论上被检索到的行应该展开

  store.setData({
    data: searchResult,
    shouldForceUpdate: false
  });
  console.log(data); // 记录一下关键字 用于做替换

  store.setStore('searchValue', searchValue, false);
  store.setStore('expandedKeys', expandedKeys, false);
  store.refresh(function () {// store.setStore('searchValue', null, false);
  });
}
/**
 * 遍历  并且查询  符合要求的数据
 * @param {*} param0
 */

function findDataByValueFilters(_ref2) {
  var data = _ref2.data,
      expandedKeys = _ref2.expandedKeys,
      searchValue = _ref2.searchValue,
      filters = _ref2.filters,
      expanded = _ref2.expanded,
      defaultExpandAllRows = _ref2.defaultExpandAllRows,
      _ref2$expectData = _ref2.expectData,
      expectData = _ref2$expectData === void 0 ? [] : _ref2$expectData;

  if (!searchValue || data.length === 0) {
    return data || [];
  }

  var needFilters = false,
      filtersLength = filters.length; // 不区分大小写

  searchValue = searchValue.toLocaleLowerCase();
  data.map(function (item) {
    var isMatch = false,
        values = item.values,
        value;
    var expectItem = JSON.parse(JSON.stringify(item, function (k, v) {
      if (k === "children" && Object.prototype.toString.call(v) === "[object Array]") {
        return null;
      }

      return v;
    })); // 数据拷贝
    // console.log(expectItem);

    for (var vi in values) {
      // 该字段是否需要过滤
      needFilters = filtersLength === 0 ? true : filters.indexOf(vi) !== -1; // 不区分大小写

      value = String(values[vi]["display"] || values[vi]["value"]).toLocaleLowerCase();

      if (needFilters && value && value.indexOf(searchValue) !== -1) {
        // 匹配到行
        isMatch = true;
        break;
      }
    }

    if (Array.isArray(item.children)) {
      // 子循环
      expectItem.children = findDataByValueFilters({
        data: item.children,
        expandedKeys: expandedKeys,
        searchValue: searchValue,
        filters: filters,
        expanded: expanded,
        defaultExpandAllRows: defaultExpandAllRows,
        expectData: []
      });
      expectItem.children.length === 0 && (expectItem.children = null);
    }

    (isMatch || expectItem.children && expectItem.children.length > 0) && expectData.push(expectItem);

    if ((isMatch || expectItem.children && expectItem.children.length > 0) && (expanded || defaultExpandAllRows)) {
      // 默认展开 或者全部展开
      expandedKeys.push(item.key || item.rowId);
    }
  });
  return expectData;
}
/*
 *   异步加载时，设置子表数据
 *    @ child 子表数据
 *    @ parent 点击的当前行数据
 * */


function setChildNode(moduleId, child, parent, isCheckedHasChild) {
  if (!moduleId || !child || !parent) {
    console.warn("树状表setChildNode 方法参数不正确");
    return false;
  }

  if (!Array.isArray(child)) {
    console.warn("树状表setChildNode 方法,第二个参数应为数组");
    return false;
  }

  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var rowId = store.getStore('rowId');
  var async = store.getStore('async');
  var checkedKeys = store.getStore('checkedKeys');
  var expandedKeys = store.getStore('expandedKeys');
  var data = store.getData();
  var cacheData = store.getCache('cacheData');
  isCheckedHasChild = isCheckedHasChild || store.getStore('isCheckedHasChild');

  if (async) {
    addChildren(child);
    addRowId(child, rowId);
    setChildNodeEve(data, child, parent, checkedKeys, expandedKeys, isCheckedHasChild); // 更新缓存数据以用于查找 by bbqin

    setChildNodeEve(cacheData, child, parent, checkedKeys, expandedKeys, isCheckedHasChild); // 更新

    store.setStore('searchValue', null);
  } else {
    console.warn("setChildNode方法只能异步加载时调用");
  }
}
function methods_getChildren(data, parentKey) {
  return getChildren(data, parentKey);
}
/*
 *   编辑行
 * */

function editRowEve(moduleId, newData) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var rowId = store.getStore('rowId');
  var data = store.getData();
  var cacheData = store.getCache('cacheData');

  if (!newData.values[rowId]) {
    console.warn && console.warn("\u6811\u72B6\u8868editRowEve \u65B9\u6CD5,\u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E2D\u6CA1\u6709\u627E\u5230\u8868\u793ARowId\u7684\u5B57\u6BB5\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u4E2D\u662F\u5426\u6709".concat(rowId, "\u5B57\u6BB5"));
    return false;
  }

  newData.rowId = newData.values[rowId].value;
  addChildren([newData]);
  editRow(data, newData); // 更新缓存数据以用于查找 by bbqin

  editRow(cacheData, newData); // 更新

  store.setStore('searchValue', null);
}
/*
 *   增加子节点
 * */

function addChildRowEve(moduleId, newData) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var rowId = store.getStore('rowId');
  var currentRow = store.getStore('currentRow');
  var data = store.getData();
  var cacheData = store.getCache('cacheData');
  console.log(newData, currentRow, data, cacheData);

  var runThis = function runThis(item) {
    var kValue = item.values[rowId];
    item.values[rowId] = kValue && kValue.value !== undefined && kValue.value !== null ? kValue : {
      value: Object(api_index_["getSafeRandom"])()
    }; // if (!item.values[rowId]) {
    // 	console.warn(`树状表editRowEve 方法,第二个参数中没有找到表示RowId的字段，请检查数据中是否有${rowId}字段`);
    // 	return false;
    // }

    item.key = item.rowId = item.values[rowId].value;
    addChildren([item]);
    addChildNode(data, item, currentRow, true); // 更新缓存数据以用于查找 by bbqin

    addChildNode(cacheData, item, currentRow, true);
    store.setStore('searchValue', null, false);
  };

  if (Array.isArray(newData)) {
    newData.forEach(function (items) {
      runThis(items);
    });
  } else {
    runThis(newData);
  } // 更新


  store.refresh();
}
/*
 *   更新全部子节点
 * */

function updateChildRow(moduleId, newData, parentRow) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var rowId = store.getStore('rowId');
  var currentRow = store.getStore('currentRow');
  var data = store.getData();
  var newDataArr = [];
  var pk = "root";
  if (currentRow) pk = currentRow.key;
  if (parentRow) pk = parentRow.key;

  if (Array.isArray(newData)) {
    newDataArr = newData;
  } else {
    newDataArr = [newDataArr];
  }

  var loop = function loop(data, pk) {
    if (!data.length) return;
    data.map(function (item) {
      var kValue = item.values[rowId];
      item.values[rowId] = kValue && kValue.value !== undefined ? kValue : {
        value: Object(api_index_["getSafeRandom"])()
      };
      item.key = item.rowId = item.values[rowId].value;

      if (!item.values.pid) {
        item.values.pid = {
          value: pk
        };
      }

      if (item.hasOwnProperty("isleaf") && !item.isleaf) {
        item.children = item.children || [];
        loop(item.children, item.key);
      }
    });
  };

  var updateRowByRowId = function updateRowByRowId(tableData, rowId) {
    var i = tableData.length;

    while (i--) {
      var item = tableData[i];

      if (item.rowId === rowId) {
        tableData[i].children = newDataArr;
        tableData[i].isleaf = false;
        return true;
      } else {
        if (Array.isArray(item.children)) {
          var res = updateRowByRowId(item.children, rowId);
          if (res) return true;
        }
      }
    }
  };

  loop(newDataArr, pk); // 处理节点数据，检查key，rowId，children

  if (!updateRowByRowId(data, pk)) {
    data = newDataArr;
  } // 更新


  store.setStore('searchValue', null);
}
/*
 *   增加兄弟节点
 * */

function addBrotherRow(moduleId, newData) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var rowId = store.getStore('rowId');
  var currentRow = store.getStore('currentRow');
  var data = store.getData();
  var cacheData = store.getCache('cacheData');

  if (!newData.values[rowId]) {
    console.warn("\u6811\u72B6\u8868addBrotherRow \u65B9\u6CD5,\u7B2C\u4E8C\u4E2A\u53C2\u6570\u4E2D\u6CA1\u6709\u627E\u5230\u8868\u793ARowId\u7684\u5B57\u6BB5\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u4E2D\u662F\u5426\u6709".concat(rowId, "\u5B57\u6BB5"));
    return false;
  }

  newData.rowId = newData.values[rowId].value;
  addChildren([newData]);
  addBrother(data, newData, currentRow); // 更新缓存数据以用于查找 by bbqin

  addBrother(cacheData, newData, currentRow); // 更新

  store.setStore('searchValue', null);
}
/*
 *   删除节点
 * */

function delRowByPk(moduleId, record) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var data = store.getData();
  var cacheData = store.getCache('cacheData');
  var key = record.key;
  delRow(data, key); // 更新缓存数据以用于查找 by bbqin

  delRow(cacheData, key);

  if (record.pid) {
    checkHasChildren(data, record.pid); // 更新缓存数据以用于查找 by bbqin

    checkHasChildren(cacheData, record.pid);
  } // 更新数据


  store.setData({
    data: data,
    shouldForceUpdate: false
  });
  store.setCache('cacheData', cacheData); // 更新

  store.setStore('searchValue', null);
}
/*
 *   同步时，组装树状表所需要的数据结构
 * */

function methods_createNewData(data) {
  if (!Array.isArray(data)) {
    console.warn("createTreeData方法，参数应该为数组");
    return false;
  }

  var group = new Map();
  data.forEach(function (e) {
    if (!(e.values.pid && e.values.pid.value)) {
      e.values.pid = {
        value: PID
      };
    }

    group.get(e.values.pid.value) ? group.get(e.values.pid.value).push(e) : group.set(e.values.pid.value, [e]);
  });

  function makeDOM(pid) {
    if (group.get(pid)) {
      return group.get(pid).map(function (e) {
        e.children = makeDOM(e.values.refpk.value);
        return e;
      });
    } else {
      return null;
    }
  }

  var newData = makeDOM(PID) || [];
  /* 添加isleaf字段 */

  var addIsLeaf = function addIsLeaf(data) {
    data.forEach(function (item) {
      if (item.checked) {
        item.checked = true;
      } else {
        item.checked = false;
      }

      if (Array.isArray(item.children)) {
        item.isleaf = false;
        addIsLeaf(item.children);
      } else {
        item.isleaf = true;
      }
    });
  };

  addIsLeaf(newData);
  return newData;
}
/*
 *   获取当前表格所有数据
 * */

function getAllValue(moduleId) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  return store.getData();
}
function getExpandedRowKeys(moduleId) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  return store.getStore('expandedKeys');
}
/*
 *   获取当前表格某行数据 byId
 * */

function getValueByRowId(moduleId, rowId) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var data = store.getData();
  return getValueByRowIdEve(data, rowId);
}
/*
 *   弹出框  (要改)
 * */

function showModal(moduleId, record, modalType) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var langJson = store.getCache('langJson');
  var formStore = store.getStore('formStore');
  var uuid = store.getStore('uuid');
  MODALNAME.add = langJson["insert-tree-table-012"];
  MODALNAME.edit = langJson["insert-tree-table-011"];
  store.setStore('currentRow', record, false); // this.state.form[moduleId + 'form'] = modalType === 'edit' ? record.values : {};

  var formValues = JSON.parse(JSON.stringify(modalType === "edit" ? record.values : {}));
  console.log(formValues, formStore);
  formStore.emptyAllFormValue();
  formStore.setAllFormValue(formValues);
  store.setStore('modalType', modalType, true);
  this.modal.show("treeTableManyColModal", {
    title: "".concat(MODALNAME[modalType])
  });
}
/* 清空表格 */

function emptyAllData(moduleId) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  store.setData({
    data: [],
    shouldForceUpdate: false
  });
  store.setCache('cacheData', []); // 更新缓存数据以用于查找 by bbqin

  store.setStore('searchValue', null);
}
/* 展开节点*/

function openRow(moduleId, key) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var expandedKeys = store.getStore('expandedKeys');
  !expandedKeys.find(function (i) {
    return i === key;
  }) && expandedKeys.push(key);
  store.refresh();
}
/* 收起节点*/

function closeRow(moduleId, key) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var expandedKeys = store.getStore('expandedKeys');
  var index = expandedKeys.findIndex(function (i) {
    return i === key;
  });
  expandedKeys.splice(index, 1);
  store.refresh();
}
/* 获取选中行数据 */

function getSelectedRow(moduleId) {
  var store = methods_existenceCheck.call(this, moduleId);

  if (!store) {
    return;
  }

  var data = store.getData();
  var expandedKeys = store.getStore('expandedKeys');
  var isCheckedHasChild = store.getStore('isCheckedHasChild');
  var selectedRows = getSelectedRowEve(data, store);
  var res = JSON.parse(JSON.stringify(selectedRows));
  res = res.map(function (item) {
    var children = item.children,
        others = _objectWithoutProperties(item, ["children"]); //勾选节点未展开, 且children不存在


    if (!expandedKeys.includes(item.key) && (!children || Array.isArray(children) && children.length === 0)) {
      //若勾选项不是叶子节点，且设置了isCheckHasChild:true
      if (item.isleaf !== false && isCheckedHasChild) {
        others.isCheckHasChild = true;
      }
    }

    return others;
  });
  return res;
} // /* 获取选中行数据 */
// export function getSelectedRow(moduleId) {
// }
//   获取最深树层级 数

function methods_countDeep(source) {
  return countDeep(source);
}
/**
 * @desc 如果点击的是操作列，展开图标，文本夹图标就不执行选中事件。 选中文本时也不执行
 * @param e {object} 事件源
 * @param checkOnRowClick {boolean} 配置是否需要勾选功能
 */

function methods_stopCheckBoxChange(e, checkOnRowClick) {
  return stopCheckBoxChange(e, checkOnRowClick);
}
/**
 * @desc 判断此单元格是否需要显示tooltip
 * @param cellDom {object} 单元格dom
 * @param attrCode {string}
 * @param fixed {string} 锁定列表
 * @return {boolean} true -> 显示tooltip, false -> 不显示
 */

function perceptionTooltip(_ref3) {
  var cellDom = _ref3.cellDom,
      attrCode = _ref3.attrCode,
      fixed = _ref3.fixed;
  var PRE_FIX = "nc_tree";
  var id = "".concat(PRE_FIX, "_").concat(attrCode);
  var cloneDom = document.getElementById(id);

  if (cloneDom) {
    cloneDom.innerText = cellDom.innerText;
    return cloneDom.offsetWidth > cellWidth[attrCode];
  } else if (fixed === "left") {
    var fixedDom = document.querySelectorAll(".u-table-fixed-left span[fieldid=\"".concat(attrCode, "\"] span"))[0];
    if (fixedDom === null) return false;
    cloneDom = createCloneDomAndSetAttribute({
      id: id,
      attrCode: attrCode,
      cellWidth: cellWidth,
      originDom: fixedDom
    });
    return cloneDom.offsetWidth > fixedDom.offsetWidth;
  } else {
    cloneDom = createCloneDomAndSetAttribute({
      id: id,
      attrCode: attrCode,
      cellWidth: cellWidth,
      originDom: cellDom
    });
    return cloneDom.offsetWidth > cellDom.offsetWidthh;
  }
}

function createCloneDomAndSetAttribute(_ref4) {
  var originDom = _ref4.originDom,
      id = _ref4.id,
      attrCode = _ref4.attrCode,
      cellWidth = _ref4.cellWidth;
  var cloneDom = originDom.cloneNode();
  cloneDom.className = "u-cell-hidden";
  cloneDom.id = id;
  document.body.appendChild(cloneDom);
  cloneDom.innerText = originDom.innerText;
  cloneDom.height = "0px";
  cellWidth[attrCode] = originDom.offsetWidth;
  return cloneDom;
}
// CONCATENATED MODULE: ./src/platform/components/TreeTable/treeTableManyCol.js
function treeTableManyCol_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * @Author: liyxt
 * @Date: 2019-10-21 14:15:59
 * @LastEditors: bbq
 * @LastEditTime: 2020-08-07 14:28:12
 * @Description: file content
 */

/*
 *  	树状表组件
 * */









var treeTableManyCol_defaultColor = ['#111111', '#555555', '#111', '#555'];

__webpack_require__(374);

var isMultilingual = false; // 计算主表表体高度

var treeTableManyCol_tableHeight = 0;
var treeTableManyCol_screenHeight = window.screen.width;

if (treeTableManyCol_screenHeight <= 1919 > 1440) {
  treeTableManyCol_tableHeight = 48 * 10 + 'px';
} else if (treeTableManyCol_screenHeight > 1919) {
  treeTableManyCol_tableHeight = 56 * 10 + 'px';
} else {
  treeTableManyCol_tableHeight = 40 * 10 + 'px';
}

var formId = null;

function TreeTableManyCol(id) {
  var _this = this;

  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
      expandEve = _ref.expandEve,
      collapandEve = _ref.collapandEve,
      async = _ref.async,
      editNodeCallBack = _ref.editNodeCallBack,
      addNodeCallBack = _ref.addNodeCallBack,
      delNodeCallBack = _ref.delNodeCallBack,
      onAfterEvent = _ref.onAfterEvent,
      _ref$showCheckBox = _ref.showCheckBox,
      showCheckBox = _ref$showCheckBox === void 0 ? false : _ref$showCheckBox,
      _ref$checkedType = _ref.checkedType,
      checkedType = _ref$checkedType === void 0 ? 'checkbox' : _ref$checkedType,
      checkboxChange = _ref.checkboxChange,
      scrollConfig = _ref.scrollConfig,
      ncOnRowDoubleClick = _ref.ncOnRowDoubleClick,
      _ref$isDrag = _ref.isDrag,
      isDrag = _ref$isDrag === void 0 ? true : _ref$isDrag,
      _ref$multipleRowCell = _ref.multipleRowCell,
      multipleRowCell = _ref$multipleRowCell === void 0 ? false : _ref$multipleRowCell,
      _ref$adaptionHeight = _ref.adaptionHeight,
      adaptionHeight = _ref$adaptionHeight === void 0 ? true : _ref$adaptionHeight,
      _ref$inModal = _ref.inModal,
      inModal = _ref$inModal === void 0 ? false : _ref$inModal,
      _ref$checkOnRowClick = _ref.checkOnRowClick,
      checkOnRowClick = _ref$checkOnRowClick === void 0 ? true : _ref$checkOnRowClick,
      fieldid = _ref.fieldid,
      onRowClickEve = _ref.onRowClickEve,
      _ref$isLazyload = _ref.isLazyload,
      isLazyload = _ref$isLazyload === void 0 ? true : _ref$isLazyload,
      _ref$addBlankCol = _ref.addBlankCol,
      addBlankCol = _ref$addBlankCol === void 0 ? true : _ref$addBlankCol,
      _ref$showContextMenu = _ref.showContextMenu,
      showContextMenu = _ref$showContextMenu === void 0 ? false : _ref$showContextMenu,
      expandAllEve = _ref.expandAllEve,
      closeAllEve = _ref.closeAllEve,
      _ref$hideExpandAll = _ref.hideExpandAll,
      hideExpandAll = _ref$hideExpandAll === void 0 ? false : _ref$hideExpandAll,
      _ref$hideIncludeChild = _ref.hideIncludeChild,
      hideIncludeChild = _ref$hideIncludeChild === void 0 ? false : _ref$hideIncludeChild,
      onCellMouseDown = _ref.onCellMouseDown,
      extendRightMenu = _ref.extendRightMenu,
      _ref$isCheckedHasChil = _ref.isCheckedHasChild,
      isCheckedHasChild = _ref$isCheckedHasChil === void 0 ? false : _ref$isCheckedHasChil;

  var flag = false;
  var that = this;

  if (!this.state.treeTableCol.hasOwnProperty(id)) {
    this.state.treeTableCol[id] = {
      firstTime: true,
      async: async,
      expandedKeys: [],
      checkedKeys: {},
      tableHeight: treeTableManyCol_tableHeight,
      isEllipsis: true
    };
  }

  var columns = this.state.meta[id];

  if (!columns) {
    return;
  }

  if (!this.state.treeTableCol[id].data) {
    return; // this.state.treeTableCol[id].data = [];
  }

  var thisTable = this.state.treeTableCol[id];

  if (typeof thisTable.isCheckedHasChild === "undefined") {
    thisTable.isCheckedHasChild = isCheckedHasChild;
  }

  var treeData = thisTable.data;
  var defTreeData = JSON.parse(JSON.stringify(treeData));
  var defCol = Object(api_index_["cloneObj"])(columns); //调用多语

  var callback = function callback(json, bool, LangData) {
    if (isMultilingual) return;
    thisTable.multilingual = json;
    SAVE_MULTI.lang = json;
    that.setState({
      treeTableCol: that.state.treeTableCol
    }, function () {
      isMultilingual = true;
    });
  };

  Object(api_index_["getMultiLang"])({
    moduleId: 'containers_insert_tree_table',
    callback: callback
  }); //	第一次渲染，处理数据，并设置编辑弹出模态框模板

  if (thisTable.firstTime) {
    formId = id + 'form';
    var formItem = [];

    if (!Object(api_index_["isArray"])(defCol.items)) {
      console.error('树状表模板中，items应为数组,请参考文档');
      return;
    }

    defCol.items.map(function (item) {
      if (item.itemtype !== 'customer') {
        // item 内部东西太复杂 直接给会导致一些问题
        var nItem = JSON.parse(JSON.stringify(item || {}, function (key, value) {
          if (key == 'render' || key == 'title') {
            // title 和 value 是react对象  会导致问题
            return undefined;
          }

          return value;
        }));
        delete nItem.render;
        delete nItem.title;
        formItem.push(nItem);
      }
    });
    this.state.meta[formId] = {
      moduletype: 'form',
      items: formItem,
      status: 'edit'
    };
    this.use.form(formId);
    this.formDataSource[formId].setMeta(this.state.meta, formId);
    thisTable.firstTime = false;
  }
  /* setState */


  var setStateEve = function setStateEve() {
    _this.setState({
      treeTableCol: _this.state.treeTableCol
    });
  }; // 查找数据类型，并返回


  var checkDataType = function checkDataType(field) {
    var data = columns.items.find(function (item) {
      return item.attrcode === field;
    });

    if (data) {
      return data.itemtype;
    }
  }; // 设置一个拉平数据 给框选用  超大数据量时不知道有没有性能问题 by bbqin
  // 由于框选需要数据顺序 现在取出来的顺序不对 后面再调整


  var fullDataArray = {}; //  处理数据格式

  var createNewData = function createNewData(data) {
    var dataSource = data.map(function (item, index) {
      item.key = item.rowId; // 记录一下行顺序给 框选使用

      item.rowIndex = index;

      if (item.values.pid) {
        item.pid = item.values.pid.value;
      }

      if (Array.isArray(item.children)) {
        createNewData(item.children);
      }

      fullDataArray[item.key] = item;
      return item;
    });
    return dataSource;
  };

  var createNewDataRes = createNewData(defTreeData);
  var cp = JSON.parse(JSON.stringify(createNewDataRes)); //   获取到最深层级
  //   countDeep(cp)

  /* 复选框change事件(多选) */

  var itemCheckBoxChange = function itemCheckBoxChange(data, key) {
    thisTable.checkedKeys[key] = !thisTable.checkedKeys[key]; //包含下级时，全部选中

    if (thisTable.isCheckedHasChild && showContextMenu) {
      var setChecked = function setChecked(children) {
        if (Array.isArray(children)) {
          children.forEach(function (item) {
            thisTable.checkedKeys[item.key] = thisTable.checkedKeys[key];

            if (Array.isArray(item.children)) {
              setChecked(item.children);
            }
          });
        }
      };

      var children = methods_getChildren(data, key);
      console.log("设置children选中:  children", children);
      setChecked(children);
    }
  };
  /* 复选框change事件(单选) */


  var checkBoxChange_radio = function checkBoxChange_radio(data, key) {
    if (thisTable.checkedKeys[key]) {
      thisTable.checkedKeys = {};
    } else {
      thisTable.checkedKeys = treeTableManyCol_defineProperty({}, key, true);
    } // thisTable.isCheckedHasChild

  };
  /* 复选框选中事件 */


  var onCheckboxChangeChild = function onCheckboxChangeChild(text, record, index, e) {
    e.stopPropagation();

    if (checkedType === 'radio') {
      //单选
      checkBoxChange_radio(thisTable.data, record.key);
    } else {
      //多选
      itemCheckBoxChange(thisTable.data, record.key);
    }

    if (Object(api_index_["isFunction"])(checkboxChange)) {
      checkboxChange(record, index, e);
    }

    setStateEve();
  };
  /* 查找对应的行数据 */


  var findItem = function findItem(data, key) {
    var res = null;

    var f = function f(data) {
      data.map(function (item) {
        if (item.rowId === key) {
          res = item;
          return true;
        } else if (Array.isArray(item.values.children)) {
          var r = f(item.values.children);

          if (r) {
            return false;
          }
        }
      });
    };

    f(data);
    return res;
  }; // 处理模板


  var createNewCol = function createNewCol(data) {
    var multiYes = thisTable.multilingual && thisTable.multilingual['insert-tree-table-009'];
    var multiNo = thisTable.multilingual && thisTable.multilingual['insert-tree-table-010'];
    var newArr = [];
    data.forEach(function (item) {
      if (item.visible) {
        item._width = item._width || item.width || 120;
        item.width = item.width || 120;
        item.title = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          fieldid: Object(api_index_["getSysFieldid"])(item.attrcode || 'opr'),
          style: {
            color: treeTableManyCol_defaultColor.includes(item.color) ? '' : item.color
          }
        }, ' ', item.label, ' ');
        item.dataIndex = item.attrcode;

        if (item.itemtype !== 'customer' && item.itemtype !== 'numberindex') {
          if (!item.hasOwnProperty('render')) {
            item.render = function (text, record, index) {
              if (record && record.values.hasOwnProperty(item.attrcode)) {
                if (item.itemtype === 'switch') {
                  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                    fieldid: Object(api_index_["getSysFieldid"])(item.attrcode),
                    onMouseDown: function onMouseDown(e) {
                      onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
                    }
                  }, record.values[item.attrcode].value ? multiYes : multiNo);
                } else {
                  var langIndex;
                  var langAttrCode;
                  var context = '';

                  if (item.itemtype === 'residtxt') {
                    var LangCode = Object(api_index_["getLangCode"])();
                    var loginLang = item.languageMeta.filter(function (i) {
                      return i.languageCode == LangCode;
                    });

                    if (loginLang[0]) {
                      langIndex = loginLang[0].index == '1' ? '' : loginLang[0].index;
                      langAttrCode = item.attrcode + langIndex;
                    }
                  }

                  if (langAttrCode && (record.values[langAttrCode].display || record.values[langAttrCode].value)) {
                    context = record.values[langAttrCode].display || record.values[langAttrCode].value || '';
                  } else {
                    context = record.values[item.attrcode].display || record.values[item.attrcode].value || '';
                  }

                  var fixedStyle = {
                    display: ''
                  };

                  if (item.fixed && item.fixed === 'left') {
                    if (item.width) {
                      var _width = String(item.width).replace('px', '');

                      if (_width != '120' && showCheckBox) {
                        fixedStyle.width = item.width;
                      }
                    }
                  }

                  if (typeof context != 'string') {
                    context += '';
                  } // 添加高亮 by bbqin


                  var searchValue = thisTable.searchValue || '';
                  var searchValueLow = searchValue.toLocaleLowerCase();
                  var contextLow = context.toLocaleLowerCase();
                  var beforeStr = '';
                  var afterStr = context;

                  var _index = contextLow.indexOf(searchValueLow);

                  if (searchValue && _index !== -1) {
                    beforeStr = context.substr(0, _index);
                    afterStr = context.substr(_index + searchValue.length);
                    searchValue = context.substr(_index, searchValue.length);
                  }

                  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(TreeTable_Cell, {
                    item: item,
                    beforeStr: beforeStr,
                    afterStr: afterStr,
                    searchValue: searchValue,
                    fixedStyle: fixedStyle,
                    context: context,
                    isEllipsis: thisTable.isEllipsis,
                    multipleRowCell: multipleRowCell,
                    index: _index,
                    record: record,
                    onCellMouseDown: onCellMouseDown
                  });
                }
              } else {
                return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
                  style: {
                    width: '100%',
                    height: '100%',
                    display: 'inline-block'
                  },
                  onMouseDown: function onMouseDown(e) {
                    onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
                  }
                });
              }
            };
          }
        } else if (item.itemtype === 'customer' && item.hasOwnProperty('render') && item.alreadyAssignment === undefined) {
          var Irender = item.render;
          item.alreadyAssignment = true;

          item.render = function (text, record, index) {
            return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
              fieldid: Object(api_index_["getSysFieldid"])('opr'),
              className: STOP_CHECK_OPERATION_ELEMENT,
              onMouseDown: function onMouseDown(e) {
                onCellMouseDown && onCellMouseDown(record, index, item.attrcode, item, e);
              }
            }, Irender(text, record, index));
          };
        }

        newArr.push(item);
      }
    });
    var defaultColumns = [{
      title: /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        fieldid: Object(api_index_["getSysFieldid"])('firstcol')
      }),
      attrcode: 'checkbox',
      dataIndex: 'checkbox',
      itemtype: 'customer',
      width: '100px',
      _width: '100px',
      render: function render(text, record, index) {
        // let item = findItem( thisTable.data, record.key);
        // console.log(record, index);
        if (showCheckBox) {
          return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Checkbox"], {
            onMouseDown: function onMouseDown(e) {
              onCellMouseDown && onCellMouseDown(record, index, 'checkbox', {
                attrcode: 'checkbox',
                itemtype: 'customer'
              }, e);
            },
            className: "table-checkbox",
            checked: thisTable.checkedKeys[record.key],
            onClick: onCheckboxChangeChild.bind(_this, text, record, index)
          });
        }
      }
    }];

    if (newArr[0].fixed && newArr[0].fixed == 'left') {
      defaultColumns[0].fixed = 'left';
    }

    var resArr = showCheckBox ? defaultColumns.concat(newArr) : newArr; // 给第一行增加图标

    var oldFirstColRender = resArr[0].render;
    resArr[0].render = null;

    resArr[0].render = function (text, record, index) {
      var expendSwich;

      if (Object.prototype.toString.call(record.isLeaf) == '[object Boolean]' && !record.isLeaf || Object.prototype.toString.call(record.isleaf) == '[object Boolean]' && !record.isleaf) {
        expendSwich = thisTable.expandedKeys.includes(record.key) ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont  icon-wenjianjiadakai tree-wenjian treeTableIcon ".concat(STOP_CHECK_ELEMENT)
        }) : /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "icon iconfont  icon-wenjianjia tree-wenjian treeTableIcon ".concat(STOP_CHECK_ELEMENT)
        });
      } else {
        expendSwich = /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("i", {
          className: "dian",
          style: {
            display: 'none'
          }
        });
      }

      var res = oldFirstColRender(text, record, index);

      if (res && res.props && res.props.children && res.props.children[0] && res.props.children[0].props && res.props.children[0].props.className === 'expend-switch') {
        return res;
      }

      if (res && res.props && res.props.className === 'table-checkbox') {
        return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          fieldid: Object(api_index_["getSysFieldid"])('firstcol'),
          onMouseDown: function onMouseDown(e) {
            onCellMouseDown && onCellMouseDown(record, index, 'checkbox', {
              attrcode: 'checkbox',
              itemtype: 'customer'
            }, e);
          }
        }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "first-col"
        }, res), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
          className: "expend-switch"
        }, expendSwich));
      }

      return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        fieldid: Object(api_index_["getSysFieldid"])('firstcol'),
        onMouseDown: function onMouseDown(e) {
          onCellMouseDown && onCellMouseDown(record, index, 'checkbox', {
            attrcode: 'checkbox',
            itemtype: 'customer'
          }, e);
        },
        className: classnames_default()({
          zaiyihang: showCheckBox
        })
      }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "expend-switch"
      }, expendSwich), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
        className: "first-col"
      }, res));
    }; // 给第一列追加宽度


    var width = resArr[0]._width;

    if (!flag && width) {
      if (typeof width === 'string') {
        if (width.includes('px')) {
          width = width.replace('px', '');
        }

        width = Number(width);
      }

      width += methods_countDeep(cp) * 16;
      flag = true;
    }

    resArr[0].width = width;
    return resArr;
  }; //	展开行


  var onExpand = function onExpand(status, item, e) {
    if (status) {
      if (expandEve && typeof expandEve === 'function') {
        thisTable.currentRow = item;
        expandEve(item, thisTable.isCheckedHasChild);
      }
    } else {
      if (Object(api_index_["isFunction"])(collapandEve)) {
        collapandEve(item);
      }
    }

    setStateEve();
  }; // 新增节点弹出框内容


  var modalContent = function modalContent() {
    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
      className: "addModal"
    }, _this.form.createForm(formId, {
      onAfterEvent: onAfterEvent
    }));
  }; // 删除 事件回调


  var delNodeEve = function delNodeEve() {
    if (Object(api_index_["isFunction"])(delNodeCallBack)) {
      delNodeCallBack(formId);
    }
  }; // 模态框确定按钮事件回调


  var beSureBtnClick = function beSureBtnClick() {
    var isValid = _this.form.isCheckNow(formId);

    if (!isValid) {
      return false;
    }

    var data = _this.form.getAllFormValue(formId).rows[0];

    if (thisTable.modalType === 'add') {
      data.status = 2;

      if (Object(api_index_["isFunction"])(addNodeCallBack)) {
        addNodeCallBack(data, thisTable.currentRow);
      }
    } else if (thisTable.modalType === 'edit') {
      if (Object(api_index_["isFunction"])(editNodeCallBack)) {
        editNodeCallBack(data, thisTable.currentRow);
      }
    }

    _this.modal.close('treeTableManyColModal');
  };

  var onRowDoubleClick = function onRowDoubleClick(record, index, event) {
    if (Object(api_index_["isFunction"])(ncOnRowDoubleClick)) {
      ncOnRowDoubleClick(record, index, event);
    }
  }; // const getColSetConfig = () => { //---by liuxis 鼠标不做列设置
  //   const appcode = pageTo.getAppCode();
  //   const pagecode = pageTo.getPageCode();
  //   const areaCode = id;
  //   const areaId = this.state.meta[areaCode] && this.state.meta[areaCode].oid;
  //   const code = this.state.meta.code;
  //   const pageId = this.state.meta.pageid;
  //   return { appcode, pagecode, areaCode, areaId, code, pageId };
  // };

  /**
  * @param row 行数据
  * @param index 行数
  * @param e 事件源
  */


  var onRowClick = function onRowClick(row, index, e) {
    thisTable.currentSelectedRow = row; // 为了避免和新开发的行框选点选区域选事件冲突

    if (e.ctrlKey || e.shiftKey || e.metaKey) {
      return;
    }

    if (showCheckBox && methods_stopCheckBoxChange(e, checkOnRowClick)) return;

    if (Object(api_index_["isFunction"])(onRowClickEve)) {
      onRowClickEve(row, index, e);
    }

    onCheckboxChangeChild(null, row, index, e);
  };

  var rowClassName = function rowClassName(record, current) {
    if (thisTable.currentSelectedRow && thisTable.currentSelectedRow.key == record.key) {
      return 'tree-table-col-selected';
    } else {
      return '';
    }
  };

  var createContextMenu = function createContextMenu() {
    var multilingual = thisTable.multilingual || {};
    return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_["Fragment"], null, !hideExpandAll && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
      className: classnames_default()({
        'menu expand-all': true
      }),
      onClick: function onClick() {
        var expandedKeys = [];
        getAllExpandKeys(thisTable.data);
        thisTable.expandedKeys = expandedKeys;
        setStateEve();

        function getAllExpandKeys(data) {
          data.forEach(function (item) {
            expandedKeys.push(item.key);

            if (Array.isArray(item.children)) {
              getAllExpandKeys(item.children);
            }
          });
        } //若为异步，调用业务全部展开回调


        Object(api_index_["isFunction"])(expandAllEve) && expandAllEve();
      }
    }, multilingual['insert-tree-table-0013'] || '全部展开'), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
      className: classnames_default()({
        'menu close-all': true
      }),
      onClick: function onClick() {
        thisTable.expandedKeys = [];
        setStateEve(); //业务全部收起的回调

        Object(api_index_["isFunction"])(closeAllEve) && closeAllEve();
      }
    }, multilingual['insert-tree-table-0014'] || '全部收起'), !hideIncludeChild && /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("li", {
      className: classnames_default()({
        'menu include-child': true
      }),
      onClick: function onClick() {
        thisTable.isCheckedHasChild = !thisTable.isCheckedHasChild;
        setStateEve();
      }
    }, /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Checkbox"], {
      className: 'include-child-checkbox',
      checked: thisTable.isCheckedHasChild,
      onChange: function onChange() {
        thisTable.isCheckedHasChild = !thisTable.isCheckedHasChild;
        setStateEve();
      }
    }), /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("span", {
      className: classnames_default()({
        'include-child-selected': thisTable.isCheckedHasChild
      })
    }, " ", multilingual['insert-tree-table-0015'] || '包含下级')), Object(api_index_["isFunction"])(extendRightMenu) && extendRightMenu());
  };

  return /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement("div", {
    id: id,
    className: "treeTableManyCol",
    fieldid: Object(api_index_["getSysFieldid"])("".concat(fieldid || id, "_table"))
  }, showCheckBox && checkedType !== 'radio' ? /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Selectable"], {
    canvas: "#".concat(id) // 注意可以加下前后空格
    ,
    selector: " tbody tr ",
    unitKey: "key",
    disabled: checkedType === 'radio' || 'slide' // 可选值 true false 'shift' 'ctrl' 'slide'
    ,
    userSelect: true // 启用用户文字选中
    // unitsData={fullDataArray}  // 用dom做shift 操作 数据的问题是目前顺序不对 // 数组改为对象 给下面使用
    // 开始项  主要配合外部的 单选事件处理
    ,
    startItem: "",
    onSelect: function onSelect(selectedRowKeys, hotkey, _ref2) {
      var currentKey = _ref2.currentKey;
      // 树状数据不太好处理 需要一个拉平数据
      var rowLen = thisTable.data.length;

      if (rowLen > 0) {
        if (hotkey === 'ctrl') {
          thisTable.checkedKeys[currentKey] = selectedRowKeys[currentKey]; // thisTable.isCheckedHasChild

          _this.setState({
            treeTableCol: _this.state.treeTableCol
          }, function () {
            var selectedRecord = fullDataArray[currentKey]; // console.log(fullDataArray, currentKey, selectedRecord, '数据的问题处理');

            if (Object(api_index_["isFunction"])(checkboxChange) && selectedRecord) {
              checkboxChange(selectedRecord, selectedRecord.rowIndex, {});
            }
          });
        } else {
          thisTable.checkedKeys = {};

          for (var key in selectedRowKeys) {
            if (selectedRowKeys.hasOwnProperty(key)) {
              thisTable.checkedKeys[key] = selectedRowKeys[key]; // thisTable.isCheckedHasChild
            }
          } // TODO 先使用循环调用时间 如果不行的话  后面需要单独加一个回调


          _this.setState({
            treeTableCol: _this.state.treeTableCol
          }, function () {
            for (var _key in selectedRowKeys) {
              if (selectedRowKeys.hasOwnProperty(_key) && Object(api_index_["isFunction"])(checkboxChange)) {
                var selectedRecord = fullDataArray[_key];
                selectedRowKeys[_key] && checkboxChange(selectedRecord, selectedRecord.rowIndex, {});
              }
            }
          });
        }
      }
    }
  }) : '', /*#__PURE__*/external_root_React_var_React_commonjs_react_commonjs2_react_amd_react_default.a.createElement(index_["Table"], {
    lazyload: isLazyload,
    className: "tree-table-manyCol-container",
    expandedRowKeys: thisTable.expandedKeys //搜索节点关键字后要展开的父节点
    ,
    columns: createNewCol(columns.items),
    columnKey: "attrcode",
    data: createNewDataRes,
    onExpand: onExpand.bind(this),
    onExpandedRowsChange: function onExpandedRowsChange(expandedRowKeys) {
      thisTable.expandedKeys = expandedRowKeys;
      setStateEve();
    },
    bodyDisplayInRow: false //折行回调
    ,
    foldingRowChange: function foldingRowChange(isEllipsis) {
      thisTable.isEllipsis = isEllipsis;
      setStateEve();
    },
    scroll: scrollConfig || {
      x: true,
      y: this.state.treeTableCol[id].tableHeight
    },
    onRowDoubleClick: onRowDoubleClick,
    adaptionHeight: adaptionHeight,
    inModal: inModal,
    onRowClick: onRowClick,
    isDrag: isDrag,
    ref: function ref(dom) {
      _this.dom = external_root_ReactDOM_var_ReactDOM_commonjs_react_dom_commonjs2_react_dom_amd_react_dom_default.a.findDOMNode(dom);
    },
    rowClassName: rowClassName,
    addBlankCol: addBlankCol,
    extendRightMenu: showContextMenu ? createContextMenu() : Object(api_index_["isFunction"])(extendRightMenu) ? extendRightMenu() : null,
    cancelCustomRightMenu: true //bodyStyle={{ height: this.state.treeTableCol[id].tableHeight }}
    // colsSettingParam={getColSetConfig()}

  }), thisTable.multilingual ? this.modal.createModal('delNode', {
    title: thisTable.multilingual['insert-tree-table-001'],
    content: thisTable.multilingual['insert-tree-table-002'],
    beSureBtnClick: delNodeEve.bind(this),
    backdrop: 'static'
  }) : null, this.modal.createModal('treeTableManyColModal', {
    content: modalContent.call(this),
    beSureBtnClick: beSureBtnClick.bind(this),
    cancelBtnClick: function cancelBtnClick() {
      _this.modal.close('treeTableManyColModal');
    },
    size: 'lg',
    userControl: true,
    backdrop: 'static'
  }));
}

/* harmony default export */ var treeTableManyCol = (TreeTableManyCol);
// CONCATENATED MODULE: ./src/platform/components/TreeTable/index.js
function TreeTable_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function TreeTable_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { TreeTable_ownKeys(Object(source), true).forEach(function (key) { TreeTable_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { TreeTable_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function TreeTable_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-12-11 11:25:40
 * @LastEditors: bbq
 * @LastEditTime: 2021-01-14 11:08:05
 */




var TreeTableAPI = {
  TreeTableManyCol: treeTableManyCol,
  treeTableCol: treeTableCol,
  initTreeTableData: initTreeTableData,
  setChildNode: setChildNode,
  editRowEve: editRowEve,
  addChildRowEve: addChildRowEve,
  addBrotherRow: addBrotherRow,
  delRowByPk: delRowByPk,
  createNewData: methods_createNewData,
  getAllValue: getAllValue,
  getValueByRowId: getValueByRowId,
  getExpandedRowKeys: getExpandedRowKeys,
  showModal: showModal,
  emptyAllData: emptyAllData,
  openRow: openRow,
  closeRow: closeRow,
  getSelectedRow: getSelectedRow,
  searchTreeTable: searchTreeTable,
  updataDataSource: updataDataSource,
  setCheckedKeys: setCheckedKeys,
  setSelectedRow: setSelectedRow,
  updateChildRow: updateChildRow
};
/**
 * 兼容旧版本创建表格方法
 * @param {string} mainCode 表格主区域编码
 * @param {object} config 表格业务配置
 */

function treeTableCompatible() {
  this.register("treeTable", TreeTable_store); // 生成 this.treeTableDataSource[id]

  return TreeTable_objectSpread({}, apiBindPage.call(this, TreeTableAPI));
}

function apiBindPage(simpleTableAPI) {
  var res = {};

  for (var _i = 0, _Object$keys = Object.keys(simpleTableAPI); _i < _Object$keys.length; _i++) {
    var pop = _Object$keys[_i];
    res[pop] = simpleTableAPI[pop].bind(this);
  }

  return res;
}

treeTableCompatible.component = treeTable;
treeTableCompatible.displayName = "TreeTable";
treeTableCompatible.unfinished = ["treeTableUnFinishedApi"];

/***/ }),

/***/ 46:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Con = exports.Row = exports.Col = undefined;

var _Col2 = __webpack_require__(660);

var _Col3 = _interopRequireDefault(_Col2);

var _Row2 = __webpack_require__(661);

var _Row3 = _interopRequireDefault(_Row2);

var _Layout = __webpack_require__(662);

var _Layout2 = _interopRequireDefault(_Layout);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

exports.Col = _Col3["default"];
exports.Row = _Row3["default"];
exports.Con = _Layout2["default"];

/***/ }),

/***/ 47:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return stopFormHotKeyChange; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return stopCardTableHotKeyChange; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return stopEditTableHotKeyChange; });
/*
 * @Descripttion: 
 * @version: 
 * @Author: jinfjk
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2020-09-28 15:34:56
 */
var FORM_BROWSE = 'browse';
/**
 * @desc 如果以下条件只要有一个不满足就停止执行下面的代码
 * @param props {object}
 * @param autoFocusDeferred {boolean} true -> 不执行， false -> 执行
 * @param status {string} 此状态是form内部的状态，如果此状态不为空优先读取此状态
 * @returns {boolean}
 */

function stopFormHotKeyChange(_ref) {
  var props = _ref.props,
      autoFocusDeferred = _ref.autoFocusDeferred,
      status = _ref.status;
  var name = props.name;

  var _ref2 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      withHotKeyChange = _ref2.withHotKeyChange,
      meta = _ref2.meta;

  if (!props.getHotKeyConfig) {
    return console.warn('some form hotkey invalid');
  }

  var moduleType = meta[name] && meta[name]['moduletype'];
  var formStatus;

  if (status) {
    formStatus = status;
  } else {
    //首先判断meta中是否存在name ？ (如果有就去取meta里的值，如果meta里没有设置status默认设值浏览态) ：（meta中不存在name默认设值浏览态）
    formStatus = meta[name] ? meta[name].status || FORM_BROWSE : FORM_BROWSE;
  }

  if (name === undefined || withHotKeyChange === false || moduleType === undefined || autoFocusDeferred || formStatus === FORM_BROWSE) {
    return true;
  }

  return false;
}

function stopCardTableHotKeyChange(props) {
  var name = props.name,
      high_hotkey = props.high_hotkey,
      getHotKeyConfig = props.getHotKeyConfig; // console.log(high_hotkey, getHotKeyConfig)

  var _ref3 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      withHotKeyChange = _ref3.withHotKeyChange,
      meta = _ref3.meta;

  if (!props.getHotKeyConfig) {
    return console.warn('some form hotkey invalid');
  }

  var store = high_hotkey.store,
      tableId = high_hotkey.tableId;
  if (!store) return true;
  var notEditStatus = store.getTableProps('status') !== 'edit';
  var rows = store.getData();
  var columns = meta[name] && meta[name].items;
  rows = rows === undefined ? [] : rows; //状态不是编辑状态，无rows数据, 业务组设置withHotKeyChange->false时停止生成keyMap

  return notEditStatus || rows.length === 0 || !withHotKeyChange || columns === undefined;
}

function stopEditTableHotKeyChange(props, autoFocusDeferred) {
  var name = props.name,
      high_hotkey = props.high_hotkey,
      getHotKeyConfig = props.getHotKeyConfig; // console.log(high_hotkey, getHotKeyConfig)

  var _ref4 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      withHotKeyChange = _ref4.withHotKeyChange,
      meta = _ref4.meta;

  if (!props.getHotKeyConfig) {
    return console.warn('some form hotkey invalid');
  }

  var store = high_hotkey.store,
      tableId = high_hotkey.tableId;
  if (!store) return true;
  var notEditStatus = store.getTableProps('status') !== 'edit';
  var rows = store.getData();
  var columns = meta[name] && meta[name].items;
  rows = rows === undefined ? [] : rows; //autoFocusDeferred == true || 状态不是编辑状态，rows无数据 并且业务组设置withHotKeyChange->false时才停止生成keyMap

  return autoFocusDeferred || notEditStatus || rows.length === 0 || !withHotKeyChange || columns === undefined;
}



/***/ }),

/***/ 5:
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/* global define */

(function () {
	'use strict';

	var hasOwn = {}.hasOwnProperty;

	function classNames () {
		var classes = [];

		for (var i = 0; i < arguments.length; i++) {
			var arg = arguments[i];
			if (!arg) continue;

			var argType = typeof arg;

			if (argType === 'string' || argType === 'number') {
				classes.push(arg);
			} else if (Array.isArray(arg) && arg.length) {
				var inner = classNames.apply(null, arg);
				if (inner) {
					classes.push(inner);
				}
			} else if (argType === 'object') {
				for (var key in arg) {
					if (hasOwn.call(arg, key) && arg[key]) {
						classes.push(key);
					}
				}
			}
		}

		return classes.join(' ');
	}

	if ( true && module.exports) {
		classNames.default = classNames;
		module.exports = classNames;
	} else if (true) {
		// register as 'classnames', consistent with npm package name
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function () {
			return classNames;
		}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	} else {}
}());


/***/ }),

/***/ 52:
/***/ (function(module, exports) {

module.exports = function(module) {
	if (!module.webpackPolyfill) {
		module.deprecate = function() {};
		module.paths = [];
		// module.parent = undefined by default
		if (!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),

/***/ 54:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return findNextFocusItemInForm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return findLastFocusItemInForm; });
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _WithAutoFocus_executeAutoFocus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(22);



function findNextFocusItemInForm(nextModuleKeyMap, nextModuleId) {
  var wrapper = document.querySelector("#".concat(_platform_api__WEBPACK_IMPORTED_MODULE_0__["config"].hotKeyModuleIdPrefix, "-").concat(nextModuleId));
  var formItem = wrapper.querySelector(".".concat(nextModuleKeyMap.firstItem));
  var type = getFormType(formItem);
  _WithAutoFocus_executeAutoFocus__WEBPACK_IMPORTED_MODULE_1__[/* matchItemFocus */ "a"][type] === undefined ? _WithAutoFocus_executeAutoFocus__WEBPACK_IMPORTED_MODULE_1__[/* matchItemFocus */ "a"]['normal'](wrapper) : _WithAutoFocus_executeAutoFocus__WEBPACK_IMPORTED_MODULE_1__[/* matchItemFocus */ "a"][type](wrapper);
}

function findLastFocusItemInForm(nextModuleKeyMap, nextModuleId) {}

function getFormType(formItem) {
  return Array.prototype.find.call(formItem.classList, function (item) {
    return item.startsWith('js-type');
  }).split('-').pop();
}



/***/ }),

/***/ 55:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return calculateNeedJumpTimes; });
/**
 * @desc：有些行整行不可编辑，添加了标示tabindex = -1,一直循环找到可编辑的行数
 * @param tr {node} 当前行不可编辑的行
 * @param needJumpTimes {number} 向上/下查找的行数
 * @param direction {string}  'down'/ 'up' 向上或向下查找
 * @return 返回需要向上/下查找的行数
 */
function calculateNeedJumpTimes(tr, needJumpTimes, direction) {
  var tempTr = tr;
  var tempNeedJumpTimes = needJumpTimes;

  while (tempTr !== null && tempTr.getAttribute('tabindex') === '-1') {
    tempNeedJumpTimes += 1;
    tempTr = direction === 'up' ? tempTr.previousElementSibling : tempTr.nextElementSibling;
  }

  return tempNeedJumpTimes;
}

/***/ }),

/***/ 6:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__6__;

/***/ }),

/***/ 62:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__62__;

/***/ }),

/***/ 64:
/***/ (function(module, exports, __webpack_require__) {

var freeGlobal = __webpack_require__(170);

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

module.exports = root;


/***/ }),

/***/ 65:
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(86);

/* Built-in method references that are verified to be native. */
var nativeCreate = getNative(Object, 'create');

module.exports = nativeCreate;


/***/ }),

/***/ 66:
/***/ (function(module, exports, __webpack_require__) {

var eq = __webpack_require__(110);

/**
 * Gets the index at which the `key` is found in `array` of key-value pairs.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} key The key to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function assocIndexOf(array, key) {
  var length = array.length;
  while (length--) {
    if (eq(array[length][0], key)) {
      return length;
    }
  }
  return -1;
}

module.exports = assocIndexOf;


/***/ }),

/***/ 660:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _classnames = __webpack_require__(5);

var _classnames2 = _interopRequireDefault(_classnames);

var _react = __webpack_require__(0);

var _react2 = _interopRequireDefault(_react);

var _propTypes = __webpack_require__(2);

var _propTypes2 = _interopRequireDefault(_propTypes);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }

var propTypes = {
  componentClass: _propTypes2["default"].oneOfType([_propTypes2["default"].element, _propTypes2["default"].string]),

  /**
   * xs显示列数
   */
  xs: _propTypes2["default"].number,
  /**
   * sm显示列数
   */
  sm: _propTypes2["default"].number,
  /**
   * md显示列数
   */
  md: _propTypes2["default"].number,
  /**
   * lg显示列数
   */
  lg: _propTypes2["default"].number,
  /**
   * xs偏移列数
   */
  xsOffset: _propTypes2["default"].number,
  /**
   * sm偏移列数
   */
  smOffset: _propTypes2["default"].number,
  /**
   * md偏移列数
   */
  mdOffset: _propTypes2["default"].number,
  /**
   * lg偏移列数
   */
  lgOffset: _propTypes2["default"].number,
  /**
   * xs右偏移列数
   */
  xsPush: _propTypes2["default"].number,
  /**
   * sm右偏移列数
   */
  smPush: _propTypes2["default"].number,
  /**
   * md右偏移列数
   */
  mdPush: _propTypes2["default"].number,
  /**
   * lg右偏移列数
   */
  lgPush: _propTypes2["default"].number,
  /**
   * xs左偏移列数
   */
  xsPull: _propTypes2["default"].number,
  /**
   * sm左偏移列数
   */
  smPull: _propTypes2["default"].number,
  /**
   * md左偏移列数
   */
  mdPull: _propTypes2["default"].number,
  /**
   * lg左偏移列数
   */
  lgPull: _propTypes2["default"].number
};

var defaultProps = {
  componentClass: 'div',
  clsPrefix: 'u-col'
};

var DEVICE_SIZES = ['lg', 'md', 'sm', 'xs'];

var Col = function (_Component) {
  _inherits(Col, _Component);

  function Col() {
    _classCallCheck(this, Col);

    return _possibleConstructorReturn(this, _Component.apply(this, arguments));
  }

  Col.prototype.render = function render() {
    var _props = this.props,
        Component = _props.componentClass,
        className = _props.className,
        clsPrefix = _props.clsPrefix,
        others = _objectWithoutProperties(_props, ['componentClass', 'className', 'clsPrefix']);

    var tbClass = [];
    /**
     * 对传入props做样式转化
     * @type {[type]}
     */
    DEVICE_SIZES.forEach(function (size) {
      function popProp(propSuffix, modifier) {
        var propName = '' + size + propSuffix;
        var propValue = others[propName];

        if (propValue != undefined && propValue != null) {
          tbClass.push(clsPrefix + '-' + size + modifier + '-' + propValue);
        }

        delete others[propName];
      }

      popProp('', '');
      popProp('Offset', '-offset');
      popProp('Push', '-push');
      popProp('Pull', '-pull');
    });

    return _react2["default"].createElement(
      Component,
      _extends({
        className: (0, _classnames2["default"])(tbClass, className)
      }, others),
      this.props.children
    );
  };

  return Col;
}(_react.Component);

Col.defaultProps = defaultProps;
Col.propTypes = propTypes;

exports["default"] = Col;
module.exports = exports['default'];

/***/ }),

/***/ 661:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _classnames = __webpack_require__(5);

var _classnames2 = _interopRequireDefault(_classnames);

var _react = __webpack_require__(0);

var _react2 = _interopRequireDefault(_react);

var _propTypes = __webpack_require__(2);

var _propTypes2 = _interopRequireDefault(_propTypes);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }

var propTypes = {
  componentClass: _propTypes2["default"].oneOfType([_propTypes2["default"].element, _propTypes2["default"].string])
};

var defaultProps = {
  componentClass: 'div',
  clsPrefix: 'u-row'
};

var Row = function (_Component) {
  _inherits(Row, _Component);

  function Row() {
    _classCallCheck(this, Row);

    return _possibleConstructorReturn(this, _Component.apply(this, arguments));
  }

  Row.prototype.render = function render() {
    var _props = this.props,
        Component = _props.componentClass,
        clsPrefix = _props.clsPrefix,
        className = _props.className,
        others = _objectWithoutProperties(_props, ['componentClass', 'clsPrefix', 'className']);

    var bsclass = '' + clsPrefix;

    return _react2["default"].createElement(
      Component,
      _extends({}, others, {
        className: (0, _classnames2["default"])(bsclass, className)
      }),
      this.props.children
    );
  };

  return Row;
}(_react.Component);

Row.propTypes = propTypes;
Row.defaultProps = defaultProps;

exports["default"] = Row;
module.exports = exports['default'];

/***/ }),

/***/ 662:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _classnames = __webpack_require__(5);

var _classnames2 = _interopRequireDefault(_classnames);

var _react = __webpack_require__(0);

var _react2 = _interopRequireDefault(_react);

var _propTypes = __webpack_require__(2);

var _propTypes2 = _interopRequireDefault(_propTypes);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }

var propTypes = {
  /**
   * Adds `container-fluid` class.
   */
  fluid: _propTypes2["default"].bool,
  /**
   * You can use a custom element for this component
   */
  componentClass: _propTypes2["default"].oneOfType([_propTypes2["default"].element, _propTypes2["default"].string])
};

var defaultProps = {
  componentClass: 'div',
  fluid: false,
  clsPrefix: 'u-container'
};

var Con = function (_React$Component) {
  _inherits(Con, _React$Component);

  function Con() {
    _classCallCheck(this, Con);

    return _possibleConstructorReturn(this, _React$Component.apply(this, arguments));
  }

  Con.prototype.render = function render() {
    var _tbclass;

    var _props = this.props,
        fluid = _props.fluid,
        Component = _props.componentClass,
        clsPrefix = _props.clsPrefix,
        className = _props.className,
        others = _objectWithoutProperties(_props, ['fluid', 'componentClass', 'clsPrefix', 'className']);

    var tbclass = (_tbclass = {}, _defineProperty(_tbclass, '' + clsPrefix, !fluid), _defineProperty(_tbclass, clsPrefix + '-fluid', fluid), _tbclass);

    return _react2["default"].createElement(
      Component,
      _extends({}, others, {
        className: (0, _classnames2["default"])(tbclass, className)
      }),
      this.props.children
    );
  };

  return Con;
}(_react2["default"].Component);

Con.propTypes = propTypes;
Con.defaultProps = defaultProps;

exports["default"] = Con;
module.exports = exports['default'];

/***/ }),

/***/ 67:
/***/ (function(module, exports, __webpack_require__) {

var isKeyable = __webpack_require__(350);

/**
 * Gets the data for `map`.
 *
 * @private
 * @param {Object} map The map to query.
 * @param {string} key The reference key.
 * @returns {*} Returns the map data.
 */
function getMapData(map, key) {
  var data = map.__data__;
  return isKeyable(key)
    ? data[typeof key == 'string' ? 'string' : 'hash']
    : data.map;
}

module.exports = getMapData;


/***/ }),

/***/ 69:
/***/ (function(module, exports) {

/**
 * lodash 3.0.3 (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 */

/** `Object#toString` result references. */
var boolTag = '[object Boolean]';

/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)
 * of values.
 */
var objectToString = objectProto.toString;

/**
 * Checks if `value` is classified as a boolean primitive or object.
 *
 * @static
 * @memberOf _
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.
 * @example
 *
 * _.isBoolean(false);
 * // => true
 *
 * _.isBoolean(null);
 * // => false
 */
function isBoolean(value) {
  return value === true || value === false ||
    (isObjectLike(value) && objectToString.call(value) == boolTag);
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return !!value && typeof value == 'object';
}

module.exports = isBoolean;


/***/ }),

/***/ 690:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 7:
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE__7__;

/***/ }),

/***/ 70:
/***/ (function(module, exports) {

/**
 * lodash 3.0.2 (Custom Build) <https://lodash.com/>
 * Build: `lodash modern modularize exports="npm" -o ./`
 * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 */

/**
 * Checks if `value` is the [language type](https://es5.github.io/#x8) of `Object`.
 * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(1);
 * // => false
 */
function isObject(value) {
  // Avoid a V8 JIT bug in Chrome 19-20.
  // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.
  var type = typeof value;
  return !!value && (type == 'object' || type == 'function');
}

module.exports = isObject;


/***/ }),

/***/ 716:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 72:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return keyMap; });
/**
 *
 * 
 *  shiftUp: {sequence: string, action: string}, 让下一个Table的第一个元素聚焦
 *  shiftDown: {sequence: string, action: string} 让上一个Table的第一个元素聚焦
 *
 * 
 */
var keyMap = {
  shiftUp: {
    sequence: 'shift+up',
    action: 'keydown'
  },
  shiftDown: {
    sequence: 'shift+down',
    action: 'keydown'
  },
  tab: {
    sequence: 'tab',
    action: 'keydown'
  }
};


/***/ }),

/***/ 722:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 723:
/***/ (function(module, exports) {

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/**
 * Adds `value` to the array cache.
 *
 * @private
 * @name add
 * @memberOf SetCache
 * @alias push
 * @param {*} value The value to cache.
 * @returns {Object} Returns the cache instance.
 */
function setCacheAdd(value) {
  this.__data__.set(value, HASH_UNDEFINED);
  return this;
}

module.exports = setCacheAdd;


/***/ }),

/***/ 724:
/***/ (function(module, exports) {

/**
 * Checks if `value` is in the array cache.
 *
 * @private
 * @name has
 * @memberOf SetCache
 * @param {*} value The value to search for.
 * @returns {number} Returns `true` if `value` is found, else `false`.
 */
function setCacheHas(value) {
  return this.__data__.has(value);
}

module.exports = setCacheHas;


/***/ }),

/***/ 725:
/***/ (function(module, exports, __webpack_require__) {

var baseFindIndex = __webpack_require__(726),
    baseIsNaN = __webpack_require__(727),
    strictIndexOf = __webpack_require__(728);

/**
 * The base implementation of `_.indexOf` without `fromIndex` bounds checks.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function baseIndexOf(array, value, fromIndex) {
  return value === value
    ? strictIndexOf(array, value, fromIndex)
    : baseFindIndex(array, baseIsNaN, fromIndex);
}

module.exports = baseIndexOf;


/***/ }),

/***/ 726:
/***/ (function(module, exports) {

/**
 * The base implementation of `_.findIndex` and `_.findLastIndex` without
 * support for iteratee shorthands.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {Function} predicate The function invoked per iteration.
 * @param {number} fromIndex The index to search from.
 * @param {boolean} [fromRight] Specify iterating from right to left.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function baseFindIndex(array, predicate, fromIndex, fromRight) {
  var length = array.length,
      index = fromIndex + (fromRight ? 1 : -1);

  while ((fromRight ? index-- : ++index < length)) {
    if (predicate(array[index], index, array)) {
      return index;
    }
  }
  return -1;
}

module.exports = baseFindIndex;


/***/ }),

/***/ 727:
/***/ (function(module, exports) {

/**
 * The base implementation of `_.isNaN` without support for number objects.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.
 */
function baseIsNaN(value) {
  return value !== value;
}

module.exports = baseIsNaN;


/***/ }),

/***/ 728:
/***/ (function(module, exports) {

/**
 * A specialized version of `_.indexOf` which performs strict equality
 * comparisons of values, i.e. `===`.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} value The value to search for.
 * @param {number} fromIndex The index to search from.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function strictIndexOf(array, value, fromIndex) {
  var index = fromIndex - 1,
      length = array.length;

  while (++index < length) {
    if (array[index] === value) {
      return index;
    }
  }
  return -1;
}

module.exports = strictIndexOf;


/***/ }),

/***/ 729:
/***/ (function(module, exports, __webpack_require__) {

var apply = __webpack_require__(730);

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeMax = Math.max;

/**
 * A specialized version of `baseRest` which transforms the rest array.
 *
 * @private
 * @param {Function} func The function to apply a rest parameter to.
 * @param {number} [start=func.length-1] The start position of the rest parameter.
 * @param {Function} transform The rest array transform.
 * @returns {Function} Returns the new function.
 */
function overRest(func, start, transform) {
  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);
  return function() {
    var args = arguments,
        index = -1,
        length = nativeMax(args.length - start, 0),
        array = Array(length);

    while (++index < length) {
      array[index] = args[start + index];
    }
    index = -1;
    var otherArgs = Array(start + 1);
    while (++index < start) {
      otherArgs[index] = args[index];
    }
    otherArgs[start] = transform(array);
    return apply(func, this, otherArgs);
  };
}

module.exports = overRest;


/***/ }),

/***/ 730:
/***/ (function(module, exports) {

/**
 * A faster alternative to `Function#apply`, this function invokes `func`
 * with the `this` binding of `thisArg` and the arguments of `args`.
 *
 * @private
 * @param {Function} func The function to invoke.
 * @param {*} thisArg The `this` binding of `func`.
 * @param {Array} args The arguments to invoke `func` with.
 * @returns {*} Returns the result of `func`.
 */
function apply(func, thisArg, args) {
  switch (args.length) {
    case 0: return func.call(thisArg);
    case 1: return func.call(thisArg, args[0]);
    case 2: return func.call(thisArg, args[0], args[1]);
    case 3: return func.call(thisArg, args[0], args[1], args[2]);
  }
  return func.apply(thisArg, args);
}

module.exports = apply;


/***/ }),

/***/ 731:
/***/ (function(module, exports, __webpack_require__) {

var baseSetToString = __webpack_require__(732),
    shortOut = __webpack_require__(734);

/**
 * Sets the `toString` method of `func` to return `string`.
 *
 * @private
 * @param {Function} func The function to modify.
 * @param {Function} string The `toString` result.
 * @returns {Function} Returns `func`.
 */
var setToString = shortOut(baseSetToString);

module.exports = setToString;


/***/ }),

/***/ 732:
/***/ (function(module, exports, __webpack_require__) {

var constant = __webpack_require__(733),
    defineProperty = __webpack_require__(354),
    identity = __webpack_require__(372);

/**
 * The base implementation of `setToString` without support for hot loop shorting.
 *
 * @private
 * @param {Function} func The function to modify.
 * @param {Function} string The `toString` result.
 * @returns {Function} Returns `func`.
 */
var baseSetToString = !defineProperty ? identity : function(func, string) {
  return defineProperty(func, 'toString', {
    'configurable': true,
    'enumerable': false,
    'value': constant(string),
    'writable': true
  });
};

module.exports = baseSetToString;


/***/ }),

/***/ 733:
/***/ (function(module, exports) {

/**
 * Creates a function that returns `value`.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Util
 * @param {*} value The value to return from the new function.
 * @returns {Function} Returns the new constant function.
 * @example
 *
 * var objects = _.times(2, _.constant({ 'a': 1 }));
 *
 * console.log(objects);
 * // => [{ 'a': 1 }, { 'a': 1 }]
 *
 * console.log(objects[0] === objects[1]);
 * // => true
 */
function constant(value) {
  return function() {
    return value;
  };
}

module.exports = constant;


/***/ }),

/***/ 734:
/***/ (function(module, exports) {

/** Used to detect hot functions by number of calls within a span of milliseconds. */
var HOT_COUNT = 800,
    HOT_SPAN = 16;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeNow = Date.now;

/**
 * Creates a function that'll short out and invoke `identity` instead
 * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`
 * milliseconds.
 *
 * @private
 * @param {Function} func The function to restrict.
 * @returns {Function} Returns the new shortable function.
 */
function shortOut(func) {
  var count = 0,
      lastCalled = 0;

  return function() {
    var stamp = nativeNow(),
        remaining = HOT_SPAN - (stamp - lastCalled);

    lastCalled = stamp;
    if (remaining > 0) {
      if (++count >= HOT_COUNT) {
        return arguments[0];
      }
    } else {
      count = 0;
    }
    return func.apply(undefined, arguments);
  };
}

module.exports = shortOut;


/***/ }),

/***/ 735:
/***/ (function(module, exports) {

/**
 * Appends the elements of `values` to `array`.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {Array} values The values to append.
 * @returns {Array} Returns `array`.
 */
function arrayPush(array, values) {
  var index = -1,
      length = values.length,
      offset = array.length;

  while (++index < length) {
    array[offset + index] = values[index];
  }
  return array;
}

module.exports = arrayPush;


/***/ }),

/***/ 736:
/***/ (function(module, exports, __webpack_require__) {

var Symbol = __webpack_require__(93),
    isArguments = __webpack_require__(419),
    isArray = __webpack_require__(78);

/** Built-in value references. */
var spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;

/**
 * Checks if `value` is a flattenable `arguments` object or array.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.
 */
function isFlattenable(value) {
  return isArray(value) || isArguments(value) ||
    !!(spreadableSymbol && value && value[spreadableSymbol]);
}

module.exports = isFlattenable;


/***/ }),

/***/ 737:
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(107),
    isObjectLike = __webpack_require__(94);

/** `Object#toString` result references. */
var argsTag = '[object Arguments]';

/**
 * The base implementation of `_.isArguments`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 */
function baseIsArguments(value) {
  return isObjectLike(value) && baseGetTag(value) == argsTag;
}

module.exports = baseIsArguments;


/***/ }),

/***/ 742:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_1__);
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2021-01-13 13:40:50
 */



function TableWithAutoFocus(WrappedComponent) {
  return /*#__PURE__*/function (_Component) {
    _inherits(WithAutoFocus, _Component);

    var _super = _createSuper(WithAutoFocus);

    function WithAutoFocus() {
      _classCallCheck(this, WithAutoFocus);

      return _super.apply(this, arguments);
    }

    _createClass(WithAutoFocus, [{
      key: "componentDidMount",
      value: function componentDidMount() {
        var store = this.props.store;
        this.autoFocusToken = _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].subscribe('autoFocus', function (msg, _ref) {
          var data = _ref.data,
              moduleId = _ref.moduleId,
              force = _ref.force;
          var el = document.querySelector("div[".concat(data, "=\"").concat(data, "\"] [tabindex=\"0\"]"));
          var activeEl = document.activeElement;
          var tableId = "".concat(_platform_api__WEBPACK_IMPORTED_MODULE_1__["config"].hotKeyModuleIdPrefix, "-").concat(moduleId);
          console.log(tableId, activeEl, store);

          if (WithAutoFocus.judgeFocus(el, activeEl, tableId, force)) {
            _platform_api__WEBPACK_IMPORTED_MODULE_1__["ViewModel"].shouldAutoFocus = true;
            el.ncExecuteFocus = true; // 设置一个属性

            var cellselectorkey = el.getAttribute('cellselectorkey') || '';
            cellselectorkey = cellselectorkey.split('@') || [];
            store && cellselectorkey[0] && cellselectorkey[1] && store.setCellProps(cellselectorkey[0], cellselectorkey[1], {
              autoFocus: true
            }, false); //如果当点聚焦元素与需要聚焦的元素相同就不执行；

            !el.contains(activeEl) && el.focus();
            delete el.ncExecuteFocus; // 直接执行  ie下会有顺序问题

            setTimeout(function () {
              _platform_api__WEBPACK_IMPORTED_MODULE_1__["ViewModel"].shouldAutoFocus = false;
            }, 100);
          }
        });
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        this.autoFocusToken && _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].subscribe(this.autoFocusToken);
      }
      /**
       * @desc: 业务中存在新增行时先调用addRow后调用setStatus的方法导致焦点在table的第一个可编辑字段，
       *        而不在新增行的第一个可编辑字段上。
       * @resolve: 聚集时判断table是否包含当前活跃元素且活跃元素的tabIndex不等于-1，如果包含就不去执行autoFocus
       *           当前活跃元素可能是table里的操作列，全选功能里的input元素，如果是这些元素就依旧执行focus方法
       * @param el 需要聚焦的元素
       * @param activeEl 当前活跃的元素
       * @param tableId 区域Id
       * @param force true -> 强制执行
       * @return {boolean}
       */

    }, {
      key: "render",
      value: function render() {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {
          id: "".concat(_platform_api__WEBPACK_IMPORTED_MODULE_1__["config"].hotKeyModuleIdPrefix, "-").concat(this.props.tableId || this.props.name)
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent, this.props));
      }
    }], [{
      key: "judgeFocus",
      value: function judgeFocus(el, activeEl, tableId, force) {
        var tableEL = document.getElementById(tableId);

        if (el) {
          return activeEl.tabIndex !== -1 && tableEL && !tableEL.contains(activeEl) || force;
        }
      }
    }]);

    return WithAutoFocus;
  }(react__WEBPACK_IMPORTED_MODULE_0__["Component"]);
}

/* harmony default export */ __webpack_exports__["a"] = (TableWithAutoFocus);

/***/ }),

/***/ 743:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(25);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_hotkeys__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _config_tableKeyboardMap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(72);
/* harmony import */ var _createKeyMap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(9);
/* harmony import */ var _handleKeyDown__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(38);
/* harmony import */ var _config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(47);
/* harmony import */ var _util_findNextFocusItemInTable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(20);
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2021-01-27 09:49:43
 */









function EditTableWithKeyboardChange(WrappedComponent) {
  var _temp;

  return _temp = /*#__PURE__*/function (_Component) {
    _inherits(WithKeyboardChange, _Component);

    var _super = _createSuper(WithKeyboardChange);

    function WithKeyboardChange(props) {
      var _this;

      _classCallCheck(this, WithKeyboardChange);

      _this = _super.call(this, props);

      _this.hotKeyWithArrow = function (_ref) {
        var e = _ref.e,
            ViewModel = _ref.ViewModel,
            moduleId = _ref.moduleId,
            itemType = _ref.itemType,
            target = _ref.target;
        var eventTarget = target || e.target;

        var _ref2 = _this.props.getHotKeyConfig ? _this.props.getHotKeyConfig() : {},
            orderOfHotKey = _ref2.orderOfHotKey;

        if (!orderOfHotKey) {
          console.warn('not find orderOfHotKey in getHotKeyConfig');
          return;
        }

        Object(_handleKeyDown__WEBPACK_IMPORTED_MODULE_5__[/* handleArrowKeyDown */ "a"])({
          eventTarget: eventTarget,
          ViewModel: ViewModel,
          moduleId: moduleId,
          orderOfHotKey: orderOfHotKey,
          itemType: itemType,
          keyCode: e.keyCode
        });
      };

      _this.hotKeyWithEnter = _this.hotKeyWithEnter.bind(_assertThisInitialized(_this));
      return _this;
    }

    _createClass(WithKeyboardChange, [{
      key: "componentDidUpdate",
      value: function componentDidUpdate() {
        var _ref3 = this.props.getHotKeyConfig ? this.props.getHotKeyConfig() : {},
            autoFocusDeferred = _ref3.autoFocusDeferred;

        if (Object(_config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_6__[/* stopEditTableHotKeyChange */ "b"])(this.props, autoFocusDeferred)) {
          return;
        }

        _createKeyMap__WEBPACK_IMPORTED_MODULE_4__[/* createByModuleType */ "a"]['editTable'](this.props);
      }
    }, {
      key: "componentDidMount",
      value: function componentDidMount() {
        var _this2 = this;

        this.autoFocusToken = _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].subscribe('autoFocus-IoC', function () {
          if (Object(_config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_6__[/* stopEditTableHotKeyChange */ "b"])(_this2.props, false)) {
            return;
          }

          _createKeyMap__WEBPACK_IMPORTED_MODULE_4__[/* createByModuleType */ "a"]['editTable'](_this2.props, true);
        });
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        this.autoFocusToken && _platform_api__WEBPACK_IMPORTED_MODULE_1__["PubSub"].subscribe(this.autoFocusToken);
      }
    }, {
      key: "hotKeyWithEnter",
      value: function hotKeyWithEnter(_ref4) {
        var e = _ref4.e,
            ViewModel = _ref4.ViewModel,
            moduleId = _ref4.moduleId,
            target = _ref4.target;
        //阻止冒泡会影响Page/index 下的keydown 事件
        //e.stopPropagation();
        var eventTarget = target || e.target;

        var _ref5 = this.props.getHotKeyConfig ? this.props.getHotKeyConfig() : {},
            orderOfHotKey = _ref5.orderOfHotKey;

        if (!orderOfHotKey) {
          console.warn('not find orderOfHotKey in getHotKeyConfig');
          return;
        }

        var timer = setTimeout(function () {
          Object(_util_findNextFocusItemInTable__WEBPACK_IMPORTED_MODULE_7__[/* findNextFocusItemInTable */ "b"])({
            eventTarget: eventTarget,
            ViewModel: ViewModel,
            moduleId: moduleId,
            orderOfHotKey: orderOfHotKey
          });
          clearTimeout(timer);
        });
      }
    }, {
      key: "render",
      value: function render() {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_hotkeys__WEBPACK_IMPORTED_MODULE_2__["HotKeys"], {
          keyMap: _config_tableKeyboardMap__WEBPACK_IMPORTED_MODULE_3__[/* keyMap */ "a"],
          handlers: {
            shiftUp: _handleKeyDown__WEBPACK_IMPORTED_MODULE_5__[/* keyDownOfShiftUp */ "b"].bind(this, this.props.moduleId),
            shiftDown: _handleKeyDown__WEBPACK_IMPORTED_MODULE_5__[/* keyDownOfShiftUp */ "b"].bind(this, this.props.moduleId)
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent, _extends({
          tableStatusChanged: WithKeyboardChange.tableStatusChanged,
          hotKeyWithEnter: this.hotKeyWithEnter,
          hotKeyWithArrow: this.hotKeyWithArrow
        }, this.props)));
      }
    }]);

    return WithKeyboardChange;
  }(react__WEBPACK_IMPORTED_MODULE_0__["Component"]), _temp;
}

/* harmony default export */ __webpack_exports__["a"] = (EditTableWithKeyboardChange);

/***/ }),

/***/ 744:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(25);
/* harmony import */ var react_hotkeys__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_hotkeys__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _config_tableKeyboardMap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(72);
/* harmony import */ var _createKeyMap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(9);
/* harmony import */ var _handleKeyDown__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(38);
/* harmony import */ var _config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47);
/* harmony import */ var _util_findNextFocusItemInTable__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(20);
function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2021-02-01 14:05:45
 */








function TableWithKeyboardChange(WrappedComponent) {
  var _temp;

  return _temp = /*#__PURE__*/function (_Component) {
    _inherits(WithKeyboardChange, _Component);

    var _super = _createSuper(WithKeyboardChange);

    function WithKeyboardChange(props) {
      var _this;

      _classCallCheck(this, WithKeyboardChange);

      _this = _super.call(this, props);

      _this.hotKeyWithEnter = function (_ref) {
        var e = _ref.e,
            ViewModel = _ref.ViewModel,
            moduleId = _ref.moduleId,
            target = _ref.target,
            itemType = _ref.itemType;
        var eventTarget = target || e.target;

        var _ref2 = _this.props.getHotKeyConfig ? _this.props.getHotKeyConfig() : {},
            orderOfHotKey = _ref2.orderOfHotKey;

        if (!orderOfHotKey) {
          console.warn('not find orderOfHotKey in getHotKeyConfig');
          return;
        } //日期类型延迟执行时eventTarget已被移出document导致寻找不到父元素td,所以日期类型立即执行


        if (itemType === 'datePicker') {
          Object(_util_findNextFocusItemInTable__WEBPACK_IMPORTED_MODULE_6__[/* findNextFocusItemInTable */ "b"])({
            eventTarget: eventTarget,
            ViewModel: ViewModel,
            moduleId: moduleId,
            orderOfHotKey: orderOfHotKey
          });
          return;
        } //CLOUD-147579 中文输入法下会带进冒号空格等符号，原因是因为输入法的enter比我们的enter后执行导致


        var timer = setTimeout(function () {
          Object(_util_findNextFocusItemInTable__WEBPACK_IMPORTED_MODULE_6__[/* findNextFocusItemInTable */ "b"])({
            eventTarget: eventTarget,
            ViewModel: ViewModel,
            moduleId: moduleId,
            orderOfHotKey: orderOfHotKey
          });
          clearTimeout(timer);
        });
      };

      _this.hotKeyWithArrow = function (_ref3) {
        var e = _ref3.e,
            ViewModel = _ref3.ViewModel,
            moduleId = _ref3.moduleId,
            itemType = _ref3.itemType,
            target = _ref3.target;
        var eventTarget = target || e.target;

        var _ref4 = _this.props.getHotKeyConfig ? _this.props.getHotKeyConfig() : {},
            orderOfHotKey = _ref4.orderOfHotKey;

        if (!orderOfHotKey) {
          console.warn('not find orderOfHotKey in getHotKeyConfig');
          return;
        }

        Object(_handleKeyDown__WEBPACK_IMPORTED_MODULE_4__[/* handleArrowKeyDown */ "a"])({
          eventTarget: eventTarget,
          ViewModel: ViewModel,
          moduleId: moduleId,
          orderOfHotKey: orderOfHotKey,
          itemType: itemType,
          keyCode: e.keyCode
        });
      };

      return _this;
    }

    _createClass(WithKeyboardChange, [{
      key: "componentDidUpdate",
      value: function componentDidUpdate() {
        if (Object(_config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_5__[/* stopCardTableHotKeyChange */ "a"])(this.props)) {
          return;
        }

        _createKeyMap__WEBPACK_IMPORTED_MODULE_3__[/* createByModuleType */ "a"]['table'](this.props);
      }
    }, {
      key: "componentWillUnmount",
      value: function componentWillUnmount() {
        // 部分情况下KeyByModuleId 没有清除  导致创建不能直接聚焦
        Object(_createKeyMap__WEBPACK_IMPORTED_MODULE_3__[/* deleteKeyByModuleId */ "b"])(this.props.moduleId || this.props.name);
      }
    }, {
      key: "render",
      value: function render() {
        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_hotkeys__WEBPACK_IMPORTED_MODULE_1__["HotKeys"], {
          keyMap: _config_tableKeyboardMap__WEBPACK_IMPORTED_MODULE_2__[/* keyMap */ "a"],
          handlers: {
            shiftUp: _handleKeyDown__WEBPACK_IMPORTED_MODULE_4__[/* keyDownOfShiftUp */ "b"].bind(this, this.props.moduleId),
            shiftDown: _handleKeyDown__WEBPACK_IMPORTED_MODULE_4__[/* keyDownOfShiftUp */ "b"].bind(this, this.props.moduleId)
          }
        }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent, _extends({}, this.props, {
          tableStatusChanged: WithKeyboardChange.tableStatusChanged,
          hotKeyWithEnter: this.hotKeyWithEnter,
          hotKeyWithArrow: this.hotKeyWithArrow
        })));
      }
    }], [{
      key: "tableStatusChanged",
      value: function tableStatusChanged(_ref5) {
        var props = _ref5.props,
            status = _ref5.status;

        if (status === 'edit' && !Object(_config_stopHotKeyChange__WEBPACK_IMPORTED_MODULE_5__[/* stopCardTableHotKeyChange */ "a"])(props)) {
          _createKeyMap__WEBPACK_IMPORTED_MODULE_3__[/* createByModuleType */ "a"]['table'](props);
        } else {
          Object(_createKeyMap__WEBPACK_IMPORTED_MODULE_3__[/* deleteKeyByModuleId */ "b"])(props.moduleId);
        }
      }
    }]);

    return WithKeyboardChange;
  }(react__WEBPACK_IMPORTED_MODULE_0__["Component"]), _temp;
}

/* harmony default export */ __webpack_exports__["a"] = (TableWithKeyboardChange);

/***/ }),

/***/ 745:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _FormWithAutoFocus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(384);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FormWithAutoFocus", function() { return _FormWithAutoFocus__WEBPACK_IMPORTED_MODULE_0__["a"]; });

/* harmony import */ var _TableWithAutoFocus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(742);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TableWithAutoFocus", function() { return _TableWithAutoFocus__WEBPACK_IMPORTED_MODULE_1__["a"]; });

/*
 * @Descripttion: 
 * @version: 
 * @Author: jinfjk
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2020-08-27 14:06:59
 */




/***/ }),

/***/ 746:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _FormWithKeyboardChange__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(383);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FormWithKeyboardChange", function() { return _FormWithKeyboardChange__WEBPACK_IMPORTED_MODULE_0__["a"]; });

/* harmony import */ var _TableWithKeyboardChange__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(744);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TableWithKeyboardChange", function() { return _TableWithKeyboardChange__WEBPACK_IMPORTED_MODULE_1__["a"]; });

/* harmony import */ var _EditTableWithKeyboardChange__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(743);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EditTableWithKeyboardChange", function() { return _EditTableWithKeyboardChange__WEBPACK_IMPORTED_MODULE_2__["a"]; });

/*
 * @Descripttion: 
 * @version: 
 * @Author: bbq
 * @Date: 2020-08-17 09:56:43
 * @LastEditors: bbq
 * @LastEditTime: 2020-09-19 13:46:46
 */





/***/ }),

/***/ 75:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */



var ReactPropTypesSecret = __webpack_require__(76);

function emptyFunction() {}
function emptyFunctionWithReset() {}
emptyFunctionWithReset.resetWarningCache = emptyFunction;

module.exports = function() {
  function shim(props, propName, componentName, location, propFullName, secret) {
    if (secret === ReactPropTypesSecret) {
      // It is still safe when called from React.
      return;
    }
    var err = new Error(
      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +
      'Use PropTypes.checkPropTypes() to call them. ' +
      'Read more at http://fb.me/use-check-prop-types'
    );
    err.name = 'Invariant Violation';
    throw err;
  };
  shim.isRequired = shim;
  function getShim() {
    return shim;
  };
  // Important!
  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.
  var ReactPropTypes = {
    array: shim,
    bool: shim,
    func: shim,
    number: shim,
    object: shim,
    string: shim,
    symbol: shim,

    any: shim,
    arrayOf: getShim,
    element: shim,
    elementType: shim,
    instanceOf: getShim,
    node: shim,
    objectOf: getShim,
    oneOf: getShim,
    oneOfType: getShim,
    shape: getShim,
    exact: getShim,

    checkPropTypes: emptyFunctionWithReset,
    resetWarningCache: emptyFunction
  };

  ReactPropTypes.PropTypes = ReactPropTypes;

  return ReactPropTypes;
};


/***/ }),

/***/ 76:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
 * Copyright (c) 2013-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */



var ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';

module.exports = ReactPropTypesSecret;


/***/ }),

/***/ 766:
/***/ (function(module, exports, __webpack_require__) {

var baseDifference = __webpack_require__(415),
    baseFlatten = __webpack_require__(418),
    baseRest = __webpack_require__(154),
    isArrayLikeObject = __webpack_require__(178);

/**
 * Creates an array of `array` values not included in the other given arrays
 * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * for equality comparisons. The order and references of result values are
 * determined by the first array.
 *
 * **Note:** Unlike `_.pullAll`, this method returns a new array.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to inspect.
 * @param {...Array} [values] The values to exclude.
 * @returns {Array} Returns the new array of filtered values.
 * @see _.without, _.xor
 * @example
 *
 * _.difference([2, 1], [2, 3]);
 * // => [1]
 */
var difference = baseRest(function(array, values) {
  return isArrayLikeObject(array)
    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))
    : [];
});

module.exports = difference;


/***/ }),

/***/ 78:
/***/ (function(module, exports) {

/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

module.exports = isArray;


/***/ }),

/***/ 83:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return setMultiLang; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return timeFunctionHandler; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return getFuntionValue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return getTimeFunctionLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return getDateFunNode; });
/* harmony import */ var bee_layout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(46);
/* harmony import */ var bee_layout__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bee_layout__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);
/* harmony import */ var _platform_api__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_platform_api__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _HotKeys__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(33);
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }



__webpack_require__(115);



var _multiLang = {};
var functionList = {};
var setMultiLang = function setMultiLang() {
  var multiLang = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  functionList = {
    '#day(-1)#': multiLang['page-search-0060'],
    '#day(0)#': multiLang['page-search-0061'],
    '#day(1)#': multiLang['page-search-0062'],
    '#month(-1)#': multiLang['page-search-0063'],
    '#month(0)#': multiLang['page-search-0064'],
    '#month(1)#': multiLang['page-search-0065'],
    '#week(-1)#': multiLang['page-search-0066'],
    '#week(0)#': multiLang['page-search-0067'],
    '#week(1)#': multiLang['page-search-0068'],
    '#quarter(-1)#': multiLang['page-search-0069'],
    '#quarter(0)#': multiLang['page-search-0070'],
    '#quarter(1)#': multiLang['page-search-0071'],
    '#year(-1)#': multiLang['page-search-0072'],
    '#year(0)#': multiLang['page-search-0073'],
    '#year(1)#': multiLang['page-search-0074'],
    '#lastDayOfMonth#': multiLang['page-search-0075'],
    '#lastDayOfWeek#': multiLang['page-search-0076'],
    '#finalDayOfLastMonth#': multiLang['page-search-0077']
  };
  _multiLang = multiLang;
  return functionList;
}; // 用来判断和处理时间函数

function timeFunctionHandler(val) {
  var result = false;

  if (typeof val === 'string' && val.indexOf('#') !== -1) {
    result = true;
  }

  return result;
}

function selectDateFunction(e, callback, item) {
  console.log("触发click事件", item);
  pickerState(e, false);
  callback(item);
}

function pickerState(e, flag) {
  var pickerDOM = document.getElementsByClassName('rc-calendar-picker')[0];

  if (pickerDOM) {
    pickerDOM.style.display = flag ? 'block' : 'none';
  }
}

var getFuntionValue = function getFuntionValue(value) {
  return functionList[value] || value;
};
var getTimeFunctionLabel = function getTimeFunctionLabel(value, show, openCallBack) {
  var label = functionList[value] || '';
  return show && label ? /*#__PURE__*/React.createElement("div", {
    className: "date-picker-mask",
    onClick: function onClick() {
      return openCallBack(true);
    }
  }, label) : null;
}; // value = 选择的时间 callback = 单击回调 show  = 是否显示时间函数

var getDateFunNode = function getDateFunNode(value, callback, show, hiddenFunList) {
  if (!show) return;
  var spen = 4;

  var newFunList = _objectSpread({}, functionList);

  if (Array.isArray(hiddenFunList)) {
    hiddenFunList.forEach(function (element) {
      delete newFunList[element];
    });
  }

  return /*#__PURE__*/React.createElement(_HotKeys__WEBPACK_IMPORTED_MODULE_2__[/* default */ "a"], {
    keyMap: {
      rightHandler: ["right"],
      leftHandler: ["left"],
      enterHander: ["enter"]
    },
    handlers: {
      rightHandler: function rightHandler(e) {
        if (document.activeElement.nextElementSibling) {
          document.activeElement.nextElementSibling.focus();
        }
      },
      leftHandler: function leftHandler() {
        if (document.activeElement.previousElementSibling) {
          document.activeElement.previousElementSibling.focus();
        }
      },
      enterHander: function enterHander() {
        if (document.activeElement) {
          document.activeElement.click();
        }
      }
    },
    clearOpenPanel: false
  }, /*#__PURE__*/React.createElement("div", {
    className: "function-area",
    style: {
      maxHeight: "160px",
      overflow: "scroll"
    }
  }, Object.keys(newFunList).map(function (item, index) {
    return /*#__PURE__*/React.createElement("div", {
      tabIndex: index === 0 ? "0" : "-1",
      className: "fun-plan-area function-area-item",
      lg: spen,
      md: spen,
      sm: spen,
      xs: spen,
      onClick: function onClick(e) {
        return selectDateFunction(e, callback, item);
      },
      onKeyDown: function onKeyDown(e) {
        e.stopPropagation();
      }
    }, /*#__PURE__*/React.createElement("span", {
      className: value.toString().includes(item) && 'select'
    }, newFunList[item]));
  })));
};

/***/ }),

/***/ 86:
/***/ (function(module, exports, __webpack_require__) {

var baseIsNative = __webpack_require__(333),
    getValue = __webpack_require__(337);

/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */
function getNative(object, key) {
  var value = getValue(object, key);
  return baseIsNative(value) ? value : undefined;
}

module.exports = getNative;


/***/ }),

/***/ 87:
/***/ (function(module, exports) {

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}

module.exports = isObject;


/***/ }),

/***/ 9:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, "a", function() { return /* binding */ createByModuleType; });
__webpack_require__.d(__webpack_exports__, "d", function() { return /* binding */ keyByModuleId; });
__webpack_require__.d(__webpack_exports__, "e", function() { return /* binding */ createKeyMap_orderOfHotKey; });
__webpack_require__.d(__webpack_exports__, "b", function() { return /* binding */ deleteKeyByModuleId; });
__webpack_require__.d(__webpack_exports__, "c", function() { return /* binding */ getFirstItem; });
__webpack_require__.d(__webpack_exports__, "f", function() { return /* binding */ setValueOfActiveTable; });

// UNUSED EXPORTS: setFormDisableAttrCode, editTableFieldEditable

// CONCATENATED MODULE: ./src/platform/components/WithKeyboardChange/config/availableItems.js
var availableFormItems = ['input', 'textarea', 'number', 'refer', 'datepicker', 'datetimepicker', 'timepicker', 'select', 'switch', 'residtxt', 'checkbox_switch'];
var availableTableItems = ['refer', 'datepicker', 'input', 'datetimepicker', 'timepicker', 'select', 'number', 'residtxt', 'checkbox_switch', 'rangepicker', 'datePickerNoTimeZone', 'TZDatePickerStart', 'TZDatePickerStart', 'switch'];

// EXTERNAL MODULE: ./src/platform/components/WithKeyboardChange/config/moduleType.js
var moduleType = __webpack_require__(15);

// EXTERNAL MODULE: external "@platform/api/index"
var index_ = __webpack_require__(1);

// CONCATENATED MODULE: ./src/platform/components/WithKeyboardChange/createKeyMap.js
function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }




/**
 * 我们要生成的数据格式
 *
 * @keyByModuleId = {
 *     moduleId1: {
 *         firstItem: 'attrCode1',
 *         lastItem: 'attrCode2',
 *         type: 'form'
 *     },
 *     moduleId2: {
 *         firstItem: 'attrCode3',
 *         lastItem: 'attrCode4',
 *         type: 'table',
 *         children: ['moduleId3', 'moduleId4'] // 表示此表格的关联表有哪些
 *     },
 *     moduleId3: {
 *         firstItem: 'attrCode3',
 *         lastItem: 'attrCode4',
 *         type: 'table',
 *         parent: 'moduleId3', // 表示此表格的主表是哪个，
 *         activeTable: 'moduleId3' //对于多页签的表格添加此字段表示当显示的是哪个页签，第一次渲染默认展示主
 *                                    表
 *     }
 * }
 *
 * @formDisableAttrCode = {
 *     moduleId: {
 *         attrCode1: true,
 *         attrCode2: false
 *     }
 * }
 */

var keyByModuleId = {};
var formDisableAttrCode = {};
var tableDisabledAttrCode = {};
var createKeyMap_orderOfHotKey = [];
var hotKeyPrefix = index_["config"].hotKeyModuleIdPrefix;
/**
 * @desc 实现上面所描述的数据格式
 * @param props
 * @param force 是否强制执行，如果是通过业务组调用executeAutoFocus方法执行，就强制执行聚焦方法， 默认false
 */

function keyMapOfForm(props) {
  var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var name = props.name;

  var _ref = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      meta = _ref.meta,
      newOrderOfHotKey = _ref.orderOfHotKey; // 可以考虑加个参数控制整个快捷键  TOOD


  if (!props.getHotKeyConfig) {
    return console.warn('some form hotkey invalid');
  }

  var formItems = meta[name]['items'];
  createKeyMap_orderOfHotKey = newOrderOfHotKey;
  var itemsAttrCode = formItems.filter(function (item) {
    return isAvailableFormItem(item, name);
  }).map(function (item) {
    return item.attrcode;
  });

  if (formAutoFocusJudgement(name, force)) {
    keyByModuleId[name] = {
      firstItem: itemsAttrCode[0],
      type: moduleType["a" /* MODULE_TYPE */].form
    };
    var firstItemKey = itemsAttrCode[0];
    index_["PubSub"].publish('autoFocus', {
      data: firstItemKey
    });
  }
}
/**
 * @desc：keyMapOfForm方法会根据form的状态执行多次。
 * 现象：只要meta里面的数据一更改就会重新聚焦到第一个可编辑元素上。
 * 解决：keyByModuleId里是否存在此moduleId作为标示，
 */


function formAutoFocusJudgement(name, force) {
  return keyByModuleId[name] === undefined && createKeyMap_orderOfHotKey[0] === name || force;
}
/**
 * @desc 判断此item是否需要在按tab键获得焦点
 * @param item
 * @param name
 * @returns {boolean}
 */


function isAvailableFormItem(item, name) {
  var metaRes = availableFormItems.includes(item.itemtype) && item.disabled !== true && item.visible !== false;
  var itemDisabled = !!(formDisableAttrCode[name] && formDisableAttrCode[name][item.attrcode] === true);
  return metaRes && !itemDisabled;
}
/**
 *
 * @param props
 * @param force {Boolean} 是否强制执行
 */


function keyMapOfTable(props) {
  var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var name = props.name,
      high_hotkey = props.high_hotkey,
      getHotKeyConfig = props.getHotKeyConfig; // console.log(high_hotkey, getHotKeyConfig)

  var _ref2 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      withHotKeyChange = _ref2.withHotKeyChange,
      meta = _ref2.meta,
      newOrderOfHotKey = _ref2.orderOfHotKey;

  if (!props.getHotKeyConfig || !newOrderOfHotKey) {
    return console.warn('some form hotkey invalid');
  }

  createKeyMap_orderOfHotKey = newOrderOfHotKey;
  var store = high_hotkey.store,
      tableId = high_hotkey.tableId;
  var columns = meta[tableId] && meta[tableId].items;
  var rows = store.getData();
  var lastRowIndex = rows.length - 1;
  var availableItems = columns && iteratorTableColumns(tableId, columns, []);
  if (rows && rows.length === 0) return;
  processKeyMapOfTable({
    tableId: tableId,
    availableItems: availableItems,
    lastRowIndex: lastRowIndex,
    moduleType: moduleType["a" /* MODULE_TYPE */].cardTable,
    force: force
  });

  if (hasTabRelation(props, tableId) && keyByModuleId[tableId]) {
    createTabRelationKeyMap(props, tableId, lastRowIndex); //设置关联表

    keyByModuleId[tableId].children = meta.gridrelation[tableId].tabRelation;
  }
}

function keyMapOfEditTable(props) {
  var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var name = props.name,
      high_hotkey = props.high_hotkey,
      getHotKeyConfig = props.getHotKeyConfig; // console.log(high_hotkey, getHotKeyConfig)

  var _ref3 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      withHotKeyChange = _ref3.withHotKeyChange,
      meta = _ref3.meta,
      newOrderOfHotKey = _ref3.orderOfHotKey;

  if (!props.getHotKeyConfig || !newOrderOfHotKey) {
    return console.warn('some form hotkey invalid');
  }

  createKeyMap_orderOfHotKey = newOrderOfHotKey;
  var store = high_hotkey.store,
      tableId = high_hotkey.tableId;
  var columns = meta[tableId] && meta[tableId].items;
  var rows = store.getData();
  var lastRowIndex = rows.length - 1;
  var availableItems = columns && iteratorTableColumns(tableId, columns, []);
  if (rows && rows.length === 0) return;
  processKeyMapOfTable({
    tableId: tableId,
    availableItems: availableItems,
    lastRowIndex: lastRowIndex,
    moduleType: moduleType["a" /* MODULE_TYPE */].editTable,
    force: force
  });
}

function iteratorTableColumns(tableId, iterable, pool) {
  return iterable.reduce(function (pre, next) {
    if (next.children) {
      iteratorTableColumns(tableId, next.children, pre);
    } else {
      isAvailableTableItem(tableId, next) ? pre.push(next.attrcode) : pre;
    }

    return pre;
  }, pool);
}

function isAvailableTableItem(moduleId, item) {
  //如果业务组通过table的api修改可编辑性，就根据业务组的设置的只返回，不去读meta里面的值
  if (tableDisabledAttrCode[moduleId]) {
    if (tableDisabledAttrCode[moduleId][item.attrcode] === false) {
      return false;
    }

    if (tableDisabledAttrCode[moduleId][item.attrcode] === true) {
      return true;
    }
  }

  return availableTableItems.includes(item.itemtype) && item.visible !== false && item.disabled !== true && item.attrcode !== undefined;
}

function processKeyMapOfTable(_ref4) {
  var moduleId = _ref4.moduleId,
      availableItems = _ref4.availableItems,
      lastRowIndex = _ref4.lastRowIndex,
      moduleType = _ref4.moduleType,
      force = _ref4.force;
  var firstItem = "".concat(hotKeyPrefix, "-").concat(moduleId, "-").concat(availableItems[0], "-0");
  var lastAvailableItem = availableItems.length - 1;
  var lastItem = "".concat(hotKeyPrefix, "-").concat(moduleId, "-").concat(availableItems[lastAvailableItem], "-").concat(lastRowIndex);
  publishFocusItem({
    orderOfHotKey: createKeyMap_orderOfHotKey,
    moduleId: moduleId,
    firstItem: firstItem,
    force: force
  });
  keyByModuleId[moduleId] = {
    firstItem: firstItem,
    lastItem: lastItem,
    type: moduleType,
    activeTable: moduleId
  };
}
/**
 * @desc    原因：此方法是在componentDidUpdate生命周期里调用的。
 *          现象：只要meta里面的数据一更改就会重新聚焦到第一个可编辑元素上。
 *          解决：keyByModuleId里是否存在此moduleId作为标示
 *
 * @param orderOfHotKey
 * @param moduleId
 * @param firstItem
 * @param force 是否强制执行，如果是业务组通过executeAutoFocus api 执行的，就强制执行
 */


function publishFocusItem(_ref5) {
  var orderOfHotKey = _ref5.orderOfHotKey,
      moduleId = _ref5.moduleId,
      firstItem = _ref5.firstItem,
      force = _ref5.force;

  if (tableAutoFocusJudgement({
    orderOfHotKey: orderOfHotKey,
    moduleId: moduleId,
    force: force
  })) {
    index_["PubSub"].publish('autoFocus', {
      data: firstItem,
      moduleId: moduleId
    });
  }
}

function tableAutoFocusJudgement(_ref6) {
  var _ref6$orderOfHotKey = _ref6.orderOfHotKey,
      orderOfHotKey = _ref6$orderOfHotKey === void 0 ? [] : _ref6$orderOfHotKey,
      moduleId = _ref6.moduleId,
      force = _ref6.force;
  return orderOfHotKey[0] === moduleId && keyByModuleId[moduleId] === undefined || force;
}
/**
 * @desc 判断此table是否有tabRelation
 * @param props {object}
 * @param moduleId {string}
 */


function hasTabRelation(props, moduleId) {
  // console.log(high_hotkey, getHotKeyConfig)
  var _ref7 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      meta = _ref7.meta;

  if (!props.getHotKeyConfig) {
    return console.warn('some form hotkey invalid');
  }

  var tabRelation = meta.gridrelation && meta.gridrelation[moduleId].tabRelation;
  return !!(tabRelation && tabRelation.length > 1);
}

function createTabRelationKeyMap(props, moduleId, lastRowIndex) {
  var _ref8 = props.getHotKeyConfig ? props.getHotKeyConfig() : {},
      meta = _ref8.meta;

  if (!props.getHotKeyConfig) {
    return console.warn('some form hotkey invalid');
  }

  var tabRelation = meta.gridrelation[moduleId].tabRelation;
  tabRelation.forEach(function (item) {
    //因为主表keyMap已经生成不需要重复执行
    if (item !== moduleId) {
      var columns = meta[item] && meta[item].items;
      var availableItems = columns && iteratorTableColumns(moduleId, columns, []);
      var code = meta[item].code;
      var firstItem = "".concat(hotKeyPrefix, "-").concat(moduleId, "-").concat(availableItems[0], "-0");
      var lastAvailableItem = availableItems[availableItems.length - 1];
      var lastItem = "".concat(hotKeyPrefix, "-").concat(moduleId, "-").concat(lastAvailableItem, "-").concat(lastRowIndex);
      /**
       * @type {{parent: string}} 表明此此标签页属于哪个区域ID
       */

      keyByModuleId[code] = {
        firstItem: firstItem,
        lastItem: lastItem,
        type: moduleType["a" /* MODULE_TYPE */].cardTable,
        parent: moduleId
      };
    }
  });
}

function deleteKeyByModuleId(moduleId) {
  delete keyByModuleId[moduleId];
}

function setFormDisableAttrCode(moduleId, values) {
  formDisableAttrCode[moduleId] = values;
}
/**
 *
 * @param disabledValue {boolean} 是否可编辑 true -> 可编辑 false -> 不可编辑
 * @param moduleId  {string}
 * @param attrcode {string}
 */


function editTableFieldEditable(disabledValue, moduleId, attrcode) {
  if (tableDisabledAttrCode[moduleId] === undefined) {
    tableDisabledAttrCode[moduleId] = _defineProperty({}, attrcode, disabledValue);
  } else {
    tableDisabledAttrCode[moduleId][attrcode] = disabledValue;
  }
}

function getFirstItem(moduleId) {
  return keyByModuleId[moduleId] && keyByModuleId[moduleId].firstItem;
}

function setValueOfActiveTable(_ref9) {
  var moduleId = _ref9.moduleId,
      activeKey = _ref9.activeKey;
  var moduleInfo = keyByModuleId[moduleId];

  if (moduleInfo) {
    moduleInfo.activeTable = activeKey;
  }
}

var createByModuleType = {
  form: keyMapOfForm,
  table: keyMapOfTable,
  editTable: keyMapOfEditTable
};


/***/ }),

/***/ 927:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 928:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 929:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 93:
/***/ (function(module, exports, __webpack_require__) {

var root = __webpack_require__(64);

/** Built-in value references. */
var Symbol = root.Symbol;

module.exports = Symbol;


/***/ }),

/***/ 930:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 931:
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ }),

/***/ 94:
/***/ (function(module, exports) {

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return value != null && typeof value == 'object';
}

module.exports = isObjectLike;


/***/ })

/******/ });
});