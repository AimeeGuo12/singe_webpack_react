/*! @ncctag content */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@platform/api/index"),require("@platform/base/index"),require("react-dom"),require("@platform/table-core/index")):"function"==typeof define&&define.amd?define(["react","@platform/api/index","@platform/base/index","react-dom","@platform/table-core/index"],t):"object"==typeof exports?exports["@platform/transfer-table/index"]=t(require("react"),require("@platform/api/index"),require("@platform/base/index"),require("react-dom"),require("@platform/table-core/index")):e["@platform/transfer-table/index"]=t(e.React,e["@platform/api/index"],e["@platform/base/index"],e.ReactDOM,e["@platform/table-core/index"])}(window,(function(e,t,a,r,l){return function(e){var t={};function a(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(r,l,function(t){return e[t]}.bind(null,l));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../platform/",a(a.s=1896)}({0:function(t,a){t.exports=e},1:function(e,a){e.exports=t},1896:function(e,t,a){"use strict";a.r(t);var r=a(0),l=a.n(r),n=a(6),s=a.n(n),o=a(3),i=a(1);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function u(e,t){if(null==e)return{};var a,r,l=function(e,t){if(null==e)return{};var a,r,l={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}function f(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=y(e);if(t){var l=y(this).constructor;a=Reflect.construct(r,arguments,l)}else a=r.apply(this,arguments);return b(this,a)}}function b(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(i,e);var t,a,r,n=m(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e)).state={visible:e.visible||!1},t}return t=i,(a=[{key:"componentWillReceiveProps",value:function(){var e=s.a.findDOMNode(this),t=e&&(e.parentNode||e.parentElement||e);t&&t.clientWidth<t.scrollWidth||this.props.noEllipsis?this.setState({visible:!0}):this.setState({visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.children,a=u(e,["children"]);return this.state.visible?l.a.createElement(o.Tooltip,d({},a,{placement:"left",delay:1}),t):t}}])&&f(t.prototype,a),r&&f(t,r),i}(r.Component);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){w(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,l=!1,n=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){l=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(l)throw n}}return a}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function D(e,t){if(null==e)return{};var a,r,l=function(e,t){if(null==e)return{};var a,r,l={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}function O(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=I(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw n}}}}function k(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return j(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var x=["datepicker","NCTZDatePickerStart","NCTZDatePickerEnd","timepicker","datetimepicker","rangepicker","datePickerNoTimeZone"],C=["select","radio","checkbox","refer"];function E(e,t,a){if(t){var r=!("true"!==e&&"Y"!==e&&!0!==e);return l.a.createElement(o.Checkbox,{disabled:!0,checked:r})}return"true"===e||"Y"===e||!0===e?a&&a["page-transferTable-0020"]||"是":a&&a["page-transferTable-0021"]||"否"}function N(e,t){console.time("测试用时");var a=e.selected,r=e[t].outerData,l=e[t].bodyData,n=a.selectedData.childSelData,s=a.masterCheckedId,o=!1,i=!1;if(!r||!l||!r.length)return{isSelectAll:o,isIndeterminate:i};l=l.data;var c,d=!1,u=O(r);try{for(u.s();!(c=u.n()).done;){var f=c.value,h=f.values||f;if(!h.saga_status||"1"!==h.saga_status.value){var m,b=f.rowId,y=n[b]||{},p=l[b]||{rows:[]},v=p.rows.length,g=0,S=0,T=O(p.rows);try{for(T.s();!(m=T.n()).done;){var w=m.value,D=w.values||w;D.saga_status&&"1"===D.saga_status.value?S++:y[w.childId]&&(i=!0,g++)}}catch(e){T.e(e)}finally{T.f()}s.includes(b)?(0===v&&(i=!0),v>0&&g!==v-S&&(d=!0)):(0===v||g!==v)&&(d=!0)}}}catch(e){u.e(e)}finally{u.f()}return o=!d,console.timeEnd("测试用时"),console.log(i,o),{isSelectAll:o,isIndeterminate:i}}function A(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a=a||document;var l=0;if(e&&e.length){var n=a.querySelector(".u-table-thead"),s=a.querySelector(".u-table-tbody"),o=s&&s.querySelectorAll(".u-table-row")[0],c=n&&n.getBoundingClientRect().height,d=o&&o.getBoundingClientRect().height,u=t?30:0,f=30,h=8,m=t?16:8,b=Object(i.myBrowser)();if(m="Firefox"===b||"IE"===b?t?28:14:m,o&&c){var y=c+h+u+m;return l=e.length<11?e.length*d<f?f+y:e.length*d+y:10*d+y,r?e.length>9?l-y:"":l}return 0}}function P(e,t){var a;this.state.meta?a=this:this.props&&this.props._this&&(a=this.props._this);var r=a.state.meta;if(e.length&&t){var l=k(r[t].items),n=[],s=[];e.map((function(e){r[t].items.map((function(t,a){e.attrcode===t.attrcode&&(t.width=e.width,t.islock=e.islock,t.visible=e.visible,n.push(a),s.push(t))}))})),n.sort((function(e,t){return e-t})),n.forEach((function(e,t){l[e]=s[t]})),r[t].items=l,a.setState({meta:r})}}function M(e,t){var a=e&&e[t]||{};return{appcode:a.appcode||i.pageTo.getAppCode(),pagecode:a.pagecode||i.pageTo.getPageCode(),code:a.templateCode||e&&e.code,pageid:a.pageid||e&&e.pageid,areaCode:t,areaId:a.oid}}function L(e,t,a,r){var l=a.state.transferTable,n=l[t].selected,s=l.allSelected;if(!e||!e.length||!r)return!1;!function(e,t,a,r){var l=e[t],n=l[t],s=l.selected,o=e.allSelected,i=r[0].parentRowId;l.sortInfoObj=a,s.selectedShow||o.selectedShow?n.showFullTable||o.showFullTable?s.fullSortInfoObj=a:i?(s[i]={},s[i].childSortInfoObj=a):s.mainSortInfoObj=a:n.showFullTable||o.showFullTable?n.fullSortInfoObj=a:i?(n[i]={},n[i].childSortInfoObj=a):n.mainSortInfoObj=a}(l,t,r,e),n.selectedShow||s.selectedShow?function(e,t,a,r){var l=Object.assign({},a.state.transferTable),n=l[t][t],s=(n.outerData,n.bodyData.data,n.showFullTable,l[t].selected),o=l.allSelected;e[0].parentRowId,s.selectedShow&&l[t].selected,o.selectedShow&&l.allSelected}(e,t,a):function(e,t,a,r){var l=Object.assign({},a.state.transferTable),n=l[t][t],s=n.outerData,o=n.bodyData.data,i=n.showFullTable,c=[],d=e[0].parentRowId,u={};if(i)return s.length&&(n.fullSortData=e,a.setState({transferTable:l})),c;if(delete n.fullSortData,delete n.fullSortInfoObj,d){if(u=Object.assign({},o),o){var f=Object.keys(o),h=!1;f.forEach((function(e){e===d&&(h=!0)})),h&&(u[d].rows=e.map((function(e){return{status:0,values:e,childId:e.key}})),n.bodyData.data=u,a.setState({transferTable:l}))}}else s.length&&e.some((function(e,t){if(s[t].values.key!==e.key)return!0}))&&(c=e.map((function(e){return{status:"0",values:e,rowId:e.key}})),n.outerData=c,a.setState({transferTable:l}))}(e,t,a)}function R(){var e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight),e}function F(e,t,a,r,l,n){(e||t)&&(n.setSelectListHeightIsDone=!1,n.setListHeightIsDone=!1,n.setModalHeightIsDone=!1),n.setTimeIndex=setTimeout((function(){if(n.doing&&n.transferTableIsInModal(),n.transfertableMainIsModalSChild)if(n.setModalHeightIsDone)n.setModalTransferTableHeight();else{var t=document.querySelector(".u-modal-body");if(t)t.style.padding="0 15px",t.style.height=l-140+"px",(t.parentElement&&t.parentElement.parentElement).style.overflow="auto";n.setState({modalBodyHeight:l-140},(function(){n.setModalHeightIsDone=!0,e?n.showTransferTableTimer=setTimeout((function(){n.setModalTransferTableHeight()}),200):n.setModalTransferTableHeight()}))}else{var s=0;a?n.setSelectListHeightIsDone||(s=l-r,n.setState({transferTableHeight:s,selectedListHeight:s},(function(){n.setSelectListHeightIsDone=!0}))):n.setListHeightIsDone||(s=l-r,n.setState({transferTableHeight:s,listHeight:s},(function(){n.setListHeightIsDone=!0})))}}))}function _(e,t){t&&e&&this.setState({fixedWidth:e})}function H(e,t,a){var r=e.attrcode,l=e.itemtype;if(Object(i.isFunction)(a))a(e);else switch(!0){case"number"===l:e.sorter=function(e,t){var a=e[r]&&e[r].value||"0",l=t[r]&&t[r].value||"0";return Number(a)-Number(l)};break;case x.includes(l):e.sorter=function(e,t){var a=e[r]&&e[r].value||"0",l=t[r]&&t[r].value||"0";return Number(new Date(a).getTime())-Number(new Date(l).getTime())};break;case C.includes(l):e.sorter=function(e,t){var a=String(e[r]&&e[r].display||""),l=String(t[r]&&t[r].display||"");return a.localeCompare(l)};break;case"label"===l:e.sorter=function(e,t){var a=e[r]&&e[r].value||"",l=e[r]?e[r].display:"",n=t[r]&&t[r].value||"",s=t[r]?t[r].display:"",o=String(Object(i.isNullOrVoid)(l)?a:l),c=String(Object(i.isNullOrVoid)(s)?n:s);return o.localeCompare(c)};break;case"numberindex"!==r&&"opr"!==r:e.sorter=function(e,t){var a=String(e[r]&&e[r].value||""),l=String(t[r]&&t[r].value||"");return a.localeCompare(l)}}e.sorterClick=function(e,a){t&&!0===t.backSource&&Object(i.isFunction)(t.sortFun)&&t.sortFun(e,a)}}function B(e,t){if(e&&"NaN"!==e&&"undefined"!==e&&"null"!==e){if("number"===t||"string"===t){if(String(e).length>4){if("number"==typeof e&&"string"===t){var a=(e=String(e)).slice(0,3),r=e.slice(3,e.length);return"".concat(a,",").concat(r)}return"string"==typeof e&&"number"===t?Number(String(e).split(",").join("")):e}return e}return null}return"number"===t?0:"string"===t?"":null}function K(e){var t=this;if(this.state.transferTable.allSelected){var a=this.state.transferTable.allSelected.selIds||{},r=this.state.transferTable.allSelected.masterCheckedId||[],l=function e(t){var a=[],r=!1;return t.forEach((function(e){Array.isArray(e)?(r=!0,a.push.apply(a,k(e))):a.push(e)})),r?e(a):a}(Object.values(a)||[]),n=this.state.transferTable[e],s=n.selected,o=s.masterCheckedId,i=n[e].tableType,c=n[e].bodyData.data,d=n[e].outerData||[],u=s.selectedData.masterSelData||{},f=s.selectedData.childSelData||{};if(d.length){for(var h=function(){var t=b[m],r=null;if(d.forEach((function(e,a){e.rowId===t&&(r=a)})),null!==r){var l=a[t];if(u.hasOwnProperty(t)||(u[t]={data:d[r].values,sel:!0}),"simple"!==n[e].tableType){var s,i=c[t].rows,h=O(l);try{var y=function(){var e=s.value,a=null;if(i.map((function(t,r){t.childId===e&&(a=r)})),null!==a){var r=i[a].values;f[t]||(f[t]=w({},e,{sel:!0,data:{childId:e,values:r}})),f[t]&&!f[t][e]&&(f[t][e]={sel:!0,data:{childId:e,values:r}})}};for(h.s();!(s=h.n()).done;)y()}catch(e){h.e(e)}finally{h.f()}o.includes(t)||o.push(t)}else o.includes(t)||o.push(t)}},m=0,b=Object.keys(a);m<b.length;m++)h();if(Object.keys(f).length)for(var y=function(){for(var a=v[p],r=0,n=Object.keys(f[a]);r<n.length;r++){var s=n[r];l.includes(s)||(delete f[a][s],t.state.transferTable[e].selected.selectedData.selAll=!1,t.state.transferTable[e].selected.masterCheckedId=t.state.transferTable[e].selected.masterCheckedId.filter((function(e){return e!==a})),Object.keys(f[a]).length||delete f[a])}},p=0,v=Object.keys(f);p<v.length;p++)y();for(var g=function(){var l=T[S];a.hasOwnProperty(l)||"simple"===i?r.includes(l)||"simple"!==i||(delete u[l],t.state.transferTable[e].selected.selectedData.selAll=!1,t.state.transferTable[e].selected.masterCheckedId=t.state.transferTable[e].selected.masterCheckedId.filter((function(e){return e!==l}))):(delete u[l],f.hasOwnProperty(l)&&delete f[l],t.state.transferTable[e].selected.selectedData.selAll=!1,t.state.transferTable[e].selected.masterCheckedId=t.state.transferTable[e].selected.masterCheckedId.filter((function(e){return e!==l})))},S=0,T=Object.keys(u);S<T.length;S++)g();var D=N(this.state.transferTable[e],e),I=D.isCheckedOutData,j=D.isCheckedBodyData,x=D.isAllOutData,C=D.isAllBodyData;I&&j&&x&&C&&(s.selectedData.selAll=!0),s.bodyAmount=0;for(var E=0,A=Object.values(s.selectedData.childSelData);E<A.length;E++){var P=A[E];s.bodyAmount+=Object.keys(P).length||1}s.masterAmount=Object.keys(s.selectedData.masterSelData).length}}}function V(e,t,a,r,l){var n=this.myState.transferList[e].transformForm,s=n.activeIndex,o=n.list[s].data,i=!0===r?"browse":"edit",c=this.form.getAllFormValue(t);if(o&&o.head&&o.head[t]&&(o.head[t].rows=c.rows,n.list[s].formStatus=i,"browse"===i&&(n.list[s].browseData.head=w({},t,{rows:c.rows}))),"string"==typeof a){n.list[s].browseData.body||(n.list[s].browseData.body={});var d=(this.cardTable||this.props.cardTable).getAllRows(a);o&&o.body&&o.body[a]&&(o.body[a].rows=d,"browse"===i&&(n.list[s].browseData.body[a]={rows:d}))}else if(Array.isArray(a)){o&&o.body&&!n.list[s].browseData.body&&(n.list[s].browseData.body={}),o&&o.bodys&&!n.list[s].browseData.bodys&&(n.list[s].browseData.bodys={});var u,f=O(a);try{for(f.s();!(u=f.n()).done;){var h=u.value,m=(this.cardTable||this.props.cardTable).getAllRows(h)||[];o&&o.bodys&&o.bodys[h]&&(o.bodys[h].rows=m,"browse"===i&&(n.list[s].browseData.bodys[h]={rows:m})),o&&o.body&&o.body[h]&&o.body[h].rows&&(o.body[h].rows=m,"browse"===i&&(n.list[s].browseData.body[h]={rows:m}))}}catch(e){f.e(e)}finally{f.f()}}"function"==typeof l&&l(n,t,a)}function J(e,t){if(e){var a={transferTable:this.state.transferTable};this.ViewModel.setData(e,a),t||this.ViewModel.setData("".concat(e,"_PK"),[])}}function q(e){var t=String(e);if(null==t)return"";var a=t.split("."),r=0;return a.length>1&&(r=a[1].length),Object(i.formatAcuracy)(t,r)}function z(e,t){var a;return!0===e||!1===e?e:"null"===e?"":e?(t=String(t))&&"-1"!==t?(a=(e||0).toString().split("."),"0"===t?a[0]:2===a.length?a[1].length>t?(a[1]=a[1].slice(0,Number(t)),a.join(".")):a[1].length===Number(t)?e:(a[1]=a[1].padEnd(Number(t),"0"),a.join(".")):"0"!==t?e+"."+"".padEnd(Number(t),"0"):e):e:""}function Y(e,t){var a,r,l,n;if(a=String(e).split("."),r=String(t).split("."),l=a.length,1===(n=r.length)&&1===l)return String(-1);if(1===n&&2===l)return String(a[1].length);if(1===l&&2===n)return String(r[1].length);if(2===l&&2===n){var s=a[1].length,o=r[1].length;if(s>o)return String(a[1].length);if(s<=o)return String(r[1].length)}}var W,U=a(8),G=a(5),$=a.n(G);function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(a),!0).forEach((function(t){X(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function X(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ee(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||le(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=le(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw n}}}}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,l=!1,n=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){l=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(l)throw n}}return a}(e,t)||le(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){if(e){if("string"==typeof e)return ne(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function se(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ue(e);if(t){var l=ue(this).constructor;a=Reflect.construct(r,arguments,l)}else a=r.apply(this,arguments);return ce(this,a)}}function ce(e,t){return!t||"object"!==te(t)&&"function"!=typeof t?de(e):t}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe,he=(0,U.lib.total)(o.Table.SortTable),me=Object(i.withViewModel)(W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(c,e);var t,a,r,n=ie(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=n.call(this,e)).dealDataFromTransferListBack=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=t.props,r=a._this,l=a.dataSource,n=a.componentInitFinished,s=a.headTableId;if(l){var o=t.ViewModel.getData(l);if(o&&o.transferTable&&Object.keys(o.transferTable).length){var i=t.ViewModel.getData("".concat(l,"_PK"))||[];t.processingData(o.transferTable,i,s),r.setState({transferTable:o.transferTable},(function(){e&&"function"==typeof n&&n()}))}}},t.setModalTransferTableHeight=function(){var e=t.props,a=e.transferTable,r=e.showSeletedArea,l=a.selected.selectedShow&&r,n=document.querySelector(".u-modal-body"),s=n?n.getBoundingClientRect():null,o=t.transfertableMain&&t.transfertableMain.current&&t.transfertableMain.current.getBoundingClientRect&&t.transfertableMain.current.getBoundingClientRect().top,i=0;l?t.setSelectListHeightIsDone||(i=s.bottom-o,t.setState({transferTableHeight:i,selectedListHeight:i},(function(){t.setSelectListHeightIsDone=!0,t.showTransferTableTimer=null}))):t.setListHeightIsDone||(i=s.bottom-o,t.setState({transferTableHeight:i,listHeight:i},(function(){t.setListHeightIsDone=!0,t.showTransferTableTimer=null})))},t.transferTableIsInModal=function(){for(var e=document.querySelector(".u-modal-body"),a=t.transfertableMain.current,r=[],l=a&&a.parentNode;l&&"BODY"!=l.tagName;)r.push(l),l=l.parentNode;t.doing=!1,t.transfertableMainIsModalSChild=r.includes(e)},t.onresizeEvents=function(e){var a=e.isIntl,r=e.windowResize,l=t.props,n=l.transferTable,s=l.showSeletedArea,o=n.selected.selectedShow&&s,i=R();F(a,r,o,t.transfertableMain&&t.transfertableMain.current&&t.transfertableMain.current.getBoundingClientRect&&t.transfertableMain.current.getBoundingClientRect().top,i,de(t))},t.switchSelectedAndAll=function(){var e=t.props,a=e._this,r=e.transferTable,l=e.headTableId;r.selected.selectedShow?(r.selected.selectedShow=!1,a.state.transferTable[l]=r):r.selected.selectedShow=!0,a.setState({transferTable:a.state.transferTable},(function(){t.onresizeEvents({isIntl:!1,windowResize:!1})}))},t.getSelectedAmount=function(){for(var e=t.props._this.state.transferTable,a=0,r=0,l=0,n=Object.keys(e);l<n.length;l++){var s=n[l];if("allSelected"!==s){var o=e[s].selected;r+=o.masterAmount?Number(o.masterAmount):0,a+=o.bodyAmount?Number(o.bodyAmount):0}}return{masterAmount:r,bodyAmount:a}},t.customAggregate=function(){for(var e=t.props,a=(e._this,e.totalKey),r=e.getTheLongestPrecision,n=e.totalTitle,s=e.transferTable.selected.selectedData,o=s.masterSelData,i=s.childSelData,c=[],d=a.reduce((function(e,t){return e[t]=0,e}),{}),u=0,f=Object.entries(o);u<f.length;u++){var h,m=re(f[u],2),b=m[0],y=m[1].data,p=ae(a);try{for(p.s();!(h=p.n()).done;){var v=h.value;y.hasOwnProperty(v)&&(d[v]=r(String(y[v].value),String(d[v])),d[v]=q(d[v]))}}catch(e){p.e(e)}finally{p.f()}if(i.hasOwnProperty(b))for(var g=0,S=Object.entries(i[b]);g<S.length;g++){var T,w=re(S[g],2),D=(w[0],w[1]),O=D.data.values?D.data.values:D.data,k=ae(a);try{for(k.s();!(T=k.n()).done;){var I=T.value;O.hasOwnProperty(I)&&(d[I]=r(String(O[I].value),String(d[I])),d[I]=q(d[I]))}}catch(e){k.e(e)}finally{k.f()}}}return a.map((function(e,t){c.push({title:n[t],value:d[e],key:e})})),c.length?l.a.createElement("div",{style:{display:"inline-block"}},c.map((function(e){return l.a.createElement("span",{key:e.key,style:{display:"inline-block",marginRight:"20px"}},"".concat(e.title,": ").concat(e.value))}))):""},t.bodyTableDataIsSelected=function(e,t){return e&&e.rows&&e.rows.some((function(e){return e.childId===t}))},t.processingTotalData=function(e,a,r,l,n){var s,o=t.props.getScaleData,c={},d=[],u={},f=e.selectedData.childSelData,h=e.selectedData.masterSelData,m=n?n.outerData:Object.keys(h),b=n&&n.bodyData&&n.bodyData.data,y=ae(r);try{for(y.s();!(s=y.n()).done;){var p=s.value;c[p.attrcode]={value:"",display:""},p.istotal&&(d.push(p.attrcode),u[p.attrcode]=p.scale)}}catch(e){y.e(e)}finally{y.f()}if(l&&"simple"!==a){if(l&&"simple"!==a){if(f)for(var v=0,g=Object.keys(f);v<g.length;v++)for(var S=g[v],T=0,w=Object.keys(f[S]);T<w.length;T++){var D=w[T];if(!b||b&&t.bodyTableDataIsSelected(b[S],D)){var O,k=ae(d);try{for(k.s();!(O=k.n()).done;){var I=O.value;if(f[S][D].data.values?f[S][D].data.values.hasOwnProperty(I):f[S][D].data.hasOwnProperty(I)){var j=f[S][D].data.values||f[S][D].data;if(j[I]&&"object"===te(j[I])){var x=j[I]?j[I].value:0,C=j[I].scale?j[I].scale:u[I];if(c[I].value){var E=Object(i.sum)(Number.parseFloat(x),Number.parseFloat(c[I].value.replace(/,/g,"")));c[I].scale=C>c[I].scale?C:c[I].scale,c[I].value=o(String(E),c[I].scale)}else c[I].scale=C,c[I].value=o(String(x),c[I].scale)}}}}catch(e){k.e(e)}finally{k.f()}}}var N,A=ae(m);try{for(A.s();!(N=A.n()).done;){var P=N.value;if(h[P=P.rowId?P.rowId:P]){var M,L=h[P].data.values||h[P].data,R=ae(d);try{for(R.s();!(M=R.n()).done;){var F=M.value;if(L.hasOwnProperty(F)&&L[F]&&"object"===te(L[F])){var _=L[F]?L[F].value:"0",H=L[F].scale?L[F].scale:u[F];if(c[F].value){var B=Object(i.sum)(Number.parseFloat(_),Number.parseFloat(c[F].value.replace(/,/g,"")));c[F].scale=H>c[F].scale?H:c[F].scale,c[F].value=o(String(B),c[F].scale)}else c[F].scale=H,c[F].value=o(String(_),H)}}}catch(e){R.e(e)}finally{R.f()}}}}catch(e){A.e(e)}finally{A.f()}}}else{var K,V=ae(m);try{for(V.s();!(K=V.n()).done;){var J=K.value;if(h[J=J.rowId?J.rowId:J]){var q,z=h[J].data,Y=ae(d);try{for(Y.s();!(q=Y.n()).done;){var W=q.value;if(z[W]&&"object"===te(z[W])){var U=z[W]?z[W].value:0,G=z[W].scale?z[W].scale:u[W];if(c[W].value){var $=Object(i.sum)(Number.parseFloat(U),Number.parseFloat(c[W].value.replace(/,/g,"")));c[W].scale=G>c[W].scale?G:c[W].scale,c[W].value=o(String($),c[W].scale)}else c[W].scale=G,c[W].value=o(String(U),c[W].scale)}}}catch(e){Y.e(e)}finally{Y.f()}}}}catch(e){V.e(e)}finally{V.f()}}return[c]},t.processingTotalDataChild=function(e,a,r){var l,n=t.props.getScaleData,s=e[r.key],o={},c=[],d={},u=ae(a);try{for(u.s();!(l=u.n()).done;){var f=l.value;o[f.attrcode]={value:"",display:""},f.istotal&&(c.push(f.attrcode),d[f.attrcode]=f.scale)}}catch(e){u.e(e)}finally{u.f()}if(s)for(var h=0,m=Object.keys(s);h<m.length;h++){var b,y=m[h],p=s[y].data.values?s[y].data.values:s[y].data,v=ae(c);try{for(v.s();!(b=v.n()).done;){var g=b.value;if(p[g]&&"object"===te(p[g])){var S=p[g].scale?p[g].scale:d[g],T=p[g]?p[g].value:0;if(o[g].value){var w=Object(i.sum)(Number.parseFloat(T),Number.parseFloat(o[g].value.replace(/,/g,"")));o[g].scale=S>o[g].scale?S:o[g].scale,o[g].value=n(String(w),o[g].scale)}else o[g].scale=S,o[g].value=n(String(T),S)}}}catch(e){v.e(e)}finally{v.f()}}return[o]},t.expandedRowRender=function(e,a){var r=t.props,n=r.bodyColumn,o=r.isBodyTotal,c=r._this,d=r.currentTable,u=r.createNewData,f=r.transferTable,h=r.setSelectedColumns,m=r.createNewCol,b=r.isDrag,y=r.showChildIndex,p=r.comType,v=r.sortType,g=r.bodyTableId,S=r.headTableId,T=r.meta,w=r.cancelCustomRightMenu,D="",O=e.values||e;O&&O.saga_status&&"1"===O.saga_status.value&&(D=" socket-error-class");var k=n,I=e.headKey||e.key,j=t.processingTotalDataChild(f.selected.selectedData.childSelData,k,e),x=M.call(c,T,g);if(!(k instanceof Array&&k.length>0))return l.a.createElement("span",null);if(k=t.renderColumnsMultiSelectChild.call(c,k,e,a,p),d.bodyData&&Object.keys(d.bodyData).length&&d.bodyData.data.hasOwnProperty(I)||f&&f.selected&&f.selected.selectedData&&"selectedList"===p){var C=null,E=0,N=0;if("selectedList"===p)C=u(Object.values(f.selected.selectedData.childSelData[I]||{}).map((function(e){return e.data})));else E=A(C=u(d.bodyData.data[e.key].rows||d.bodyData.data[e.key]),o,s.a.findDOMNode(de(t))),N=A(C,o,s.a.findDOMNode(de(t)),!0);return f.selected.selectedShow?l.a.createElement("div",{className:"u-col-md-12 u-col-sm-12 u-col-xs-12 transfertable-expand-wraper ".concat(D),fieldid:Object(i.getSysFieldid)("selected-list-".concat(a,"_table")),style:{height:"".concat(E,"px")}},l.a.createElement(he,{className:"".concat(o?"expand-table expand-table-total":"expand-table"),columns:h(m({column:k,outerRecordKey:I,columnType:"child",json:t.state.json})),data:C,lazyload:!0,isDrag:b,isTotal:o,totalBodyHeight:30,totalData:j,totalColumns:t.createClumus(k,y,!1,45,!0),scroll:{x:!0,y:N||450},sort:v,updateColumnHandle:P.bind(de(t)),bodyStyle:{minHeight:"30px"},tableType:"transfer",foldingRowChange:function(e){c.state.transferTable[S].isEllipsis=e,c.setState({transferTable:c.state.transferTable})},bodyDisplayInRow:c.state.transferTable[S].isEllipsis,cancelCustomRightMenu:w,colsSettingParam:x})):l.a.createElement("div",{className:"u-col-md-12 u-col-sm-12 u-col-xs-12 transfertable-expand-wraper ".concat(D),fieldid:Object(i.getSysFieldid)("transfer-".concat(a,"_table")),style:{height:"".concat(E,"px")}},l.a.createElement(he,{className:"".concat(o?"expand-table expand-table-total":"expand-table"),columns:m({column:k,outerRecordKey:I,columnType:"child",json:t.state.json}),data:C,isDrag:b,scroll:{x:!0,y:N||450},lazyload:!0,isTotal:o,totalData:j,totalBodyHeight:30,totalColumns:t.createClumus(k,y,!1,45,!0),sort:v,updateColumnHandle:P.bind(de(t)),bodyStyle:{minHeight:"30px"},tableType:"transfer",foldingRowChange:function(e){c.state.transferTable[S].isEllipsis=e,c.setState({transferTable:c.state.transferTable})},bodyDisplayInRow:c.state.transferTable[S].isEllipsis,colsSettingParam:x,cancelCustomRightMenu:w}))}},t.haveExpandIcon=function(e,a,r,l){var n,s,o=t.props,i=o.bodyColumn,c=o.currentTable,d=o.transferTable;if(a){var u=d.selected.selectedData.childSelData;Object.keys(u)&&Object.keys(u).length&&(n=!0)}else if(d&&d[e]&&d[e].outerData){var f=r.key||r.headKey;c&&c.bodyData&&c.bodyData.data&&c.bodyData.data[f]&&c.bodyData.data[f].rows.length>0&&(n=!0)}return i instanceof Array&&i.length>0&&(s=!0),!n||!s},t.processingData=function(e,a,r){var l=t.props,n=l.onCheckedChange,s=l.tableType;if(a.length)for(var o=0,i=Object.keys(e);o<i.length;o++){var c=i[o];if(c===r&&function(){var t=e[c][r].bodyData.hasOwnProperty("data")?e[c][r].bodyData.data:null,l=e[c][r].outerData,o=e[c].selected.selectedData,i=e[c].selected&&e[c].selected.masterCheckedId,d=o&&o.childSelData,u=o&&o.masterSelData,f=e[c].selected.selectedShow,h=0;if(i=i.filter((function(e){return!a.includes(e)})),e[c][r].outerData=l.length?l.filter((function(e){if(a.includes(e.rowId))return!1;if(t&&Object.keys(t).length&&t[e.rowId]&&t[e.rowId].rows){var r=t[e.rowId].rows.length;if(t[e.rowId].rows=t[e.rowId].rows.filter((function(e){return!a.includes(e.childId)})),r&&0===t[e.rowId].rows.length)return!1}return!0})):[],a&&a.length>0&&o&&(o.selAll=!1),t&&Object.keys(t).length)for(var m=0,b=Object.keys(t);m<b.length;m++){var y=b[m];a.includes(y)?delete t[y]:t[y].rows=t[y].rows.filter((function(e){return!a.includes(e.childId)}))}if(d&&Object.keys(d).length)for(var p=function(){var r=g[v],l={body:[],head:{}},s=Object.keys(t).indexOf(r);if(a.includes(r))delete d[r];else for(var o=0,f=Object.keys(d[r]);o<f.length;o++){var h=f[o];a.includes(h)?(delete d[r][h],Object.keys(d[r]).length||(delete d[r],delete u[r],e[c].selected.masterCheckedId=i.filter((function(e){return e!==r})),e.allSelected.masterCheckedId=i.filter((function(e){return e!==r})))):l.body.push(d[r][h].data.values?d[r][h].data.values:d[r][h].data)}u.hasOwnProperty(r)&&(l.head=u[r].data),Object.keys(l.head).length&&"function"==typeof n&&n(!0,JSON.parse(JSON.stringify(l.head)),s,JSON.parse(JSON.stringify(l.body)))},v=0,g=Object.keys(d);v<g.length;v++)p();if(u&&Object.keys(u).length)for(var S=0,T=Object.keys(u);S<T.length;S++){var w=T[S],D={body:[],head:{}};u.hasOwnProperty(w)&&(D.head=u[w].data);var O=Object.keys(u).indexOf(w);a.includes(w)?delete u[w]:"simple"===s&&Object.keys(D.head).length&&"function"==typeof n&&n(!0,JSON.parse(JSON.stringify(D.head)),O,JSON.parse(JSON.stringify(D.body)))}if(d&&Object.keys(d).length)for(var k=0,I=Object.keys(d);k<I.length;k++){var j=I[k];h+=Object.keys(d[j]).length||1}e[c].selected.selectedShow=f,e[c].selected.bodyAmount=h,e[c].selected.masterAmount=Object.keys(u).length,e[c].selected&&(e[c].selected.masterCheckedId=i)}(),"allSelected"==c){var d=e.allSelected?e.allSelected.selIds:null,u=e.allSelected.selectedData,f=u.childSelData,h=u.masterSelData,m=e.allSelected.masterCheckedId||[],b=0;if(d){for(var y=function(){var t=v[p];e.allSelected.selIds[t]=d[t].filter((function(e){return!a.includes(e)})),d[t].length||(m=m.filter((function(e){return e!==t})),delete d[t])},p=0,v=Object.keys(d);p<v.length;p++)y();for(var g=function(){for(var e=T[S],t=0,r=Object.keys(f[e]);t<r.length;t++){var l=r[t];a.includes(l)&&delete f[e][l]}Object.keys(f[e]).length||(m=m.filter((function(t){return t!==e})),delete h[e],delete f[e])},S=0,T=Object.keys(f);S<T.length;S++)g();for(var w=0,D=Object.keys(d);w<D.length;w++){var O=D[w];d[O]&&(b+=d[O].length||1)}e.allSelected.masterCheckedId=m,e.allSelected.masterAmount=Object.keys(d).length,e.allSelected.bodyAmount=b}}}else if(t.props.onCheckedChange)for(var k=0,I=Object.keys(e);k<I.length;k++){var j=I[k];if(j===r){var x=Object.keys(e[j][r].bodyData.hasOwnProperty("data")?e[j][r].bodyData.data:{}),C=e[j].selected.selectedData,E=C&&C.childSelData,N=Object.keys(E),A=C&&C.masterSelData,P=Object.keys(A);if(E&&N.length){var M,L=ae(N);try{for(L.s();!(M=L.n()).done;){for(var R=M.value,F={body:[],head:A[R]?A[R].data:{}},_=E[R],H=Object.keys(_),B=0,K=H;B<K.length;B++){var V=K[B];F.body.push(_[V].data.values?_[V].data.values:_[V].data)}if(Object.keys(F.head).length&&"function"==typeof n){var J=x.indexOf(R);n(!0,JSON.parse(JSON.stringify(F.head)),J,JSON.parse(JSON.stringify(F.body)))}}}catch(e){L.e(e)}finally{L.f()}}if(P.length&&"simple"===s){var q,z=ae(P);try{for(z.s();!(q=z.n()).done;){var Y=q.value;if(!a.includes(Y)&&"function"==typeof n){var W=P.indexOf(Y);n(!0,JSON.parse(JSON.stringify(A[Y].data)),W,P.indexOf(Y),[])}}}catch(e){z.e(e)}finally{z.f()}}}}else console.log("么得数据！么得PK！")},t.renderColumnsMultiSelectChild=function(e,a,r,n){var s=t.state.json,i=t.props,c=i._this,d=i.defaultProps,u=i.showChildIndex,f=i.onSelectedItemRemove,h=i.transferTable,m=i.onCheckboxChangeChild,b=i.currentTable,y=d.multiSelect,p=[{label:l.a.createElement("span",{style:{display:"block",textAlign:"left"},bbq:"子表序号"},s["page-transferTable-0007"]||"序号-1"),attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:"hasCheckBox_child"==n?45:55,className:"col-customer-numberindex",render:function(e,t,a){return l.a.createElement("span",{style:{display:"block",textAlign:"left"}},a+1)}}],v=[].concat(e);u&&(v=p.concat(v));var g=s["page-transferTable-0006"]?s["page-transferTable-0006"]:"操作-2";if("hasCheckBox_child"==n){if(y&&"checkbox"===y.type){var S=h.selected.selectedData.childSelData[a.key],T=a.values||a,w=T&&T.saga_status&&"1"===T.saga_status.value;v=[{label:l.a.createElement("span",{bbq:"子表复选框"}),attrcode:"checkbox",itemtype:"customer",fixed:"left",dataIndex:"checkbox",width:70,visible:!0,className:"col-customer-checkbox",onCellClick:function(e,l){var n=e.key,s=e.values||e,o=-1;(((b.bodyData.data||{})[a.key]||{}).rows||[]).some((function(e,t){if((e.values||e).key===n)return o=t,!0})),-1==o||w||s&&s.saga_status&&"1"===s.saga_status.value||m.call(de(t),"",e,o,a,r)},render:function(e,t,n){var s=t.values||t;return s&&s.saga_status&&"1"===s.saga_status.value||w?l.a.createElement(o.ErrorPop,{record:t}):l.a.createElement(o.Checkbox,{className:"table-checkbox",checked:!(!S||!S[t.key]),onChange:m.bind(c,e,t,n,a,r)})}}].concat(v)}}else if("selectedList"==n){var D={label:l.a.createElement("span",null,g),attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:100,fixed:"right",visible:!0,render:function(e,r,n){return l.a.createElement("div",{className:"row-remove",bbq:"子表移除",onClick:function(){f&&f(r),m(e,r,n,a,n,!0)}},t.state.json["page-transferTable-0001"])}};v=[].concat(ee(v),[D])}return v},t.expandedRowRenderSelect=function(e,a){return(0,t.props.expandedRowRender)(e,a,"selectedList",t.state.json)},t.createClumus=function(e,a){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,s=arguments.length>4?arguments[4]:void 0,o=t.state.json,c=[],d=t.props,u=d.comType,f=d.headTableId,h=o["page-transferTable-0010"],m=o["page-transferTable-0006"]?o["page-transferTable-0006"]:"操作-1";return"hasCheckBox"!=u&&"hasCheckBox_child"!=u||!h||c.push({label:l.a.createElement("span",{style:{display:"block",textAlign:"left"}},o["page-transferTable-0007"]||"序号-1"),attrcode:"checkbox",itemtype:"customer",dataIndex:"checkbox",visible:!0,fixed:"left",width:s?70:80,className:"col-customer-checkbox col-customer-total",render:function(e,t,a){return l.a.createElement("span",{bbq:"普通表主合计",title:h||"合计-4",style:{display:"block",textAlign:"left",paddingRight:"13px"}},h||"合计-4")}}),a&&(!s||s&&"hasCheckBox_child"==u)&&c.push({label:l.a.createElement("span",{style:{display:"block",textAlign:"left"}},o["page-transferTable-0007"]||"序号-1"),attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:n,className:"col-customer-numberindex",render:function(e,t,a){return l.a.createElement("span",{style:{}})}}),e.map((function(e){var a=e.width;a||(a=120);var r=null;r="customer"!==e.itemtype&&e.visible&&!e.render?function(a,r,n){if(r[e.attrcode]){var s=r[e.attrcode].display,o=r[e.attrcode].value,c="";if(c=s||0===s?s:o,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(c=Object(i.changeTime)(o,"YYYY-MM-DD HH:mm:ss"),c=Object(i.formatDatetime)(c,"datetime")):"timepicker"==e.itemtype?(c=o,c=Object(i.formatDatetime)(c,"time")):(c=Object(i.changeTime)(o),c=Object(i.formatDatetime)(c,"date"))),"residtxt"===e.itemtype){var d=Object(i.getLangCode)(),u=(e.languageMeta||[]).filter((function(e){return e.languageCode==d}));u.length>0&&("1"===u[0].index&&(u[0].index=""),r[e.attrcode+u[0].index]&&r[e.attrcode+u[0].index].value&&(c=r[e.attrcode+u[0].index].value))}return"number"===e.itemtype&&(c=Object(i.formatNumber)(c)),l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},l.a.createElement(p,{overlay:c},l.a.createElement("span",{className:$()({"single-line-and-ellipsis":t.state.transferTable[f].isEllipsis,"three-line-and-ellipsis":!t.state.transferTable[f].isEllipsis})},c)))}}:"customer"===e.itemtype?e.render:function(a,r,n){return l.a.createElement(p,{className:"tooltip-word-color",overlay:e.render.call(null,a,r,n)},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":t.state.transferTable[f].isEllipsis,"three-line-and-ellipsis":!t.state.transferTable[f].isEllipsis})},e.render.call(null,a,r,n)))},e.visible&&"checkbox"!==e.attrcode&&"numberindex"!==e.attrcode&&c.push(Q(Q({},e),{},{render:r,width:a,key:e.attrcode,title:e.label}))})),r&&c.push({label:l.a.createElement("span",null,m),attrcode:"operate",itemtype:"customer",dataIndex:"operate",visible:!0,width:100,render:function(e,t,a){return l.a.createElement("span",null)}}),c},t.createSelectColumns=function(e,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,n=t.state.json,s=[],o=t.props,c=o.comType,d=o.headTableId,u=n["page-transferTable-0006"]||"操作-1";return"hasCheckBox"!=c&&"hasCheckBox_child"!=c||s.push({label:l.a.createElement("span",null),attrcode:"checkbox",itemtype:"customer",dataIndex:"checkbox",visible:!0,fixed:"left",width:r,className:"col-customer-checkbox col-customer-total",render:function(e,a,r){return l.a.createElement("span",{title:t.state.json["page-transferTable-0010"]||"合计-5"},t.state.json["page-transferTable-0010"]||"合计-5")}}),e.map((function(e){var a=e.width;a||(a=120);var r=null;r="customer"!==e.itemtype&&e.visible&&!e.render?function(a,r,n){if(r[e.attrcode]){var s=r[e.attrcode].display,o=r[e.attrcode].value,c="";if(c=s||0===s?s:o,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(c=Object(i.changeTime)(o,"YYYY-MM-DD HH:mm:ss"),c=Object(i.formatDatetime)(c,"datetime")):"timepicker"==e.itemtype?(c=o,c=Object(i.formatDatetime)(c,"time")):(c=Object(i.changeTime)(o),c=Object(i.formatDatetime)(c,"date"))),"residtxt"===e.itemtype){var u=Object(i.getLangCode)(),f=(e.languageMeta||[]).filter((function(e){return e.languageCode==u}));f.length>0&&("1"===f[0].index&&(f[0].index=""),r[e.attrcode+f[0].index]&&r[e.attrcode+f[0].index].value&&(c=r[e.attrcode+f[0].index].value))}return"number"===e.itemtype&&(c=Object(i.formatNumber)(c)),l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},l.a.createElement(p,{overlay:c},l.a.createElement("span",{className:$()({"single-line-and-ellipsis":t.state.transferTable[d].isEllipsis,"three-line-and-ellipsis":!t.state.transferTable[d].isEllipsis})},c)))}}:"customer"===e.itemtype?e.render:function(a,r,n){return l.a.createElement(p,{className:"tooltip-word-color",overlay:e.render.call(null,a,r,n),noEllipsis:!0},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":t.state.transferTable[d].isEllipsis,"three-line-and-ellipsis":!t.state.transferTable[d].isEllipsis})},e.render.call(null,a,r,n)))},e.visible&&"checkbox"!==e.attrcode&&"numberindex"!==e.attrcode&&s.push(Q(Q({},e),{},{render:r,width:a,key:e.attrcode,title:e.label}))})),s.push({label:l.a.createElement("span",null,u),attrcode:"operate",itemtype:"customer",dataIndex:"operate",visible:!0,width:100,render:function(e,t,a){return l.a.createElement("span",null)}}),s},t.ViewModel=t.props.ViewModel,t.expandArrId=t.props.events&&t.props.events.expandArr,t.state={switchViewState:"evenUp",top:0,height:0,selectedTop:0,selectedHeight:0,json:{},LangData:null,modalBodyHeight:0,windowHeight:0,transferTableHeight:0,selectedTransferTableHeight:0,selectedListBoxHeight:0,boundingClientRect:{},listHeight:0,selectedListHeight:0},t.main={},t.setTimeIndex=null,t.selsectMain=null,t.bodyDom=null,t.transfertableMain=l.a.createRef(),t.transfertableSelectedList=l.a.createRef(),t.transfertableMainIsModalSChild=!1,t.transferTableClient=null,t.isTransferTableSetHeight=!1,t.isSelectedListSetHeight=!1,t.transferTableHeight=null,t.modalBodyClient=null,t.modalBodyHeight=0,t.total=null,t.doing=!0,t.setListHeightIsDone=!1,t.setSelectListHeightIsDone=!1,t.setModalHeightIsDone=!1,t.myBrowser=Object(i.myBrowser)(),t}return t=c,(a=[{key:"componentWillMount",value:function(){var e=this;Object(i.getMultiLang)({moduleId:"page-transferTable",callback:function(t,a,r){e.setState({json:t,LangData:r},(function(){var t=e.props,a=t._this,r=t.dataSource,l=t.componentInitFinished,n=t.headTableId;if(r){var s=e.ViewModel.getData(r);if(s&&s.transferTable&&Object.keys(s.transferTable).length){var o=e.ViewModel.getData("".concat(r,"_PK"))||[];e.processingData(s.transferTable,o,n),a.setState({transferTable:s.transferTable},(function(){"function"==typeof l&&l()}))}}}))}})}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.onresizeEvents({isIntl:!0})}),200),window.onresize=function(){var t=e.props,a=t.getMultiChildChangeWidth,r=t.isMultiChild,l=t.containerSelector,n=l&&document.querySelector(l)&&document.querySelector(l).clientWidth;r&&"function"==typeof a&&a(n,r),e.onresizeEvents({windowResize:!0})};var t=this.props._this;t.infoExchangeController.subscribe("heightChange",(function(t,a){var r=a.area;"searchArea"===r||r===e.props.headTableId?(console.log("侦测到".concat(r,"高度变化，进行高度毁灭打击！")),setTimeout((function(){e.onresizeEvents({windowResize:!0})}),20)):console.log(r)})),t.infoExchangeController.subscribe("modelResizeEnd",(function(t,a){var r=a.indexInfo,l=a.className,n=a.id;console.log("侦测到弹窗resize变化，随风起舞吧！",r,l,n,t),setTimeout((function(){e.onresizeEvents({windowResize:!0})}),20)}))}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e._this,a=e.dataSource,r=e.isMultiChild;J.call(t,a,r),t.infoExchangeController&&t.infoExchangeController.unsubscribe("heightChange"),t.infoExchangeController&&t.infoExchangeController.unsubscribe("modelResizeEnd")}},{key:"componentDidUpdate",value:function(){var e=this.props._this;e.state.singleDelete&&(this.dealDataFromTransferListBack(!1),e.state.singleDelete=!1)}},{key:"render",value:function(){var e=this.props,t=e.classByType,a=e.column,r=e.columns,n=e.comType,s=e.isHeadTotal,c=e.isFullTotal,d=e.createNewCol,u=e.createFullData,f=e.createNewData,h=e.currentTable,m=e.customAreaOfSelectedHead,b=e.fullColumns,y=e.getMasterData,p=e.getSelectedFullData,v=e.handleClearAllSelected,g=e.handleChangeView,S=e.showChangeViewBtn,T=e.handleGenerateClick,w=e.renderColumnsMultiSelect,D=e.selectArea,O=e.setSelectedColumns,k=e.showMasterIndex,I=(e.showChildIndex,e.showSeletedArea),j=e.showSeletedBtn,x=e.showGenerateBtn,C=e.tableType,E=e.transferBtnText,N=e.transferTable,A=e.totalKey,L=e.totalTitle,R=e.isDrag,F=e.headTableId,_=e.fullTableId,H=e.bodyTableId,B=e.sortType,K=e.containerSelector,V=e.onExpandedRowsChange,J=e.meta,q=e.fieldid,z=e._this,Y=e.cancelCustomRightMenu,W=e.autoHeight,U=e.fieldId,G=this.getSelectedAmount(),$=this.state,Z=$.json,Q=($.LangData,$.listHeight),X=$.selectedListHeight,ee=h.showFullTable,te=ee?b:r,ae=!1,re={};"simple"===C?(ae=s,re=M.call(z,J,F)):ee?(ae=c,re=M.call(z,J,_)):(ae=s,re=M.call(z,J,F));var le=!I||I&&!N.selected.selectedShow?"":"showSelectedList",ne=80;le||(ne=45),le&&ee&&(ne=60),"hasCheckBox"!=n&&"hasCheckBox_child"!=n||(a=w(r,Z,ne,!ee&&le?"selectedAndExpand":""),b=w(b,Z,ne),t="hasCheckBox");var se=this.createClumus(te,k,!1,ne),oe=this.createSelectColumns(te,k,ne);X=W?X:400,Q=W?Q:400;var ie=I&&N.selected.selectedShow?X:Q,ce=(document.querySelector(K)&&document.querySelector(K).clientWidth,this.transfertableMainIsModalSChild?{position:"absolute",bottom:0,width:"auto",left:"0",right:"0"}:{width:"auto",left:"15px",right:"15px"}),de=N.selected.selectedShow?{height:0,width:0,opacity:0}:{},ue="Firefox"===this.myBrowser||"IE"===this.myBrowser?8:0,fe=Q-35-45-42-2*ue,me=Q-35-42-ue,be=X-35-45-42-54-2*ue,ye=X-35-42-54-ue,pe=function(){if(z.state.transferTable.allSelected&&z.state.transferTable.allSelected.params){var e=z.state.transferTable.allSelected,t=e.params;return!!t.length&&t[e.activeTab].bodyTableId===H}return!0};return l.a.createElement("div",{className:"transfertable-main transfertable-main-".concat(this.myBrowser||"chrome","  ").concat(ae?"transfertable-main-total-wrapper":""),style:{width:"100%",height:"".concat(ie?ie+"px":"auto"),position:"relative"},ref:this.transfertableMain},l.a.createElement("div",{className:["insertTable",t].join(" ")},l.a.createElement("div",{style:de},l.a.createElement("div",{fieldid:Object(i.getSysFieldid)("".concat(q||F,"_table"))},ee?l.a.createElement(he,{columns:d({column:b,bool:!0,columnType:"full",json:this.state.json}),data:u(h),scroll:{x:!0,y:c?fe:me},isTotal:c,totalData:c?this.processingTotalData(N.selected,C,te,ee,h):void 0,lazyload:!0,isDrag:R,bodyStyle:{height:c?fe:me},totalColumns:c?se:void 0,sort:B,updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){z.state.transferTable[F].isEllipsis=e,z.setState({transferTable:z.state.transferTable})},bodyDisplayInRow:z.state.transferTable[F].isEllipsis,cancelCustomRightMenu:Y,colsSettingParam:re}):l.a.createElement(he,{columns:d({column:a,json:this.state.json}),data:f(h.outerData),expandedRowRender:"nest"!==C&&"full"!==C||!pe()?void 0:this.expandedRowRender,haveExpandIcon:"nest"===C||"full"===C?this.haveExpandIcon.bind(this,F,!1):void 0,onExpandedRowsChange:V,scroll:{x:!0,y:s?fe:me},isDrag:R,isTotal:s,totalData:s?this.processingTotalData(N.selected,C,te,ee,h):void 0,totalColumns:s?se:void 0,bodyStyle:{height:s?fe:me},sort:B,updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){z.state.transferTable[F].isEllipsis=e,z.setState({transferTable:z.state.transferTable})},bodyDisplayInRow:z.state.transferTable[F].isEllipsis,colsSettingParam:re,cancelCustomRightMenu:Y}))),l.a.createElement("div",{className:"".concat(le," selected-list-wrapper")},l.a.createElement("div",{className:"selected-list"},l.a.createElement("div",{className:"header-area"},l.a.createElement("span",{className:"selected-icon-back-btn"},l.a.createElement(o.BackBtn,{onClick:this.switchSelectedAndAll,className:"back-transfer-list"})),l.a.createElement("span",{className:"header-title"},this.state.json["page-transferTable-0002"]),l.a.createElement("div",{className:"header-right"},l.a.createElement("div",{className:"header-right-inner"},l.a.createElement("span",{className:"header-right-change-view-area"},!0===S&&"simple"!==C?l.a.createElement(o.ToggleViewBtn,{tooltips:[Z["page-transferTable-0023"],Z["page-transferTable-0022"]],className:"selected-toggle-view",expand:!!ee,onClick:g.bind(this)}):""),l.a.createElement("span",{className:"header-right-custom-area"},m&&m()),l.a.createElement("span",{className:"clear-selected-item-btn"},l.a.createElement(o.Button,{className:"item",fieldid:"clearAll",onClick:v.bind(this)},Z["page-transferTable-0013"]||"清空"))))),l.a.createElement("div",{className:"content-area",ref:this.transfertableSelectedList},l.a.createElement("div",{fieldid:Object(i.getSysFieldid)("selected-list_table")},ee?l.a.createElement(he,{className:"insertTable transfer-table-selected-wrapper",lazyload:!0,isDrag:R,columns:O(d({column:b,bool:!0,columnType:"full",json:this.state.json}),this.state.json,!0),data:p(N.selected.selectedData),scroll:{x:!0,y:c?be:ye},bodyStyle:{height:c?be:ye},isTotal:c,totalData:c?this.processingTotalData(N.selected,C,te,ee):void 0,totalColumns:c?oe:void 0,sort:B,updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){z.state.transferTable[F].isEllipsis=e,z.setState({transferTable:z.state.transferTable})},bodyDisplayInRow:z.state.transferTable[F].isEllipsis,colsSettingParam:re,cancelCustomRightMenu:Y}):l.a.createElement(he,{className:"insertTable transfer-table-selected-wrapper",columns:O(d({column:a,bool:"simple"===C,json:this.state.json}),this.state.json),data:y(N.selected.selectedData),expandedRowRender:"nest"===C&&pe()?this.expandedRowRenderSelect:void 0,haveExpandIcon:"nest"===C?this.haveExpandIcon.bind(this,F,!0):void 0,onExpandedRowsChange:V,rowKey:function(e){return e.key},isTotal:s,isDrag:R,totalData:s?this.processingTotalData(N.selected,C,te,ee):void 0,totalColumns:s?oe:void 0,scroll:{x:!0,y:s?be:ye},bodyStyle:{height:s?be:ye},sort:B,updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){z.state.transferTable[F].isEllipsis=e,z.setState({transferTable:z.state.transferTable})},bodyDisplayInRow:z.state.transferTable[F].isEllipsis,colsSettingParam:re,cancelCustomRightMenu:Y})))))),I?l.a.createElement("div",{className:"fixed-bottom-outer",style:ce},l.a.createElement("div",{className:"fixed-bottom-container bottom-area-container",fieldid:Object(i.getSysFieldid)("bottom-area")},j?l.a.createElement("div",{className:"area-left"},l.a.createElement(o.Button,{className:"middle-btn",fieldid:N.selected.selectedShow?"alllist":"selected",onClick:this.switchSelectedAndAll},N.selected.selectedShow?this.state.json["page-transferTable-0003"]||"全部列表-1":this.state.json["page-transferTable-0004"]||"查看已选-1")):"",l.a.createElement("div",{className:"area-center"},l.a.createElement("span",null,l.a.createElement("span",null,this.state.json["page-transferTable-0010"],":",l.a.createElement("span",null,G.masterAmount),this.state.json["page-transferTable-0017"]),"simple"!==C?l.a.createElement("span",{style:{marginLeft:8}},this.state.json["page-transferTable-0018"],":",l.a.createElement("span",null,G.bodyAmount),this.state.json["page-transferTable-0019"]):"")),D?l.a.createElement("div",{className:"area-custom"},D&&"function"==typeof D&&D()):"",A.length&&L.length?l.a.createElement("span",null,this.customAggregate()):"",x?l.a.createElement("div",{className:"area-right"},l.a.createElement(o.Button,{fieldid:U||"generate",className:"main-button button-component large-btn",onClick:T.bind(this),disabled:"{}"===JSON.stringify(N.selected.selectedData.masterSelData)},E)):"")):"")}}])&&se(t.prototype,a),r&&se(t,r),c}(r.Component))||W;function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Te(e);if(t){var l=Te(this).constructor;a=Reflect.construct(r,arguments,l)}else a=r.apply(this,arguments);return ge(this,a)}}function ge(e,t){return!t||"object"!==be(t)&&"function"!=typeof t?Se(e):t}function Se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=Object(i.withViewModel)(fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(s,e);var t,a,r,n=ve(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).onresizeEvent=function(){var e=document.querySelector(".transfer-list-main-wrapper");e&&t.setState({top:e.offsetTop,height:R()-e.offsetTop})},t.getTransferListDom=function(){var e=t.props,a=e._this,r=e.dataAreaCode,n=e.handleTransformListClick,s=e.transformForm,o=e.transferListId;if(!a.state.meta)return!1;if(!a.state.meta[o]||!a.myState.transferList[o])return!1;var c=a.state.meta[o].items,d=t.state,u=d.height,f=d.json,h=d.LangData,m=s.show&&s.list&&s.list.length>1;return l.a.createElement("div",{className:"transfer-list-main-wrapper ".concat(m?"show-tranferList":"hide-tranferList"," "),style:{height:u-16,overflow:"hidden"}},m?l.a.createElement("div",{className:"transformtable-main",style:{height:u-8,overflow:"auto"}},l.a.createElement("div",{className:"transform-list"},l.a.createElement("ul",{style:{paddingBottom:"48px"}},s.list&&s.list.map((function(e,o){return l.a.createElement("li",{className:"".concat(o===s.activeIndex?"item active-transfer-list-item":"item"," ").concat(e.complete&&"complete"),onClick:function(){n.call(Se(t),e.data,o),a.myState.stopSetScroll=!1}},l.a.createElement("span",{className:"status".concat(e.complete?" complete":"")}),l.a.createElement("div",{className:"content"},c.map((function(t,a){var n=e.data.head[r].rows[0].values[t.attrcode]||{value:"",display:""};if(n.display=n.display||"",n.value=n.value||"","datepicker"!==t.itemtype&&"datetimepicker"!==t.itemtype){var s=n&&(n.display||n.value||"")||"";return"number"===t.itemtype&&(s=Object(i.formatNumber)(s)),t.visible&&l.a.createElement("div",{className:"item-inner"},"".concat(t.label,"："),l.a.createElement("span",{style:{paddingLeft:8}},s))}var o="datepicker"===t.itemtype?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss",c="datepicker"===t.itemtype?"date":"datetime";return t.visible&&l.a.createElement("div",{className:"item-inner"},"".concat(t.label,"："),l.a.createElement("span",{style:{paddingLeft:8}},"".concat((n&&n.display?Object(i.formatDatetime)(Object(i.DongbaToLocalTime)(Object(i.moment)(n.display)).format(o),c):Object(i.formatDatetime)(Object(i.DongbaToLocalTime)(Object(i.moment)(n.value)).format(o),c))||"")))}))),e.complete&&l.a.createElement("span",{className:"saved-mark"},f["page-transferTable-0016"]||"已处理"))}))),s.list[0]?l.a.createElement("div",{className:"total-area",style:{bottom:"7px"}},f["page-transferTable-0014"]||"共计-1","：",l.a.createElement("span",{className:"active"},h?h.get("page-transferTable-0012",{n:s.list.length}):s.list.length+"条")):"")):"")},t.ViewModel=t.props.ViewModel,t.expandArrId=t.props.events&&t.props.events.expandArr,t.state={switchViewState:"evenUp",transferList:null,transformForm:null,top:0,json:{},LangData:null,height:0},t.props._this.myState.transferListComponent=Se(t),t}return t=s,(a=[{key:"componentWillMount",value:function(){var e=this;Object(i.getMultiLang)({moduleId:"page-transferTable",callback:function(t,a,r){var l=e.props,n=l._this,s=l.dataSource,o=l.componentInitFinished;if(e.setState({json:t,LangData:r}),s){var i=e.ViewModel.getData(s);i&&i.transferTable&&n.setState({transferTable:i.transferTable},(function(){"function"==typeof o&&o()}))}}})}},{key:"componentDidMount",value:function(){var e=this;this.onresizeEvent(),window.onresize=function(){e.onresizeEvent()}}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({resize:(new Date).getTime()},(function(){t.onresizeEvent()}))}},{key:"render",value:function(){return l.a.createElement("span",null,this.getTransferListDom())}}])&&ye(t.prototype,a),r&&ye(t,r),s}(r.Component))||fe;function De(e){return function(e){if(Array.isArray(e))return Ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||xe(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(a),!0).forEach((function(t){Ee(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ke(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function je(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=xe(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw n}}}}function xe(e,t){if(e){if("string"==typeof e)return Ce(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ce(e,t):void 0}}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ee(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}a(904);var Ne,Ae=(0,U.lib.total)(o.Table.SortTable),Pe={prefixCls:"bee-table",multiSelect:{type:"checkbox",param:"key"}},Me=["#111111","#555555","#111","#555"];function Le(e,t){if(null==e)return{};var a,r,l=function(e,t){if(null==e)return{};var a,r,l={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Fe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(a),!0).forEach((function(t){_e(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _e(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=Ve(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw n}}}}function Ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,l=!1,n=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){l=!0,n=e}finally{try{r||null==o.return||o.return()}finally{if(l)throw n}}return a}(e,t)||Ve(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){if(e){if("string"==typeof e)return Je(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Je(e,t):void 0}}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function qe(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ge(e);if(t){var l=Ge(this).constructor;a=Reflect.construct(r,arguments,l)}else a=r.apply(this,arguments);return We(this,a)}}function We(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?Ue(e):t}function Ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $e=(0,U.lib.total)(o.Table.SortTable),Ze="unique-tag"+(new Date).getTime(),Qe=o.Tabs.TabPane,Xe=["#111111","#555555","#111","#555"],et=Object(i.withViewModel)(Ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(s,e);var t,a,r,n=Ye(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).dealDataFromTransferListBack=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=t.props,r=a._this,l=a.dataSource,n=a.componentInitFinished,s=a.tabActiveIndex,o=a.onTabClick;if(o&&"function"==typeof o&&s&&(o(s),r.setState({transferTable:data.transferTable})),l){var i=t.ViewModel.getData(l);if(i&&i.transferTable&&Object.keys(i.transferTable).length){o&&"function"==typeof o&&i.transferTable.allSelected&&i.transferTable.allSelected.activeTab&&(t.activeTab=s||i.transferTable.allSelected.activeTab,o(s||i.transferTable.allSelected.activeTab));var c=t.ViewModel.getData("".concat(l,"_PK"))||[],d=t.ViewModel.getData("".concat(l,"_ID"))||{},u=i.transferTableRelation;t.processingData(i.transferTable,c,u,d),r.setState({transferTable:i.transferTable},(function(){e&&"function"==typeof n&&n()}))}}},t.setModalTransferTableHeight=function(){var e=t.props,a=e.transferTable,r=e.showAll&&a.allSelected.selectedShow,l=document.querySelector(".u-modal-body"),n=l?l.getBoundingClientRect():null,s=t.multiTransfertableMain&&t.multiTransfertableMain.current&&t.multiTransfertableMain.current.getBoundingClientRect&&t.multiTransfertableMain.current.getBoundingClientRect().top,o=0;r?t.setSelectListHeightIsDone||(o=n.bottom-s,t.setState({transferTableHeight:o,selectedListHeight:o},(function(){t.setSelectListHeightIsDone=!0,t.showTransferTableTimer=null}))):t.setListHeightIsDone||(o=n.bottom-s,t.setState({transferTableHeight:o,listHeight:o},(function(){t.setListHeightIsDone=!0,t.showTransferTableTimer=null})))},t.transferTableIsInModal=function(){for(var e=document.querySelector(".u-modal-body"),a=[],r=t.multiTransfertableMain.current.parentNode;r&&"BODY"!=r.tagName;)a.push(r),r=r.parentNode;t.doing=!1,t.transfertableMainIsModalSChild=a.includes(e)},t.onresizeEvents=function(e){var a=e.isIntl,r=e.windowResize,l=t.props,n=l.showAll,s=l.transferTable.allSelected.selectedShow&&n,o=R();F(a,r,s,t.multiTransfertableMain&&t.multiTransfertableMain.current&&t.multiTransfertableMain.current.getBoundingClientRect&&t.multiTransfertableMain.current.getBoundingClientRect().top,o,Ue(t))},t.customAggregate=function(){for(var e=t.props,a=e.totalKey,r=e.totalTitle,n=e.getTheLongestPrecision,s=e.transferTable.allSelected.selectedData,o=s.masterSelData,i=s.childSelData,c=[],d=a.reduce((function(e,t){return e[t.join("_")]=0,e}),{}),u=0,f=Object.entries(o);u<f.length;u++){var h,m=Ke(f[u],2),b=m[0],y=m[1].data,p=Be(a);try{for(p.s();!(h=p.n()).done;){var v,g=h.value,S=g.join("_"),T=Be(g);try{for(T.s();!(v=T.n()).done;){var w=v.value;y.hasOwnProperty(w)&&(d[S]=n(String(y[w].value),String(d[S])),d[S]=q(d[S]))}}catch(e){T.e(e)}finally{T.f()}}}catch(e){p.e(e)}finally{p.f()}if(i.hasOwnProperty(b))for(var D=0,O=Object.entries(i[b]);D<O.length;D++){var k,I=Ke(O[D],2),j=(I[0],I[1]),x=j.data.values?j.data.values:j.data,C=Be(a);try{for(C.s();!(k=C.n()).done;){var E,N=k.value,A=N.join("_"),P=Be(N);try{for(P.s();!(E=P.n()).done;){var M=E.value;x.hasOwnProperty(M)&&(d[A]=n(String(x[M].value),String(d[A])),d[A]=q(d[A]))}}catch(e){P.e(e)}finally{P.f()}}}catch(e){C.e(e)}finally{C.f()}}}return a.map((function(e,t){var a=e.join("_");c.push({title:r[t],value:d[a],key:a})})),c.length?l.a.createElement("div",{style:{display:"inline-block"}},c.map((function(e){return l.a.createElement("span",{style:{display:"inline-block",marginRight:"20px"},key:e.key},"".concat(e.title,": ").concat(e.value))}))):""},t.closeSelectedList=function(){var e=t.props,a=e._this,r=e.showAllList;a.state.transferTable.allSelected.selectedShow=!1,a.setState({transferTable:a.state.transferTable},(function(){t.onresizeEvents({isIntl:!0,windowResize:!1}),r&&r()}))},t.viewSelectedList=function(){var e=t.props,a=e._this,r=e.showAll,l=e.transferTable,n=e.allHeadId,s=e.getAllSelectedData,o=e.onSelectedBtnClick;if(r){for(var i=JSON.parse(JSON.stringify(a.state.transferTable)),c=JSON.parse(JSON.stringify(a.state.transferTable.allSelected)),d=0,u=Object.keys(i);d<u.length;d++){var f=u[d];if("allSelected"!==f){for(var h=i[f].selected,m=h.selectedData.childSelData,b=h.selectedData.masterSelData,y=0,p=Object.keys(b);y<p.length;y++){var v=p[y];Object.keys(b).length&&(c.selectedData.masterSelData.hasOwnProperty(v)||(c.masterCheckedId.push(v),c.selIds[v]=[],c.selectedData.masterSelData[v]=b[v]))}for(var g=0,S=Object.keys(m);g<S.length;g++){var T=S[g];if(Object.keys(m).length)if(c.selectedData.childSelData.hasOwnProperty(T))for(var w=0,D=Object.keys(m[T]);w<D.length;w++){var O=D[w];c.selectedData.childSelData[T].hasOwnProperty(O)||(c.selectedData.childSelData[T][O]=m[T][O],c.selIds[T].push(O))}else{c.selectedData.childSelData[T]=m[T];for(var k=0,I=Object.keys(m[T]);k<I.length;k++){var j=I[k];c.selIds[T].push(j)}}}c.masterAmount=c.masterCheckedId.length;for(var x=0,C=Object.keys(c.selIds);x<C.length;x++){var E=C[x];c.bodyAmount+=c.selIds[E].length||1}}}a.state.transferTable.allSelected=c}else s();if(!a.state.meta[n])return console.error("没有加载全部页签模板"),!1;l.allSelected.selectedShow=!l.allSelected.selectedShow,a.setState({transferTable:a.state.transferTable},(function(){t.onresizeEvents({isIntl:!1,windowResize:!1}),"function"==typeof o&&o()}))},t.processingTotalData=function(e,a,r,l){var n,s=t.props,o=s.getTheLongestPrecision,c=s.getScaleData,d={},u=[],f={},h=Be(r);try{for(h.s();!(n=h.n()).done;){var m=n.value;d[m.attrcode]={value:"",display:""},m.istotal&&"number"===m.itemtype&&(u.push(m.attrcode),f[m.attrcode]=m.scale)}}catch(e){h.e(e)}finally{h.f()}if("master"===a)for(var b=0,y=Object.keys(e.masterSelData);b<y.length;b++){var p,v=y[b],g=e.masterSelData[v].data,S=Be(u);try{for(S.s();!(p=S.n()).done;){var T=p.value;g[T]&&"object"===He(g[T])&&g[T]&&"object"===He(g[T])&&(d[T].value?(d[T].scale=Y(g[T].value,d[T].value),d[T].value=o(g[T].value,d[T].value)):(d[T].scale=g[T].scale,d[T].value=g[T].value))}}catch(e){S.e(e)}finally{S.f()}}else if(l&&"full"===a){var w=e.childSelData,D=e.masterSelData;if(w)for(var O=0,k=Object.keys(w);O<k.length;O++)for(var I=k[O],j=0,x=Object.keys(w[I]);j<x.length;j++){var C,E=x[j],N=Be(u);try{for(N.s();!(C=N.n()).done;){var A=C.value;if(w[I][E].data.values?w[I][E].data.values.hasOwnProperty(A):w[I][E].data.hasOwnProperty(A)){var P=w[I][E].data.values||w[I][E].data;P[A]&&"object"===He(P[A])&&P[A]&&"object"===He(P[A])&&(d[A].value?(d[A].scale=Y(P[A].value,d[A].value),d[A].value=o(P[A].value,d[A].value)):(d[A].scale=P[A].scale,d[A].value=P[A].value))}}}catch(e){N.e(e)}finally{N.f()}}for(var M=0,L=Object.keys(D);M<L.length;M++){var R,F=L[M],_=D[F].data.values||D[F].data,H=Be(u);try{for(H.s();!(R=H.n()).done;){var B=R.value;if(_.hasOwnProperty(B)&&_[B]&&"object"===He(_[B])){var K=_[B].scale?_[B].scale:f[B],V=_[B]?_[B].value:0;if(d[B].value){var J=Object(i.sum)(Number.parseFloat(V),Number.parseFloat(d[B].value.replace(/,/g,"")));d[B].scale=K>d[B].scale?K:d[B].scale,d[B].value=c(String(J),d[B].scale)}else d[B].scale=K,d[B].value=c(V,K)}}}catch(e){H.e(e)}finally{H.f()}}}return[d]},t.createSelectColumns=function(e,a){var r=[];t.props.headTableId;return r.push({label:t.state.json["page-transferTable-0007"]||"序号-5",attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",fixed:"left",visible:!0,width:80,className:"col-customer-numberindex",render:function(e,a,r){return l.a.createElement("span",{title:t.state.json["page-transferTable-0010"]||"合计-2"},t.state.json["page-transferTable-0010"]||"合计-2")}}),e.map((function(e){var a=e.width;a||(a=120);var n=null;n="customer"!==e.itemtype&&e.visible&&!e.render?function(a,r,n){if(r[e.attrcode]){var s=r[e.attrcode].display,o=r[e.attrcode].value,c="";if(c=s||0===s?s:o,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(c=Object(i.changeTime)(o,"YYYY-MM-DD HH:mm:ss"),c=Object(i.formatDatetime)(c,"datetime")):"timepicker"==e.itemtype?(c=o,c=Object(i.formatDatetime)(c,"time")):(c=Object(i.changeTime)(o),c=Object(i.formatDatetime)(c,"date"))),"residtxt"===e.itemtype){var d=Object(i.getLangCode)(),u=(e.languageMeta||[]).filter((function(e){return e.languageCode==d}));u.length>0&&("1"===u[0].index&&(u[0].index=""),r[e.attrcode+u[0].index]&&r[e.attrcode+u[0].index].value&&(c=r[e.attrcode+u[0].index].value))}return"number"===e.itemtype&&(c=Object(i.formatNumber)(c)),l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},l.a.createElement(p,{overlay:c},l.a.createElement("span",{className:$()({"single-line-and-ellipsis":t.state.transferTable.allSelected.isEllipsis,"three-line-and-ellipsis":!t.state.transferTable.allSelected.isEllipsis})},c)))}}:"customer"===e.itemtype?e.render:function(a,r,n){return l.a.createElement(p,{className:"tooltip-word-color",overlay:e.render.call(null,a,r,n),noEllipsis:!0},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":t.state.transferTable.allSelected.isEllipsis,"three-line-and-ellipsis":!t.state.transferTable.allSelected.isEllipsis})},e.render.call(null,a,r,n)))},e.visible&&"checkbox"!==e.attrcode&&"numberindex"!==e.attrcode&&r.push(Fe(Fe({},e),{},{render:n,width:a,key:e.attrcode,title:l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":""),style:{color:Xe.includes(e.color)?"":e.color}},e.label)}))})),r.length&&(r[r.length-1].render=function(){}),r},t.processingData=function(e,a,r,l){var n=t.props.params;if(a.length)for(var s=0,o=Object.keys(e);s<o.length;s++){var i,c=o[s],d="",u=null,f=Be(n);try{for(f.s();!(i=f.n()).done;){var h=i.value;if(c===h.headTableId){d=h.headTableId,u=h.onCheckedChange;break}}}catch(e){f.e(e)}finally{f.f()}if("allSelected"!==c)e.hasOwnProperty(d)&&function(){var t=Object.keys(e[c][d].bodyData).length?e[c][d].bodyData.data:{},r=e[c][d].outerData,l=e[c].selected.selectedData,n=e[c].selected&&e[c].selected.masterCheckedId,s=l&&l.childSelData,o=l&&l.masterSelData;if(e[c][d].outerData=r.length?r.filter((function(e){if(a.includes(e.rowId))return!1;if(t&&Object.keys(t).length&&t[e.rowId]&&t[e.rowId].rows){var r=t[e.rowId].rows.length;if(t[e.rowId].rows=t[e.rowId].rows.filter((function(e){return!a.includes(e.childId)})),r&&0===t[e.rowId].rows.length)return!1}return!0})):[],a&&a.length>0&&l&&(l.selAll=!1),Object.keys(s).length){for(var i=function(){for(var e=h[f],r={body:[],head:{}},l=Object.keys(t).indexOf(e),i=0,c=Object.keys(s[e]);i<c.length;i++){var d=c[i];a.includes(d)?delete s[e][d]:r.body.push(s[e][d].data.values?s[e][d].data.values:s[e][d].data)}Object.keys(s[e]).length||(n=n.filter((function(t){return t!==e})),delete s[e],delete o[e]),o.hasOwnProperty(e)&&(r.head=o[e].data),Object.keys(r.head).length&&"function"==typeof u&&u(!0,r.head,l,r.body)},f=0,h=Object.keys(s);f<h.length;f++)i();for(var m=0,b=Object.keys(t);m<b.length;m++){var y=b[m];t[y].rows=t[y].rows.filter((function(e){return!a.includes(e.childId)}))}}else if(!Object.keys(s).length&&Object.keys(o).length){for(var p=[],v=function(){var e=S[g];a.includes(e)?(p.push(e),n=n.filter((function(t){return t!==e}))):"function"==typeof u&&u(!0,o[e].data,Object.keys(o).indexOf(e),[])},g=0,S=Object.keys(o);g<S.length;g++)v();for(var T=0,w=p;T<w.length;T++){var D=w[T];delete o[D]}var O=e[c][d].outerData;e[c][d].outerData=O.filter((function(e,t){return!p.includes(e.rowId)}))}if(e[c].selected&&(e[c].selected.masterCheckedId=n),e[c].selected.bodyAmount=Object.keys(l.childSelData).reduce((function(e,t){return e+(Object.keys(l.childSelData[t]).length||1)}),0),e[c].selected.masterAmount=Object.keys(l.masterSelData).length,t)for(var k=0,I=Object.keys(t);k<I.length;k++){for(var j=I[k],x=[],C=t[j].rows||t[j],E=0;E<C.length;E++)a.includes(C[E].childId)||x.push(C[E]);t[j].rows=x}}();else{var m=e.allSelected?e.allSelected.selIds:null,b=e.allSelected.selectedData,y=b.childSelData,p=b.masterSelData,v=e.allSelected.masterCheckedId||[],g=0;if(m){for(var S=function(){var t=w[T];e.allSelected.selIds[t]=m[t].filter((function(e){return!a.includes(e)})),m[t].length||(v=v.filter((function(e){return e!==t})),delete m[t])},T=0,w=Object.keys(m);T<w.length;T++)S();for(var D=function(){for(var e=k[O],t=0,r=Object.keys(y[e]);t<r.length;t++){var l=r[t];a.includes(l)&&delete y[e][l]}Object.keys(y[e]).length||(v=v.filter((function(t){return t!==e})),delete p[e],delete y[e])},O=0,k=Object.keys(y);O<k.length;O++)D();for(var I=0,j=Object.keys(m);I<j.length;I++){var x=j[I];m[x]&&(g+=m[x].length||1)}e.allSelected.masterCheckedId=v,e.allSelected.masterAmount=Object.keys(m).length,e.allSelected.bodyAmount=g}}}else if(t.props.onCheckedChange)for(var C=0,E=Object.keys(e);C<E.length;C++){var N,A=E[C],P=null,M="",L=Be(n);try{for(L.s();!(N=L.n()).done;){var R=N.value;if(A===R.headTableId){M=R.headTableId,P=R.onCheckedChange;break}}}catch(e){L.e(e)}finally{L.f()}if("allSelected"!==A&&e.hasOwnProperty(M)){var F=Object.keys(Object.keys(e[A][M].bodyData).length?e[A][M].bodyData.data:{}),_=e[A].selected.selectedData,H=_&&_.childSelData,B=Object.keys(H),K=_&&_.masterSelData,V=Object.keys(K);if(B.length){var J,q=Be(B);try{for(q.s();!(J=q.n()).done;){for(var z=J.value,Y={body:[],head:K[z]?K[z].data:{}},W=H[z],U=Object.keys(W),G=0,$=U;G<$.length;G++){var Z=$[G];Y.body.push(W[Z].data.values?W[Z].data.values:W[Z].data)}if(Object.keys(Y.head).length&&"function"==typeof P){var Q=F.indexOf(z);P(!0,JSON.parse(JSON.stringify(Y.head)),Q,JSON.parse(JSON.stringify(Y.body)))}}}catch(e){q.e(e)}finally{q.f()}}else if(V.length){var X,ee=Be(V);try{for(ee.s();!(X=ee.n()).done;){var te=X.value;a.includes(te)||"function"==typeof P&&P(!0,JSON.parse(JSON.stringify(K[te].data)),V.indexOf(te),[])}}catch(e){ee.e(e)}finally{ee.f()}}}}else console.log("么得数据！么得PK！")},t.haveExpandIcon=function(e,a,r,l){var n=t.props,s=(n.bodyColumn,n.currentTable),o=n.transferTable;if(a){var i=o.allSelected.selectedData.childSelData,c=i&&i[r.key]||{};return!(Object.keys(c)&&Object.keys(c).length)}if(o&&o[e]&&o[e].outerData){var d=r.key||r.headKey;s&&s.bodyData&&s.bodyData.data&&s.bodyData.data[d]&&s.bodyData.data[d].rows.length>0&&!0}return!0},t.ViewModel=t.props.ViewModel,t.expandArrId=t.props.events&&t.props.events.expandArr,t.state={switchViewState:"evenUp",selectedTop:0,multiTransfertableHeight:0,selectedHeight:0,top:0,height:0,json:{},LangData:null,transferTableHeight:0,selectedListBoxHeight:0,listHeight:0,selectedListHeight:0,fixedWidth:0},t.activeTab="",t.multiTransfertableMain=l.a.createRef(),t.multiTransfertableSelectedList=l.a.createRef(),t.setTimeIndex=null,t.transferTableClient=null,t.isTransferTableSetHeight=!1,t.isSelectedListSetHeight=!1,t.transferTableHeight=null,t.modalBodyClient=null,t.modalBodyHeight=0,t.transfertableMainIsModalSChild=!1,t.total=null,t.doing=!0,t.setListHeightIsDone=!1,t.setSelectListHeightIsDone=!1,t.setModalHeightIsDone=!1,t.myBrowser=Object(i.myBrowser)(),t}return t=s,(a=[{key:"componentWillMount",value:function(){var e=this;this.props.showAll?Object(i.getMultiLang)({moduleId:"page-transferTable",callback:function(t,a,r){e.setState({json:t,LangData:r},(function(){e.dealDataFromTransferListBack()}))}}):this.dealDataFromTransferListBack()}},{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.onresizeEvents({isIntl:!0})}),200),window.onresize=function(){e.onresizeEvents({windowResize:!0})};var t=this.props._this;t.infoExchangeController.subscribe("heightChange",(function(t,a){var r=a.area;"searchArea"===r?(console.log("侦测到查询区变化，进行高度毁灭打击！"),setTimeout((function(){e.onresizeEvents({windowResize:!0})}),20)):console.log(r)})),t.infoExchangeController.subscribe("modelResizeEnd",(function(t,a){a.indexInfo,a.className,a.id,console.log("侦测到弹窗resize变化，随风起舞吧！"),setTimeout((function(){e.onresizeEvents({windowResize:!0})}),20)}))}},{key:"componentDidUpdate",value:function(){var e=this.props._this;e.state.multiDelete&&(this.dealDataFromTransferListBack(!1),e.state.multiDelete=!1)}},{key:"componentWillUnmount",value:function(){window.onresize=null;var e=this.props,t=e._this,a=e.dataSource;J.call(t,a),t.infoExchangeController&&t.infoExchangeController.unsubscribe("heightChange"),t.infoExchangeController&&t.infoExchangeController.unsubscribe("modelResizeEnd")}},{key:"render",value:function(){var e=this,t=this.props,a=t._this,r=t.clearAllSelectedData,n=t.createNewCol,s=t.cutParams,c=t.isHeadTotal,d=t.isFullTotal,u=t.params,f=t.expandedRowRender,h=t.fullColumns,m=t.getMasterData,b=t.headPkIds,y=t.bodyPkIds,p=t.getSelectedFullData,v=t.handleChangeView,g=t.showChangeViewBtn,S=t.handleGenerateClick,T=t.handleTabClick,w=t.showAll,D=t.showSeletedBtn,O=t.showGenerateBtn,k=t.isDrag,I=t.selectArea,j=t.selectedHeaderRender,x=t.selectedAmount,C=t.setSelectedColumns,E=t.transferBtnText,N=t.transferTable,A=t.totalKey,L=t.totalTitle,R=t.containerSelector,F=t.sortType,H=t.onExpandedChange,B=t.meta,K=t.allHeadId,V=t.allFullTableId,J=t.cancelCustomRightMenu,q=t.isShowBodyAmount,z=t.autoHeight,Y=(t.headTableId,this.state),W=Y.json,U=(Y.LangData,Y.listHeight),G=Y.selectedListHeight,$=(Y.fixedWidth,document.querySelector(R)&&document.querySelector(R).clientWidth,this.transfertableMainIsModalSChild?{position:"absolute",bottom:0,width:"auto",left:"0",right:"0"}:{width:"auto",left:"15px",right:"15px"}),Z=!w||w&&!N.allSelected.selectedShow?{}:{height:0,width:0,opacity:0},Q=!w||w&&!N.allSelected.selectedShow?"showAllListCssCls":"",X=w&&N.allSelected.selectedShow?"showSelectedList":"",ee=n(void 0,this.state.json),te=n(h,this.state.json,"full"),ae=this.createSelectColumns(C(n(void 0,this.state.json),this.state.json),!0,this.state.json),re=this.createSelectColumns(C(te,this.state.json),!0,this.state.json);G=z?G:400,U=z?U:400;var le=w&&N.allSelected.selectedShow?G:U,ne="Firefox"===this.myBrowser||"IE"===this.myBrowser?8:0,se=G-35-45-42-54-2*ne,oe=G-35-42-54-ne;return l.a.createElement("div",{className:"multitransfer-container multi-transfertable-main transfertable-main-".concat(this.myBrowser||"chrome"),ref:this.multiTransfertableMain,style:{height:"".concat(le?le+"px":"auto"),position:"relative",overflow:"hidden"}},l.a.createElement("div",{style:Z,className:Q},l.a.createElement(o.Tabs,{activeKey:String(a.state.transferTable.allSelected.activeTab),onChange:function(t){e.activeTab=t,T(t),e.onresizeEvents({windowResize:!0})},animated:!1},u&&u.map((function(t,r){t.tabName;var n=t.searchArea,o=(t.onTabClick,t.containerSelector),i=Le(t,["tabName","searchArea","onTabClick","containerSelector"]);return i.showSeletedArea=!w,i.showSeletedBtn=w,i.showGenerateBtn=O,s.includes(r)?"":l.a.createElement(Qe,{tab:t.tabName,key:r},l.a.createElement("div",{className:"multi-transfer-container"},l.a.createElement("div",{className:"".concat(n?"transfer-search-container":"transfer-search-container-space")},n&&n()),l.a.createElement("div",null,a.transferTable.createTransferTable(Fe(Fe({},i),{},{isMultiChild:!0,headPkIds:b,bodyPkIds:y,containerSelector:o,showChangeViewBtn:g,getMultiChildChangeWidth:_.bind(e),onExpandedChange:H,meta:B})))))})))),l.a.createElement("div",{className:"".concat(X," selected-list-wrapper")},l.a.createElement("div",{className:"selected-list"},l.a.createElement("div",{className:"header-area"},l.a.createElement("span",{className:"selected-icon-back-btn"},l.a.createElement(o.BackBtn,{onClick:this.closeSelectedList,className:"back-transfer-list"})),l.a.createElement("span",{className:"header-title"},W["page-transferTable-0002"]||"已选列表"),l.a.createElement("div",{className:"header-right"},l.a.createElement("div",{className:"header-right-inner"},l.a.createElement("span",{className:"header-right-change-view-area"},!0===g&&l.a.createElement(o.ToggleViewBtn,{tooltips:[W["page-transferTable-0023"],W["page-transferTable-0022"]],className:"selected-toggle-view",expand:!!N.allSelected.showFullTable,onClick:v.bind(this)})),l.a.createElement("span",{className:"clear-selected-item-view-btn"},l.a.createElement(o.Button,{className:"item",onClick:r.bind(this),fieldid:"clearAll"},W["page-transferTable-0013"]||"清空")),l.a.createElement("div",{className:"header-right-custom-area"},j&&j())))),w?l.a.createElement("div",{className:"content-area",ref:this.multiTransfertableSelectedList},l.a.createElement("div",{fieldid:Object(i.getSysFieldid)("selected-list_table"),className:"".concat(Ze)},N.allSelected.showFullTable?d&&te?l.a.createElement($e,{className:"insertTable total-table-wrapper multi-transfer-selected-wrapper",lazyload:!0,isDrag:k,columns:C(te,this.state.json),sort:F,data:p(N.allSelected.selectedData,u),scroll:{x:!0,y:se},isTotal:!0,totalData:this.processingTotalData(N.allSelected.selectedData,"full",C(te,this.state.json),!0),totalColumns:re,bodyStyle:{height:se},updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){a.state.transferTable.allSelected.isEllipsis=e,a.setState({transferTable:a.state.transferTable})},bodyDisplayInRow:a.state.transferTable.allSelected.isEllipsis,colsSettingParam:M.call(a,B,V),cancelCustomRightMenu:J}):l.a.createElement($e,{className:"insertTable multi-transfer-selected-wrapper",lazyload:!0,isDrag:k,columns:C(n(h,this.state.json,"full"),this.state.json),sort:F,data:p(N.allSelected.selectedData,u),scroll:{x:!0,y:oe},bodyStyle:{height:oe},updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){a.state.transferTable.allSelected.isEllipsis=e,a.setState({transferTable:a.state.transferTable})},bodyDisplayInRow:a.state.transferTable.allSelected.isEllipsis,colsSettingParam:M.call(a,B,V),cancelCustomRightMenu:J}):c&&ee?l.a.createElement($e,{className:"insertTable multi-transfer-selected-wrapper multi-transfertable-total-selected-wrapper",columns:C(ee,this.state.json),sort:F,data:m(N.allSelected.selectedData,u),expandedRowRender:function(t,a){return f(t,a,e.state.json,Ze)},haveExpandIcon:this.haveExpandIcon.bind(this,K,!0)||void 0,rowKey:function(e){return e.key},scroll:{x:!0,y:se},isTotal:!0,isDrag:k,bodyStyle:{height:se},totalData:this.processingTotalData(N.allSelected.selectedData,"master",ee,!1),totalColumns:ae,updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){a.state.transferTable.allSelected.isEllipsis=e,a.setState({transferTable:a.state.transferTable})},bodyDisplayInRow:a.state.transferTable.allSelected.isEllipsis,cancelCustomRightMenu:J,colsSettingParam:M.call(a,B,K)}):l.a.createElement($e,{className:"insertTable multi-transfer-selected-wrapper",columns:C(ee,this.state.json),sort:F,data:m(N.allSelected.selectedData,u),expandedRowRender:function(t,a){return f(t,a,e.state.json,Ze)},haveExpandIcon:this.haveExpandIcon.bind(this,K,!0)||void 0,rowKey:function(e){return e.key},scroll:{x:!0,y:oe},isDrag:k,bodyStyle:{height:oe},updateColumnHandle:P.bind(this),tableType:"transfer",foldingRowChange:function(e){a.state.transferTable.allSelected.isEllipsis=e,a.setState({transferTable:a.state.transferTable})},bodyDisplayInRow:a.state.transferTable.allSelected.isEllipsis,colsSettingParam:M.call(a,B,K),cancelCustomRightMenu:J}))):"")),w?l.a.createElement("div",{className:"fixed-bottom-outer",style:$,fieldid:Object(i.getSysFieldid)("bottom-area")},l.a.createElement("div",{className:"fixed-bottom-container bottom-area-container"},D&&l.a.createElement("div",{className:"area-left"},a.state.transferTable.allSelected.selectedShow?l.a.createElement(o.Button,{className:"middle-btn",onClick:this.closeSelectedList,fieldid:"alllist"},this.state.json["page-transferTable-0003"]||"全部列表-2"," "):l.a.createElement(o.Button,{className:"middle-btn",fieldid:"selected",onClick:this.viewSelectedList},this.state.json["page-transferTable-0004"]||"查看已选-2"," ")),l.a.createElement("div",{className:"area-center"},l.a.createElement("span",null,l.a.createElement("span",null,this.state.json["page-transferTable-0010"],":",l.a.createElement("span",null,x.masterAmount),this.state.json["page-transferTable-0017"]),q&&l.a.createElement("span",{style:{marginLeft:8}},this.state.json["page-transferTable-0018"],":",l.a.createElement("span",null,x.bodyAmount),this.state.json["page-transferTable-0019"]))),I?l.a.createElement("div",{className:"area-custom"},I&&"function"==typeof I&&I()):"",A.length&&L.length?l.a.createElement("span",null,this.customAggregate()):"",s.map((function(e,t){var a={};return t!=N.allSelected.activeTab&&(a={display:"none"}),e.selectArea&&l.a.createElement("div",{className:"area-custom",style:a},"function"==typeof e.selectArea&&e.selectArea())})),O&&l.a.createElement("div",{className:"area-right"},l.a.createElement(o.Button,{fieldid:function(){if(Array.isArray(u)){var t=e.activeTab||0;return u[t].fieldId}}()||"generate",className:"main-button large-btn",onClick:S.bind(this),disabled:q?0===x.bodyAmount&&0===x.masterAmount:0===x.masterAmount},E)))):"")}}])&&qe(t.prototype,a),r&&qe(t,r),s}(r.Component))||Ne;function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function at(e){return function(e){if(Array.isArray(e))return it(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ot(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function lt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(a),!0).forEach((function(t){nt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function nt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function st(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=ot(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(o)throw n}}}}function ot(e,t){if(e){if("string"==typeof e)return it(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?it(e,t):void 0}}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}et.defaultProps={isTotal:!0},a(904);var ct=(0,U.lib.total)(o.Table.SortTable),dt=["#111111","#555555","#111","#555"];t.default={createTransferTable:function(e){var t,a=this,r=e.dataSource,n=e.headTableId,c=e.bodyTableId,d=e.fullTableId,u=e.editStatus,f=void 0!==u&&u,h=e.isMultiChild,m=void 0!==h&&h,b=e.comType,y=void 0===b?"hasCheckBox_child":b,v=e.showMasterIndex,g=void 0===v||v,S=e.showChildIndex,T=void 0===S||S,w=e.transferBtnText,D=void 0===w?"转单":w,O=e.onTransferBtnClick,k=e.containerSelector,I=e.componentInitFinished,j=e.onChangeViewClick,x=e.showChangeViewBtn,C=void 0===x||x,R=e.showSeletedArea,F=void 0===R||R,_=e.showSeletedBtn,K=void 0===_||_,V=e.showGenerateBtn,J=void 0===V||V,q=e.tableType,Y=void 0===q?"nest":q,W=e.selectArea,U=e.onCheckedChange,G=e.onClearAll,Z=e.onSelectedItemRemove,Q=e.generateKeys,X=e.customAreaOfSelectedHead,ee=e.headPkIds,te=e.bodyPkIds,ae=e.cacheItem,re=e.editableItem,le=e.afterEvent,ne=e.totalKey,se=void 0===ne?[]:ne,oe=e.totalTitle,ie=void 0===oe?[]:oe,ce=e.isDrag,de=e.sortType,ue=void 0===de?{mode:"single",backSource:!1,sortFun:function(e,t){L(t,n,a,e)}}:de,fe=e.onExpandedChange,he=e.customSortRule,be=e.getMultiChildChangeWidth,ye=(e.fieldid,e.fieldId),pe=e.defaultOperateColumnHidden,ve=void 0!==pe&&pe,ge=e.currentPageId,Se=e.cancelCustomRightMenu,Te=void 0!==Se&&Se,we=e.autoHeight,ke=void 0===we||we,xe=e.fullDataRule,Ce=void 0===xe?"mainbody":xe;if(r&&(this.transferTableDataSource=r),this.state.transferTable.hasOwnProperty("allSelected")||(this.state.transferTable.allSelected={activeTab:"0",selectedShow:!1,masterAmount:0,bodyAmount:0,masterCheckedId:[],selIds:{},showFullTable:!1,selectedData:{selAll:!1,masterSelData:{},childSelData:{}}}),this.state.transferTable.hasOwnProperty(n)||(this.state.transferTable[n]=(Ee(t={},n,{tableType:Y,bodyData:{},outerData:[],showFullTable:"full"===Y,firstTime:!0,bodyTableId:c}),Ee(t,"selected",{selectedShow:!1,masterAmount:0,bodyAmount:0,masterCheckedId:[],selectedData:{selAll:!1,masterSelData:{},childSelData:{}}}),t)),!this.state.meta)return!1;var Ne=this.state.transferTable[n];Ne.hasOwnProperty("isEllipsis")||(Ne.isEllipsis=!0);var Le=this.state.transferTable[n][n];if(Le.showFullTable){if(!this.state.meta[d])return!1}else if(!this.state.meta.hasOwnProperty(n)||!this.state.meta[n])return!1;var Re=Le.outerData.map((function(e){return e.values.headKey=e.values.key,e.values.headTs=e.values.ts,e}));this.onTransferBtnClick=O,this.onChangeViewClick=j,this.onCheckedChange=U,this.onClearAll=G;var Fe=this.state.meta[n]&&this.state.meta[n].items.map((function(e,t){return H(e,ue,he),e&&e.required&&delete e.required,e})),_e=c&&this.state.meta[c]?this.state.meta[c].items.map((function(e,t){return H(e,ue,he),e&&e.required&&delete e.required,e})):[],He=d&&this.state.meta[d]?this.state.meta[d].items.map((function(e,t){return H(e,ue,he),e&&e.required&&delete e.required,e})):[],Be=(this.myState.status.traversalStatus,function(e,t){var a=Ne.selected,r=a.masterCheckedId,l=a.selectedData;!r.includes(e)&&t?r.push(e):-1===r.indexOf(e)||l.selAll||r.splice(r.indexOf(e),1)}),Ke=function(e,t){if(e){var r,l=je(e);try{for(l.s();!(r=l.n()).done;){r.value.istotal&&(a.myState.status["".concat(t,"TotalStatusOfTransferTable")]=!0,a.myState.status["".concat(t,"traversalStatus")]=!0)}}catch(e){l.e(e)}finally{l.f()}}};(function(e){var t,r=je(e);try{for(r.s();!(t=r.n()).done;){var l=t.value;if(l.istotal)a.myState.status.totalStatusOfTransferTable=!0,a.myState.status.traversalStatus=!0;else if(l.data){var n,s=je(l.data);try{for(s.s();!(n=s.n()).done;){n.value.istotal&&(a.myState.status.totalStatusOfTransferTable=!0,a.myState.status.traversalStatus=!0)}}catch(e){s.e(e)}finally{s.f()}}if(a.myState.status.traversalStatus)break}}catch(e){r.e(e)}finally{r.f()}Ke.call(a,e[0].data,"head"),Ke.call(a,e[1].data,"full"),Ke.call(a,e[2].data,"body")}).bind(this,[{data:Fe,title:"columns"},{data:He,title:"columns"},{data:_e,title:"columns"}])();var Ve=function(e){return Le.bodyData.data[e.key].rows.length===Object.keys(Ne.selected.selectedData.childSelData[e.key]).length},Je=function(){return N(Ne,n).isSelectAll},qe=function(e){var t=e.record,r=e.parents,l=e.flag,s=e.type,o=r,i=a.state.transferTable.allSelected,c=i.selectedData.childSelData,d=i.selectedData.masterSelData;if("body"===s)l?(i.masterCheckedId.includes(o.key)||i.masterCheckedId.push(o.key),i.selIds.hasOwnProperty(o.key)?i.selIds[o.key].includes(t.key)||i.selIds[o.key].push(t.key):i.selIds[o.key]=[t.key],d[o.key]={sel:!0,data:o},c.hasOwnProperty(o.key)?c[o.key].hasOwnProperty(t.key)||(c[o.key][t.key]={sel:!0,data:{childId:t.key,values:t}}):c[o.key]=Ee({},t.key,{sel:!0,data:{childId:t.key,values:t}})):(i.selIds[o.key]=i.selIds[o.key].filter((function(e){return e!==t.key})),i.selIds[o.key].length||delete i.selIds[o.key],c[o.key].hasOwnProperty(t.key)&&delete c[o.key][t.key],Object.keys(c[o.key]).length||(delete c[r.key],delete c[r.key],i.masterCheckedId=i.masterCheckedId.filter((function(e){return e!==r.key}))));else if("head"===s){var u=t.headKey||t.key;if(l){var f=Ne[n].bodyData.data,h={},m={};i.masterCheckedId.includes(u)||i.masterCheckedId.push(u),d[u]={sel:!0,data:t};for(var b=0,y=Object.keys(f);b<y.length;b++){var p=y[b],v={},g=[];if(p===u){var S,T=je(f[p].rows);try{for(T.s();!(S=T.n()).done;){var w=S.value;v[w.childId]={sel:!0,data:{childId:w.childId,values:w.values}},g.includes(w.childId)||g.push(w.childId)}}catch(e){T.e(e)}finally{T.f()}h[p]=v,m[p]=g}}i.selectedData.childSelData=Ie(Ie({},c),h),i.selIds=Ie(Ie({},i.selIds),m)}else i.masterCheckedId=i.masterCheckedId.filter((function(e){return e!==u})),delete d[u],delete c[u],delete i.selIds[u]}i.bodyAmount=Object.values(i.selIds).reduce((function(e,t){return e+(t.length||1)}),0),i.masterAmount=i.masterCheckedId.length},ze=function(e){for(var t=e.selected.selectedData,a=0,r=0,l=Object.keys(t.childSelData);r<l.length;r++){var n=l[r];a+=Object.keys(t.childSelData[n]).length||1}return{bodyAmount:a,masterAmount:Object.keys(t.masterSelData).length}},Ye=function(e,t,r,l,s){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],c=Ne.selected,d=c.selectedData,u=d.childSelData[l.key],f=!0;if(u){var h=u[t.key];if(f=!h,h){delete d.childSelData[l.key][t.key];var m=d.childSelData[l.key];0===Object.keys(m).length&&(delete d.childSelData[l.key],delete d.masterSelData[l.key]),qe({record:t,parents:l,flag:!1,type:"body"}),d.selAll=!1,Be(l.key,!1)}else d.childSelData[l.key][t.key]={sel:!0,data:t},d.masterSelData[l.key]={sel:!0,data:l},qe({record:t,parents:l,flag:!0,type:"body"}),We("body",!0,l.key,t.key),Ve(l)&&Be(l.key,!0),Je()&&(d.selAll=!0)}else d.childSelData[l.key]=Ee({},t.key,{sel:!0,data:t}),d.masterSelData[l.key]={sel:!0,data:l},qe({record:t,parents:l,flag:!0,type:"body"}),Je()&&(d.selAll=!0),Ve(l)&&Be(l.key,!0);var b=ze.call(a,Ne);c.bodyAmount=b.bodyAmount,c.masterAmount=b.masterAmount,a.state.transferTable[n]=Ne,a.setState({transferTable:a.state.transferTable},(function(){"boolean"==typeof o&&i&&U&&U(f,JSON.parse(JSON.stringify(t)),r,null,s)}))},We=function(e,t,r,l){window.transferTable=a.state.transferTable;var n=a.state.transferTable.allSelected;if(n)if(t)n.selIds[r]?l&&!n.selIds[r].includes(l)&&n.selIds[r].push(l):n.selIds[r]="head"===e?[]:[l];else if("head"===e)delete n.selIds[r];else{var s=n.selIds;s[r]&&(s[r].splice(s[r].indexOf(l),1),0===s[r].length&&delete s[r])}},Ue=function(e){var t;Ne.selected.selectedData.selAll=e,t=e,Le.outerData.map((function(e,a){var r=e.values||e;r.saga_status&&"1"===r.saga_status.value||$e(t,e.values,e.values,a,!0)})),a.state.transferTable[n]=Ne,a.setState({transferTable:a.state.transferTable})},Ge=function(e,t,a,r){var l=t.headKey||t.key;$e(!Ne.selected.selectedData.masterSelData[l],e,t,a,r)},$e=function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=Ne.selected,i=Ne.selected.selectedData,c=Le.bodyData.data,d=r.headKey||r.key;if(t){i.masterSelData[d]={sel:!0,data:r},qe({record:r,parents:d,flag:!0,type:"head"});var u=c[d];u&&(i.childSelData[d]={},u.rows.map((function(e,t){i.childSelData[d][e.values.key]={sel:!0,data:e}}))),Be(d,!0),Je()&&(i.selAll=!0)}else i.selAll=!1,Be(d,!1),qe({record:r,flag:!1,type:"head"}),i.masterSelData[d]&&delete i.masterSelData[d],i.childSelData[d]&&(e=i.childSelData[d],delete i.childSelData[d]);var f=ze.call(a,Ne);o.bodyAmount=f.bodyAmount,o.masterAmount=f.masterAmount,a.state.transferTable[n]=Ne,a.setState({transferTable:a.state.transferTable},(function(){if("object"===Oe(s)||!0===s){var a=t?i.childSelData[d]:e,n=a?Object.values(a).map((function(e){return e.data.values||e.data})):[];U&&U(t,JSON.parse(JSON.stringify(r)),l,JSON.parse(JSON.stringify(n)))}}))},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=Ne[n].bodyData.data[a],s="empty";if(r){var o=e[a]||t&&t[a];return o?"full":s}var i=t&&t[a];if(l){var c,d=je(l.rows);try{for(d.s();!(c=d.n()).done;){var u=c.value;e[u.childId]?s="indeterminate":i=!1}}catch(e){d.e(e)}finally{d.f()}}return i?"full":s},Qe=function(e,t,r){var l,s=Ne.selected,o=Ne.selected.selectedData,i=o.childSelData[t.headKey],c=Ne[n].outerData,d=Ne[n].bodyData,u=d.data[t.headKey].rows.filter((function(e){return e.childId===t.key})),f={},h=je(c);try{for(h.s();!(l=h.n()).done;){var m=l.value;m.rowId===t.headKey&&(f=m.values)}}catch(e){h.e(e)}finally{h.f()}var b=a.state.transferTable.allSelected&&a.state.transferTable.allSelected.selectedData,y=!0;if(u&&u[0]&&(!i||!i[t.key])||(!u||!u[0])&&!o.masterSelData[t.headKey])o.childSelData[t.headKey]=o.childSelData[t.headKey]||{},u&&u[0]&&u[0].values&&(o.childSelData[t.headKey][t.key]={sel:!0,data:u[0].values}),o.masterSelData[t.headKey]={sel:!0,data:f},b&&(b.childSelData[t.headKey]=b.childSelData[t.headKey]||{},u&&u[0]&&u[0].values&&(b.childSelData[t.headKey][t.key]={sel:!0,data:u[0].values}),b.masterSelData[t.headKey]={sel:!0,data:f}),We("body",!0,t.headKey,t.key),i&&d.data[t.headKey].rows.length!==Object.keys(o.childSelData[t.headKey]).length||Be&&Be(t.headKey,!0),Je()&&(o.selAll=!0,b&&(b.selAll=!0));else{y=!1,delete o.childSelData[t.headKey][t.key];var p=o.childSelData[t.headKey];if(0===Object.keys(p).length&&(delete o.childSelData[t.headKey],delete o.masterSelData[t.headKey]),o.selAll=!1,b){delete b.childSelData[t.headKey][t.key];var v=b.childSelData[t.headKey];0===Object.keys(v).length&&(delete b.childSelData[t.headKey],delete b.masterSelData[t.headKey]),b.selAll=!1}Be(t.headKey,!1),We("body",!1,t.headKey,t.key)}var g=ze.call(a,Ne);s.bodyAmount=g.bodyAmount,s.masterAmount=g.masterAmount,a.state.transferTable[n]=Ne,a.setState({transferTable:a.state.transferTable},(function(){U&&U(y,JSON.parse(JSON.stringify(t)),r)}))},Xe=function(e,t){var a,r=[],l=[],n=je(e);try{for(n.s();!(a=n.n()).done;){var s=a.value,o=s.values||s;if((!o.saga_status||"1"!=o.saga_status.value)&&(r.push(s.values||s),t.data&&t.data[s.rowId]&&t.data[s.rowId].rows)){var i,c=je(t.data[s.rowId].rows);try{for(c.s();!(i=c.n()).done;){var d=i.value,u=d.values||d;u.saga_status&&"1"==u.saga_status.value||l.push(d.values||d)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){n.e(e)}finally{n.f()}return{body:l,head:r}},et=function(e,t,r,n,s){var i=Pe.multiSelect,c=[{label:l.a.createElement("span",{bbq:"已选展开列序号",style:{display:"block",textAlign:"left"}},s["page-transferTable-0007"]||"序号-2"),attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:70,className:"col-customer-numberindex",render:function(e,t,a){return l.a.createElement("span",{style:{display:"block",textAlign:"left"}},a+1)}}],d=e,u=s["page-transferTable-0006"]?s["page-transferTable-0006"]:"操作-4";if(T&&(d=c.concat(d)),"hasCheckBox_child"==n){if(i&&"checkbox"===i.type){var f=Ne.selected.selectedData.childSelData[t.key],h=t.values||t,m=h&&h.saga_status&&"1"===h.saga_status.value;d=[{label:"",attrcode:"checkbox",itemtype:"customer",dataIndex:"checkbox",width:40,className:"col-customer-checkbox",fixed:"left",visible:!0,onCellClick:function(e,l){var n=e.key,s=e.values||e,o=-1;(((Le.bodyData.data||{})[t.key]||{}).rows||[]).some((function(e,t){if((e.values||e).key===n)return o=t,!0})),-1==o||m||s&&s.saga_status&&"1"===s.saga_status.value||Ye.call(a,"",e,o,t,r)},render:function(e,n,s){var i=n.values||n;return i&&i.saga_status&&"1"===i.saga_status.value||m?l.a.createElement(o.ErrorPop,{record:n}):l.a.createElement(o.Checkbox,{className:"table-checkbox",checked:!(!f||!f[n.key]),onChange:Ye.bind(a,e,n,s,t,r)})}}].concat(d)}}else if("selectedList"==n&&!0!==ve){var b={label:l.a.createElement("span",null," ",u," "),attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:100,visible:!0,render:function(e,a,r){return l.a.createElement("div",{className:"row-remove",bbq:"子表移除",onClick:function(){Z&&Z(a),Ye(e,a,r,t,r,!0,!1)}},s["page-transferTable-0001"]||"移除")}};d=[].concat(De(d),[b])}return d},tt=function(e,t,r,l){var s=Ne.selected,o=Ne.selected.selectedData,i=a.state.transferTable[n][n].childId,c=t.headKey,d=t[i].value;delete o.childSelData[c][d];var u=o.childSelData[c];0===Object.keys(u).length&&(delete o.childSelData[c],delete o.masterSelData[c]),We("body",!1,c,d),o.selAll=!1,Be(c,!1),a.state.transferTable[n]=Ne;var f=ze.call(a,Ne);s.bodyAmount=f.bodyAmount,s.masterAmount=f.masterAmount,a.setState({transferTable:a.state.transferTable})};Re&&Le.firstTime&&(Le.firstTime=!1);var at=Fe,rt=null;"hasCheckBox"!=y&&"hasCheckBox_child"!=y||(rt="hasCheckBox");var lt=function(e,t){var a=String(e).replace(/,/g,""),r=Number(t);if(!a)return 0;var l=r>=0?a.split(".")[0].length+r+1:a.split(".")[0].length;if(-1!==a.indexOf(".")){a.split(".");Number.isNaN(r)||-1===r||(a=0===r?String(a).split(".")[0]:String(a).padEnd(l,"0"))}else{if(!Number.isNaN(r)&&-1!==r)if(0===r)a=String(a);else a=(a+".").padEnd(Number(l),"0")}return Object(i.commafy)(a)},nt=function(e){var t=e.column,r=e.outerRecordKey,s=(e.bool,e.expander),u=e.columnType,h=e.json,m=[],b=ge||a.state&&a.state.meta.pageid;return s&&t.length&&"operate"===t[t.length-1].attrcode&&(t[t.length-1].fixed="right"),t.map((function(e){var t=e.width;t||(t=120);var s=function(e,t){var r=a.state.transferTable,l=r[n],s=l[n],o=l.selected,i=r.allSelected,c={order:"flatscend",orderNum:""};return(o.selectedShow||i.selectedShow?s.showFullTable||i.showFullTable?o.fullSortInfoObj||l.sortInfoObj||[]:t?o[t]&&o[t].childSortInfoObj||[]:o.mainSortInfoObj||l.sortInfoObj||[]:s.showFullTable||i.showFullTable?s.fullSortInfoObj||l.sortInfoObj||[]:t?s[t]&&s[t].childSortInfoObj||[]:s.mainSortInfoObj||l.sortInfoObj||[]).forEach((function(t){e.attrcode===t.field&&(c.order=t.order,c.orderNum=t.orderNum,c.field=t.field,c.isSort=!0)})),c}(e,r);s.order&&(e.order=s.order,e.orderNum=s.orderNum);var y=null;"customer"!==e.itemtype&&e.visible&&!e.render?(e.dataIndex=e.attrcode,y=function(t,s,m){var y=e.hyperlinkflag;if(s[e.attrcode]){var v=s[e.attrcode].display,g=s[e.attrcode].value,S=s[e.attrcode].scale?s[e.attrcode].scale:e.scale?e.scale:0,T="";if(T=v||0===v?v:g,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(T=Object(i.changeTime)(g,"YYYY-MM-DD HH:mm:ss"),T=Object(i.formatDatetime)(T,"datetime")):"timepicker"==e.itemtype?(T=g,T=Object(i.formatDatetime)(T,"time")):(T=Object(i.changeTime)(g),T=Object(i.formatDatetime)(T,"date"))),"residtxt"===e.itemtype){var w=Object(i.getLangCode)(),D=(e.languageMeta||[]).filter((function(e){return e.languageCode==w}));D.length>0&&("1"===D[0].index&&(D[0].index=""),s[e.attrcode+D[0].index]&&s[e.attrcode+D[0].index].value&&(T=s[e.attrcode+D[0].index].value))}"switch"==e.itemtype?T=function(e,t){return e?t&&t["page-transferTable-0020"]||"是":t&&t["page-transferTable-0021"]||"否"}(g,h):"checkbox_switch"==e.itemtype&&(T=E(g,f,h));var O=s[e.attrcode].isEdit,k=e.disabled,I=S;if("-1"===S&&T){var j=String(T).split(".");j.length&&j[1]&&(I=j[1].length)}if(f){var x=T;if("number"===e.itemtype){var C=z(T,S);x=Object(i.formatAcuracy)(C,I),x=Object(i.formatNumber)(x)}return O&&!k?l.a.createElement("div",{fieldid:Object(i.getSysFieldid)(e.attrcode),className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},function(e,t,r,s,i,c){switch(e.itemtype){case"number":return l.a.createElement(o.NumberInput,{value:t,scale:c,autoFocus:!0,onChange:function(l){a.myState.transferTableEditOldValueIsSaved||(a.myState.transferTableEditOldValueIsSaved=!0,a.myState.transferTableEditOldValue=t);var o=a.state.transferTable;(s?o[n][n].bodyData.data[s].rows[r].values[e.attrcode]:o[n][n].outerData[r].values[e.attrcode]).value=l},onBlur:function(t){a.myState.transferTableEditOldValueIsSaved=!1;var l=a.state.transferTable,o=null;o=s?l[n][n].bodyData.data[s].rows[r].values[e.attrcode]:l[n][n].outerData[r].values[e.attrcode];var d=a.myState.transferTableEditOldValue;o.isEdit=!1,o.value=z(t,c),i[e.attrcode].value=t,l&&n&&l[n]&&l[n].selected&&l[n].selected.selectedData&&l[n].selected.selectedData.childSelData&&i&&i.key&&i.parentRowId&&l[n].selected.selectedData.childSelData[i.parentRowId]&&l[n].selected.selectedData.childSelData[i.parentRowId][i.key]&&l[n].selected.selectedData.childSelData[i.parentRowId][i.key].data&&e&&e.attrcode&&l[n].selected.selectedData.childSelData[i.parentRowId][i.key].data[e.attrcode]&&(l[n].selected.selectedData.childSelData[i.parentRowId][i.key].data[e.attrcode].value=t),i[e.attrcode].isEdit=!1,"function"==typeof le&&le(e.attrcode,t,i,r,d),a.setState({transferTable:l})}});default:return l.a.createElement("span",null,t)}}(e,T,m,r,s,I)):l.a.createElement("span",{className:$()({"number-td-span-wrapper editor-td-span-wrapper":"number"===e.itemtype,"single-line-and-ellipsis":a.state.transferTable[n].isEllipsis,"three-line-and-ellipsis":!a.state.transferTable[n].isEllipsis}),fieldid:Object(i.getSysFieldid)(e.attrcode),onClick:function(){if(!re||re.includes(e.attrcode)){var t=a.state.transferTable;r?t[n][n].bodyData.data[r].rows[m].values[e.attrcode].isEdit=!0:t[n][n].outerData[m].values[e.attrcode].isEdit=!0,a.setState({transferTable:t})}}},l.a.createElement(p,{overlay:x},l.a.createElement("span",null,x)))}return"number"===e.itemtype&&(T=z(T,S),T=Object(i.formatAcuracy)(T,I),T=Object(i.formatNumber)(T)),l.a.createElement("span",{className:$()({"number-td-span-wrapper":"number"===e.itemtype,"single-line-and-ellipsis":a.state.transferTable[n].isEllipsis,"three-line-and-ellipsis":!a.state.transferTable[n].isEllipsis}),fieldid:Object(i.getSysFieldid)(e.attrcode)},l.a.createElement(p,{overlay:T},y&&T?l.a.createElement("a",{href:"javascript:;",className:"hyper-link",onClick:function(t){t.stopPropagation();var r="child"===u?c:"full"===u?d:n,l=b;a.state&&a.state.meta&&a.state.meta[r]&&a.state.meta[r].pageid&&(l=a.state.meta[r].pageid),Object(i.linkTo)(l,r,e.attrcode,g||T)}},T):l.a.createElement("span",null,T," ")))}}):y="customer"===e.itemtype?e.render:function(t,r,s){return l.a.createElement(p,{className:"tooltip-word-color",overlay:e.render.call(null,t,r,s),noEllipsis:!0},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":a.state.transferTable[n].isEllipsis,"three-line-and-ellipsis":!a.state.transferTable[n].isEllipsis})},e.render.call(null,t,r,s)))},e.visible&&m.push(Ie(Ie({},e),{},{render:y,width:t,key:e.attrcode,dataIndex:e.dataIndex||e.attrcode,title:l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"text-td-span-wrapper"),style:{color:Me.includes(e.color)?"":e.color},fieldid:Object(i.getSysFieldid)(e.attrcode)},e.label)}))})),m},st=function(e,t){var a=[];return e.map((function(e,t){e=e.values||e;for(var r=0,l=Object.keys(e);r<l.length;r++){var n=l[r],s=e[n];s&&"object"===Oe(s)&&s.hasOwnProperty("scale")&&(e[n].value=z(s.value,e[n].scale))}a.push(e)})),a},ot=function(e,t,r,s){var o=[];return o.push({label:l.a.createElement("span",null),attrcode:"checkbox",itemtype:"customer",fixed:"left",dataIndex:"checkbox",visible:!0,width:s?70:80,className:"col-customer-checkbox col-customer-total",render:function(e,t,a){return l.a.createElement("span",{title:r["page-transferTable-0010"]||"合计-1"},r["page-transferTable-0010"]||"合计-1")}}),e.map((function(e){var t=e.width;t||(t=120);var r=null;r="customer"!==e.itemtype&&e.visible&&!e.render?function(t,r,s){if(r[e.attrcode]){var o=r[e.attrcode].display,c=r[e.attrcode].value,d="";if(d=o||0===o?o:c,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(d=Object(i.changeTime)(c,"YYYY-MM-DD HH:mm:ss"),d=Object(i.formatDatetime)(d,"datetime")):"timepicker"==e.itemtype?(d=c,d=Object(i.formatDatetime)(d,"time")):(d=Object(i.changeTime)(c),d=Object(i.formatDatetime)(d,"date"))),"residtxt"===e.itemtype){var u=Object(i.getLangCode)(),f=(e.languageMeta||[]).filter((function(e){return e.languageCode==u}));f.length>0&&("1"===f[0].index&&(f[0].index=""),r[e.attrcode+f[0].index]&&r[e.attrcode+f[0].index].value&&(d=r[e.attrcode+f[0].index].value))}return"number"===e.itemtype&&(d=Object(i.formatNumber)(d)),l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},l.a.createElement(p,{overlay:d},l.a.createElement("span",{className:$()({"single-line-and-ellipsis":a.state.transferTable[n].isEllipsis,"three-line-and-ellipsis":!a.state.transferTable[n].isEllipsis})},d," ")))}}:"customer"===e.itemtype?e.render:function(t,r,s){return l.a.createElement(p,{className:"tooltip-word-color",inverse:!0,overlay:e.render.call(null,t,r,s),noEllipsis:!0},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":a.state.transferTable[n].isEllipsis,"three-line-and-ellipsis":!a.state.transferTable[n].isEllipsis})},e.render.call(null,t,r,s)))},e.visible&&"checkbox"!==e.attrcode&&"numberindex"!==e.attrcode&&o.push(Ie(Ie({},e),{},{render:r,width:t,key:e.attrcode,title:e.label}))})),o[1],!0!==ve&&o.push({label:l.a.createElement("span",null,r["page-transferTable-0006"]||"操作-2"),attrcode:"operate",itemtype:"customer",fixed:"right",dataIndex:"operate",visible:!0,width:100,render:function(e,t,a){return l.a.createElement("span",null," ")}}),o},it=function(e,t,a){var r,l=e[a.key],n={},s=[],o={},c=je(t);try{for(c.s();!(r=c.n()).done;){var d=r.value;n[d.attrcode]={value:"",display:""},d.istotal&&"number"===d.itemtype&&(s.push(d.attrcode),o[d.attrcode]=d.scale)}}catch(e){c.e(e)}finally{c.f()}if(l)for(var u=0,f=Object.keys(l);u<f.length;u++){var h,m=f[u],b=l[m].data.values||l[m].data,y=je(s);try{for(y.s();!(h=y.n()).done;){var p=h.value;if(b[p]&&"object"===Oe(b[p])){var v=b[p].scale?b[p].scale:o[p],g=b[p]&&String(b[p].value)?String(b[p].value).replace(/,/g,""):0;if(n[p].value){var S=Object(i.sum)(Number.parseFloat(g),Number.parseFloat(String(n[p].value).replace(/,/g,"")));n[p].scale=v>n[p].scale?v:n[p].scale,n[p].value=lt(String(S),n[p].scale)}else n[p].scale=v,n[p].value=lt(g,v)}}}catch(e){y.e(e)}finally{y.f()}}return[n]},ct=function(){for(var e=a.state.transferTable,t=0,r=0,l=0,n=Object.keys(e);l<n.length;l++){var s=n[l];if("allSelected"!==s){var o=e[s].selected;r+=o.masterAmount?Number(o.masterAmount):0,t+=o.bodyAmount?Number(o.bodyAmount):0}}return{masterAmount:r,bodyAmount:t}}();return l.a.createElement(me,{_this:this,bodyColumn:_e,classByType:rt,column:at,columns:Fe,comType:y,componentInitFinished:I,createNewCol:nt,createFullData:function(e){var t=e.outerData,a=e.bodyData,r=e.fullSortData,l=[],n={},s=Ce||"mainbody";if(r)return r;a&&a.data&&Array.isArray(t)&&t.forEach((function(e){var t=e.rowId;if(n[t]=e.values,a.data[t]&&a.data[t].rows&&a.data[t].rows.length)a.data[t].rows.map((function(e){var a=Object.assign({},e.values,n[t]);"[object Function]"==Object.prototype.toString.call(s)&&(a=s(n[t],e.values)||{}),"bodymain"===s&&(a=Object.assign({},n[t],e.values)),"body"===s&&((a=Object.assign({},e.values)).headKey=t),"main"===s&&(a=Object.assign({},n[t])),a.headKey||(a.headKey=t),a.key=e.values.key,a.headTs=n[t].ts,l.push(a)}));else{var r=n[t];r.headKey=t,r.key=t,r.headTs=n[t].ts,l.push(r)}}));for(var o=0,i=l;o<i.length;o++)for(var c=i[o],d=0,u=Object.keys(c);d<u.length;d++){var f=u[d],h=c[f];h&&h.hasOwnProperty("scale")&&(c[f].value=z(h.value,c[f].scale))}return l},createNewData:st,currentTable:Le,customAreaOfSelectedHead:X,renderColumnsMultiSelect:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,s=arguments.length>3?arguments[3]:void 0,i=Pe.multiSelect,c=Ne[n].showFullTable,d=Ne[n].tableType,u=[{label:l.a.createElement("span",{style:{display:"block",textAlign:"left"}},t["page-transferTable-0007"]||"序号-3"),attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:c||"simple"===d?45:r,className:"col-customer-numberindex",render:function(e,t,a){return l.a.createElement("span",{style:{display:"block",textAlign:"left"}},a+1)}}],f=[].concat(e),h=!Ne[n].outerData.length;if(g&&(f=u.concat(f)),g||"selectedAndExpand"!==s||(f=[{label:l.a.createElement("span",{style:{display:"block",textAlign:"left"}}),attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:30,className:"col-customer-noindexcol",render:function(e,t,a){return l.a.createElement("span",{style:{display:"block",textAlign:"left"}})}}].concat(f)),i&&"checkbox"===i.type){var m=N(Ne,n),b=m.isSelectAll,y=m.isIndeterminate;f.unshift({label:l.a.createElement(o.Checkbox,{className:"table-checkbox",disabled:h,checked:b,indeterminate:y,onChange:function(){if(Ue.call(a,!b),b)"function"==typeof G&&G();else{var e=Xe(Le.outerData,Le.bodyData),t=e.head,r=e.body;U&&U(!b,JSON.parse(JSON.stringify(t)),"all",JSON.parse(JSON.stringify(r)))}}}),onCellClick:function(e,t){var r=e.key||e.headKey,l=e.values||e,n=-1;(Le.outerData||[]).some((function(e,t){var a=e.values||e;if((a.key||a.headKey)===r)return n=t,!0})),-1==n||l&&l.saga_status&&"1"===l.saga_status.value||(c?Qe.call(a,"",e,n):Ge.call(a,"",e,n))},attrcode:"checkbox",itemtype:"customer",dataIndex:"checkbox",visible:!0,width:c||"simple"===d?54:80,fixed:"left",className:"col-customer-checkbox",render:function(e,t,r){var n=t.key||t.headKey,s=Ne.selected.selectedData.childSelData,i=Ne.selected.selectedData.masterSelData,d=Ze(s[t.headKey||t.key],i,n,c),u=t.values||t;return u&&u.saga_status&&"1"===u.saga_status.value?l.a.createElement(o.ErrorPop,{record:t}):l.a.createElement(o.Checkbox,{className:"table-checkbox",checked:"full"===d,indeterminate:"indeterminate"===d,onClick:c?Qe.bind(a,e,t,r):Ge.bind(a,e,t,r)})}})}return f},dataSource:r,defaultProps:Pe,expandedRowRender:function(e,t,r,o){var i,d,u=_e,f=a.props,h=f.showChildIndex,m=f.sortType,b=a.myState.status.bodyTotalStatusOfTransferTable,y=e.headKey||e.key,p=it.call(a,Ne.selected.selectedData.childSelData,u,e);if(u instanceof Array&&u.length>0&&(u=et.call(a,u,e,t,r,o),Le.bodyData&&Object.keys(Le.bodyData).length&&Le.bodyData.data.hasOwnProperty(y)||Ne&&Ne.selected&&Ne.selected.selectedData&&"selectedList"===r)){var v,g,S=null,T=s.a.findDOMNode(a);"selectedList"===r?(S=st(Object.values(Ne.selected.selectedData.childSelData[y]||{}).map((function(e){return e.data}))),T=T.querySelector(".selected-list-wrapper")||T):S=st(Le.bodyData.data[e.key].rows||Le.bodyData.data[e.key]),v=A(S,b,T),g=A(S,b,T,!0);i="selected-list",(d=document.querySelector(".".concat(i," .u-table-scroll .u-table-body")))&&d.getBoundingClientRect().width;return l.a.createElement("div",{className:"transfertable-expand-wraper",style:{height:"".concat(v,"px"),width:"100%"}},l.a.createElement(Ae,{columns:nt({column:u,outerRecordKey:y,expander:!0,columnType:"child",json:o}),data:S,isTotal:b,isDrag:ce,lazyload:!0,totalBodyHeight:30,totalData:p,totalColumns:ot.call(a,_e,h,o,!0),scroll:{x:!0,y:g||300},sort:m,updateColumnHandle:P.bind(a),bodyStyle:{minHeight:"30px"},tableType:"transfer",foldingRowChange:function(e){a.state.transferTable[n].isEllipsis=e,a.setState({transferTable:a.state.transferTable})},bodyDisplayInRow:a.state.transferTable[n].isEllipsis,colsSettingParam:M.call(a,a.state.meta,c),cancelCustomRightMenu:Te}))}return console.log("没有找到子表数据呀！！"),l.a.createElement("div",null)},fullColumns:He,getMasterData:function(e){var t=Object.values(e.masterSelData);Ne.selected.mainSortInfoObj;return t=t.map((function(e){return e.data}))},getSelectedFullData:function(e){for(var t=e.masterSelData,a=e.childSelData,r=[],l=function(){var e,l=s[n];if((e=a[l])&&Object.values(e).length)Object.values(a[l]).forEach((function(e){var a=Object.assign({},e.data.values||e.data||{}),n=Object.assign({},t[l].data||{});a.headKey=n.key||n.headKey;var s=Object.assign({},a,n);s.headKey&&(s.headKey=l),s.key=a.key,r.push(s)}));else{var o=t[l].data;o.headKey=l,o.key=l,r.push(o)}},n=0,s=Object.keys(a);n<s.length;n++)l();return r},getScaleData:lt,getTheLongestPrecision:function(e,t){if(""===e||null===e||"null"===e)return t;var a=String(e).split("."),r=String(t).split("."),l=a.length>=2?String(a[1]).length:0,n=r.length>=2?String(r[1]).length:0,s=Number.parseFloat(t);if("number"!=typeof Number(e)||Number.isNaN(Number(e)))return t;e=B(e,"number"),t=B(t,"number"),s=Number.parseFloat(e)+Number.parseFloat(Number(t));var o=String(s).split("."),i=o.length>=2?String(o[1]).length:0;if(n>=l){for(var c="",d=0;d<n-i;d++)c+="0";var u=String(s).includes(".")?"".concat(s).concat(c):"".concat(s,".").concat(c);return Number(u).toFixed(n)}for(var f="",h=0;h<l-i;h++)f+="0";var m=String(s).includes(".")?"".concat(s).concat(f):"".concat(s,".").concat(f);return Number(m).toFixed(l)},handleClearAllSelected:function(){var e=a.state.transferTable.allSelected;e&&(e.masterCheckedId=[],e.selectedData.selAll=!1,e.selectedData.masterSelData={},e.selectedData.childSelData={},e.masterAmount=0,e.bodyAmount=0,e.selIds={}),Ne.selected.masterCheckedId=[],Ne.selected.selectedData.selAll=!1,Ne.selected.selectedData.masterSelData={},Ne.selected.selectedData.childSelData={},Ne.selected.masterAmount=0,Ne.selected.bodyAmount=0,a.setState({transferTable:a.state.transferTable},(function(){G&&G()}))},handleChangeView:function(){"function"==typeof j&&j()},showChangeViewBtn:C,handleGenerateClick:function(){var e=[],t=[];m?function(){for(var r=a.state.transferTable,l=Ne.selected.selectedData.masterSelData,n=Ne.selected.selectedData.childSelData,s=0,o=Object.keys(r);s<o.length;s++){"allSelected"===o[s]&&function(){for(var a=r.allSelected,s=JSON.parse(JSON.stringify(a.selectedData.masterSelData)),o=JSON.parse(JSON.stringify(a.selectedData.childSelData)),i=[],c=[],d=function(){var a=f[u],r=s[a].data;if(r.saga_status&&"1"===r.saga_status.value)return"continue";if(o[a])for(var d=function(){var e=m[h],t=o[a][e].data.values||o[a][e].data;if(t.saga_status&&"1"===t.saga_status.value)return"continue";te&&te.map((function(r){var l;(o[a][e].data.values||o[a][e].data).hasOwnProperty(r)&&i.push((Ee(l={},r,e),Ee(l,"pk",e),Ee(l,"ts",t.ts&&t.ts.value),l))}))},h=0,m=Object.keys(o[a]);h<m.length;h++)d();if(n[a])for(var b=function(){var e=p[y],t=n[a][e].data.values||n[a][e].data;if(t.saga_status&&"1"===t.saga_status.value)return"continue";te&&te.map((function(r){var l;(n[a][e].data.values||n[a][e].data).hasOwnProperty(r)&&c.push((Ee(l={},r,e),Ee(l,"pk",e),Ee(l,"ts",t.ts&&t.ts.value),l))}))},y=0,p=Object.keys(n[a]);y<p.length;y++)b();ee&&ee.map((function(r){var n,o;s[a].data.hasOwnProperty(r)&&e.push({head:(n={},Ee(n,r,a),Ee(n,"pk",a),Ee(n,"ts",s[a].data.ts&&s[a].data.ts.value),n),bodys:i});l[a]&&l[a].data.hasOwnProperty(r)&&t.push({head:(o={},Ee(o,r,a),Ee(o,"pk",a),Ee(o,"ts",l[a].data.ts&&l[a].data.ts.value),o),bodys:c})})),i=[]},u=0,f=Object.keys(s);u<f.length;u++)d()}()}i.ViewModel.setData("multiTransferIds",e),i.ViewModel.setData("transferIds",t)}():function(){var t=Ne.selected.selectedData.masterSelData,r=Ne.selected.selectedData.childSelData;if(t)for(var l=function(){var a=o[s],l=t[a].data;if(l.saga_status&&"1"===l.saga_status.value)return"continue";var n=[],i={};if(r){var c=Ne.selected.selectedData.childSelData[a];if(c)for(var d=function(){var e=f[u],t=c[e].data.values||c[e].data;if(t.saga_status&&"1"===t.saga_status.value)return"continue";var r={};if(ae&&ae.forEach((function(e){var l=t[e];if(l)r[e]=l;else{var n=Ne.selected.selectedData.masterSelData[a],s=(n.data.values||n.data)[e];s&&(r[e]=s)}})),Q&&Q.body&&Q.body.length>0){var l,s={},o=je(Q.body);try{for(o.s();!(l=o.n()).done;){var i=l.value;s[i]=t[i]&&t[i].value}}catch(e){o.e(e)}finally{o.f()}n.push(Ie({bodyKeyVal:s},r))}else n.push(Ie({pk:e,ts:t.ts&&t.ts.value},r))},u=0,f=Object.keys(c);u<f.length;u++)d()}if(Q&&Q.head&&Q.head.length>0){var h,m=je(Q.head);try{for(m.s();!(h=m.n()).done;){var b=h.value;i[b]=t[a].data[b]&&t[a].data[b].value}}catch(e){m.e(e)}finally{m.f()}}else{var y=t[a].ts?t[a].ts:t[a].data&&t[a].data.ts&&t[a].data.ts.value;y=t[a].data.headTs?t[a].data.headTs.value:y,i={pk:a,ts:y}}var p={};ae&&ae.forEach((function(e){var r=t[a].data[e];r&&(p[e]=r)})),e.push(Ie({head:i,bodys:n},p))},s=0,o=Object.keys(t);s<o.length;s++)l();i.ViewModel.setData("transferIds",e),a.state.transferTable[n]=Ne}(),"function"==typeof O&&(i.ViewModel.setData("isCreateTransferList",!0),O(e))},isTotal:this.myState.status.totalStatusOfTransferTable,isHeadTotal:this.myState.status.headTotalStatusOfTransferTable,isBodyTotal:this.myState.status.bodyTotalStatusOfTransferTable,isFullTotal:this.myState.status.fullTotalStatusOfTransferTable,isMultiChild:m,onCheckedChange:U,onCheckboxChangeChild:Ye,selectArea:W,selectedAmount:ct,setSelectedColumns:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,s=[],o=Le.showFullTable||"simple"===Y,i=t["page-transferTable-0006"]?t["page-transferTable-0006"]:"操作-3",c=o?{title:l.a.createElement("span",null,i),attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:100,fixed:"right",visible:!0,render:function(e,s,o){return l.a.createElement("div",{className:"row-remove",onClick:function(){var t=a.state.transferTable[n].selected.selectedData,l=(a.state.transferTable[n][n].tableType,t.childSelData[s.key]||t.childSelData[s.headKey]),i=[];if(l)for(var c=0,d=Object.keys(l);c<d.length;c++){var u=d[c];i.push(l[u].data.values?l[u].data.values:l[u].data)}Z&&Z(s,r?[]:i),Le.showFullTable?tt(0,s):Ge(e,s,o,!0)}},t["page-transferTable-0001"]||"移除")}}:{title:i,attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:100,visible:!0,render:function(e,r,s){return l.a.createElement("div",{className:"row-remove",onClick:function(){var t=a.state.transferTable[n].selected.selectedData,l=(a.state.transferTable[n][n].tableType,t.childSelData[r.key]||t.childSelData[r.headKey]),o=[];if(l)for(var i=0,c=Object.keys(l);i<c.length;i++){var d=c[i];o.push(l[d].data.values?l[d].data.values:l[d].data)}Z&&Z(r,o),Le.showFullTable?tt(0,r):Ge(e,r,s,!0)}},t["page-transferTable-0001"]||"移除")}};return e&&e.map((function(e){"checkbox"!==e.attrcode&&e.label!==i&&s.push(e)})),[].concat(s,[c])},showChildIndex:T,showSeletedArea:F,showSeletedBtn:K,showGenerateBtn:J,showMasterIndex:g,tableType:Y,transferBtnText:D,transferTable:Ne,totalKey:se,totalTitle:ie,isDrag:ce,sortType:ue,containerSelector:k,getMultiChildChangeWidth:be,onExpandedRowsChange:function(e){"function"==typeof fe&&fe(e)},meta:this.state.meta,headTableId:n,bodyTableId:c,fullTableId:d,defaultOperateColumnHidden:ve,autoHeight:ke,cancelCustomRightMenu:Te,fieldId:ye})},createTransferList:function(e){var t=this,a=e.headcode,r=e.bodycode,n=e.transferListId,s=e.dataSource,o=e.componentInitFinished,i=e.onTransferItemClick,c=e.onTransferItemSelected,d=e.onUpdateLastActiveFormData,u=e.onGrandSonsDataUpdate;s&&(this.transferTableDataSource=s),a&&(this.transferListCardHeadCode=a),this.myState.transferListAreas={headcode:a,bodycode:r},this.myState.transferList.hasOwnProperty(n)||(this.myState.transferList[n]={transformForm:{activeIndex:0,show:!0,listData:{},list:[],first:0}});var f=this.myState.transferList[n].transformForm,h=a;this.onTransferItemClick=i,this.onTransferItemSelected=c;var m=this;0===f.first?f.first++:1===f.first&&(f.list[0]&&c&&c(f.list[0].data,f.list[0].complete,f.activeIndex,"edit"),f.first++);var b=f.show&&f.list&&f.list.length>1;return l.a.createElement(we,{_this:this,dataAreaCode:h,dataSource:s,componentInitFinished:o,flag:b,handleTransformListClick:function(e,l){var s=m.form.getFormStatus(a);u&&u(n,"browse"===s),a&&r&&V.call(t,n,a,r,"browse"===s,d),f.activeIndex=l,t.setState({transformForm:f},(function(){if("function"==typeof c){var t=f.list[l].complete?f.list[l].formStatus:"edit";c(e,f.list[l].complete,l,t)}}))},transformForm:f,transferListId:n})},createMultiTransferTable:function(e,t){var a=this,r=e.showAll,n=void 0!==r&&r,o=e.allHeadId,c=e.allBodyId,d=e.allFullTableId,u=e.dataSource,f=e.headPkIds,h=e.bodyPkIds,m=e.containerSelector,b=e.componentInitFinished,y=e.transferBtnText,v=e.showSeletedBtn,g=void 0===v||v,S=e.showGenerateBtn,T=void 0===S||S,w=e.onTransferBtnClick,D=e.onCheckedChange,O=e.onSelectedBtnClick,k=e.onChangeViewClick,I=e.showChangeViewBtn,j=void 0===I||I,x=e.showAllList,C=e.onTabClick,N=e.selectArea,R=e.selectedHeaderRender,F=e.onClearAll,_=e.onSelectedItemRemove,V=e.tabActiveIndex,J=e.hideTabs,q=e.totalKey,Y=void 0===q?[]:q,W=e.totalTitle,U=void 0===W?[]:W,G=e.isDrag,Z=void 0!==G&&G,Q=e.sortType,X=void 0===Q?{mode:"single",backSource:!1,sortFun:function(e,t){L(t,o,a,e)}}:Q,ee=e.cancelCustomRightMenu,te=void 0!==ee&&ee,ae=e.onExpandedChange,re=e.customSortRule,le=(e.fieldid,e.currentPageId),ne=e.isShowBodyAmount,se=void 0===ne||ne,oe=e.autoHeight,ie=void 0===oe||oe;u&&(this.transferTableDataSource=u),this.state.transferTable.hasOwnProperty("allSelected")||(this.state.transferTable.allSelected={activeTab:V||"0",selectedShow:!1,masterAmount:0,bodyAmount:0,masterCheckedId:[],selIds:{},showFullTable:!1,isEllipsis:!0,selectedData:{selAll:!1,masterSelData:{},childSelData:{}}},V&&C&&C(V)),this.state.transferTable.allSelected.params=Array.isArray(t)?t.map((function(e){return{bodyTableId:e.bodyTableId,headTableId:e.headTableId,fullTableId:e.fullTableId,fieldId:e.fieldId}})):[];var ce=c&&this.state.meta[c]?this.state.meta[c].items.map((function(e,t){return H(e,X,re),e&&e.required&&delete e.required,e})):[],de=o&&this.state.meta[o]?this.state.meta[o].items.map((function(e,t){return H(e,X,re),e&&e.required&&delete e.required,e})):[],ue=d&&this.state.meta[d]?this.state.meta[d].items.map((function(e,t){return H(e,X,re),e&&e.required&&delete e.required,e})):[],fe=this.state.transferTable,he=this.myState.status.traversalStatus,me=function(e,t){if(e){var r,l=st(e);try{for(l.s();!(r=l.n()).done;){r.value.istotal&&(a.myState.status["".concat(t,"TotalStatusOfTransferTable")]=!0,a.myState.status["".concat(t,"traversalStatus")]=!0)}}catch(e){l.e(e)}finally{l.f()}}};he||function(e){var t,r=st(e);try{for(r.s();!(t=r.n()).done;){var l=t.value;if(l.istotal)a.myState.status.totalStatusOfTransferTable=!0,a.myState.status.traversalStatus=!0;else if(l.data){var n,s=st(l.data);try{for(s.s();!(n=s.n()).done;){n.value.istotal&&(a.myState.status.totalStatusOfTransferTable=!0,a.myState.status.traversalStatus=!0)}}catch(e){s.e(e)}finally{s.f()}}if(a.myState.status.traversalStatus)break}}catch(e){r.e(e)}finally{r.f()}me.call(a,e[0].data,"head"),me.call(a,e[1].data,"full"),me.call(a,e[2].data,"body")}.bind(this,[{data:de,title:"columns"},{data:ue,title:"columns"},{data:ce,title:"columns"}])(),this.onTabClick=C,this.onClearAll=F,this.onSelectedItemRemove=_;var be=[],ye=t.length;if(J)for(var pe=0;pe<ye;pe++)J.includes(pe)&&be.push(pe);else be=t;var ve=function(e,t,r){var n=[],s=le||a.state&&a.state.meta.pageid;return a.state.meta[o]||e?((e||a.state.meta[o].items).map((function(e){var u=e.width;u||(u=120);var f=null;f="customer"!==e.itemtype&&e.visible&&!e.render?function(a,n,u){if(n[e.attrcode]){var f=n[e.attrcode].display,h=n[e.attrcode].value,m=n[e.attrcode].scale,b="";if(b=f||0===f?f:h,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(b=Object(i.changeTime)(h,"YYYY-MM-DD HH:mm:ss"),b=Object(i.formatDatetime)(b,"datetime")):"timepicker"==e.itemtype?(b=h,b=Object(i.formatDatetime)(b,"time")):(b=Object(i.changeTime)(h),b=Object(i.formatDatetime)(b,"date"))),"residtxt"===e.itemtype){var y=Object(i.getLangCode)(),v=(e.languageMeta||[]).filter((function(e){return e.languageCode==y}));v.length>0&&("1"===v[0].index&&(v[0].index=""),n[e.attrcode+v[0].index]&&n[e.attrcode+v[0].index].value&&(b=n[e.attrcode+v[0].index].value))}if("switch"==e.itemtype?b=function(e,t){return e?t&&t["page-transferTable-0020"]||"是":t&&t["page-transferTable-0021"]||"否"}(h,t):"checkbox_switch"==e.itemtype&&(b=E(h,!1,t)),"number"==e.itemtype){var g=m||(e.scale?e.scale:"-1");b=z(b,g),b=Object(i.formatAcuracy)(b,g),b=Object(i.formatNumber)(b)}return l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},b?l.a.createElement(p,{overlay:b},e.hyperlinkflag&&b?l.a.createElement("a",{href:"javascript:;",className:"hyper-link",onClick:function(t){t.stopPropagation();var a="child"===r?c:"full"===r?d:o;Object(i.linkTo)(s,a,e.attrcode,h||b)}},b):l.a.createElement("span",null,b," ")):l.a.createElement("span",null,b," "))}}:"customer"===e.itemtype?e.render:function(t,r,n){return r[e.attrcode]?l.a.createElement(p,{className:"tooltip-word-color",overlay:e.render.call(null,t,r,n),noEllipsis:!0},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":a.state.transferTable.allSelected.isEllipsis,"three-line-and-ellipsis":!a.state.transferTable.allSelected.isEllipsis})},e.render.call(null,t,r,n))):r[e.attrcode]},e.visible&&n.push(lt(lt({},e),{},{width:u,render:f,key:e.attrcode,dataIndex:e.dataIndex||e.attrcode,title:l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"text-td-span-wrapper","  ").concat(e.className||""),style:{color:dt.includes(e.color)?"":e.color}}," ",e.label)}))})),console.log("子表模板数据",n),n):[]},ge=function(e,t,r,n){var s={label:n&&n["page-transferTable-0007"]||"序号-8",itemtype:"customer",attrcode:"numberindex",dataIndex:"numberindex",visible:!0,width:60,className:"col-customer-numberindex",render:function(e,t,a){return l.a.createElement("span",null,a+1)}},o={label:l.a.createElement("span",null,n["page-transferTable-0006"]||"操作-6"),attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:100,fixed:"right",visible:!0,className:"col-customer-operate",render:function(e,r,s){return l.a.createElement("div",{className:"row-remove",onClick:we.bind(a,"body",t.key,r.key,r,!0)},n&&n["page-transferTable-0001"]||"移除-1")}};return[s].concat(at(e),[o])},Se=function(){var e=a.state.transferTable.allSelected;if(e){var t=0;Object.values(e.selIds).forEach((function(e){t+=e.length||1}));var r=Object.keys(e.selIds).length||e.masterCheckedId&&e.masterCheckedId.length,l=t;return e.masterAmount=r,e.bodyAmount=l,{masterAmount:r,bodyAmount:l}}}(),Te=function(e,t,a){var r=fe[e].selected,l=r.masterCheckedId,n=r.selectedData;!l.includes(t)&&a?l.push(t):-1===l.indexOf(t)||n.selAll||l.splice(l.indexOf(t),1)},we=function(e,t,r,l,n){for(var s,o=0,i=Object.keys(fe);o<i.length;o++){var c=i[o],d="allSelected"!==c?fe[c].selected.selectedData:fe[c].selectedData,u=d.masterSelData,f=d.childSelData;if(d.selAll=!1,"head"===e)"allSelected"===c&&(s=f[t]&&f[t]),delete u[t],delete f[t],delete fe.allSelected.selIds[t],delete fe.allSelected.selectedData.masterSelData[t];else if("body"===e&&f[t]){var h=Object.keys(f[t]);if(h.length){var m,b=st(h);try{for(b.s();!(m=b.n()).done;){var y=m.value,p=fe.allSelected.selIds[t];p&&y===r&&p.includes(y)&&p.splice(p.indexOf(y),1),y===r&&delete f[t][y],0===Object.keys(f[t]||{}).length&&(delete f[t],delete u[t],delete fe.allSelected.selIds[t],delete fe.allSelected.selectedData.masterSelData[t],delete fe.allSelected.selectedData.childSelData[t])}}catch(e){b.e(e)}finally{b.f()}}!Object.keys(f[t]||{}).length&&u[t]&&(delete f[t],delete u[t],delete fe.allSelected.selIds[t],delete fe.allSelected.selectedData.masterSelData[t],delete fe.allSelected.selectedData.childSelData[t])}"allSelected"!==c&&Te(c,t,!1)}fe.allSelected.masterCheckedId=Object.keys(fe.allSelected.selIds||{}),a.setState({transferTable:fe},(function(){var e=s?Object.values(s).map((function(e){return e.data.values||e.data})):[];_&&_(l,n?[]:e)}))},De=function(e,t){var a,r,l;try{a=e.toString().split(".")[1].length}catch(e){a=0}try{r=t.toString().split(".")[1].length}catch(e){r=0}return(e*(l=Math.pow(10,Math.max(a,r)))+t*l)/l},Oe=function(e,t,r,l,n){a.props._this;var s,o="",c={},d=[],u={},f=st(r);try{for(f.s();!(s=f.n()).done;){var h=s.value;c[h.attrcode]={value:"",display:""},h.istotal&&"number"===h.itemtype&&(d.push(h.attrcode),u[h.attrcode]=h.scale)}}catch(e){f.e(e)}finally{f.f()}if("body"===t){o=n.headKey||n.key;var m=e.childSelData[o];if(m)for(var b=0,y=Object.keys(m);b<y.length;b++){var p,v=y[b],g=st(d);try{for(g.s();!(p=g.n()).done;){var S=p.value;if(m[v].data.values?m[v].data.values.hasOwnProperty(S):m[v].data.hasOwnProperty(S)){var T=m[v].data.values||m[v].data;if(T[S]&&"object"===tt(T[S])){var w=T[S].scale?T[S].scale:u[S],D=T[S]?T[S].value:0;if(c[S].value){var O=Object(i.sum)(Number.parseFloat(D),Number.parseFloat(c[S].value.replace(/,/g,"")));c[S].scale=w>c[S].scale?w:c[S].scale,c[S].value=ke(String(O),c[S].scale)}else c[S].scale=w,c[S].value=ke(D,w)}}}}catch(e){g.e(e)}finally{g.f()}}}return[c]},ke=function(e,t){var a=String(e).replace(/,/g,""),r=Number(t);if(!a)return 0;var l=r>=0?a.split(".")[0].length+r+1:a.split(".")[0].length;if(-1!==a.indexOf(".")){a.split(".");Number.isNaN(r)||-1===r||(a=0===r?String(a).split(".")[0]:String(a).padEnd(l,"0"))}else{if(!Number.isNaN(r)&&-1!==r)if(0===r)a=String(a);else a=(a+".").padEnd(Number(l),"0")}return Object(i.commafy)(a)},Ie=function(e,t,r){var n=[];return n.push({label:r["page-transferTable-0007"]||"序号-6",attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:60,className:"col-customer-numberindex",render:function(e,t,a){return l.a.createElement("span",{title:r["page-transferTable-0010"]||"合计-7"},r["page-transferTable-0010"]||"合计-7")}}),e.map((function(e){var t=e.width;t||(t=120);var r=null;r="customer"!==e.itemtype&&e.visible&&!e.render?function(t,a,r){if(a[e.attrcode]){var n=a[e.attrcode].display,s=a[e.attrcode].value,o="";if(o=n||0===n?n:s,Object(i.isTimeType)(e.itemtype)&&("datetimepicker"==e.itemtype?(o=Object(i.changeTime)(s,"YYYY-MM-DD HH:mm:ss"),o=Object(i.formatDatetime)(o,"datetime")):"timepicker"==e.itemtype?(o=s,o=Object(i.formatDatetime)(o,"time")):(o=Object(i.changeTime)(s),o=Object(i.formatDatetime)(o,"date"))),"residtxt"===e.itemtype){var c=Object(i.getLangCode)(),d=(e.languageMeta||[]).filter((function(e){return e.languageCode==c}));d.length>0&&("1"===d[0].index&&(d[0].index=""),a[e.attrcode+d[0].index]&&a[e.attrcode+d[0].index].value&&(o=a[e.attrcode+d[0].index].value))}return"number"===e.itemtype&&(o=Object(i.formatNumber)(o)),l.a.createElement("span",{className:"".concat("number"===e.itemtype?"number-td-span-wrapper":"")},o?l.a.createElement(p,{overlay:o},l.a.createElement("span",null,o)):o)}}:"customer"===e.itemtype?e.render:function(t,r,n){return r[e.attrcode]?l.a.createElement(p,{className:"tooltip-word-color",placement:"left",delay:1,overlay:e.render.call(null,t,r,n),noEllipsis:!0},l.a.createElement("div",{className:$()("col-customer-render-unit",{"single-line-and-ellipsis":a.state.transferTable.allSelected.isEllipsis,"three-line-and-ellipsis":!a.state.transferTable.allSelected.isEllipsis})},e.render.call(null,t,r,n))):r[e.attrcode]},e.visible&&"checkbox"!==e.attrcode&&"numberindex"!==e.attrcode&&n.push(lt(lt({},e),{},{render:r,width:t,key:e.attrcode,title:e.label}))})),n.length&&(n[n.length-1].render=function(){}),n};if(Array.isArray(be))return l.a.createElement(et,{_this:this,allHeadId:o,headPkIds:f,showAllList:x,onSelectedBtnClick:O,getAllSelectedData:function(){for(var e=a.state.transferTable,t=a.state.transferTable.allSelected,r=0,l=Object.keys(e);r<l.length;r++){var n=l[r];if("allSelected"!==n){for(var s=e[n].selected,o=s.selectedData.childSelData,i=s.selectedData.masterSelData,c=0,d=Object.keys(i);c<d.length;c++){var u=d[c];Object.keys(i).length&&(t.selectedData.masterSelData.hasOwnProperty(u)||(t.masterCheckedId.push(u),t.selIds[u]=[],t.selectedData.masterSelData[u]=i[u]))}for(var f=0,h=Object.keys(o);f<h.length;f++){var m=h[f];if(Object.keys(o).length)if(t.selectedData.childSelData.hasOwnProperty(m))for(var b=0,y=Object.keys(o[m]);b<y.length;b++){var p=y[b];t.selectedData.childSelData[m].hasOwnProperty(p)||(t.selectedData.childSelData[m][p]=o[m][p],t.selIds[m].push(p))}else{t.selectedData.childSelData[m]=o[m];for(var v=0,g=Object.keys(o[m]);v<g.length;v++){var S=g[v];t.selIds[m].push(S)}}}t.masterAmount=t.masterCheckedId.length;for(var T=0,w=Object.keys(t.selIds);T<w.length;T++){var D=w[T];t.bodyAmount+=t.selIds[D].length||1}}}a.state.transferTable.allSelected=t},bodyPkIds:h,clearAllSelectedData:function(){fe.allSelected.selectedData.masterSelData={},fe.allSelected.selectedData.childSelData={},fe.allSelected.selIds={},fe.allSelected.masterAmount=0,fe.allSelected.bodyAmount=0,fe.allSelected.masterCheckedId=[];for(var e=0,t=Object.keys(fe);e<t.length;e++){var r=t[e];"allSelected"!==r&&(fe[r].selected.masterCheckedId=[],fe[r].selected.selectedData.selAll=!1,fe[r].selected.selectedData.masterSelData={},fe[r].selected.selectedData.childSelData={})}a.setState({transferTable:fe},(function(){F&&F()}))},componentInitFinished:b,createNewCol:ve,cutParams:be,dataSource:u,expandedRowRender:function(e,r,n,o){var d=a.state.transferTable.allSelected.activeTab,u=t[d].bodyTableId;if(!a.state.meta[u]||!a.state.meta[u].items)return l.a.createElement("span",null);var f=a.state.meta[u].items,h=a.props.sortType;if(f instanceof Array&&f.length>0){f=ge.call(a,f,e,r,n);var m,b,y;m=function(e){var t=[];return e.map((function(e,a){e=e.values||e,t.push(e)})),t}(Object.values(fe.allSelected.selectedData.childSelData[e.key]||{}).map((function(e){return e.data})));var p=a.myState.status.bodyTotalStatusOfTransferTable,v=document&&document.querySelector(".".concat(o));return b=A(m,p,v||s.a.findDOMNode(a)),y=A(m,p,v||s.a.findDOMNode(a),!0),l.a.createElement("div",{style:{height:"".concat(b,"px")},className:"transfertable-expand-wraper",fieldid:Object(i.getSysFieldid)("selected-list-".concat(r,"_table"))},l.a.createElement(ct,{columns:ve(f,n,"child"),sort:h,data:m,lazyload:!0,isDrag:Z,scroll:{x:!0,y:y||450},isTotal:p,totalBodyHeight:30,totalData:Oe(fe.allSelected.selectedData,"body",ve(f,n),0,e),totalColumns:Ie(ve(f,n),0,n),updateColumnHandle:P.bind(a),bodyStyle:{minHeight:"30px"},tableType:"transfer",foldingRowChange:function(e){a.state.transferTable.allSelected.isEllipsis=e,a.setState({transferTable:a.state.transferTable})},bodyDisplayInRow:a.state.transferTable.allSelected.isEllipsis,cancelCustomRightMenu:te,colsSettingParam:M.call(a,a.state.meta,c)}))}},fullColumns:ue,getMasterData:function(e){return Object.values(e.masterSelData).map((function(e){return e.data}))},getScaleData:ke,getSelectedFullData:function(e){for(var t=e.masterSelData,a=e.childSelData,r=[],l=function(){var e,l=s[n];if((e=a[l])&&Object.values(e).length)Object.values(a[l]).forEach((function(e){var a=Object.assign({},e.data.values||e.data||{}),n=Object.assign({},t[l].data||{});a.headKey=n.key||n.headKey;var s=Object.assign({},a,n);s.headKey&&(s.headKey=l),s.key=a.key,r.push(s)}));else{var o=t[l].data;o.headKey=l,o.key=l,r.push(o)}},n=0,s=Object.keys(a);n<s.length;n++)l();return r},getTheLongestPrecision:function(e,t){if(""===e||null===e||"null"===e)return t;var a=String(e).split("."),r=String(t).split("."),l=a.length>=2?String(a[1]).length:0,n=r.length>=2?String(r[1]).length:0;e=B(e,"number"),t=B(t,"number");var s=De(Number.parseFloat(e),Number.parseFloat(Number(t))),o=String(s).split("."),i=o.length>=2?String(o[1]).length:0;if(n>=l){for(var c="",d=0;d<n-i;d++)c+="0";var u=String(s).includes(".")?"".concat(s).concat(c):"".concat(s,".").concat(c);return Number(u).toFixed(n)}for(var f="",h=0;h<l-i;h++)f+="0";var m=String(s).includes(".")?"".concat(s).concat(f):"".concat(s,".").concat(f);return Number(m).toFixed(l)},handleChangeView:function(){"function"==typeof k&&k()},showChangeViewBtn:j,handleGenerateClick:function(){var e=[];f&&h||console.error("没有传主表或子表主键字段");for(var t=0,a=Object.keys(fe);t<a.length;t++){var r=a[t];"allSelected"!==r&&function(){for(var t=fe[r].selected,a=JSON.parse(JSON.stringify(t.selectedData.masterSelData)),l=JSON.parse(JSON.stringify(t.selectedData.childSelData)),n=[],s=function(){var t=i[o],r=a[t].data;if(r.saga_status&&"1"===r.saga_status.value)return"continue";if(l[t])for(var s=function(){var e=d[c],a=l[t][e].data.values||l[t][e].data;if(a.saga_status&&"1"===a.saga_status.value)return"continue";h&&h.map((function(r){var s;(l[t][e].data.values||l[t][e].data).hasOwnProperty(r)&&n.push((nt(s={},r,e),nt(s,"ts",a.ts&&a.ts.value),s))}))},c=0,d=Object.keys(l[t]);c<d.length;c++)s();f&&f.map((function(r){var l;a[t].data.hasOwnProperty(r)&&e.push({head:(l={},nt(l,r,t),nt(l,"ts",a[t].data.ts&&a[t].data.ts.value),l),bodys:n})})),n=[]},o=0,i=Object.keys(a);o<i.length;o++)s()}()}i.ViewModel.setData("multiTransferIds",e),"function"==typeof w&&w(e)},handleTabClick:function(e){if(a.state.transferTable.allSelected){var r=t[e].headTableId;K.call(a,r),a.state.transferTable.allSelected.activeTab=e}a.setState({transferTable:a.state.transferTable},(function(){a.infoExchangeController&&a.infoExchangeController.publish("heightChange",{area:t[e].headTableId}),"function"==typeof C&&C(e)}))},isTotal:this.myState.status.totalStatusOfTransferTable,isHeadTotal:this.myState.status.headTotalStatusOfTransferTable,isBodyTotal:this.myState.status.bodyTotalStatusOfTransferTable,isFullTotal:this.myState.status.fullTotalStatusOfTransferTable,params:t,showAll:n,onTabClick:this.onTabClick,onCheckedChange:D,showSeletedBtn:g,showGenerateBtn:T,selectArea:N,selectedHeaderRender:R,selectedAmount:Se,isShowBodyAmount:se,setSelectedColumns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r={label:l.a.createElement("span",null,t["page-transferTable-0007"]||"序号-9"),title:l.a.createElement("span",null,t["page-transferTable-0007"]||"序号-9"),attrcode:"numberindex",itemtype:"customer",dataIndex:"numberindex",visible:!0,width:80,className:"col-customer-selected-numberindex",render:function(e,t,a){return l.a.createElement("span",null,a+1)}},n={};return n=fe.allSelected.showFullTable?{title:l.a.createElement("span",{bbq:"已选拉平移除"},t["page-transferTable-0006"]||"操作-7"),attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:81,visible:!0,fixed:"right",className:"col-customer-operate",render:function(e,r,n){return l.a.createElement("div",{className:"row-remove",onClick:fe.allSelected.showFullTable?we.bind(a,"body",r.headKey,r.key,r,!0):we.bind(a,"head",r.key,"",r,!1)},t&&t["page-transferTable-0001"]||"移除-6")}}:{title:l.a.createElement("span",{bbq:"已选非拉平移除"},t["page-transferTable-0006"]||"操作-9"),attrcode:"operate",itemtype:"customer",dataIndex:"operate",width:81,visible:!0,className:"col-customer-operate",render:function(e,r,n){return l.a.createElement("div",{className:"row-remove",onClick:fe.allSelected.showFullTable?we.bind(a,"body",r.headKey,r.key,r):we.bind(a,"head",r.key,"",r,!1)},t&&t["page-transferTable-0001"]||"移除-3")}},[r].concat(at(e),[n])},transferBtnText:y,transferTable:fe,totalKey:Y,totalTitle:U,containerSelector:m,sortType:X,onExpandedChange:ae,meta:this.state.meta,allBodyId:c,allFullTableId:d,autoHeight:ie})},getTransferTableValue:function(e){return e?this.state.transferTable[e]:this.state.transferTable},setTransferTableValue:function(e,t,a,r,l,n){this.state.transferTable[e].selected.selectedData.selAll=!1,this.state.transferTable.hasOwnProperty("allSelected")||(this.state.transferTable.allSelected={activeTab:"0",selectedShow:!1,masterAmount:0,bodyAmount:0,masterCheckedId:[],selIds:{},showFullTable:!1,selectedData:{selAll:!1,masterSelData:{},childSelData:{}}});var s,o,c=this.state.transferTable[e].selected.selectedData.childSelData||{},d=this.state.transferTable[e].selected.selectedData.masterSelData||{},u=this.state.transferTable.allSelected.selectedData.childSelData||{},f=this.state.transferTable.allSelected.selectedData.masterSelData||{},h=[],m={},b={};"string"==typeof r&&"string"==typeof l&&(s=r,o=l),"simple"===this.state.transferTable[e][e].tableType?a.rows&&a.rows.length>0&&a.rows.map((function(e,t){e.rowId=e.values[s].value,e.values.key=e.rowId,e.values.rowIndex=t,b[e.rowId]="simple",h.push(e),d[e.rowId]&&d[e.rowId].data&&(e.values.headTs=e.values.ts,d[e.rowId].data=JSON.parse(JSON.stringify(e.values||{}))),f[e.rowId]&&f[e.rowId].data&&(e.values.headTs=e.values.ts,f[e.rowId].data=JSON.parse(JSON.stringify(e.values||{})))})):a&&a.length>0&&a.forEach((function(a,n){var i=a.head[e].rows[0];if(Array.isArray(r)&&r.map((function(e){Object.keys(i.values).includes(e)&&(s=e)})),!i.rowId&&0!==i.rowId){if(!i.values[s])return console.error("setTransferTableValue方法中，主表Id没找到"),!1;i.rowId=i.values[s].value}i.values.key=i.rowId,i.values.rowIndex=n,b[i.rowId]="head",h.push(i),d[i.rowId]&&d[i.rowId].data&&(i.values.headTs=i.values.ts,d[i.rowId].data=JSON.parse(JSON.stringify(i.values||{}))),f[i.rowId]&&f[i.rowId].data&&(i.values.headTs=i.values.ts,f[i.rowId].data=JSON.parse(JSON.stringify(i.values||{})));var y=a.body[t].rows.map((function(e,t){if(Array.isArray(l)&&l.map((function(t){Object.keys(e.values).includes(t)&&(o=t)})),e.childId||0===e.childId||(e.values[o]||console.error("setTransferTableValue方法中，子表Id没找到"),e.childId=e.values[o]&&e.values[o].value),e.values.key=e.childId,e.values.rowIndex=t,e.values.parentRowId=i.rowId,b[e.childId]="body",c[i.rowId]&&c[i.rowId][e.childId]&&c[i.rowId][e.childId].data){var a=c[i.rowId][e.childId].data||{};c[i.rowId][e.childId].data=JSON.parse(JSON.stringify(a.values?e:e.values))}if(u[i.rowId]&&u[i.rowId][e.childId]&&u[i.rowId][e.childId].data){var r=u[i.rowId][e.childId].data||{};u[i.rowId][e.childId].data=JSON.parse(JSON.stringify(r.values?e:e.values))}return e}));m[i.rowId]={rows:y}})),this.state.transferTable[e][e].masterId=s,this.state.transferTable[e][e].childId=l,this.state.transferTable[e][e].outerData=h,this.state.transferTable[e][e].bodyData={data:m},K.call(this,e),this.transferTableDataSource&&i.ViewModel.setData("".concat(this.transferTableDataSource,"_ID"),{headPk:r,bodyPk:l}),this.myState.transferTableRelationship=b,this.setState({transferTable:this.state.transferTable},(function(){n&&n()}))},insertTransferTableValue:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rowId",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"childId";if("[object Array]"!==Object.prototype.toString.call(a))return console.warn("invalid data, please check");var n=this.state.transferTable,s=this.state.transferTable[e][e].bodyData.data;s||(this.state.transferTable[e][e].bodyData={data:{}},s=this.state.transferTable[e][e].bodyData.data);var o=this.state.transferTable[e][e].outerData,i=(this.state.transferTable[e].selected.selectedData.childSelData,this.state.transferTable[e].selected.selectedData.masterSelData,this.state.transferTable.allSelected.selectedData.childSelData,this.state.transferTable.allSelected.selectedData.masterSelData,o.reduce((function(e,t){var a=t.values;return e[t.rowId||(a[r]||{}).value]=t,e}),{}));console.log(a,n,s,o,i),a.forEach((function(e){var t=e.rowId,a=e.values,n=e.index,c=e.children,d=t||(a[r]||{}).value;if(!i[d]){var u=JSON.parse(JSON.stringify(e));u.rowId=d,delete u.children,u.values.key=d,u.values.rowIndex=n||o.length,u.values.headKey=d,o.push(u)}if(c&&c.length>0){s[d]||(s[d]={},s[d].rows=[]);var f=s[d].rows,h=f.reduce((function(e,t){var a=t.values;return e[t.childId||(a[l]||{}).value]=t,e}),{});console.log("bodyRowsObjbodyRowsObj",h),c.forEach((function(e){var t=e.childId,a=e.values,r=e.index,n=t||(a[l]||{}).value;h[n]||(e.values.key=n,e.values.rowIndex=r,e.values.headKey=d,e.values.parentRowId=d,e.childId=n,f.push(e))}))}})),this.setState({transferTable:this.state.transferTable})},setChildTransferTableData:function(e,t,a,r){var l=this,n=t.key;a.rows.map((function(e,t){if(!e.rowId&&0!==e.rowId){if(!e.values[r])return console.error("传入数据中没有找到子表Id"),!1;e.rowId=e.values[r].value}e.values.key=e.rowId})),this.state.transferTable[e].selected.selectedData.masterSelData[n]&&(this.state.transferTable[e].selected.selectedData.childSelData[n]={},a.rows.map((function(t,a){l.state.transferTable[e].selected.selectedData.childSelData[n][t.values.key]={sel:!0,data:t}}))),this.setState({transferTable:this.state.transferTable})},getTransferTableSelectedValue:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null,r=null;e&&(r=(a=i.ViewModel.getData(e))?a.transferTable:null);var l=this.state.transferTable,n=(l.allSelected,D(l,["allSelected"]));if(r&&(n=r),n){for(var s={},o=0,c=Object.keys(n);o<c.length;o++){var d=c[o];if("allSelected"!==d){s.hasOwnProperty(d)||(s[d]=[]);var u=n[d].selected.selectedData.masterSelData,f=n[d].selected.selectedData.childSelData,h=n[d][d].bodyTableId;if("simple"===n[d][d].tableType)for(var m=0,b=Object.keys(u);m<b.length;m++){var y=b[m];s[d].push(u[y].data)}else for(var p=function(){var e=g[v],t=[],a=[];0==t.length&&t.push({values:u[e].data}),Object.values(f[e]).forEach((function(e){var t=e.data.values||e.data;a.push({values:t})})),s[d].push({head:w({},d,{rows:t}),body:w({},h,{rows:a})})},v=0,g=Object.keys(f);v<g.length;v++)p()}}return t?JSON.parse(JSON.stringify(s)):s}if(!e)return console.error("未传dataSource");for(var S=i.ViewModel.getData(e),T=(S.allSelected,D(S,["allSelected"])),O={},k=0,I=Object.keys(T);k<I.length;k++){var j=I[k];O.hasOwnProperty(j)||(O[j]=[]);var x=T[j].selected.selectedData.masterSelData,C=T[j].selected.selectedData.childSelData,E=T[j][j].bodyTableId;if("simple"===T[j][j].tableType)for(var N=0,A=Object.keys(x);N<A.length;N++){var P=A[N];O[j].push(x[P].data)}else for(var M=function(){var e=R[L],t=[],a=[];0==t.length&&t.push({values:x[e].data}),Object.values(C[e]).forEach((function(e){var t=e.data.values||e.data;a.push({values:t})})),O[j].push({head:w({},j,{rows:t}),body:w({},E,{rows:a})})},L=0,R=Object.keys(C);L<R.length;L++)M()}return JSON.parse(JSON.stringify(O))},setTransferListValue:function(e,t,a){var r=this,l=this.myState.transferList[e].transformForm,n=this.myState.transferListComponent,s=[],o=[];l.listData.data=t&&t,t.length&&(l.show=!0),t&&t.map((function(e){s.push({complete:!1,data:e,browseData:{head:{},body:{},grandSons:{}}}),o.push(!1)})),l.list=s,l.completeArr=o,l.activeIndex=0,n&&n.setState({transformForm:l},(function(){var e=l.list[0].complete?l.list[0].formStatus:"add";r.onTransferItemSelected&&r.onTransferItemSelected(l.list[0].data,l.list[0].complete,l.activeIndex,e),r.transferListCardHeadCode&&r.form.resetItemWidth(r.transferListCardHeadCode)}))},getSelectedListDisplay:function(e){return"all"===e?this.state.transferTable.allSelected&&this.state.transferTable.allSelected.selectedShow:this.state.transferTable[e]&&this.state.transferTable[e].selected?this.state.transferTable[e].selected.selectedShow:void 0},getTransformFormDisplay:function(e){if(this.myState.transferList[e]&&this.myState.transferList[e].transformForm)return this.myState.transferList[e]&&this.myState.transferList[e].transformForm&&this.myState.transferList[e].transformForm.show},setTransformFormStatus:function(e,t){var a=t.status,r=t.index,l=t.onChange,n=t.isNext,s=void 0===n||n,o=t.isTriggerSelected,i=void 0===o||o,c=this.myState.transferListAreas,d=c.headcode,u=c.bodycode;if(void 0===a||void 0===e)return!1;var f=this.myState.transferList[e],h=f.transformForm,m=h.activeIndex,b=h.list,y=h.completeArr,p=r||m;u&&V.call(this,e,d,u,a),a?b[p]&&(b[p].complete=!0,y[p]=!0,f.transformForm.currentData=b[p].data):b.length>0&&(f.transformForm.currentData=b.splice(p,1)[0].data,y.splice(p,1)),b.length>0?this.transferTable.changeNextTransformForm(e,a,l,s,d,b.length,i):this.transferTable.returnTransferTableList(e,s)},getTransformFormStatus:function(e,t){if(void 0===e)return!1;var a,r=this.myState.transferList[e].transformForm,l=(r.activeIndex,!0),n=O(r.list);try{for(n.s();!(a=n.n()).done;){!1===a.value.complete&&(l=!1)}}catch(e){n.e(e)}finally{n.f()}return l},changeNextTransformForm:function(e,t,a,r,l,n,s){var o=this,i=this.myState.transferList[e],c=this.myState.transferListComponent,d=i.transformForm,u=d.activeIndex,f=d.completeArr,h=u,m=f.indexOf(!1,u),b=m<0?u:m;m<0&&(m=f.indexOf(!1),b=f.indexOf(f[f.findIndex((function(e,t){return t===u+1}))],u)),b=f.every((function(e){return e}))?t?u:0:m,d.list[h]||(h=d.list.length-1),b=r?b:u,d.activeIndex=b,c&&c.setState({transferList:this.myState.transferList},(function(){var t=d.currentData&&d.currentData,r=d.list[b]&&d.list[b].data,i=d.list[b]&&d.list[b].complete;a&&a(t,r,u);var c=o.myState.transferList[e].transformForm.activeIndex>=d.list.length?u:o.myState.transferList[e].transformForm.activeIndex;!function(){var e=document.clientHeight||document.body.clientHeight,t=document.querySelector(".transfer-list-main-wrapper"),a=document.querySelector(".active-transfer-list-item");if(t&&a){var r=t.getBoundingClientRect().top,l=a.getBoundingClientRect().top,n=a.offsetTop,s=a.getBoundingClientRect().bottom;if(n+(s-l)>e-r-48){var o=t.scrollTop;"function"==typeof t.scrollTo&&t.scrollTo(0,s-e+o+60)}else"function"==typeof t.scrollTo&&t.scrollTo(0,0)}}();var f=d.list[b].complete?d.list[b].formStatus:"add";s&&o.onTransferItemSelected&&o.onTransferItemSelected(r,i,c,f),1==n&&o.form.resetItemWidth&&o.form.resetItemWidth(l)}))},returnTransferTableList:function(e){var t=this.myState.transferList,a=this.myState.transferListComponent;t[e].selected&&(t[e].selected.selectedShow=!1),t[e].transformForm.show=!1,a&&a.setState({transferList:t},(function(){}))},getTransformFormAmount:function(e){return this.myState.transferList[e]&&this.myState.transferList[e].transformForm.list.length},setMultiTransformFormStatus:function(e,t){var a=t.status,r=t.selId,l=t.success;if(void 0===a||void 0===e||void 0===r)return!1;var n=this.state.transferTable[e],s=n[e],o=n.transformForm,i=n.selected,c=i.selectedData,d=i.masterCheckedId,u=(o.activeIndex,o.list,o.completeArr,s.bodyData.data);Array.isArray(r)&&r.forEach((function(e){if(a)for(var t=function(){var t=l[r];u[t].rows.map((function(t,a,r){t.rowId===e&&r.splice(a,1)})),0===u[t].rows.length&&s.outerData.map((function(e,a,r){e.rowId===t&&r.splice(a,1)}))},r=0,l=Object.keys(u);r<l.length;r++)t();else for(var n=0,o=Object.keys(c.childSelData);n<o.length;n++){var i=o[n],f=Object.keys(c.childSelData[i]).includes(e)?i:null;-1!==d.indexOf(i)&&f===i&&d.splice(d.indexOf(i),1)}for(var h=0,m=Object.keys(c.childSelData);h<m.length;h++){var b=m[h];delete c.childSelData[b][e],"{}"===JSON.stringify(c.childSelData[b])&&(delete c.childSelData[b],delete c.masterSelData[b])}})),"function"==typeof l&&l()},changeViewType:function(){for(var e=this.state.transferTable,t=0,a=Object.keys(e);t<a.length;t++){var r=a[t];"allSelected"!==r?e[r][r].showFullTable=!e[r][r].showFullTable:e[r].showFullTable=!e[r].showFullTable}this.setState({transferTable:this.state.transferTable})},getTransferTableSelectedId:function(){return i.ViewModel.getData("transferIds")},getTransferTableAllSelectedId:function(e){var t=null,a=null;e&&(a=(t=i.ViewModel.getData(e))?t.transferTable:null);var r=this.state.transferTable,l=(r.allSelected,D(r,["allSelected"]));a&&(l=a);for(var n={},s=0,o=Object.keys(l);s<o.length;s++){var c=o[s];if("allSelected"!==c){var d=l[c].selected.selectedData,u=d.childSelData,f=d.masterSelData;n[c]={head:Object.keys(f),body:{}};for(var h=0,m=Object.keys(u);h<m.length;h++){var b=m[h];n[c].body[b]=Object.keys(u[b])}}}return n},getTransferTableMultiSelectedId:function(){return i.ViewModel.getData("multiTransferIds")},getTransformFormCompleteStatus:function(e,t){var a=t||this.myState.transferList[e].transformForm.activeIndex;return!!(this.myState.transferList&&this.myState.transferList[e]&&this.myState.transferList[e].transformForm.list&&this.myState.transferList[e].transformForm&&this.myState.transferList[e].transformForm.list&&this.myState.transferList[e].transformForm.list[a])&&this.myState.transferList[e].transformForm.list[a].complete},setTransferListValueByIndex:function(e,t,a,r){var l=this.myState.transferListComponent;this.myState.transferList[e].transformForm.list[a].data=t,l&&l.setState({transferList:this.myState.transferList})},setMultiSelectedValue:function(e,t,a,r,l){var n=this.state.transferTable.allSelected.selectedData,s=n.masterSelData,o=n.childSelData;a.map((function(a){var n,i=a.head[e].rows[0].values;Array.isArray(r)&&r.map((function(e){i.hasOwnProperty(e)&&(n=i[e].value,i.key=n)})),s[n]={data:JSON.parse(JSON.stringify(i)),sel:!0},a.body[t].rows.map((function(e){var t;Array.isArray(l)&&l.map((function(a){e.values.hasOwnProperty(a)&&(t=e.values[a]&&e.values[a].value,e.childId=t,e.values.key=t)})),o.hasOwnProperty([n])?o[n][t]={data:JSON.parse(JSON.stringify(e)),sel:!0}:o[n]=w({},t,{data:JSON.parse(JSON.stringify(e)),sel:!0})}))})),this.setState({transferTable:this.state.transferTable})},setSavedTransferTableDataPk:function(e,t){var a=t||this.transferTableDataSource,r=i.ViewModel.getData("".concat(a,"_PK"))||[];if("string"===T(e))r.includes(e)||(r.push(e),i.ViewModel.setData("".concat(a,"_PK"),r));else{var l,n=O(e);try{for(n.s();!(l=n.n()).done;){var s=l.value;r.includes(s)||r.push(s)}}catch(e){n.e(e)}finally{n.f()}i.ViewModel.setData("".concat(a,"_PK"),r)}},clearAllSelectedData:function(e){var t=this.state.transferTable;t.allSelected.selectedData.masterSelData={},t.allSelected.selectedData.childSelData={},t.allSelected.selIds={},t.allSelected.masterCheckedId=[],t.allSelected.masterAmount=0,t.allSelected.bodyAmount=0;for(var a=0,r=Object.keys(t);a<r.length;a++){var l=r[a];"allSelected"!==l&&(t[l].selected.masterCheckedId=[],t[l].selected.selectedData.selAll=!1,t[l].selected.selectedData.masterSelData={},t[l].selected.selectedData.childSelData={},t[l].selected.masterAmount=0,t[l].selected.bodyAmount=0)}this.setState({transferTable:t},(function(){e&&e()}))},hasCache:function(e){var t=!1,a=i.ViewModel.getData(e);return a&&a.transferTable&&(t=!!Object.keys(a.transferTable).length),t},deleteCache:function(e){i.ViewModel.setData(e,null)},setRowDataByIndex:function(e,t,a){var r=this.state.transferTable;if(e&&null!=a&&t){if(t.parentRowId){var l=t.key,n=t.parentRowId;r[e][e].bodyData.data[t.parentRowId].rows[a].values=t;var s=r[e].selected.selectedData.childSelData,o=r.allSelected.selectedData.childSelData;o[n]&&o[n][l]&&o[n][l].data&&o[n][l].data.values?o[n][l].data.values=t:o[n]&&o[n][l]&&(o[n][l].data=t),s[n]&&s[n][l]&&s[n][l].data&&s[n][l].data.values?s[n][l].data.values=t:s[n]&&s[n][l]&&(s[n][l].data=t)}else{var i=t.headKey||t.key;r[e][e].outerData[a].values=t;var c=r[e].selected.selectedData.masterSelData,d=r.allSelected.selectedData.masterSelData;c[i]&&c[i].data.values?c[i].data.values=t:c[i]&&(c[i].data=t),d[i]&&d[i].data.values?d[i].data.values=t:d[i]&&(d[i].data=t)}this.setState({transferTable:r})}else console.error("setRowDataByIndex方法缺失参数")},savePk:function(e,t){var a=i.ViewModel.getData("".concat(e,"_PK"))||[];if("string"===T(t))a.includes(t)||(a.push(t),i.ViewModel.setData("".concat(e,"_PK"),a));else{var r,l=O(t);try{for(l.s();!(r=l.n()).done;){var n=r.value;a.includes(n)||a.push(n)}}catch(e){l.e(e)}finally{l.f()}i.ViewModel.setData("".concat(e,"_PK"),a)}},getPkCache:function(e){return i.ViewModel.getData("".concat(e,"_PK"))},getTransferListValue:function(e){return this.myState.transferList[e]},updateTransferListValue:function(e,t){var a=this,r=t.transformForm,l=this.myState.transferListComponent;this.myState.transferList[e]=t,l&&l.setState({transferList:this.myState.transferList},(function(){var e=r.list[0].complete?r.list[0].formStatus:"add";a.onTransferItemSelected&&a.onTransferItemSelected(r.list[0].data,r.list[0].complete,r.activeIndex,e),a.transferListCardHeadCode&&a.form.resetItemWidth(a.transferListCardHeadCode)}))},updateTransferList:function(e){var t=this.myState.transferListComponent;if(e)this.myState.transferList[e].transformForm;else t&&t.setState({transferList:this.myState.transferList}),console.log("自助更新")},getTransferTableCache:function(e){var t=i.ViewModel.getData(e);return t?t.transferTable:null},deleteItems:function(e){var t=this.state.transferTable;if(Array.isArray(e))for(var a=0,r=Object.keys(t);a<r.length;a++){var l=r[a];if("allSelected"!==l)for(var n=0,s=Object.keys(t[l]);n<s.length;n++){var o=s[n];if("selected"!==o&&"transformForm"!==o){var i=t[l][o],c=i.bodyData&&Object.keys(i.bodyData).length?i.bodyData.data:null,d=i.outerData&&i.outerData.length?i.outerData:null;if(d&&(t[l][o].outerData=d.filter((function(t){return!e.includes(t.rowId)}))),c){var u,f=O(e);try{var h=function(){var e=u.value;if(c.hasOwnProperty(e))delete c[e];else for(var a=function(){var a=n[r];c[a].rows=c[a].rows.filter((function(t){return e!==t.childId})),c[a].rows.length||(delete c[a],t[l][o].outerData=d.filter((function(e){return e.rowId!==a})))},r=0,n=Object.keys(c);r<n.length;r++)a()};for(f.s();!(u=f.n()).done;)h()}catch(e){f.e(e)}finally{f.f()}}}else if("selected"===o){var m=t[l][o],b=m.masterCheckedId,y=m.selectedData,p=y.childSelData,v=y.masterSelData;b=b.filter((function(t){return!e.includes(t)}));for(var g=0,S=Object.keys(v);g<S.length;g++){var T=S[g];e.includes(T)&&delete v[T]}for(var w=function(){var a=k[D];if(e.includes(a))delete p[a];else for(var r=0,n=Object.keys(p[a]);r<n.length;r++){var s=n[r];e.includes(s)&&(delete p[a][s],Object.keys(p[a]).length||(delete p[a],v[a]&&delete v[a],t[l][o].masterCheckedId=b.filter((function(e){return e!==a}))))}},D=0,k=Object.keys(p);D<k.length;D++)w();t[l][o].masterAmount=b.length;var I,j=0,x=O(b);try{for(x.s();!(I=x.n()).done;){var C=I.value;p&&p[C]&&(j+=Object.keys(p[C]).length)}}catch(e){x.e(e)}finally{x.f()}t[l][o].bodyAmount=j}}else for(var E=t[l].selIds,N=(t[l].bodyAmount,t[l].masterAmount,0),A=Object.keys(E);N<A.length;N++){var P=A[N],M=E[P].length;E[P]=E[P].filter((function(t){return!e.includes(t)})),E[P].length||(delete E[P],M,1)}}this.setState({transferTable:t})},updateTransferTableValue:function(e,t,a,r,l){for(var n=this.state.transferTable[e].selected.bodyAmount,s=this.state.transferTable[e].selected.selectedData.childSelData,o=this.state.transferTable[e][e].bodyData.data,i=0,c=Object.entries(a);i<c.length;i++){var d=S(c[i],2),u=d[0],f=d[1];if(o.hasOwnProperty(u))for(var h=o[u].rows.reduce((function(e,t,a){return e[t.childId]=a,e}),{}),m=Object.keys(h),b=0,y=Object.keys(f);b<y.length;b++){var p=y[b];if(m.includes(p)){var v=h[p];o[u].rows[v].values=g(g({},o[u].rows[v].values),f[p])}else o[u].rows.push({status:0,values:g({headKey:u,key:p},f[p]),childId:p})}if(s.hasOwnProperty(u))for(var T=0,w=Object.keys(f);T<w.length;T++){var D=w[T];s[u].hasOwnProperty(D)?s[u][D].data={status:0,values:g(g({},s[u][D].data.values),a[u][D]),childId:D}:(s[u][D]={data:{status:0,values:g({headKey:u,key:D},a[u][D]),childId:D},sel:!0},this.state.transferTable[e].selected.bodyAmount=n+1)}}this.setState({transferTable:this.state.transferTable})},updateTransferListValueByIndex:function(e,t,a,r){for(var l=this,n=this.myState.transferList[e].transformForm,s=this.myState.transferListComponent,o=this.myState.transferList[e].transformForm.list[a].data.head,i=this.myState.transferList[e].transformForm.list[a].data.body,c=t.head,d=t.body,u=0,f=Object.keys(c);u<f.length;u++){var h=f[u];if(c[h]&&o.hasOwnProperty(c[h].areacode)){var m,b=O(o[h].rows);try{for(b.s();!(m=b.n()).done;){var y,p=m.value,v=O(c[h].rows);try{for(v.s();!(y=v.n()).done;){var g=y.value;p.values=Object.assign(p.values,g.values)}}catch(e){v.e(e)}finally{v.f()}}}catch(e){b.e(e)}finally{b.f()}}}for(var S=0,T=Object.keys(d);S<T.length;S++){var w=T[S];if(d[w]&&i.hasOwnProperty(d[w].areacode)){var D,k=O(i[w].rows);try{for(k.s();!(D=k.n()).done;)for(var I=D.value,j=d[w].rows.length,x=0;x<j;x++){var C=d[w].rows[x];I.rowid===C.rowid&&(d[w].rows[x].values=Object.assign(I.values,C.values))}}catch(e){k.e(e)}finally{k.f()}this.myState.transferList[e].transformForm.list[a].data.body[w].rows=d[w].rows}}return s&&s.setState({transferList:this.myState.transferList},(function(){var t=l.myState.transferList[e].transformForm.list,a=t.reduce((function(e,t){return e+(t.complete?1:0)}),0);1===l.myState.transferList[e].transformForm.list.length?l.onTransferItemSelected&&l.onTransferItemSelected(l.myState.transferList[e].transformForm.list[0].data,l.myState.transferList[e].transformForm.list[0].complete,l.myState.transferList[e].transformForm.activeIndex,r||"browse"):a===t.length&&l.onTransferItemSelected&&l.onTransferItemSelected(l.myState.transferList[e].transformForm.list[n.activeIndex].data,l.myState.transferList[e].transformForm.list[n.activeIndex].complete,l.myState.transferList[e].transformForm.activeIndex,r||"browse")})),this.myState.transferList[e].transformForm.list[a].data},updateTransformFormStatus:function(e,t){var a=t.status,r=t.index;if(void 0===a||void 0===e)return!1;var l=this.myState.transferList[e].transformForm,n=l.activeIndex,s=l.list,o=l.completeArr,i=r||n;a?s[i]&&(s[i].complete=!0,s[i].formStatus="browse",o[i]=!0):s.length>0&&(s[i].complete=!1,s[i].formStatus="edit",o[i]=!1)},updateActiveGrandsonData:function(e,t,a,r){var l=this.myState.transferList[e].transformForm,n=l.activeIndex,s=!0===a?"browse":"edit",o=l.list[r||n].data;o&&(o.grandSons=JSON.parse(JSON.stringify(t)),"browse"===s&&(l.list[n].browseData.grandSons=JSON.parse(JSON.stringify(t))))},getTheTransferListDataSavedLastTime:function(e,t){var a=this.myState.transferList[e].transformForm,r=a.activeIndex||t;return a.list[r].browseData},setTheCheckRows:function(e,t){var a=this.state.transferTable,r=a.allSelected,l=a[e].selected,n=a[e][e],s=n.outerData,o=n.bodyData.data,i=n.tableType,c=s.length,d=r.selectedData.childSelData,u=l.selectedData.childSelData,f=l.selectedData.masterSelData,h=r.selectedData.masterSelData;if("nest"===i||"full"===i){for(var m=0,b=function(){var e,a=S(p[y],2),n=a[0],o=a[1],i=o.rows.length,c=0,b=O(o.rows);try{for(b.s();!(e=b.n()).done;){var v=e.value;if(t.includes(v.childId)){u[n]||(u[n]={}),d[n]||(d[n]={}),r.selIds[n]||(r.selIds[n]=[]),r.selIds[n].includes(v.childId)||r.selIds[n].push(v.childId);var T=s.filter((function(e){return e.rowId===n}))[0];u[n][v.childId]={data:{childId:v.childId,values:v.values},sel:!0},d[n][v.childId]={data:{childId:v.childId,values:v.values},sel:!0},l.bodyAmount+=1,r.bodyAmount+=1,c+=1,f[n]||(l.masterAmount+=1,m+=1,f[n]={sel:!0,data:g({},T.values)}),h[n]||(r.masterAmount+=1,h[n]={sel:!0,data:{values:T.values}})}}}catch(e){b.e(e)}finally{b.f()}i!==c||l.masterCheckedId.includes(n)||l.masterCheckedId.push(n),i!==c||r.masterCheckedId.includes(n)||r.masterCheckedId.push(n)},y=0,p=Object.entries(o);y<p.length;y++)b();c===m&&(l.selectedData.selAll=!0)}else{var v,T=0,w=O(s);try{for(w.s();!(v=w.n()).done;){var D=v.value,k=D.rowId;t.includes(k)&&(u[k]||(u[k]={}),d[k]||(u[k]={}),r.selIds[k]||(r.selIds[k]=[]),f[k]||(l.masterAmount+=1,T+=1,f[k]={sel:!0,data:g({},D.values)}),h[k]||(r.masterAmount+=1,h[k]={sel:!0,data:{values:D.values}}),l.masterCheckedId.includes(k)||l.masterCheckedId.push(k),r.masterCheckedId.includes(k)||r.masterCheckedId.push(k))}}catch(e){w.e(e)}finally{w.f()}T===c.length&&(l.selectedData.selAll=!0)}var I=s.every((function(e){return r.masterCheckedId.includes(e.rowId)}));r.selectedData.selAll=I,this.setState({transferTable:a})},updateHeadRowByKey:function(e,t,a){var r=this.state.transferTable;if(e&&null!=a&&t){var l=r[e][e].outerData,n=this.state.transferTable[e].selected.selectedData.masterSelData,s=r.allSelected;if(this.state.transferTable[e][e].outerData=l.map((function(e){return e.rowId===a?(e.values=g(g({},e.values),t),e):e})),n[a]&&(this.state.transferTable[e].selected.selectedData.masterSelData[a].data=g(g({},n[a].data),t)),s){var o=s.selectedData.masterSelData;o[a]&&(this.state.transferTable.allSelected.selectedData.masterSelData[a].data=g(g({},o[a].data),t))}this.setState({transferTable:this.state.transferTable})}else console.error("setRowDataByIndex方法缺失参数")},cancelRowsChecked:function(e,t){var a=this.state.transferTable,r=a.allSelected,l=a[e].selected,n=r.selectedData.childSelData,s=r.selectedData.masterSelData,o=l.selectedData.childSelData,i=l.selectedData.masterSelData;if(t.length){for(var c in l.selectedData.selAll=!1,r.selectedData.selAll=!1,l.masterAmount=l.masterAmount-t.length,l.masterCheckedId=l.masterCheckedId.filter((function(e){return!t.includes(e)})),r.masterCheckedId=l.masterCheckedId.filter((function(e){return!t.includes(e)})),r.masterAmount=r.masterAmount-t.length,o)if(t.includes(c)){var d=Object.keys(o[c]).length;for(var u in l.bodyAmount=l.bodyAmount-d,r.bodyAmount=r.bodyAmount-d,r.selIds)console.log(r.selIds),t.includes(u)&&r.selIds&&delete r.selIds[u];n[c]&&delete n[c],delete o[c]}for(var f in i)t.includes(f)&&(s[f]&&delete s[f],delete i[f])}this.setState({transferTable:a})},refreshTransferTable:function(e){"multi"===e&&this.setState({multiDelete:!0}),"single"===e&&this.setState({singleDelete:!0})},whenTransferTableUnmount:J,getCurrentTransferTableStatus:function(e,t,a){var r=this.state.transferTable;if(a){var l=this.ViewModel.getData(a);r=l&&l.transferTable?l.transferTable:r}return"activeTab"===e?r.allSelected.activeTab:"showFullTable"===e?t&&r[t]&&r[t][t].showFullTable:null},setTransferTableSelectedId:function(e,t){var a=this,r=t.isMultiChild,l=t.cacheItem,n=t.generateKeys,s=t.bodyPkIds,o=t.headPkIds,c=this.state.transferTable[e],d=[],u=[];r?function(){for(var e=a.state.transferTable,t=c.selected.selectedData.masterSelData,r=c.selected.selectedData.childSelData,l=0,n=Object.keys(e);l<n.length;l++){"allSelected"===n[l]&&function(){for(var a=e.allSelected,l=JSON.parse(JSON.stringify(a.selectedData.masterSelData)),n=JSON.parse(JSON.stringify(a.selectedData.childSelData)),i=[],c=[],f=function(){var e=m[h];if(n[e])for(var a=function(){var t=b[f],a=n[e][t].data.values||n[e][t].data;s&&s.map((function(r){var l;(n[e][t].data.values||n[e][t].data).hasOwnProperty(r)&&i.push((w(l={},r,t),w(l,"pk",t),w(l,"ts",a.ts&&a.ts.value),l))}))},f=0,b=Object.keys(n[e]);f<b.length;f++)a();if(r[e])for(var y=function(){var t=v[p],a=r[e][t].data.values||r[e][t].data;s&&s.map((function(l){var n;(r[e][t].data.values||r[e][t].data).hasOwnProperty(l)&&c.push((w(n={},l,t),w(n,"pk",t),w(n,"ts",a.ts&&a.ts.value),n))}))},p=0,v=Object.keys(r[e]);p<v.length;p++)y();o&&o.map((function(a){var r,n;l[e].data.hasOwnProperty(a)&&d.push({head:(r={},w(r,a,e),w(r,"pk",e),w(r,"ts",l[e].data.ts.value),r),bodys:i});t[e]&&t[e].data.hasOwnProperty(a)&&u.push({head:(n={},w(n,a,e),w(n,"pk",e),w(n,"ts",t[e].data.ts.value),n),bodys:c})})),i=[]},h=0,m=Object.keys(l);h<m.length;h++)f()}()}i.ViewModel.setData("multiTransferIds",d),i.ViewModel.setData("transferIds",u)}():function(){var e=c.selected.selectedData.masterSelData,t=c.selected.selectedData.childSelData;if(e)for(var a=function(){var a=s[r],o=[],i={};if(t){var u=c.selected.selectedData.childSelData[a];if(u)for(var f=function(){var e=m[h],t=u[e].data.values||u[e].data,r={};if(l&&l.forEach((function(e){var l=t[e];if(l)r[e]=l;else{var n=c.selected.selectedData.masterSelData[a],s=(n.data.values||n.data)[e];s&&(r[e]=s)}})),n&&n.body&&n.body.length>0){var s,i={},d=O(n.body);try{for(d.s();!(s=d.n()).done;){var f=s.value;i[f]=t[f]&&t[f].value}}catch(e){d.e(e)}finally{d.f()}o.push(g({bodyKeyVal:i},r))}else o.push(g({pk:e,ts:t.ts&&t.ts.value},r))},h=0,m=Object.keys(u);h<m.length;h++)f()}if(n&&n.head&&n.head.length>0){var b,y=O(n.head);try{for(y.s();!(b=y.n()).done;){var p=b.value;i[p]=e[a].data[p]&&e[a].data[p].value}}catch(e){y.e(e)}finally{y.f()}}else i={pk:a,ts:e[a].data.headTs?e[a].data.headTs.value:e[a].ts};var v={};l&&l.forEach((function(t){var r=e[a].data[t];r&&(v[t]=r)})),d.push(g({head:i,bodys:o},v))},r=0,s=Object.keys(e);r<s.length;r++)a();i.ViewModel.setData("transferIds",d)}()},updateDataByRefresh:function(e,t,a,r){var l=this,n=this.state.transferTable[e][e];if("string"==typeof e&&n&&Array.isArray(a)){var s=function(){var e=n.outerData,s=n.bodyData,o=e.length,i=a.length,c=s&&s.data&&Object.keys(s.data),d={};if(!o||!i)return{v:void 0};if(a.forEach((function(e,a){var r={};for(var l in e)if(e.hasOwnProperty(l)){var n=e[l];r[l]={value:n.value||n,display:n.display||n}}d[e[t]]=r})),e.forEach((function(e,a){var l=e.values,n=l[t],s=n&&n.value,o=d[s];o&&n&&(l=Object.assign(l,o),"1"===o.saga_status&&(l.saga_errormesg=r))})),c)for(var u in s=s.data){if(s.hasOwnProperty(u))s[u].rows.forEach((function(e,a){var l=e.values,n=l[t],s=n&&n.value,o=d[s];o&&n&&(l=Object.assign(l,o),"1"===o.saga_status&&(l.saga_errormesg=r))}))}l.setState({transferTable:l.state.transferTable})}();if("object"===T(s))return s.v}}}},3:function(e,t){e.exports=a},5:function(e,t,a){var r;!function(){"use strict";var a={}.hasOwnProperty;function l(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var n=typeof r;if("string"===n||"number"===n)e.push(r);else if(Array.isArray(r)&&r.length){var s=l.apply(null,r);s&&e.push(s)}else if("object"===n)for(var o in r)a.call(r,o)&&r[o]&&e.push(o)}}return e.join(" ")}e.exports?(l.default=l,e.exports=l):void 0===(r=function(){return l}.apply(t,[]))||(e.exports=r)}()},6:function(e,t){e.exports=r},8:function(e,t){e.exports=l},904:function(e,t,a){}})}));
//# sourceMappingURL=index.js.map