/*! @ncctag content */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@platform/api/index"),require("@platform/base/index"),require("react-dom"),require("@platform/template/index")):"function"==typeof define&&define.amd?define(["react","@platform/api/index","@platform/base/index","react-dom","@platform/template/index"],t):"object"==typeof exports?exports["@platform/table-core/index"]=t(require("react"),require("@platform/api/index"),require("@platform/base/index"),require("react-dom"),require("@platform/template/index")):e["@platform/table-core/index"]=t(e.React,e["@platform/api/index"],e["@platform/base/index"],e.ReactDOM,e["@platform/template/index"])}(window,(function(e,t,r,n,o){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../../../../platform/",r(r.s=1892)}({0:function(t,r){t.exports=e},1:function(e,r){e.exports=t},106:function(e,t,r){"use strict";r.r(t),r.d(t,"HotKeys",(function(){return j})),r.d(t,"withHotKeys",(function(){return k})),r.d(t,"FocusTrap",(function(){return O})),r.d(t,"HotKeyMapMixin",(function(){return C}));var n=r(2),o=r.n(n),a=r(0),i=r.n(a),l=r(20),c=r.n(l),u=r(6),s=r.n(u),f=r(63),d=r.n(f),p=r(64),y=r.n(p),h=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},b=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},g=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},w=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},O=function(e){function t(){return h(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,a.Component),b(t,[{key:"render",value:function(){var e=this.props,t=e.component,r=e.children,n=g(e,["component","children"]);return i.a.createElement(t,v({tabIndex:"-1"},n),r)}}]),t}();function S(e,t){return!c()(e,t)}O.propTypes={onFocus:o.a.func,onBlur:o.a.func,component:o.a.oneOfType([o.a.func,o.a.string]),children:o.a.node},O.defaultProps={component:"div"};var j=function(e){function t(e,r){h(this,t);var n=w(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return n.onFocus=n.onFocus.bind(n),n.onBlur=n.onBlur.bind(n),n}return m(t,a.Component),b(t,[{key:"getChildContext",value:function(){return{hotKeyParent:this,hotKeyMap:this.__hotKeyMap__}}},{key:"componentWillMount",value:function(){this.updateMap()}},{key:"updateMap",value:function(){var e=this.buildMap();return!c()(e,this.__hotKeyMap__)&&(this.__hotKeyMap__=e,!0)}},{key:"buildMap",value:function(){var e=this.context.hotKeyMap||{},t=this.props.keyMap||{};return v({},e,t)}},{key:"getMap",value:function(){return this.__hotKeyMap__}},{key:"componentDidMount",value:function(){var e=r(107);this.__mousetrap__=new e(this.props.attach||s.a.findDOMNode(this)),this.updateHotKeys(!0)}},{key:"componentDidUpdate",value:function(e){this.updateHotKeys(!1,e)}},{key:"componentWillUnmount",value:function(){this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(null),this.__mousetrap__&&this.__mousetrap__.reset()}},{key:"updateHotKeys",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.props.handlers,n=void 0===r?{}:r,o=t.handlers,a=void 0===o?n:o,i=this.updateMap();(e||i||S(n,a))&&(this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(null),this.syncHandlersToMousetrap())}},{key:"syncHandlersToMousetrap",value:function(){var e=this,t=this.props.handlers,r=void 0===t?{}:t,n=this.getMap(),o=[],a=this.__mousetrap__;Object.keys(r).forEach((function(t){var a=r[t];(function(e,t){var r=e[t];return r?Array.isArray(r)?r:[r]:[t]})(n,t).forEach((function(t){var r=void 0;y()(t)&&(r=t.action,t=t.sequence),o.push({callback:function(t,r){if((d()(e.props.focused)?e.props.focused:e.__isFocused__)&&r!==e.__lastChildSequence__)return e.context.hotKeyParent&&e.context.hotKeyParent.childHandledSequence(r),a(t,r)},action:r,sequence:t})}))})),a.reset(),o.forEach((function(e){var t=e.sequence,r=e.callback,n=e.action;return a.bind(t,r,n)}))}},{key:"childHandledSequence",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.__lastChildSequence__=e,this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(e)}},{key:"render",value:function(){var e=this.props,t=(e.keyMap,e.handlers,e.focused,e.attach,e.children),r=g(e,["keyMap","handlers","focused","attach","children"]);return i.a.createElement(O,v({},r,{onFocus:this.onFocus,onBlur:this.onBlur}),t)}},{key:"onFocus",value:function(){var e;this.__isFocused__=!0,this.props.onFocus&&(e=this.props).onFocus.apply(e,arguments)}},{key:"onBlur",value:function(){var e;this.__isFocused__=!1,this.props.onBlur&&(e=this.props).onBlur.apply(e,arguments),this.context.hotKeyParent&&this.context.hotKeyParent.childHandledSequence(null)}}]),t}();j.propTypes={keyMap:o.a.object,handlers:o.a.object,focused:o.a.bool,attach:o.a.any,children:o.a.node,onFocus:o.a.func,onBlur:o.a.func},j.childContextTypes={hotKeyParent:o.a.any,hotKeyMap:o.a.object},j.contextTypes={hotKeyParent:o.a.any,hotKeyMap:o.a.object};var k=function(e){return function(t){return function(r){function n(e){h(this,n);var t=w(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t._setRef=t._setRef.bind(t),t.state={handlers:{}},t}return m(n,a.PureComponent),b(n,[{key:"componentDidMount",value:function(){this.setState({handlers:this._ref.hotKeyHandlers})}},{key:"_setRef",value:function(e){this._ref=e}},{key:"render",value:function(){var r=this.state.handlers;return i.a.createElement(j,{component:"document-fragment",keyMap:e,handlers:r},i.a.createElement(t,v({ref:this._setRef},this.props)))}}]),n}()}};function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{contextTypes:{hotKeyMap:o.a.object},childContextTypes:{hotKeyMap:o.a.object},getChildContext:function(){return{hotKeyMap:this.__hotKeyMap__}},componentWillMount:function(){this.updateMap()},updateMap:function(){var e=this.buildMap();return!c()(e,this.__hotKeyMap__)&&(this.__hotKeyMap__=e,!0)},buildMap:function(){var t=this.context.hotKeyMap||{},r=this.props.keyMap||{};return v({},t,e,r)},getMap:function(){return this.__hotKeyMap__}}}},107:function(e,t,r){var n;!function(o,a,i){if(o){for(var l,c={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},u={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},f={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},d=1;d<20;++d)c[111+d]="f"+d;for(d=0;d<=9;++d)c[d+96]=d.toString();m.prototype.bind=function(e,t,r){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,r),this},m.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},m.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},m.prototype.reset=function(){return this._callbacks={},this._directMap={},this},m.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function e(t,r){return null!==t&&t!==a&&(t===r||e(t.parentNode,r))}(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var r=e.composedPath()[0];r!==e.target&&(t=r)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},m.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},m.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(c[t]=e[t]);l=null},m.init=function(){var e=m(a);for(var t in e)"_"!==t.charAt(0)&&(m[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},m.init(),o.Mousetrap=m,e.exports&&(e.exports=m),void 0===(n=function(){return m}.call(t,r,t,e))||(e.exports=n)}function p(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)}function y(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return c[e.which]?c[e.which]:u[e.which]?u[e.which]:String.fromCharCode(e.which).toLowerCase()}function h(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function b(e,t,r){return r||(r=function(){if(!l)for(var e in l={},c)e>95&&e<112||c.hasOwnProperty(e)&&(l[c[e]]=e);return l}()[e]?"keydown":"keypress"),"keypress"==r&&t.length&&(r="keydown"),r}function v(e,t){var r,n,o,a=[];for(r=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),o=0;o<r.length;++o)n=r[o],f[n]&&(n=f[n]),t&&"keypress"!=t&&s[n]&&(n=s[n],a.push("shift")),h(n)&&a.push(n);return{key:n,modifiers:a,action:t=b(n,a,t)}}function m(e){var t=this;if(e=e||a,!(t instanceof m))return new m(e);t.target=e,t._callbacks={},t._directMap={};var r,n={},o=!1,i=!1,l=!1;function c(e){e=e||{};var t,r=!1;for(t in n)e[t]?r=!0:n[t]=0;r||(l=!1)}function u(e,r,o,a,i,l){var c,u,s,f,d=[],p=o.type;if(!t._callbacks[e])return[];for("keyup"==p&&h(e)&&(r=[e]),c=0;c<t._callbacks[e].length;++c)if(u=t._callbacks[e][c],(a||!u.seq||n[u.seq]==u.level)&&p==u.action&&("keypress"==p&&!o.metaKey&&!o.ctrlKey||(s=r,f=u.modifiers,s.sort().join(",")===f.sort().join(",")))){var y=!a&&u.combo==i,b=a&&u.seq==a&&u.level==l;(y||b)&&t._callbacks[e].splice(c,1),d.push(u)}return d}function s(e,r,n,o){t.stopCallback(r,r.target||r.srcElement,n,o)||!1===e(r,n)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(r),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(r))}function f(e){"number"!=typeof e.which&&(e.which=e.keyCode);var r=y(e);r&&("keyup"!=e.type||o!==r?t.handleKey(r,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):o=!1)}function d(e,t,a,i){function u(t){return function(){l=t,++n[e],clearTimeout(r),r=setTimeout(c,1e3)}}function f(t){s(a,t,e),"keyup"!==i&&(o=y(t)),setTimeout(c,10)}n[e]=0;for(var d=0;d<t.length;++d){var p=d+1===t.length?f:u(i||v(t[d+1]).action);b(t[d],p,i,e,d)}}function b(e,r,n,o,a){t._directMap[e+":"+n]=r;var i,l=(e=e.replace(/\s+/g," ")).split(" ");l.length>1?d(e,l,r,n):(i=v(e,n),t._callbacks[i.key]=t._callbacks[i.key]||[],u(i.key,i.modifiers,{type:i.action},o,e,a),t._callbacks[i.key][o?"unshift":"push"]({callback:r,modifiers:i.modifiers,action:i.action,seq:o,level:a,combo:e}))}t._handleKey=function(e,t,r){var n,o=u(e,t,r),a={},f=0,d=!1;for(n=0;n<o.length;++n)o[n].seq&&(f=Math.max(f,o[n].level));for(n=0;n<o.length;++n)if(o[n].seq){if(o[n].level!=f)continue;d=!0,a[o[n].seq]=1,s(o[n].callback,r,o[n].combo,o[n].seq)}else d||s(o[n].callback,r,o[n].combo);var p="keypress"==r.type&&i;r.type!=l||h(e)||p||c(a),i=d&&"keydown"==r.type},t._bindMultiple=function(e,t,r){for(var n=0;n<e.length;++n)b(e[n],t,r)},p(e,"keypress",f),p(e,"keydown",f),p(e,"keyup",f)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},11:function(e,t){e.exports=o},13:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={form:"form",cardTable:"cardTable",editTable:"editTable"}},16:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1);function o(e){var t=e.querySelector("div");if(t&&t.attributes){var r=Object.values(t.attributes).find((function(e){if(e&&e.value.startsWith(n.config.hotKeyModuleIdPrefix))return e}));return r&&r.value}}},167:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=function(e,t){var r,o,l,c=[{type:"flat",icon:"uf-symlist",order:"flatscend"},{type:"up",icon:"uf-sortup",order:"ascend"},{type:"down",icon:"uf-sortdown",order:"descend"}];return o=r=function(t){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this,e));l.call(n);var o=[];return n._toFlatColumn(e.columns,-1,o),n.state={data:n.props.data,columns:e.columns,flatColumns:o},n._initSort(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):function(e,t){for(var r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var o=r[n],a=Object.getOwnPropertyDescriptor(t,o);a&&a.configurable&&void 0===e[o]&&Object.defineProperty(e,o,a)}}(e,t))}(r,t),r.prototype.componentWillReceiveProps=function(e){if(e.columns!==this.props.columns){var t=[];this._toFlatColumn(e.columns,-1,t),this.setState({columns:e.columns,flatColumns:t})}e.data!==this.props.data&&this.setState({data:e.data,oldData:e.data.concat()},(function(){this._initSort()}))},r.prototype._toFlatColumn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=this,o=[];e.forEach((function(e,a){e.parentIndex=t,o=e.children,r.push(e),o&&n._toFlatColumn(o,r.length-1,r)}))},r.prototype._flatToColumn=function(e){var t=e.length,r=void 0;e.forEach((function(e){e.children&&(e.children=[])}));for(var n=t-1;n>=0;n--)(r=e[n].parentIndex)>=0&&e[r].children.unshift(e[n]);return e.filter((function(e){return-1==e.parentIndex}))},r.prototype.render=function(){var t=this.renderColumnsDropdown(this.state.flatColumns.concat());return i.default.createElement(e,n({},this.props,{columns:t,data:this.state.data}))},r}(a.Component),r.defaultProps={sort:{mode:"single",backSource:!1}},l=function(){var e=this;this._initSort=function(){var t=e.state.flatColumns,r=!1;if(t.forEach((function(e){"descend"!=e.order&&"ascend"!=e.order||(r=!0)})),r){var n=e.multiSort(t);e.setState({data:n})}},this.getOrderNum=function(){var t=0;return e.state.flatColumns.forEach((function(e,r){"ascend"!=e.order&&"descend"!=e.order||t++})),t||1},this.changeOrderNum=function(t){var r=e.state.flatColumns;r.forEach((function(e){e.orderNum>t.orderNum&&e.orderNum--,t.key==e.key&&(e.orderNum="")})),e.setState({flatColumns:r})},this.getOrderCols=function(e){var t=[];return e.forEach((function(e){"ascend"!=e.order&&"descend"!=e.order||t.push({order:e.order,field:e.dataIndex,orderNum:e.orderNum})})),t},this._sortBy=function(t,r,n,o,a){var i=n[a],l=i.getMultiSorterValue,c=t[i.key],u=r[i.key];l&&(c=l(t,i),u=l(r,i));var s=i.sorter;return"function"!=typeof s&&(s=function(){return c-u}),c==u&&a+1<=o?e._sortBy(t,r,n,o,a+1):"ascend"==i.order?s(t,r):-s(t,r)},this.multiSort=function(t){var r=e.state,n=r.data,o=r.oldData,a=void 0===o?[]:o,i=e,l={},c=0;return t.forEach((function(e){e.orderNum&&(c++,l[e.orderNum]=e)})),n=c>0?n.sort((function(e,t){return i._sortBy(e,t,l,c,1)})):a.concat()},this.toggleSortOrder=function(t,r){var n=e.state,o=n.data,a=n.oldData,i=void 0===a?[]:a,l=n.flatColumns,c=e.props.sort,u=void 0;i.length||(i=o.concat());var s=void 0;"single"==c.mode?(l.forEach((function(e){e.key==r.key?u=e:e.order&&(e.order="flatscend")})),u.order=t,s=[{order:t,field:u.dataIndex}],c.backSource&&"function"==typeof c.sortFun?c.sortFun(s):(o="ascend"===t?o.sort((function(e,t){return r.sorter(e,t)})):"descend"===t?o.sort((function(e,t){return r.sorter(t,e)})):i.concat(),"function"==typeof c.sortFun&&c.sortFun(s,o,i))):((u=l.find((function(e){return e.key==r.key}))).order=t,"flatscend"===t&&e.changeOrderNum(r),u.orderNum||"ascend"!=t&&"descend"!=t||(u.orderNum=e.getOrderNum()),s=e.getOrderCols(l),c.backSource&&"function"==typeof c.sortFun?c.sortFun(s):(o=e.multiSort(l),"function"==typeof c.sortFun&&c.sortFun(s,o,i))),e.setState({data:o,oldData:i,flatColumns:l})},this.renderColumnsDropdown=function(t){var r;return r=t.map((function(t){var r=n({},t);return e.sortColumn(r)})),e._flatToColumn(r)},this.sortColumn=function(t){var r=e.props.sort.mode,n=0,o="flat";"ascend"===t.order?(n=1,o="up"):"descend"===t.order&&(n=2,o="down");var a=void 0;if(t.sorter||t.sortEnable){if(t.sortEnable&&!t.sorter)switch(t.fieldType){case"number":t.sorter=e.numberSortFn(t.dataIndex);break;case"stringChinese":t.sorter=e.chineseSortFn(t.dataIndex);break;default:t.sorter=e.defaultSortFn(t.dataIndex)}n>0&&!t.orderNum&&"multiple"==r&&(t.orderNum=e.getOrderNum()),a=i.default.createElement("div",{className:"bee-table-column-sorter"},i.default.createElement("span",{className:"bee-table-column-sorter-"+o,onClick:function(){e.toggleSortOrder(c[2==n?0:n+1].order,t),t.sorterClick&&t.sorterClick(t,c[n].type)}},i.default.createElement("i",{className:"uf "+c[n].icon}),i.default.createElement("span",null,t.orderNum)))}return t.title=i.default.createElement("span",null,t.title,a),t},this.defaultSortFn=function(e){return function(t,r){return t[e]>=r[e]?1:-1}},this.numberSortFn=function(e){return function(t,r){return parseFloat(t[e])>=parseFloat(r[e])?1:-1}},this.chineseSortFn=function(e){return function(t,r){return t[e].localeCompare(r[e],"zh-Hans-CN",{sensitivity:"accent"})}}},o};var o,a=r(0),i=(o=a)&&o.__esModule?o:{default:o};e.exports=t.default},17:function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return h}));var n=r(16),o=r(49),a=r(33),i=r(9),l=r(13),c=r(1);function u(e){var t=e.eventTarget,r=e.ViewModel,o=e.moduleId,i=e.orderOfHotKey,l="TD"===t.tagName?t:s(t);if(l){var u=l.nextElementSibling,b=l.parentElement,v=f(b),m=u&&u.querySelector('[tabindex="0"]');if(v!==l)if(null===m||Object(a.a)(m))d({td:u,ViewModel:r,moduleId:o,orderOfHotKey:i});else{var g=Object(n.a)(u);g&&(r.enterTriggerCellId=g),h({div:m,ViewModel:r})}else b===b.parentElement.lastElementChild?function(e){var t=e.currentModuleId,r=e.ViewModel,o=e.orderOfHotKey;o&&0===o.length?function(e){var t=e.currentModuleId,r=e.ViewModel,o="".concat(c.config.hotKeyModuleIdPrefix,"-").concat(t),a=document.querySelector("#".concat(o," table tbody tr")).querySelectorAll("td"),i=Array.prototype.find.call(a,(function(e){return null!==e.querySelector('[tabindex="0"]')})),l=Object(n.a)(i);l&&(r.enterTriggerCellId=l);var u=i.querySelector('[tabindex="0"]');u&&h({div:u,ViewModel:r})}({currentModuleId:t,ViewModel:r}):o&&y({currentModuleId:t,ViewModel:r,orderOfHotKey:o})}({currentModuleId:o,ViewModel:r,orderOfHotKey:i}):p({tr:b,ViewModel:r,moduleId:o,orderOfHotKey:i})}else console.warn("not find parentTd, next hotkey invalid")}function s(e){for(;e.parentElement;)if("TD"===(e=e.parentElement).tagName)return e;return null}function f(e){return e.lastElementChild.className.includes("fixed")?e.lastElementChild.previousElementSibling:e.lastElementChild}function d(e){var t=e.td,r=e.ViewModel,o=e.moduleId,i=e.orderOfHotKey,l=t.nextElementSibling,c=l&&l.parentElement,u=c&&f(c),s=t.querySelector('[tabindex="0"]'),y=l&&l.querySelector('[tabindex="0"]');if(u===l&&null===y||u===t&&null===s)p({tr:c,ViewModel:r,moduleId:o,orderOfHotKey:i});else if(null===y||Object(a.a)(y))d({td:l,ViewModel:r,moduleId:o,orderOfHotKey:i});else{var b=Object(n.a)(l);b&&(r.enterTriggerCellId=b),h({div:y,ViewModel:r})}}function p(e){var t=e.tr,r=e.ViewModel,o=e.moduleId,a=e.orderOfHotKey,i=t&&t.nextElementSibling;if(null!==i)if("-1"!==i.getAttribute("tabindex")){var l=i.querySelector('td [tabindex="0"]'),c=s(l),u=Object(n.a)(c);u&&(r.enterTriggerCellId=u),h({div:l,ViewModel:r})}else p({tr:i,ViewModel:r,moduleId:o,orderOfHotKey:a});else a&&y({currentModuleId:o,ViewModel:r,orderOfHotKey:a})}function y(e){var t=e.currentModuleId,r=e.ViewModel,a=e.orderOfHotKey,c=function(e,t){var r=t.length,n=t.indexOf(e)+1===r?0:t.indexOf(e)+1;return t[n]}(t,a),u=i.d[c];if(void 0!==u){var f=u.type;if(f===l.a.cardTable||f===l.a.editTable){var p=i.d[u.activeTable],y=document.querySelector("div[".concat(p.firstItem,"]")),b=y.querySelector('[tabindex="0"]');if(null===b){d({td:y.parentElement,ViewModel:r,moduleId:p.moduleId,orderOfHotKey:a})}else{var v=s(b),m=Object(n.a)(v);m&&(r.enterTriggerCellId=m),h({div:b,ViewModel:r})}}else Object(o.b)(u,c)}}function h(e){var t=e.div,r=e.ViewModel;null!==t&&(r.shouldAutoFocus=!0,t.ncExecuteFocus=!0,t.focus(),delete t.ncExecuteFocus)}},1846:function(e,t,r){},1847:function(e,t,r){},1848:function(e,t,r){},1849:function(e,t,r){},1850:function(e,t,r){},1851:function(e,t,r){},1852:function(e,t,r){},1853:function(e,t,r){},1854:function(e,t,r){},1855:function(e,t,r){},1856:function(e,t,r){},1857:function(e,t,r){},1858:function(e,t,r){},1859:function(e,t,r){},1860:function(e,t,r){},1861:function(e,t,r){},1892:function(e,t,r){"use strict";r.r(t),r.d(t,"lib",(function(){return n})),r.d(t,"CONFIG",(function(){return I.a})),r.d(t,"EditTableStore",(function(){return Hn})),r.d(t,"utils",(function(){return i})),r.d(t,"TableMeta",(function(){return qn})),r.d(t,"TableData",(function(){return Fn})),r.d(t,"handleSortcolumns",(function(){return Wr}));var n={};r.r(n),r.d(n,"formatColumn",(function(){return re})),r.d(n,"pagination",(function(){return me})),r.d(n,"selectRow",(function(){return _e})),r.d(n,"indexCol",(function(){return Ae})),r.d(n,"checkCol",(function(){return Ye})),r.d(n,"errorCol",(function(){return nt})),r.d(n,"selectable",(function(){return Kr})),r.d(n,"simpleTableModal",(function(){return mt})),r.d(n,"total",(function(){return Et})),r.d(n,"filter",(function(){return ar})),r.d(n,"excel",(function(){return Hr})),r.d(n,"columnSort",(function(){return Qr})),r.d(n,"hotkey",(function(){return kn})),r.d(n,"contextMenu",(function(){return dn}));var o=r(0),a=r.n(o),i=r(7),l=r(11),c=r(1),u=r(5),s=r.n(u);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h(this,r)}}function h(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(1846);var v=["#111111","#555555","#111","#555"],m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(u,e);var t,r,n,l=y(u);function u(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),l.call(this,e)}return t=u,(r=[{key:"getParentTypeTitle",value:function(){var e=this.props,t=e.title,r=e.attrcode,n=(e.isParent,e.itemtype,e.color),i=e.unitActive;n=v.includes(n)?"":n;var l=(i?"column-title-actived":"")+"  column-title-wrapper-bg ";return a.a.createElement(o.Fragment,null,a.a.createElement("div",{className:s()("column-title-wrapper",{"column-title-actived":i}),style:{color:n},cellSelectorKey:"__tableHeader__".concat("@",r)},t),a.a.createElement("div",{className:l,cellSelectorKey:"__tableHeader__".concat("@",r)}))}},{key:"getNormalTypeTitle",value:function(){var e=this.props,t=e.title,r=e.required,n=e.attrcode,l=e.itemtype,u=e.color,f=e.status,d=void 0===f?"browse":f,p=e.unitActive,y=e.titleIcon;u=v.includes(u)?"":u;var h=(p?"column-title-actived":"")+"  column-title-wrapper-bg ";return a.a.createElement(o.Fragment,null,a.a.createElement("div",{className:s()("column-title-wrapper",{"column-title-actived":p}),cellSelectorKey:"__tableHeader__".concat("@",n),fieldid:Object(c.getSysFieldid)(n),style:"number"===l?{width:"100%",textAlign:"right",color:u}:{color:u}},"edit"==d&&r&&a.a.createElement("span",{className:"mark-required"},"*"),Object(i.isFunction)(t)?t(this.props):t),y&&y(this.props),a.a.createElement("div",{className:h,cellSelectorKey:"__tableHeader__".concat("@",n)}))}},{key:"render",value:function(){return this.props.isParent?this.getParentTypeTitle():this.getNormalTypeTitle()}}])&&d(t.prototype,r),n&&d(t,n),u}(o.Component);r(1848);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=k(e);if(t){var o=k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return j(this,r)}}function j(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=["datepicker","NCTZDatePickerStart","NCTZDatePickerEnd","timepicker","datetimepicker","rangepicker","datePickerNoTimeZone"];var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(l,e);var t,r,n,i=S(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e)}return t=l,(r=[{key:"getIcon",value:function(){var e,t=this,r=this.props,n=r.itemtype,o=(r.disabled,r.value);return r.isSaga_status,"refer"==n?a.a.createElement("i",{className:"refer-icon cell-icon align-right iconfont",onClick:function(e){var r=t.props.onClick;r&&r("refer",e)}},""):C.includes(n)?a.a.createElement("i",{className:"time-icon cell-icon align-right iconfont",style:{cursor:"pointer"},onClick:function(e){var r=t.props.onClick;r&&r("picker",e)}},""):"select"==n?a.a.createElement("i",{className:"select-icon cell-icon align-right iconfont",style:{cursor:"pointer"},onClick:function(e){var r=t.props.onClick;r&&r("select",e)}},""):null!=(e=o)&&""!==e?null:void 0}},{key:"render",value:function(){var e=this.props,t=(e.itemtype,e.attrcode,e.disabled);return e.value,e.isSaga_status,e.cellIcon,t?a.a.createElement("span",{className:"icon-placeholder"}):a.a.createElement(o.Fragment,null,this.getIcon())}}])&&w(t.prototype,r),n&&w(t,n),l}(o.Component),_=r(3),I=r(38);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function R(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=H(e);if(t){var o=H(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return F(this,r)}}function F(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?q(e):t}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(1847);var U={datepicker:!0,NCTZDatePickerStart:!0,NCTZDatePickerEnd:!0,timepicker:!0,datetimepicker:!0,rangepicker:!0,datePickerNoTimeZone:!0},B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(s,e);var t,r,n,u=N(s);function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=u.call(this,e)).getValue=function(e,t,r,n,o){var a,i,l=e.getCellValue,c=e.record,u=e.rowKey,s=e.rowIndex,f=e.itemtype,d=e.languageMeta,p=e.langJson,y=void 0===p?{}:p,h={};l?o&&"residtxt"===f?(Array.isArray(d)&&d.map((function(e){var r=e.index;e.languageCode===o&&(a=l({attrcode:1==r?t:t+r,rowKey:u,rowKeyValue:c[u],rowIndex:s}));1!=r&&""!=r||(i=l({attrcode:t,rowKey:u,rowKeyValue:c[u],rowIndex:s}))})),a&&a.value&&(h=a),i&&i.value&&(h=i)):h=l({rowKey:u,rowKeyValue:c[u],rowIndex:s,attrcode:t}):(!c.values&&console.error("无效的record格式"),(h=c.values[t])&&void 0!==h.display&&void 0!==h.value||!h&&(h={}),h.display=h.display||h.value||"",h.value=h.value||"");return h=n?h:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};switch(!0){case"number"===t:break;case I.a.boolean.includes(t):(r=JSON.parse(JSON.stringify(r||{}))).display="Y"==r.value||1==r.value?e&&e.table_yes:e&&e.table_no,r.value="Y"==r.value||1==r.value}return r}(y,f,h,r)},t.getCellStatus=function(e){var t,r=e.status,n=void 0===r?"browse":r,o=e.editType,a=void 0===o?"toggle":o,l=e.disabled,c=void 0!==l&&l,u=e.visible,s=void 0===u||u,f=e.selected,d=void 0!==f&&f,p=e.focused,y=e.actived,h=void 0!==y&&y,b=e.itemtype,v=e.render,m=e.cellIcon,g=e.disableEditType,w=void 0!==g&&g,O=e.renderStatus,S=void 0===O?"edit":O,j=(e.renderItem,e.renderItems),k=void 0===j?{}:j,C=e.attrcode,x=e.record,_=x||{},I=(_.disabled,_.visible),E=void 0===I||I,P=_.isEdit,R=void 0!==P&&P,T=_.selected,K=void 0!==T&&T,D=_.focused,M=void 0!==D&&D,V=x.values||x||{},A=V[C]||{},N=A.disabled,F=A.visible,q=void 0===F||F,H=A.isEdit,B=void 0!==H&&H,L=A.selected,W=void 0!==L&&L,J=A.focused,z=void 0!==J&&J,Y=A.actived,$=void 0!==Y&&Y,Z=A.showDrag,G=void 0!==Z&&Z,X=A.validated,Q=void 0===X||X,ee=A.leftLine,te=void 0!==ee&&ee,re=A.rightLine,ne=void 0!==re&&re,oe=A.bottomLine,ae=void 0!==oe&&oe,ie=A.topLine,le=void 0!==ie&&ie,ce=A.focusToEdit,ue=void 0!==ce&&ce,se=A.autoFocus,fe=V&&V.saga_status&&"1"===V.saga_status.value,de=Object(i.isString)(N)?"off"===N:N;c=Object(i.isBoolean)(N)?de:c||de,s=s&&E&&q,h=h||$;var pe="edit"===n;a="toggle"===a?"toggle":"normal",d=d||K||W,t=M||z;var ye="switch_browse"===b||"checkbox_switch"===b||"switch"===b,he="checkbox_switch"===b,be="switch_browse"===b||pe&&!c,ve=R||B;a="switch_browse"===b||pe&&"checkbox_switch"===b||pe&&"switch"===b?"normal":"toggle",m=v&&"customer"===b||ye?"none":m||"hover";var me="select"===b||"refer"===b||U[b];"switch_browse"===b&&pe&&(c=!0),"label"===b&&(be=!1);var ge=!1,we=!1;"attachment"===b?(be&&(we=!0),ge=!0,be=!0,a="normal",m="none"):w&&(be=!1,a="toggle");var Oe="normal";k[C]?Oe="renderInItem":v&&"customer"===b?Oe="renderInCustomer":v&&"edit"==S?Oe="renderInEdit":v&&"browse"==S&&(Oe="renderInBrowse");var Se=!1;return w?Se=!1:(pe&&"label"!=b&&"customer"!=b||"switch_browse"===b)&&(Se=!0),{disabled:c,tableEdit:pe,isEdit:ve,editable:be,editType:a,visible:s,selected:d,focused:t,actived:h,showDrag:G,cellIcon:m,isAttachment:ge,disableModify:we,validated:Q,leftLine:te,rightLine:ne,bottomLine:ae,topLine:le,focusToEdit:ue,renderType:Oe,isSwitchType:ye,isCheckboxSwitchType:he,autoFocus:se,isSagaStatus:fe,isCellIconInRight:me,renderItemInEdit:Se}},t.getCellUI=function(){var e=t.props,r=e.record,n=e.rowIndex,c=e.rowKey,u=e.attrcode,s=e.itemtype,f=e.hyperlinkflag,d=e.onCellHyperlinkTo,p=e.renderStatus,y=void 0===p?"edit":p,h=e.renderItem,b=e.renderItems,v=void 0===b?{}:b,m=e.whichKeyToDisplay,g=(e.UIProps,e.setCellProps,e.onTableCellClick,e.onBeforeEvent),w=e.onAfterEvent,O=e.onCellStatusChange,S=e.setCellValue,j=(e.getCellValue,e.render),k=e.store,C=(e.scale,e.loginLanguage,e.__col),x=e.onEnter,_=e.hotKeyWithArrow,I=(e.className,e.maxlength),E=M(e,["record","rowIndex","rowKey","attrcode","itemtype","hyperlinkflag","onCellHyperlinkTo","renderStatus","renderItem","renderItems","whichKeyToDisplay","UIProps","setCellProps","onTableCellClick","onBeforeEvent","onAfterEvent","onCellStatusChange","setCellValue","getCellValue","render","store","scale","loginLanguage","__col","onEnter","hotKeyWithArrow","className","maxlength"]),T=t.cellStatus,D=T.disabled,V=T.tableEdit,A=T.editType,N=T.editable,F=T.disableModify,q=T.validated,H=T.autoFocus,U=T.isSagaStatus,B=T.renderItemInEdit,L=T.isSwitchType,W=t.rowKeyValue,J=t.cellScale,z=t.cellValue;if(h=v[u],j&&"customer"===s){var Y=j(z,r,n,k);if(!Y)return a.a.createElement("div",null);if(!Object(o.isValidElement)(Y))return Object(i.isObject)(Y)&&(console.error("invalid react element",Y),Y=JSON.stringify(Y)),a.a.createElement("div",{className:"add-customer-cell un-react-element"},Y);var $=K(K({},Y),{},{props:K(K({},Y.props),{},{renderInTable:!0})});return a.a.createElement("div",C,Object(o.cloneElement)($))}if(!j&&f&&!N&&!V)return a.a.createElement("span",{style:{overflow:"hidden",display:"flex",width:"100%"}},a.a.createElement("a",{href:"javascript:;",className:"cell-hyper",onClick:function(e){e.stopPropagation(),Object(i.isFunction)(d)&&d(r,u,z)}},z.display||z.value||""));var Z=t.state.autoOpen?{open:t.state.autoOpen,autoShow:t.state.autoOpen}:{};return a.a.createElement(l.Item,P({},E,Z,{autoFocus:H,isCheckChinese:!!I,maxlength:I,renderInTable:!0,disabled:D,scale:J,browse:!N||U,whichKeyToDisplay:m,itemtype:s,attrcode:u,editType:A,disableModify:F,onEnter:x,hotKeyWithArrow:_,setFieldValue:function(e){var o=e.attrcode,a=e.value;return Object(i.isFunction)(S)&&S({record:r,rowKey:c,rowKeyValue:W,rowIndex:n,attrcode:o,value:a,column:K(K({},C),t.cellStatus),triggerType:t.defaultItemCreator.valueChangePropName||"onChange"})},getFieldValue:function(e){var r=e.attrcode;return t.getValue(t.props,r,t.cellScale,N)},onBeforeEvent:function(){var e,o=(e=regeneratorRuntime.mark((function e(o){var a,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.value,l=o.event,k&&k.setCellProps(W,u,{validated:!0},!1),!1===q&&k&&k.setCellProps(W,u,{validated:!0},!1),!Object(i.isFunction)(g)){e.next=9;break}return e.next=6,g({record:r,rowKey:c,rowKeyValue:W,rowIndex:n,attrcode:u,value:a,event:l,column:K(K({},C),t.cellStatus),triggerType:t.defaultItemCreator.beforeEventTrigger||"onFocus",validated:q});case 6:return e.t0=e.sent,s=!1!==e.t0,e.abrupt("return",s);case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){R(a,n,o,i,l,"next",e)}function l(e){R(a,n,o,i,l,"throw",e)}i(void 0)}))});return function(e){return o.apply(this,arguments)}}(),onAfterEvent:function(e){var o=e.value,a=e.oldValue,l=e.componentValue,s=e.event;t.setState({autoOpen:!1}),Object(i.isFunction)(w)&&w({record:r,rowKey:c,rowKeyValue:W,rowIndex:n,attrcode:u,value:o,componentValue:l,event:s,column:K(K({},C),t.cellStatus),oldValue:a,triggerType:t.defaultItemCreator.afterEventTrigger||"onBlur"})},onStatusChange:function(e){var r=e.isEdit;k&&k.setCellProps(W,u,{focusToEdit:r},!0),t.setState({autoOpen:!!r&&t.state.autoOpen,showIcon:!r}),Object(i.isFunction)(O)&&O({isEdit:r,column:K(K({},C),t.cellStatus),rowIndex:n,attrcode:u})},path:[W,u],renderItem:function(e){var t=e.isEdit;if(j&&"customer"===y)return j(z,r,n,k,B?t||L?"edit":"editBrowse":"browse");if(B){var l=t||L;if(l&&j&&"edit"===y)return j(z,r,n,k);if(!l&&j&&"editBrowse"===y)return j(z,r,n,k);if(l&&h)return Object(i.isFunction)(h)?h.call(null,z,r,n,k):h}else if(j&&"browse"===y){var c=j(z,r,n,k);return Object(o.isValidElement)(c)?c:(Object(i.isObject)(c)&&(console.error("invalid react element",c),c=JSON.stringify(c)),a.a.createElement("div",{className:"add-customer-cell un-react-element"},c))}}}))},t.handleMouseEnter=function(){if(t.cellDom){var e,r,n=t.state.showTip;if(e=t.cellDom.getElementsByClassName("template-item-wrapper-inner")[0])if((e.scrollWidth>e.clientWidth||e.offsetHeight>30)&&!1===n)r=!(e.scrollWidth>4e3),t.setState({showTip:!0,tooltipDelay:r})}},t.onCellClick=function(e,r){if(t.cellDom){var n=t.cellDom.querySelector('.template-item-wrapper.template-item-browse[tabindex="0"]');"picker"!=e&&"select"!=e&&"refer"!=e||t.setState({autoOpen:!0}),n&&(n.ncExecuteFocus=!0,t.cellDom.contains(r.target)&&n.focus(),n.ncExecuteFocus=!1)}},t.state={tipStatus:!1,autoOpen:!1,showIcon:!0,showTip:!1},t.defaultItemCreator=Object(l.itemCreator)({itemtype:e.itemtype})||{},t.cellStatus=t.getCellStatus(e);var r=e.record,n=e.attrcode,c=e.scale,f=e.rowKey,d=e.store,p=e.render,y=e.itemtype,h=e.loginLanguage;return t.rowKeyValue=Object(i.isObject)(r[f])?r[f].value:r[f],p&&"customer"===y&&(t.unregister=null==d?void 0:d.registerField([t.rowKeyValue,"sp_col_customer__",n],q(t))),t.cellScale=t.getScale(r,n,c),t.cellValue=t.getValue(e,n,t.cellScale,t.cellStatus.editable,h),t}return t=s,(r=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.cellStatus=this.getCellStatus(e);var t=e.record,r=e.attrcode,n=e.scale,o=e.rowKey,a=e.store,l=e.render,c=e.itemtype,u=e.loginLanguage,s=Object(i.isObject)(t[o])?t[o].value:t[o];this.rowKeyValue!==s&&(l&&"customer"===c&&(this.unregister(),this.unregister=null==a?void 0:a.registerField([s,"sp_col_customer__",r],this)),this.rowKeyValue=s),this.cellScale=this.getScale(t,r,n),this.cellValue=this.getValue(e,r,this.cellScale,this.cellStatus.editable,u)}},{key:"componentDidMount",value:function(){if(this.cellStatus.isEdit){var e=this.props,t=e.attrcode,r=e.store,n=this.cellDom&&this.cellDom.querySelector('[tabindex="0"]');n&&!function(e,t){if(!e)return null;for(var r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!r.call(e,t);)e=e.parentElement;return e}(n,".u-table-row-fixed-columns-in-body")&&(n.ncExecuteFocus=!0,n.focus(),n.ncExecuteFocus=!1,r&&r.setCellProps(this.rowKeyValue,t,{isEdit:void 0},!1))}}},{key:"componentDidUpdate",value:function(){}},{key:"componentWillUnmount",value:function(){var e;this.cellDom=null,this.defaultItemCreator=null,this.rowKeyValue=null,this.cellValue=null,null===(e=this.unregister)||void 0===e||e.call(this)}},{key:"getScale",value:function(e,t,r){var n=(e.values||e||{})[t],o=Object(i.isObject)(n)?n.scale:r;return(o=Object(i.isWrong)(o)||"-1"==o?+r:+o)||0}},{key:"getCellClassName",value:function(){var e=this.props,t=e.record,r=e.rowIndex,n=e.attrcode,o=e.cellClassName;return" "+((Object(i.isFunction)(o)?o({record:t,rowIndex:r,attrcode:n}):o)||"")+" "}},{key:"render",value:function(){var e,t,r=this,n=this.getCellUI();if(!n)return a.a.createElement("div",null);var l=this.props,u=l.record,s=l.rowIndex,f=l.bodyDisplayInRow,d=void 0===f||f,p=l.attrcode,y=l.itemtype,h=l.onTableCellClick,b=l.onCellKeyDown,v=l.onCellFocus,m=l.onCellMouseDown,g=l.onEnter,w=l.hotKeyWithArrow,O=l.tableId,S=l.__col,j=l.langJson,k=void 0===j?{}:j,C=this.cellStatus,E=C.disabled,R=C.tableEdit,T=C.editable,K=C.selected,D=C.focused,M=C.cellIcon,V=C.actived,A=C.showDrag,N=C.validated,F=C.focusToEdit,q=C.leftLine,H=C.rightLine,U=C.bottomLine,B=C.topLine,L=C.renderType,W=C.isCheckboxSwitchType,J=C.isSagaStatus,z=(C.isCellIconInRight,R&&this.state.showIcon&&"none"!==M),Y=(Object(i.isWrong)(null!==(e=this.cellValue.value)&&void 0!==e?e:this.cellValue.display),(R?" table-status-edit":"")+(V?" table-cell-actived":"")+(F?" table-cell-focus-blue":"")+(D?" table-cell-focused":"")+(E?" table-cell-disabled":"")+(T?" table-cell-edit":"")+(!1===N?" table-cell-valid-failed":"")),$=" table-cell-wrapper-bg "+(B?" table-cell-line-top":"")+(q?" table-cell-line-left":"")+(H?" table-cell-line-right":"")+(U?" table-cell-line-bottom":"")+Y,Z=" table-cell-wrapper "+this.getCellClassName()+" cell-icon-"+M+(K?" table-cell-selected":"")+Y+(W?" table-cell-checkbox-switch":"")+(z?" table-cell-show-icon":""),G=this.rowKeyValue+"@"+p,X=I.a.hotKeyModuleIdPrefix+"-"+O+"-"+p+"-"+s,Q={};Q[X]=X;var ee=" cell-content "+(d?" cell-ellipsis":"")+(T?" cell-edit":"")+(d?"":" cell-fold-display")+("number"===y?" number-right ":" ");return a.a.createElement(o.Fragment,null,a.a.createElement("div",P({className:$,cellSelectorKey:G,"data-code":p},Q),a.a.createElement("div",{className:"left-line line-line-line"}),a.a.createElement("div",{className:"right-line line-line-line"}),a.a.createElement("div",{className:"top-line line-line-line"}),a.a.createElement("div",{className:"bottom-line line-line-line"})),a.a.createElement("div",P({fieldid:Object(c.getSysFieldid)(p)},Q,{className:Z,ref:function(e){r.cellDom=e},onMouseEnter:this.handleMouseEnter,onClick:function(e){J||(r.onCellClick("wrapper",e),h&&h(u,s,p,S,e))},cellSelectorKey:G,"data-type":y,"data-code":p,"data-renderType":L,onKeyDown:function(e){return F||"Enter"!==e.key||(e.stopPropagation(),g({e:e,target:e.target,itemType:y})),!F&&Object(c.isArrowKeyDown)(e)&&(e.stopPropagation(),w&&w({e:e,target:e.target,itemType:y})),b&&b(u,s,p,S,e)},onMouseDown:function(e){return m&&m(u,s,p,S,e)},onFocus:function(e){return r.cellDom&&(r.cellDom.className+=" table-cell-focused"),v&&v(u,s,p,S,e)},onBlur:function(e){r.cellDom&&(r.cellDom.className=r.cellDom.className.replace("table-cell-focused",""))}}),T||!this.state.showTip?a.a.createElement("div",{className:ee},n):a.a.createElement(_.Tooltip,{placement:"top",overlay:Object(i.handleBrowseData)(y,this.cellValue.display,this.cellValue.value,this.cellScale,p,S.languageMeta,u.values||u,S.datatype,S.options,S.multiple,k),className:"tooltip-word-color high-table-tooltip",delay:this.state.tooltipDelay?1:void 0,inverse:!0},a.a.createElement("div",{className:ee},n)),T&&!J&&this.state.showIcon&&a.a.createElement(x,{itemtype:y,attrcode:p,value:null!==(t=this.cellValue.value)&&void 0!==t?t:this.cellValue.display,disabled:E,cellIcon:M,onClick:this.onCellClick})),!E&&A&&!J&&a.a.createElement("div",{cellDrag:"on",cellSelectorKey:G,className:"table-cell-drag-icon iconfont"}))}}])&&V(t.prototype,r),n&&V(t,n),s}(o.Component);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Z(e);if(t){var o=Z(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return $(this,r)}}function $(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function te(e,t){e=Object(i.filterColumns)(e,(function(e){return!e&&console.warn("columns include empty element, please check columns data"),e.visible}));var r=Object(c.getLangCode)();return e.map((function(e){return e.children?{required:!1,className:(e.className||"")+" parent-column",key:e.attrcode,dataIndex:e.dataIndex||e.attrcode,title:a.a.createElement(m,ee({},e,{title:e.title||e.label},t,{attrcode:e.attrcode||e.key,isParent:!0})),children:te(e.children,t)}:(Object(i.isWrong)(e.width)&&("datetimepicker"===e.itemtype?e.width="240px":"rangepicker"===e.itemtype?e.width="390px":I.a.timeTypes.includes(e.itemtype)?e.width="160px":e.width="120px"),X(X({},e),{},{required:!1,className:(e.className?e.className:" ")+(e.unitActive?" column-header-active ":" ")+("number"===e.itemtype?" column-type-number ":" "),key:e.key||e.attrcode,redstar:e.required,dataIndex:e.dataIndex||e.attrcode,title:a.a.createElement(m,ee({},e,{title:e.title||e.label},t,{attrcode:e.attrcode||e.key})),render:function(n,o,l){var c=e;return e.key=e.key||e.attrcode,{children:a.a.createElement(B,ee({},e,t,{loginLanguage:r,cellIcon:t.cellIcon||e.cellIcon,renderStatus:t.renderStatus||e.renderStatus,record:o,text:n,attrcode:e.attrcode||e.key,rowIndex:l,__col:c})),props:Object(i.isFunction)(t.mergeCell)?t.mergeCell({record:o,index:l,attrcode:e.attrcode}):{}}}}))}))}function re(e){return e||console.error("缺少Table组件"),e=Object(l.ItemProvider)(e),function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(u,t);var r,n,o,l=Y(u);function u(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),l.call(this,e)}return r=u,(n=[{key:"render",value:function(){var t=this.props,r=t.columns,n=t.langJson,o=t.getCellProps,l=t.setCellProps,u=t.onTableCellClick,s=t.onBeforeEvent,f=t.onAfterEvent,d=t.setCellValue,p=t.getCellValue,y=t.onCellStatusChange,h=t.rowKey,b=t.name,v=t.tableId,m=t.status,g=t.bodyDisplayInRow,w=t.cellClassName,O=t.mergeCell,S=t.store,j=t.onCellHyperlinkTo,k=t.cellIcon,C=t.renderItems,x=t.renderStatus,_=t.onCellKeyDown,I=t.onCellMouseDown,E=t.onCellFocus,P=t.disableEditType,R=t.fieldid,T=t.hotKeyWithArrow,K=t.onEnter,D=W(t,["columns","langJson","getCellProps","setCellProps","onTableCellClick","onBeforeEvent","onAfterEvent","setCellValue","getCellValue","onCellStatusChange","rowKey","name","tableId","status","bodyDisplayInRow","cellClassName","mergeCell","store","onCellHyperlinkTo","cellIcon","renderItems","renderStatus","onCellKeyDown","onCellMouseDown","onCellFocus","disableEditType","fieldid","hotKeyWithArrow","onEnter"]);return a.a.createElement("div",{className:"use-column-component",fieldid:Object(c.getSysFieldid)("".concat(R||b,"_table"))},a.a.createElement(e,ee({rowKey:function(e){return Object(i.isObject)(e[h])?e[h].value:e[h]},bodyDisplayInRow:g,columns:te(r,{getCellProps:o,setCellProps:l,onTableCellClick:u,onBeforeEvent:s,onAfterEvent:f,onCellStatusChange:y,setCellValue:d,getCellValue:p,rowKey:h,status:m,bodyDisplayInRow:g,cellClassName:w,mergeCell:O,store:S,onCellHyperlinkTo:j,cellIcon:k,renderItems:C,renderStatus:x,onCellKeyDown:_,onCellMouseDown:I,onCellFocus:E,tableId:v,langJson:n,disableEditType:P,hotKeyWithArrow:T,onEnter:K}),store:S,tableId:v,name:b,langJson:n,hotKeyWithArrow:T,onEnter:K},D)))}}])&&J(r.prototype,n),o&&J(r,o),u}(o.Component)}var ne=r(6),oe=r.n(ne),ae=(r(1849),r(2)),ie=r.n(ae);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){fe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=be(e);if(t){var o=be(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return he(this,r)}}function he(e,t){return!t||"object"!==le(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ve=_.Select.Option;function me(e){var t,r;return r=t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(l,t);var r,n,o,i=ye(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).pageIndexChange=function(e){var r=t.props,n=r.pageInfoChange,o=r.pageInfo,a=o.total,i=o.pageSize,l=se(se({},o),{},{pageIndex:e,totalPage:Math.ceil(a/i)});"function"==typeof n&&n(l)},t.pageSizeChange=function(e){var r=t.props,n=r.pageInfoChange,o=r.pageInfo,a=o.total,i=se(se({},o),{},{pageIndex:1,pageSize:+e,totalPage:Math.ceil(a/e)});"function"==typeof n&&n(i)},t.state={hideSelectDropdown:!1,json:{}},t.options=["10","20","50","100"],t.selectDom=null,t}return r=l,(n=[{key:"UNSAFE_componentWillMount",value:function(){var e=this;Object(c.getMultiLang)({moduleId:"table_lib_pagination",callback:function(t){e.setState({json:t})}})}},{key:"render",value:function(){var t=this,r=this.state,n=r.hideSelectDropdown,o=r.json,i=this.props,l=i.pageInfo,u=i.checkNum,s=i.showPagination,f=void 0!==s&&s,d=l.pageSize,p=l.total,y=l.totalPage,h=l.pageIndex;this.options.includes(String(d))||(d=d+o.pagination003+"/"+o.pagination001);var b=n?{dropdownStyle:{display:"none"}}:{};return a.a.createElement(a.a.Fragment,null,a.a.createElement(e,this.props),f&&a.a.createElement("div",{className:"pagination-wrapper",fieldid:Object(c.getSysFieldid)("pagination-div")},a.a.createElement("div",{className:"pagination-size"},a.a.createElement(_.Select,ce({ref:function(e){t.selectDom=e},className:"pagination-select",dropdownClassName:"pagination-select-dropdown",fieldid:"page-size",supportSearch:!0,showSearch:!0,supportWrite:!0,showClear:!1,value:String(d||""),onSelect:this.pageSizeChange,onChange:function(e){Array.isArray(e)&&e[0].length<500&&/^[1-9]*[1-9][0-9]*$/.test(e[0])&&(e=e>5e3?5e3:e,t.pageSizeChange(e))},onFocus:function(){n&&t.setState({hideSelectDropdown:!1})},onSearch:function(){n||t.setState({hideSelectDropdown:!0})},onKeyDown:function(e){13==e.keyCode&&t.selectDom&&oe.a.findDOMNode(t.selectDom).querySelector(".pagination-select .u-select-selection--single .u-select-search-field").blur()}},b),this.options.map((function(e,t){return a.a.createElement(ve,{key:t,value:e,className:"pagination-option"},a.a.createElement("div",{className:"pagination-size"},"".concat(e).concat(o.pagination003,"/").concat(o.pagination001)))}))),!!+p&&a.a.createElement("span",{className:"pagination-total"},o.pagination002,a.a.createElement("span",null,p),o.pagination003,u&&a.a.createElement("span",{style:{marginLeft:"1px"}}," ",o.pagination004,u(),o.pagination003))),a.a.createElement("div",{className:"pagination"},a.a.createElement(_.Pagination,{prev:!0,next:!0,boundaryLinks:!0,items:Number(y||1),maxButtons:7===Number(y||1)?6:5,activePage:Number(h),onSelect:this.pageIndexChange}))))}}])&&de(r.prototype,n),o&&de(r,o),l}(o.Component),t.defaultProps={pageInfo:{}},t.propTypes={pageInfo:ie.a.object,pageInfoChange:ie.a.function},r}r(1850);function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Oe(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=xe(e);if(t){var o=xe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ce(this,r)}}function Ce(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e){return e||console.error("缺少Table组件"),function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(l,t);var r,n,o,i=ke(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).state={selectedIndex:new Set},t}return r=l,(n=[{key:"hasSelected",value:function(e,t,r,n){var o=this.props.hasSelected;return Object(c.isFunction)(o)?o({record:e,rowKey:t,rowKeyValue:r,rowIndex:n}):this.state.selectedIndex.has(r||n)}},{key:"render",value:function(){var t=this,r=this.props,n=r.rowKey,o=r.focusIndex,i=(r.hasSelected,r.setSelectedIndex),l=r.rowSelectedCls,u=void 0===l?" table-row-selected ":l,s=r.multiSelectRow,f=void 0===s||s,d=r.rowClassName,p=r.onRowClick,y=r.onRowDoubleClick,h=Oe(r,["rowKey","focusIndex","hasSelected","setSelectedIndex","rowSelectedCls","multiSelectRow","rowClassName","onRowClick","onRowDoubleClick"]);return a.a.createElement(e,we({rowKey:n,currentIndex:o,rowClassName:function(e,r){var o="";return t.hasSelected(e,n,e[n],r)&&(o=u),o+=Object(c.isFunction)(d)?d(e,r):d},onRowClick:function(e,r,o){if(Object(c.isFunction)(i))i({record:e,rowKey:n,rowIndex:r},o);else{var a=t.state.selectedIndex;a.has(e[n]||r)?a.delete(e[n]||r):(!f&&a.clear(),a.add(e[n]||r)),t.setState({selectedIndex:t.state.selectedIndex})}Object(c.isFunction)(p)&&p(e,r,o)},onRowDoubleClick:function(e,r,o){if(Object(c.isFunction)(i))i({record:e,rowKey:n,rowIndex:r});else{var a=t.state.selectedIndex;a.has(e[n]||r)?a.delete(e[n]||r):(!f&&a.clear(),a.add(e[n]||r)),t.setState({selectedIndex:t.state.selectedIndex})}Object(c.isFunction)(y)&&y(e,r,o)}},h))}}])&&Se(r.prototype,n),o&&Se(r,o),l}(o.Component)}r(1851);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(){return(Ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Pe(e){return function(e){if(Array.isArray(e))return Re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Re(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ve(e);if(t){var o=Ve(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Me(this,r)}}function Me(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(c,t);var r,n,o,l=De(c);function c(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,e)}return r=c,(n=[{key:"render",value:function(){var t=this.props,r=t.columns,n=t.indexColConfig,o=void 0===n?{}:n,l=t.checkColConfig,c=void 0===l?{}:l,u=t.data,s=void 0===u?[]:u,f=o.showIndex,d=o.langJson;s.length&&s.forEach((function(e,t){Object(i.isObject)(e.values)?e.values.numberindex={value:"".concat(t+1)}:e.numberindex={value:"".concat(t+1)}}));var p={label:d.table001,attrcode:"numberindex",dataIndex:"numberindex",className:"table-index",visible:!0,fixed:"left",itemtype:"customer",width:c.showCheck?"60px":"70px",render:function(e,t,r){return a.a.createElement("div",null,r+1)}};return f&&Object(i.isArray)(r)&&(r=[p].concat(Pe(r))),a.a.createElement(e,Ee({},this.props,{columns:r,data:s}))}}])&&Te(r.prototype,n),o&&Te(r,o),c}(o.Component)}r(1852);function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(){return(Fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function qe(e){return function(e){if(Array.isArray(e))return He(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return He(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return He(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Je(e);if(t){var o=Je(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return We(this,r)}}function We(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ze=_.Menu.Item;function Ye(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(u,t);var r,n,o,l=Le(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).onCellClick=function(e,r){var n=t.props,o=n.data,a=n.onCheckChange,l=n.rowKey,u=e.disabled;if(!u||!u.value){var s=e[l]||e.key;Object(i.isObject)(e[l])&&(s=e[l].value);var f=o.findIndex((function(e){return Object(i.isObject)(e[l])?s===e[l].value:e[l]===s}));Object(c.isFunction)(a)&&a(e,f),r.stopPropagation()}},t.chooseStatus=function(e){var r=e.key,n=t.props.checkColConfig;(0,(void 0===n?{}:n).changeCrossSelect)(r)},t}return r=u,(n=[{key:"componentDidMount",value:function(){}},{key:"getTitle",value:function(){var e=this.props,t=e.checkColConfig,r=void 0===t?{}:t,n=e.checkInfo,o=void 0===n?{}:n,i=e.onAllCheckChange,l=r.changeCrossSelect,u=r.crossPageSelect,s=r.langJson,f=a.a.createElement(_.Menu,{onClick:this.chooseStatus},a.a.createElement(ze,{key:"all"},s.table0036||"全选"),a.a.createElement(ze,{key:"reverse"},s.table0039||"全反选"),a.a.createElement(ze,{key:"current"},s.table0040||"仅当前页"));return a.a.createElement("span",{fieldid:Object(c.getSysFieldid)("firstcol")},a.a.createElement(_.Checkbox,{className:"table-checkbox",checked:o.checkedAll,disabled:o.disabledAll,indeterminate:o.indeterminate,tabindex:"-1",onChange:function(e){Object(c.isFunction)(i)&&i(e)}}),u&&Object(c.isFunction)(l)&&a.a.createElement(_.Dropdown,{trigger:["click"],overlay:f,overlayClassName:"select-status",animation:"slide-up"},a.a.createElement("i",{className:"icon-bottom iconfont"})))}},{key:"render",value:function(){var t=this.props,r=t.columns,n=t.checkColConfig,o=void 0===n?{}:n,l=t.onCheckChange;return o.showCheck&&(r=[{title:this.getTitle.bind(this),onCellClick:this.onCellClick,dataIndex:"checkbox",className:"table-checkbox-class",visible:!0,attrcode:"checkbox",itemtype:"customer",width:"54px",fixed:"left",render:function(e,t,r){var n=t.selected,o=t.disabled;return Object(i.isObject)(t.selected)&&(n=t.selected.value),Object(i.isObject)(t.disabled)&&(o=t.disabled.value),a.a.createElement("span",{fieldid:Object(c.getSysFieldid)("firstcol")},a.a.createElement(_.Checkbox,{className:"table-checkbox",checked:!!n,disabled:!!o,tabindex:"-1",onChange:function(){Object(c.isFunction)(l)&&l(t,r,n)}}))}}].concat(qe(r))),a.a.createElement(e,Fe({},this.props,{columns:r}))}}])&&Ue(r.prototype,n),o&&Ue(r,o),u}(o.Component)}function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(){return(Ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ge(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=rt(e);if(t){var o=rt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return tt(this,r)}}function tt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(l,t);var r,n,o,i=et(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).changeColumn=function(){var e=t.props,r=e.columns,n=e.indexColConfig,o=void 0===n?{}:n,i=e.checkColConfig,l=void 0===i?{}:i,c=e.name,u=o.showIndex,s=void 0===u||u,f=l.showCheck,d=void 0===f||f?"checkbox":s?"numberindex":"";if(Array.isArray(r)&&r.length>0&&d){var p=r.find((function(e){return e.attrcode===d}));if(p){var y=p.render,h=p.onCellClick;p.onCellClick=function(e,t){var r=(e.values||e).saga_status;"1"!==(void 0===r?{}:r).value&&h&&h(e,t)},p.render=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=t.values||t,o=n.saga_status,i=void 0===o?{}:o;return"1"===i.value?a.a.createElement(_.ErrorPop,{record:t.values||t,name:c}):y(e,t,r)}}}return r},t.rowClick=function(e,r,n){if(e){var o=t.props.onRowClick,a=(e.values||e).saga_status;"1"!==(void 0===a?{}:a).value&&Object(c.isFunction)(o)&&o(e,r,n)}},t.rowRef=function(e){if(e){var t=(e.values||e).saga_status;"1"===(void 0===t?{}:t).value&&e.element&&e.element.setAttribute("tabindex","-1")}},t}return r=l,(n=[{key:"render",value:function(){var t=this.props,r=(t.columns,t.onRowClick,Ge(t,["columns","onRowClick"]));return a.a.createElement(e,Ze({columns:this.changeColumn(),onRowClick:this.rowClick,rowRef:this.rowRef},r))}}])&&Xe(r.prototype,n),o&&Xe(r,o),l}(o.Component)}function ot(){return(ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r(1855);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(){return(it=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(r),!0).forEach((function(t){ut(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ut(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=yt(e);if(t){var o=yt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return pt(this,r)}}function pt(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yt(e){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ht=_.Form.FormItem,bt=_.Select.Option,vt=["select","radio","checkbox","refer"];function mt(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(u,t);var r,n,o,l=dt(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).handleDoSave=function(){var e=t.props,r=e.store,n=e.tableModelConfirm,o=r.closeModal,a=(0,r.getStore)().modelDatas,l=a.operType,u=a.record,s={},f=t.props.name,d=l;a.modelColumn.forEach((function(e){var r=e.attrcode;"customer"!=r&&(s[r]={display:Object(c.isObj)(u[r])&&u[r].display||null,scale:Object(c.isObj)(u[r])?t.handleScale(u[r].scale):"-1",value:Object(c.isObj)(u[r])?t.handleValue(r,d,u[r].value):null})}));var p=ut({},f,{areaType:"table",pageInfo:{},rows:[{rowId:a.rowId,status:"add"==d?2:1,values:ct({},s)}]});Object(i.isFunction)(n)&&n(p,d),o(f)},t.handleScale=function(e){return void 0===e||null==e?"-1":+e},t.handleValue=function(e,t,r){return"ts"==e&&"add"==t||void 0===r||""==r?null:r},t.handleSubmit=function(){var e=t.props.modalConfig.langJson,r=t.checkSubmitRule(),n=r.flag,o=r.errorTitle,a=r.errorInfo,i=r.errorType,l=r.max;if(n){var u={1:"".concat(e.table0011+a+o),2:"".concat(o+e.table0012+l.toString())};Object(c.toast)({content:u[i],color:"danger"})}else t.handleDoSave()},t.HanlderCheckInput=function(e,t){var r=t.value,n=String(r).length;return!e&&n>0||n>0&&n<=e},t.HanlderCheckNumber=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=arguments.length>1?arguments[1]:void 0,r=t.value;return!!(r&&r<=e)},t.checkSubmitRule=function(){var e=t.props.modalConfig.langJson,r=[-1],n=r[0],o=r[1],a=r[2],i=r[3],l=r[4],c=t.props.store.getStore().modelDatas,u=c.record,s=c.modelColumn;return(s.length&&s.filter((function(e){return!!e.itemtype&&"label"!==e.itemtype&&"customer"!==e.itemtype&&!!e.required}))).some((function(t,r){n=r,o=t.label,a=vt.includes(t.itemtype)?e.table0013:e.table0014,i=null,l="";var c=(u[t.attrcode]||{}).value;return""==c||null==c||null==c?(i="1",!0):!!(t.maxlength&&String(c).length>t.maxlength)&&(i="2",l=t.maxlength,!0)}))?{flag:!0,errorIndex:n,errorTitle:o,errorInfo:a,errorType:i,max:l}:{flag:!1}},t.close=function(){t.props.store.closeModal()},t.afterEvent=function(e,r,n,o,a){"function"==typeof t.props.afterEvent&&t.props.afterEvent(t.props.moduleId,e,r,n,o,a)},t.state={json:{}},t}return r=u,(n=[{key:"render",value:function(){var t=this,r=this.props,n=r.store,o=r.type,i=(r.name,r.modalConfig),l=n.getStore,u=(n.getCtx,n.setModalValue),s=l("modelDatas"),f=s.showModal,d=s.record,p=s.modelColumn,y=i.langJson,h=y.table0015;switch(o){case"add":h=y.table0016;break;case"edit":h=y.table0017}var b=p.length?p.filter((function(e){return!!e.itemtype&&"label"!==e.itemtype&&"customer"!==e.itemtype})):[];return a.a.createElement(a.a.Fragment,null,a.a.createElement(e,this.props),f&&a.a.createElement(_.Modal,{id:"tableModal",show:f,className:"table-modal",backdrop:"static",animation:!1,onHide:this.close},a.a.createElement(_.Modal.Header,{closeButton:!0},a.a.createElement(_.Modal.Title,null,h)),a.a.createElement(_.Modal.Body,null,a.a.createElement(_.Form,{showSubmit:!1,useRow:!0,className:"table-modal-form"},b.map((function(e,r){var n="function"==typeof e.render?e.render("",s.record,s.index):null;if(n){var o=d[e.attrcode]||{};return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,valuePropsName:"value",showMast:!!e.required,isRequire:!!e.required,method:"blur",labelName:e.label},ct(ct({},n),{},{key:e.attrcode,props:ct(ct(ct({},n),e),{},{foolValue:o,disabled:!!e.disabled,onChange:function(r){u(e.attrcode,r,"refer");var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}})}))}if(e.refcode);else switch(e.itemtype){case"input":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,valuePropsName:"value",showMast:!!e.required,isRequire:!!e.required,method:"blur",asyncCheck:t.HanlderCheckInput.bind(t,e.maxlength),labelName:e.label,errorMessage:e.maxlength?"".concat(e.label+y.table0012+e.maxlength.toString()):"".concat(y.table0011+y.table0014+e.label)},a.a.createElement(_.Input,it({placeholder:"".concat(y.table0011+y.table0014,"+..."),name:e.attrcode,disabled:!!e.disabled},e,{value:d[e.attrcode]?d[e.attrcode].value:null,onChange:function(t){u(e.attrcode,t)},onBlur:function(r){var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}})));case"number":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,valuePropsName:"value",showMast:!!e.required,isRequire:!!e.required,method:"blur",asyncCheck:t.HanlderCheckNumber.bind(t,e.max),labelName:e.label,errorMessage:e.max?"".concat(e.label+y.table0018+e.max):"".concat(y.table0011+y.table0014+e.label)},a.a.createElement(_.InputNumber,it({placeholder:"".concat(y.table0011+y.table0014,"+..."),name:e.attrcode,scale:d[e.attrcode]&&!Object(c.isWrong)(d[e.attrcode].scale)&&"-1"!=d[e.attrcode].scale?+d[e.attrcode].scale:+e.scale||0,disabled:!!e.disabled},e,{value:d[e.attrcode]?d[e.attrcode].value:null,onChange:function(t){u(e.attrcode,t)},onBlur:function(r){var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}})));case"refer":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,valuePropsName:"value",showMast:!!e.required,isRequire:!!e.required,method:"blur",labelName:e.label},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case"cont":return a.a.createElement(_.Refer,ot({refName:"交易类型",refCode:"cont",queryGridUrl:"/nccloud/reva/ref/cont.do"},t));case"dept":return a.a.createElement(_.Refer,ot({refName:"部门",refCode:"dept",refType:"tree",queryTreeUrl:"/nccloud/reva/ref/dept.do"},t));case"finance":return a.a.createElement(_.Refer,ot({refName:"财务组织",refCode:"finance",refType:"tree",queryTreeUrl:"/nccloud/reva/ref/finance.do"},t));case"materialclass":return a.a.createElement(_.Refer,ot({refName:"物料分类",refCode:"materialclass",queryGridUrl:"/nccloud/reva/ref/materialclass.do"},t));case"material":return a.a.createElement(_.Refer,ot({refName:"物料",refCode:"material",refType:"gridTree",isMultiSelectedEnabled:!0,queryGridUrl:"/nccloud/reva/ref/material.do",queryTreeUrl:"/nccloud/reva/ref/materialclass.do"},t));case"obligation":return a.a.createElement(_.Refer,ot({refName:"履约义务档案",refCode:"obligation",refType:"tree",queryTreeUrl:"/nccloud/reva/ref/obligation.do"},t));default:return a.a.createElement(_.Refer,ot({refName:"test",refCode:"test",queryGridUrl:"/test/test.do"},t))}}(e.refcode,{disabled:!!e.disabled,foolValue:d[e.attrcode]||{},onChange:function(r){u(e.attrcode,r,"refer");var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}}));case"select":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,method:"blur",showMast:!!e.required,isRequire:!!e.required,labelName:e.label,errorMessage:"".concat(y.table0011+y.table0013+e.label)},a.a.createElement(_.Select,it({type:"customer",disabled:!!e.disabled,value:d[e.attrcode]?d[e.attrcode].value:""},e,{onChange:function(r){u(e.attrcode,String(r));var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:String(r)},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,String(r),s.index,s.record)},getPopupContainer:function(){return document.querySelector("#tableModal")},dropdownStyle:{zIndex:18e3},dropdownClassName:e.attrcode+"-select"}),e.options.length&&e.options.map((function(e,t){return a.a.createElement(bt,{value:String(e.value),key:t,title:e.display}," ",e.display," ")}))));case"datepicker":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,showMast:!!e.required,isRequire:!!e.required,labelName:e.label,errorMessage:"".concat(y.table0011+y.table0013+e.label)},a.a.createElement(_.DatePicker,it({type:"customer",format:"YYYY-MM-DD",disabled:!!e.disabled,getCalendarContainer:function(){return document.querySelector("#tableModal")},placeholder:"".concat(y.table0013+y.table0019+y.table0020)},e,{value:d[e.attrcode]?Object(c.moment)(d[e.attrcode].value):null,onChange:function(r){u(e.attrcode,r);var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}})));case"textarea":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,showMast:!0,labelName:e.label},a.a.createElement(_.TextArea,it({placeholder:"".concat(y.table0011+y.table0014,"+..."),disabled:!!e.disabled,name:e.attrcode},e,{value:d[e.attrcode]?d[e.attrcode].value:null,onChange:function(r){u(e.attrcode,r);var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}})));case"radio":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,showMast:!0,labelName:e.label},a.a.createElement(_.Radio.RadioGroup,it({type:"customer",name:e.attrcode,disabled:!!e.disabled,selectedValue:d[e.attrcode]?String(d[e.attrcode].value):null},e,{onChange:function(r){u(e.attrcode,String(r));var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:String(r)},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,String(r),s.index,s.record)}}),e.options.length&&e.options.map((function(e,t){return a.a.createElement(_.Radio,{value:String(e.value),key:t}," ",e.display," ")}))));case"switch":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,showMast:!0,labelName:e.label},a.a.createElement(_.Switch,it({checked:!!d[e.attrcode]&&!!d[e.attrcode].value,disabled:!!e.disabled},e,{onChange:function(r){u(e.attrcode,r);var n=[];n.push({rowid:s.rowId||String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12),newvalue:{value:r},oldvalue:{value:"value"}}),t.afterEvent(e.attrcode,n,r,s.index,s.record)}})));case"rangepicker":return a.a.createElement(ht,{key:r,inline:!0,labelMd:3,md:9,showMast:!0,labelName:e.label},a.a.createElement("div",null,"rangepicker"));default:return null}})))),a.a.createElement(_.Modal.Footer,null,a.a.createElement(_.Button,{className:"btn-2",onClick:this.handleSubmit},y.table0021),a.a.createElement(_.Button,{className:"btn-2 btn-cancel",onClick:this.close,shape:"border"},y.table_cancel))))}}])&&st(r.prototype,n),o&&st(r,o),u}(o.Component)}r(903);function gt(e,t,r){var n=r.numberPd||20;e.forEach((function(e){var o=e.children,i=e.visible,l=e.attrcode,u=e.width,s=e.fixed,f=e.istotal,d=e.scale,p=e.itemtype,y=e.islock;if(!Object(c.isUndefined)(o)&&o.length)i&&gt(o,t,r);else if(i){var h={key:l,dataIndex:l,attrcode:l,itemtype:p,width:u,fixed:y&&!s?"left":s,istotal:f,scale:d};"opr"!==l||u||(h.width=200),"checkbox"!==l&&"numberindex"!==l&&(h.render=function(e,t){var r={textAlign:"right",width:"calc(100% - "+n+"px)"};return t[l]?a.a.createElement("div",{className:"total-row-table-cell",style:r,fieldid:Object(c.getSysFieldid)(l)},a.a.createElement(_.Tooltip,{className:"tooltip-word-color table-pagination-tip",placement:"top",delay:1,overlay:t[l]},a.a.createElement("span",{className:"ellipsis"},Object(c.formatNumber)(t[l])))):a.a.createElement("span",null,"  ")}),t.push(h)}}))}function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(){return(Ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function St(e){return function(e){if(Array.isArray(e))return jt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=It(e);if(t){var o=It(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _t(this,r)}}function _t(e,t){return!t||"object"!==wt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Et(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(u,t);var r,n,o,l=xt(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).addTotalAreaScrollEvent=function(){var e=t.total&&t.total.querySelector(".u-table-body"),r=t.table&&t.table.querySelector(".u-table-body .scroll-container"),n=t.table&&t.table.querySelector(".u-table-content .u-table-scroll .u-table-header");e&&(r&&(r.scrollLeft=e.scrollLeft),n&&(n.scrollLeft=e.scrollLeft))},t.addTotalInnerAreaScrollEvent=function(){var e=t.total&&t.total.querySelector(".u-table-body .scroll-container"),r=t.table&&t.table.querySelector(".u-table-body .scroll-container"),n=t.table&&t.table.querySelector(".u-table-content .u-table-scroll .u-table-header");e&&(r&&(r.scrollLeft=e.scrollLeft),n&&(n.scrollLeft=e.scrollLeft))},t.onDropBorder=function(){for(var e=t.table.querySelectorAll(".nc-table:not(.total-row) >div.u-table-content >div.u-table-scroll >div:nth-child(1) .u-table-body table colgroup col"),r=t.total&&t.total.querySelectorAll(".u-table-scroll .u-table-body colgroup col"),n=0,o=e.length;n<o;n++){var a=e[n].style.width;r[n].style.width=a,"string"==typeof a&&(a=Number(a.match(/\d+/g)[0]))}(t.total&&t.total.querySelector(".u-table-body")).style.overflowX="auto"},t.onDraggingBorder=function(){for(var e=t.table.querySelectorAll(".nc-table:not(.total-row) >div.u-table-content >div.u-table-scroll >div:nth-child(1) .u-table-body table colgroup col"),r=t.total&&t.total.querySelectorAll(".u-table-scroll .u-table-body colgroup col"),n=0,o=e.length;n<o;n++){var a=e[n].style.width;r[n].style.width=a,"string"==typeof a&&(a=Number(a.match(/\d+/g)[0]))}(t.total&&t.total.querySelector(".u-table-body .scroll-container")).style.overflowX="auto",t.hidebodyScrollbar(),Object(i.isFunction)(t.props.onDraggingBorder)&&t.props.onDraggingBorder()},t.haveHorizontalScrollBar=function(){var e=t.total&&t.total.querySelector(".u-table-body .scroll-container");if(e)return e.querySelector("table").offsetWidth>e.offsetWidth},t.hidebodyScrollbar=function(){if(t.total){var e=t.total;if(t.haveHorizontalScrollBar()){e&&("Firefox"===t.browser||"IE"===t.browser||"Edge"===t.browser?e.style.marginTop="-17px":e.style.marginTop="-10px");var r=t.total.querySelectorAll("td");if(r&&r.length)for(var n=0,o=r.length;n<o;n++)"Firefox"===t.browser||"IE"===t.browser||"Edge"===t.browser?r[n].style.paddingTop="5px":r[n].style.paddingTop="10px"}else if(!t.haveHorizontalScrollBar()){if(e)e.style.marginTop="0px",e.querySelector(".u-table-body .scroll-container").style.overflowX="visible";var a=t.total.querySelectorAll("td");if(a&&a.length)for(var i=0,l=a.length;i<l;i++)a[i].style.paddingTop="0px"}}},t.handleFooter=function(){var e,r,n=t.props,o=n.columns,i=n.data,l=n.totalConfig,u=void 0===l?{}:l,s=n.checkColConfig,f=void 0===s?{}:s,d=n.inserttableTotalConfig,p=(n.numberPd,[]),y={};if(d)p=d.totalColumns,y=d.totalData;else{var h=t.state.json;p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return gt(e,r,t),r}(o,{numberPd:u.numberPd});var b=(e=i,r={},p.forEach((function(t){var n=0;e.forEach((function(e){var r=(e.values||e)[t.key];if(r&&!Object(c.isWrong)(r.value)&&!Object(c.isWrong)(r.scale)&&-1!=r.scale&&Number(r.scale)>n)n=Number(r.scale);else if(r&&!Object(c.isWrong)(r.value)&&(Object(c.isWrong)(r.scale)||"-1"==r.scale)){var o=t.scale?Number(t.scale):0;o>n&&(n=o)}})),r[t.key]=n})),r);y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=this,a={},i=[];e.forEach((function(e){var t=e.itemtype;a[e.key]=null,e.istotal&&"number"===t&&i.push(e.key)}));var l=r.noTotalRows,u=r.noTotalCol,s=void 0===u?[]:u,f=r.showTotal,d=r.allowTotalRows,p={};Object(c.isFunction)(l)&&Array.isArray(l.call(o))&&l.call(o).length>0&&l.call(o).forEach((function(e){var t=e.code,r=e.indexArr;p[r]=t}));var y=[];return Object(c.isFunction)(d)&&(y=d.call(o)),t.forEach((function(e,t){if(!Object(c.isFunction)(d)||y.includes(t)){var r=e.values||e;Object.keys(r).forEach((function(e){var o=r[e]||{},l=o.value,u=o.scale;if(!Object(c.isWrong)(l)&&!Object(c.isBooleanType)(l)&&!Number.isNaN(Number(l))&&(Object.keys(p).length<1||Object.keys(p).length>0&&(!p[t]||!p[t].includes(e)))&&"numberindex"!==e&&!s.includes(e)){var d=Number(Object(c.isWrong)(u)||"-1"==u?n[e]||8:u);(f||i.includes(e))&&(a[e]=Object(c.sum)(Object(c.formatDot)(a[e]||0,d),Object(c.formatDot)(Object(c.convertNum)(l),d)))}}))}})),[a]}(p,i,u,b||{}),null!==b&&(y=function(e,t){return Object.keys(e).forEach((function(r){"checkbox"!=r&&"numberindex"!=r&&(e[r]=Object(c.formatAcuracy)(e[r],t[r]))})),[e]}(y[0],b)),f.showCheck?y[0].checkbox=h.table002:y[0].numberindex=h.table002}return a.a.createElement("div",{fieldid:Object(c.getSysFieldid)("total-row")},a.a.createElement(_.Table,{minColumnWidth:10,height:35,ref:function(e){t.total=oe.a.findDOMNode(e)},className:"total-row",data:y,columns:St(p),rowKey:"total-row",showHeader:!1,headerScroll:!1,scroll:{},bodyStyle:{minHeight:35,overflowX:"auto"}}))},t.state={json:{}},t.browser=Object(c.myBrowser)(),t}return r=u,(n=[{key:"UNSAFE_componentWillMount",value:function(){var e=this;Object(c.getMultiLang)({moduleId:"page_table",callback:function(t){e.setState({json:t})}})}},{key:"componentDidMount",value:function(){var e=this.props.isTotal;e&&this.addScrollEvent(),e&&this.hidebodyScrollbar(),window.addEventListener("resize",this.hidebodyScrollbar)}},{key:"componentDidUpdate",value:function(){var e=this.props.isTotal;e&&this.addScrollEvent(),e&&this.hidebodyScrollbar()}},{key:"componentWillUnmount",value:function(){this.props.isTotal&&this.removeScrollEvent()}},{key:"addScrollEvent",value:function(){this.removeScrollEvent();var e=this.total&&this.total.querySelector(".u-table-body"),t=this.total&&this.total.querySelector(".u-table-body .scroll-container");e&&e.addEventListener("scroll",this.addTotalAreaScrollEvent),t&&t.addEventListener("scroll",this.addTotalInnerAreaScrollEvent),"Firefox"==Object(c.myBrowser)()&&(requestAnimationFrame((function(){e.style.overflowX="auto",e.style.marginBottom="0px"})),e.style.marginBottom="17px",e.style.overflowX="hidden")}},{key:"removeScrollEvent",value:function(){var e=this.total&&this.total.querySelector(".u-table-body"),t=this.total&&this.total.querySelector(".u-table-body .scroll-container");e&&e.removeEventListener("scroll",this.addTotalAreaScrollEvent),t&&t.removeEventListener("scroll",this.addTotalInnerAreaScrollEvent)}},{key:"render",value:function(){var t=this;return this.props.isTotal?a.a.createElement(e,Ot({},this.props,{footer:this.handleFooter,setCellValue:function(e){t.forceUpdate(),Object(i.isFunction)(t.props.setCellValue)&&t.props.setCellValue(e)},ref:function(e){t.table=oe.a.findDOMNode(e)},onDraggingBorder:function(){t.onDraggingBorder()}})):a.a.createElement(e,this.props)}}])&&kt(r.prototype,n),o&&kt(r,o),u}(o.Component)}function Pt(e){return function(e){if(Array.isArray(e))return Vt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Mt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(r),!0).forEach((function(t){Kt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Kt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||Mt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(e,t){if(e){if("string"==typeof e)return Vt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vt(e,t):void 0}}function Vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var At=I.a.ROW_STATUS;console.log(I.a),r(1857);var Nt=_.Modal.Header,Ft=_.Modal.Title,qt=_.Modal.Body,Ht=_.Modal.Footer,Ut=_.Select.Option,Bt=function(e,t,r,n,o,a,l,u,s,f,d){if("32"===u&&["select","checkbox","radio"].includes(e)&&Object(i.isArray)(s)&&!t&&null!=r)return"checkbox"===e||f?s.filter((function(e){return r.includes(e.value)})).map((function(e){return e.display})).join(","):(s.filter((function(e){return e.value==r}))[0]||{}).display;switch(!0){case I.a.displayTypes.includes(e):return t||r;case I.a.boolean.includes(e):return"Y"==r||1==r?d.table_yes:d.table_no;case I.a.timeTypes.includes(e):return"datetimepicker"===e?Object(c.formatDatetime)(Object(c.changeTime)(r,"YYYY-MM-DD HH:mm:ss"),"datetime"):"timepicker"===e?Object(c.formatDatetime)(r,"time"):"datePickerNoTimeZone"===e?Object(c.formatDatetime)(r,"date"):Object(c.formatDatetime)(Object(c.changeTime)(r),"date");case"label"===e:return Object(c.isNullOrVoid)(t)?r:t||r;case"number"===e:return Object(c.formatNumber)(Object(c.formatAcuracy)(r,n),!0);case"password"===e:return r&&Object(c.getRandomPassword)();case"residtxt"===e:var p=Object(c.getLangCode)(),y=a.filter((function(e){return e.languageCode==p}));return y.length>0?("1"===y[0].index&&(y[0].index=""),l[o+y[0].index]&&l[o+y[0].index].value?r=l[o+y[0].index].value:r):r;default:return Object(c.isNullOrVoid)(t)?r:t||r}},Lt=function(e){var t=e.allRows,r=e.filterFactor,n=e.customColData,o=e.rowKey,a=e.langJson;return r.reduce((function(e,r){var l=r.attrcode,c=r.itemtype,u=r.factorValue,s=r.scale,f=r.languageMeta,d=void 0===f?[]:f,p=r.itemKey,y=r.datatype,h=r.options,b=r.multiple;if(u){var v=e.filteredRow,m=e.filteredRowKeyValues,g=e.filteredColumnKey;t.forEach((function(e,t){var r=e.values,f=e.status,w=e[o];if(f!==At.delete){var O="";n&&n[l]?O=n[l][w]:r[l]&&(O=Bt.call(void 0,c,r[l].display,r[l].value,s,l,d,r,y,h,b,a)),Object(i.isWrong)(O)&&(O="");var S=String(O).toLowerCase(),j=String(u).toLowerCase();O&&S.includes(j)&&(!g.includes(p)&&g.push(p),!m.includes(w)&&v.push(e),!m.includes(w)&&m.push(w))}}))}return e}),{filteredRow:[],filteredRowKeyValues:[],filteredColumnKey:[]})},Wt=function(e){var t=e.filterFactors.current,r=e.itemKey,n=e.filterItemList,l=e.setFilterItemList,c=e.afterFilterItemList,u=e.factorList,s=e.columns,f=e.langJson,d=n[r],p=d.selectedAttr,y=d.selectFcous,h=d.inputFocus,b="",v=t[r];if(v){var m=v.factorValue;m&&(b=m)}var g=Dt(Object(o.useState)(b),2),w=g[0],O=g[1],S=Dt(Object(o.useState)(p),2),j=S[0],k=S[1];return a.a.createElement("div",{className:"filter-item-container"},a.a.createElement("div",{className:"select-container"},a.a.createElement(_.Select,{showClear:!1,autoFocus:y,value:j,onChange:function(e){var o=c.current;n[r].selectedAttr=e,k(e);var a=Object.values(n).map((function(e){return e.selectedAttr})),i=Object.values(o).map((function(e){return e.selectedAttr}));s.forEach((function(e){var t=e.attrcode;a.includes(t)?e.filterStatus="filtering":e.filterStatus="",i.includes(t)&&(e.filterStatus="filtered")})),"pselect"!==e?t[r]=v?Tt(Tt({},v),u[e]):Tt(Tt({},u[e]),{},{factorValue:w,itemKey:r}):Reflect.deleteProperty(t,r)}},[{attrcode:"pselect",label:f.table0026}].concat(Pt(s)).map((function(e){var t=e.attrcode,r=e.label,n=e.title||r;return Object(i.isFunction)(n)&&(console.warn("the column label is Function , maybe error"),n=n({})),a.a.createElement(Ut,{key:t,value:t},n)})))),a.a.createElement("div",{className:"input-container"},a.a.createElement(_.Input,{value:w,disabled:"pselect"===j,onChange:function(e){v?(t[r]=Tt(Tt({},v),{},{factorValue:e,itemKey:r}),O(e)):"pselect"!==j&&(t[r]=Tt(Tt({},u[j]),{},{factorValue:e,itemKey:r}),O(e))},autoFocus:h})),a.a.createElement("i",{className:"iconfont nc-theme-icon-font-c icon-shanchu",onClick:function(){Reflect.deleteProperty(n,r),Reflect.deleteProperty(t,r);var e=c.current,o=Object.values(n).map((function(e){return e.selectedAttr})),a=Object.values(e).map((function(e){return e.selectedAttr}));s.forEach((function(e){var t=e.attrcode;o.includes(t)||(e.filterStatus=""),a.includes(t)&&(e.filterStatus="filtered")})),l(Tt({},n))}}))},Jt=function(e){var t=e.tableColumns,r=e.tableScope,n=e.filterData,l=e.customColData,u=e.rowKey,s=e.selectedAttr,f=e.filterStatus,d=e.isReset,p=e.handleResetCallBack,y=e.handleFilterCallBack,h=e.tableName,b=e.langJson,v=e.open,m=void 0!==v&&v,g=e.onHide,w=null,O=Object(o.useRef)({}),S=Object(o.useRef)({}),j=Object(o.useRef)({}),k=Dt(Object(o.useState)({}),2),C=k[0],x=k[1],I=Dt(Object(o.useState)({selectedAttr:s,filterStatus:f}),2),E=(I[0],I[1],Dt(Object(o.useState)(""),2)),P=E[0],R=E[1],T=Object(o.useMemo)((function(){return function e(t){var r=t.columns,n=t.finalFactorList;return r.reduce((function(t,r){var n=r.children,o=r.visible;return Object(i.isUndefined)(n)?(o&&t.push(r),t):(e({columns:n,finalFactorList:t}),t)}),n)}({columns:t,finalFactorList:[]})}),[t]),K=Object(o.useMemo)((function(){return T.reduce((function(e,t){var r=t.attrcode,n=t.itemtype,o=t.languageMeta,a=t.scale,i=t.datatype,l=t.options,c=t.multiple;return e[r]={attrcode:r,itemtype:n,languageMeta:o,scale:a,datatype:i,options:l,multiple:c},e}),{})}),[T]),D=function(){O.current={},x({}),P.length&&R(""),setTimeout((function(){g&&g({filterItemList:C,afterFilterItemList:S,arrColumns:T})}),20)},M=function(e,t){e&&(O.current=e),e&&(j.current=e),t&&(S.current=t);var r=O.current,o=S.current,a=j.current,i=Lt({allRows:n.map((function(e){return e.filterIndex&&delete e.filterIndex,e})),filterFactor:Object.values(r),customColData:l,rowKey:u,langJson:b}),c=i.filteredRow,s=i.filteredRowKeyValues,f=i.filteredColumnKey;if(console.log(c,s,f),c.length){R("");var d=f.reduce((function(e,t){var n=e.newAfterFilterItemListCurrent,i=e.newAfterFilterFactorsCurrent;return o[t]?(n[t]=o[t],i[t]=a[t]):(n[t]=C[t],i[t]=r[t]),e}),{newAfterFilterFactorsCurrent:{},newAfterFilterItemListCurrent:{}}),p=d.newAfterFilterItemListCurrent,h=d.newAfterFilterFactorsCurrent;S.current=p,j.current=h;var v=Object.values(C).map((function(e){return e.selectedAttr})),m=Object.values(p).map((function(e){return e.selectedAttr}));T.forEach((function(e){var t=e.attrcode;m.includes(t)?e.filterStatus="filtered":v.includes(t)||(e.filterStatus="")})),y&&y({filteredRow:c,filterItemList:C,filteredRowKeyValues:s,afterFilterItemList:p,afterFilterFactors:h,arrColumns:T}),D()}else R(b.table0027)},V=function(e){e&&13==e.keyCode&&M()},A=function(){S.current={},j.current={},T.forEach((function(e){e.filterStatus=""})),p&&p({filterItemList:C,arrColumns:T}),D()},N=function(e){var t=e.selectedAttr,r=e.filterStatus,n=Object(i.getRandom)(),o=null,a=O.current,l=j.current,c=S.current;if(Object.keys(c).length){if("filtered"===r)return void function(){var e=j.current,t=S.current;if(Object.keys(t).length)O.current=e,x(t);else{var r=Object(i.getRandom)();Object.values(C).forEach((function(e){e.selectFcous=!1,e.inputFocus=!1})),C[r]={key:r,selectedAttr:"pselect",selectFcous:!0,inputFocus:!1}}}();var u=Object.values(c).filter((function(e){return e.selectFcous=!1,e.inputFocus=!1,e.selectedAttr===t}));if(u.length)return u.forEach((function(e){var t=e.key;Reflect.deleteProperty(C,t),Reflect.deleteProperty(a,t),Reflect.deleteProperty(l,t),Reflect.deleteProperty(c,t)})),O.current=l,o=c,Object.values(c).length?void M():void A();O.current=l,o=Tt(Tt({},c),{},Kt({},n,{key:n,selectedAttr:t,selectFcous:!1,inputFocus:!0})),T.forEach((function(e){var r=e.attrcode;t===r&&(e.filterStatus=e.filterStatus||"filtering")})),x(Tt({},o))}else Object.values(C).forEach((function(e){e.selectFcous=!1,e.inputFocus=!1})),C[n]={key:n,selectedAttr:t,selectFcous:!1,inputFocus:!0},T.forEach((function(e){var r=e.attrcode;t===r&&(e.filterStatus=e.filterStatus||"filtering")}))};Object(o.useEffect)((function(){console.log(d,"isReset"),d&&(T.forEach((function(e){e.filterStatus=""})),r.filterData=null,S.current={},j.current={})}),[d]),Object(o.useEffect)((function(){console.log(s,f,"currentFilter"),s&&N({selectedAttr:s,filterStatus:f})}),[s,f]);var F=M.bind(null,null,null);return a.a.createElement(_.Modal,{ref:function(e){w=oe.a.findDOMNode(e)},size:"lg",zIndex:800,show:m,backdrop:!0,onHide:D.bind(null),backdropClosable:!0,onEntered:function(){w.childNodes[1].querySelector(".modal-content-parent,.modal-content-resizeWrap-parent").addEventListener("keydown",V),x(Tt({},C))},onExited:function(){w.childNodes[1].querySelector(".modal-content-parent,.modal-content-resizeWrap-parent").removeEventListener("keydown",V)},draggable:!0,resizable:!0,className:"filterPanel-modal",fieldid:"filterPanel"},a.a.createElement(Nt,{closeButton:!0},a.a.createElement(Ft,{fieldid:"".concat(b.table0028).concat(h||"")},"".concat(b.table0028).concat(h||"",":"),a.a.createElement("span",{className:P?"table-filter-tips":"filter-tips-hidden"},a.a.createElement("span",{className:"iconfont icon icon-gantanhao"}),P))),a.a.createElement(qt,null,Object.values(C).map((function(e){var t=e.key;return a.a.createElement(Wt,{key:Object(i.getRandom)(),itemKey:t,afterFilterItemList:S,filterFactors:O,filterItemList:C,factorList:K,columns:T,tableScope:r,currentTable:{},setFilterItemList:x,langJson:b})})),a.a.createElement("div",{className:"add-btn-container"},a.a.createElement("div",{className:"add-btn",fieldid:Object(c.getSysFieldid)("add_btn"),onClick:function(){var e=Object(i.getRandom)();Object.values(C).forEach((function(e){e.selectFcous=!1,e.inputFocus=!1})),C[e]={key:e,selectedAttr:"pselect",selectFcous:!0,inputFocus:!1},x(Tt({},C))}},"+".concat(b.table0029)),a.a.createElement(_.Button,{onClick:function(){var e=Object(i.getRandom)();x(Kt({},e,{key:e,selectedAttr:"pselect",selectFcous:!0,inputFocus:!1})),O.current={};var t=Object.values(C).map((function(e){return e.selectedAttr}));T.forEach((function(e){var r=e.attrcode;t.includes(r)&&"filtering"===e.filterStatus&&(e.filterStatus="")}))},fieldid:"clear"},b.table0030))),a.a.createElement(Ht,null,a.a.createElement(_.ButtonGroup,null,a.a.createElement(_.Button,{className:"filter-btn",fieldid:"filter",colors:"primary",onClick:F},b.table0028),a.a.createElement(_.Button,{className:"reset-btn",fieldid:"reset",onClick:A},b.table0031)),a.a.createElement(_.Button,{onClick:D.bind(null),fieldid:"cancel"},b.table_cancel)))};function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(){return(Yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function $t(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=tr(e);if(t){var o=tr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Qt(this,r)}}function Qt(e,t){return!t||"object"!==zt(t)&&"function"!=typeof t?er(e):t}function er(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(e){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rr(Object(r),!0).forEach((function(t){or(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function or(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(1856);function ar(e){return e||console.error("缺少Table组件"),function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(u,t);var r,n,l,c=Xt(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).onTitleClick=t.onTitleClick.bind(er(t)),t.state={open:!1,filterColumns:[]},t.uuid=Object(i.uuidv4)(),t}return r=u,(n=[{key:"getFilterPanelItems",value:function(){var e=this.props,t=e.columns,r=e.nonFilterable,n=void 0===r?["numberindex","opr","checkbox"]:r;return Object(i.filterColumns)(t,(function(e){var t=e.attrcode,r=e.visible;return!n.includes(t)&&r}))}},{key:"onTitleClick",value:function(e,t){var r=this.props,n=(r.arrColumns,r.nonFilterable),o=void 0===n?["numberindex","opr","checkbox"]:n,a=e.attrcode,i=e.filterStatus;!o.includes(a)&&this.setState(nr({open:!t,selectedAttr:a},t?{}:{filterStatus:i}))}},{key:"render",value:function(){var t=this,r=this.props,n=r.columns,i=r.high_filter,l=void 0===i?{}:i,c=$t(r,["columns","high_filter"]),u=l.langJson,f=void 0===u?{}:u,d=l.alloweFilter,p=void 0===d||d,y=l.nonFilterable,h=void 0===y?["numberindex","opr","checkbox"]:y,b=l.handleResetCallBack,v=l.handleFilterCallBack,m=l.onHide,g=l.isReset,w=void 0!==g&&g,O=l.panelTitle,S=l.filterData,j=void 0===S?[]:S,k=l.customColData,C=l.rowKey,x=this.state,_=x.open,I=x.selectedAttr,E=x.filterStatus;return p&&(n=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return t.map((function(t){if(t.children)return nr(nr({},t),{},{children:e(t.children,r,n)});var i=t.className,l=t.filterStatus;return nr(nr({},t),{},{className:s()(i,"filterable-column"),titleIcon:function(){return a.a.createElement(o.Fragment,null,!r.includes(t.attrcode)&&"filtered"!==l&&a.a.createElement("i",{className:"iconfont th-filter icon-lieguolv",onClick:function(e){n&&n(t)}}),!r.includes(t.attrcode)&&"filtered"===l&&a.a.createElement("i",{className:"iconfont th-filter icon-lieshaixuanx filtered",onClick:function(e){e.stopPropagation(),n&&n(t,!0)}}))}})}))}(n,h,this.onTitleClick)),a.a.createElement(o.Fragment,null,p&&a.a.createElement(Jt,{tableColumns:this.getFilterPanelItems(),filterData:j,customColData:k,rowKey:C,open:_,isReset:w,selectedAttr:I,filterStatus:E,onHide:function(e){var r=e.arrColumns,n={};r.forEach((function(e){var t=e.attrcode;"filtering"===e.filterStatus&&(e.filterStatus="",n[t]={filterStatus:""})})),m&&m(nr(nr({},e),{columnStatus:n})),t.setState({open:!1,selectedAttr:"",filterStatus:""})},tableScope:this,tableName:O,handleFilterCallBack:function(e){var t=e.filterItemList,r=e.afterFilterItemList,n=e.arrColumns,o={},a=Object.values(t).map((function(e){return e.selectedAttr})),i=Object.values(r).map((function(e){return e.selectedAttr}));n.forEach((function(e){var t=e.attrcode;i.includes(t)?o[t]={filterStatus:"filtered"}:a.includes(t)||(o[t]={filterStatus:""})})),v&&v(nr(nr({},e),{columnStatus:o}))},handleResetCallBack:function(e){var t=e.arrColumns,r={};t.forEach((function(e){r[e.attrcode]={filterStatus:""}})),b&&b(nr(nr({},e),{columnStatus:r}))},langJson:f}),a.a.createElement(e,Yt({columns:n},c)))}}])&&Zt(r.prototype,n),l&&Zt(r,l),u}(o.Component)}function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function cr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(r),!0).forEach((function(t){ur(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ur(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fr(e,t){return(fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=hr(e);if(t){var o=hr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return pr(this,r)}}function pr(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?yr(e):t}function yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(1854);var br=2,vr=2;function mr(e){return Math.abs(e)+"px"}var gr=function(e,t){!function(e,t){return e&&t&&-1!==e.className.indexOf(t)}(e,t)&&(e.className+=" ".concat(t))},wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fr(e,t)}(a,e);var t,r,n,o=dr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).onMouseDown=function(e){var r=t.props.canvas,n=document.querySelector("".concat(r)),o=e.target,a=n&&n.querySelector(".edit-table-modal");if(!/Mac|iPod|iPhone|iPad/.test(navigator.platform)||"17"!==e.keyCode&&"Control"!==e.key&&"ControlLeft"!==e.code||0!==e.button){if(0!==e.button||!n||!n.contains(o)||!t.getEnabled()||!o||-1!==o.className.indexOf("u-table-thead-th-drag-gap")||a&&a.contains(o)||-1!==o.parentElement.className.indexOf("u-table-thead-th-drag-gap")){if(t.hotkey=null,t.drag=!1,a&&a.contains(o))return!0;var i=document.querySelector("#nc-table-setColumnMenu");if(n&&!n.contains(o)&&(!i||!i.contains(o))){var l=n.querySelector(".column-title-actived, .table-cell-actived");l&&t.clearData({isSelect:l},t.hotkey)}return!0}if(t.clearShape(),t.startPoint={x:e.clientX,y:e.clientY},(e.ctrlKey||e.metaKey)&&e.shiftKey&&t.getEnabled("ctrl")&&t.getEnabled("shift"))t.hotkey="ctrl&shift";else if((e.ctrlKey||e.metaKey)&&t.getEnabled("ctrl")){t.hotkey="ctrl";var c=t.props.hasSelectorItem,u=t.getItemKey(t.getItem(o)),s=!1;c&&(s=c(t.hotkey,u)),t.selectorItem[u]||s?delete t.selectorItem[u]:(t.selectorItem[u]=!0,t.startItem=u)}else if(e.shiftKey&&t.getEnabled("shift"))t.hotkey="shift";else{if(t.hotkey="down",o.getAttribute("cellDrag")&&t.getEnabled("drag"))t.drag=!0,t.hotkey="drag";else{var f=n&&n.querySelector(".column-title-actived, .table-cell-actived");t.clearData({isSelect:f},t.hotkey)}var d=t.getItemKey(t.getItem(o));t.startItem=d}}},t.onMouseOver=function(e){t.endItem=t.getItemKey(t.getItem(e.target))||t.endItem},t.onMouseMove=function(e){var r=t.props.canvas,n=document.querySelector("".concat(r)),o=t.props.response;if(!t.getEnabled("slide")||!n||!n.contains(e.target)&&t.$selectableShape!==e.target)return!1;if(0==e.button&&t.hotkey&&!t.drag){var a=t.startPoint.x,i=t.startPoint.y,l=e.clientX,c=e.clientY,u=e.pageX,s=e.pageY-c,f=u-l,d=(window.innerWidth,window.innerHeight,t.$selectableShape.style);if(Math.abs(c-i)<o&&Math.abs(l-a)<o||t.endItem===t.startItem)return!1;gr(n,"pointer-events-none"),t.hotkey="slide",d.right="auto",d.bottom="auto",l>=a&&c>=i?(d.top=mr(s+i-vr),d.left=mr(f+a-br)):l<a&&c>=i?(d.top=mr(s+i-vr),d.left=mr(f+l+br)):l>=a&&c<i?(d.top=mr(s+c+vr),d.left=mr(f+a-br)):(d.top=mr(s+c+vr),d.left=mr(f+l+br)),d.width=mr(l-br-a),d.height=mr(c-vr-i),t.moveToScroll(e.target,c<i)}if(0==e.button&&t.hotkey&&t.drag){var p=t.props,y=p.onSelect;p.response;t.endItem=t.getItemKey(t.getItem(e.target))||t.endItem,y&&y(t.selectorItem,t.hotkey,{currentKey:t.endItem,startKey:t.startItem})}},t.onMouseUp=function(e){var r=t.props.canvas,n=document.querySelector("".concat(r)),o=t.props,a=o.onSelect,i=o.response,l=o.single;o.clearData;if(0===e.button&&t.hotkey&&n&&n.contains(e.target)){t.endItem=t.getItemKey(t.getItem(e.target))||t.endItem;var c="down";if("drag"===t.hotkey&&t.endItem===t.startItem)return t.hotkey=null,void(t.drag=!1);switch(t.hotkey){case"ctrl":case"ctrl&shift":case"shift":break;case"slide":case"drag":var u=t.startPoint.y,s=e.clientY,f=t.startPoint.x,d=e.clientX;if(s-u<0&&(c="up"),t.clearShape(),Math.abs(s-u)<i&&Math.abs(d-f)<i||t.endItem===t.startItem)return t.hotkey=null,void(t.drag=!1)}delete t.selectorItem.null,t.hotkey&&"down"!==t.hotkey&&a&&a(t.selectorItem,t.hotkey,{currentKey:t.endItem,startKey:t.startItem,dragEnd:t.drag,direction:c}),t.hotkey&&"down"===t.hotkey&&l&&a&&a(t.selectorItem,t.hotkey,{currentKey:t.endItem,startKey:t.startItem})}else t.clearShape();t.hotkey=null,t.drag=!1},t.createSelectableShape(),t.onMouseDown=t.onMouseDown.bind(yr(t)),t.onMouseMove=t.onMouseMove.bind(yr(t)),t.onMouseUp=t.onMouseUp.bind(yr(t)),t.hotkey=null,t.drag=null,t.startPoint={x:0,y:0},t.receiveItem=e.startItem,t.startItem=e.startItem,t.endItem=null,t.selectorItem={},t}return t=a,(r=[{key:"createSelectableShape",value:function(){var e="mouse-selectable-shape";if(this.$selectableShape=document.querySelector(".".concat(e)),this.$selectableShape)return null;var t=document.createDocumentFragment(),r=document.createElement("div");r.className=e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var r in t)t.hasOwnProperty(r)&&(e.style[r]=t[r])}(r,this.props.style),t.appendChild(r),document.body.appendChild(t),this.$selectableShape=document.querySelector(".".concat(e))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.receiveItem!=e.startItem&&e.startItem&&(this.startItem=e.startItem),this.props=cr(cr({},this.props),e);var t=this.props,r=t.userSelect,n=t.canvas,o=document.querySelector("".concat(n));!r&&o&&this.getEnabled("slide")&&gr(o,"user-unselect")}},{key:"componentDidMount",value:function(){var e=this.props,t=e.canvas,r=e.selector,n=e.userSelect,o=document.querySelector("".concat(t));if(document.body.addEventListener("mousedown",this.onMouseDown),document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseover",this.onMouseOver),document.body.addEventListener("mouseup",this.onMouseUp),!n&&o&&this.getEnabled("slide")&&gr(o,"user-unselect"),o){var a=o.querySelector(r);a&&(this.startItem=this.getItemKey(a))}}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("mousedown",this.onMouseDown),document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseover",this.onMouseOver),document.body.removeEventListener("mouseup",this.onMouseUp),this.$selectableShape=null}},{key:"getEnabled",value:function(e){var t=this.props.disabled;return"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]),!t.includes(e||!0)}},{key:"getItemKey",value:function(e){return e?e.getAttribute("cellSelectorKey"):null}},{key:"getItem",value:function(e){return!e||e.querySelector("tr")?null:"TD"===e.tagName?e.querySelector(this.props.selector):function(e,t){if(!e)return null;for(var r=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!r.call(e,t);)e=e.parentElement;return e}(e,this.props.selector+", tr")}},{key:"moveToScroll",value:function(e,t){if(e){var r=function(e){if(!e)return null;for(;e&&"scroll"!==e.style.overflowY&&e!==document.body;)e=e.parentElement;return e}(e),n=r.offsetHeight,o=e.offsetHeight,a=e.getBoundingClientRect().top,i=r.getBoundingClientRect().top;t&&2*o>a-i?r.scrollTop-=o:2*o>n+i-a&&(r.scrollTop+=o)}}},{key:"clearData",value:function(e,t){var r=this.props.clearData;this.selectorItem={},r&&r(e,t)}},{key:"clearShape",value:function(){var e,t,r=this.props.canvas,n=document.querySelector("".concat(r));t="pointer-events-none",(e=n)&&(e.className=e.className.replace(t,"")),this.$selectableShape&&(this.$selectableShape.style.width="0",this.$selectableShape.style.height="0",this.$selectableShape.style.top="auto",this.$selectableShape.style.right="auto",this.$selectableShape.style.bottom="auto",this.$selectableShape.style.left="auto",this.$selectableShape.style.display="block",this.$selectableShape.style.border="none"),this.startPoint={x:0,y:0}}},{key:"render",value:function(){return null}}])&&sr(t.prototype,r),n&&sr(t,n),a}(a.a.Component);function Or(e){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sr(){return(Sr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function jr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kr(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xr(e,t){return(xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Er(e);if(t){var o=Er(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ir(this,r)}}function Ir(e,t){return!t||"object"!==Or(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Er(e){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}wr.defaultProps={unitKey:"key",canvas:"",onSelect:null,selector:"tr",response:15,disabled:!1,userSelect:!1,single:!1},r(1853),Kr.Selector=wr;var Pr=Object(i.isIE)()?" table-cell-wrapper-ie ":"",Rr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("@");return t.length<2?(console.warn("缺少一部分key"),{}):{rowKeyValue:t[0],attrcode:t[1]}},Tr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=e.rowKeyValue,o=e.attrcode,a=e;if("__tableHeader__"===n){var i=t[0];return i?{normalItem:{rowKeyValue:i[r],attrcode:o},specialItem:e}:{normalItem:{attrcode:o},specialItem:e}}return{normalItem:a,specialItem:null}};function Kr(e){return e||console.error("缺少Table组件"),function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xr(e,t)}(c,t);var r,n,o,l=_r(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this,e)).uuid=Object(i.uuidv4)(),t}return r=c,(n=[{key:"getSelectorData",value:function(e,t,r){var n=r.currentKey,o=r.startKey,a=r.dragEnd,l=r.direction,c=this.props.high_selectable,u=void 0===c?{}:c,s={},f=[],d=u.data,p=u.arrColumns,y=u.rowKey,h=u.onBatchChange,b=(u.disabledColType,u.disabledColumn),v=void 0===b?["numberindex","opr","checkbox"]:b,m=u.disabledBatchColumn,g=void 0===m?["numberindex","opr","checkbox"]:m;if("shift"===t||"ctrl&shift"===t||"slide"===t||"drag"===t){if(!o||!n)return console.warn(t+" invalid select section must start and end"),{};var w=Rr(o),O=Tr(w,d,y),S=O.normalItem,j=O.specialItem,k=S.rowKeyValue,C=S.attrcode,x=Rr(n),_=Tr(x,d,y),I=_.normalItem,E=_.specialItem,P=I.rowKeyValue,R=I.attrcode;if(C!==R&&"drag"===t)return console.warn("column patch must single !"),{};var T=function(e,t,r,n,o){var a=[],i=[];return t===r?e.some((function(e){if(e.attrcode===t)return a=[{attrcode:t,label:e.label}],!e.children&&(i=[t]),!0})):e.some((function(e){if(e.attrcode===t||e.attrcode===r){if(a.length>0)return a.push({attrcode:e.attrcode,label:e.label}),!e.children&&i.push(e.attrcode),!0;!e.children&&i.push(e.attrcode),a.push({attrcode:e.attrcode,label:e.label})}else!e.children&&i.length>0&&i.push(e.attrcode),i.length>0&&a.push({attrcode:e.attrcode,label:e.label})})),i=i.filter((function(e){return!n.includes(e)})),{columnObjSection:a=a.filter((function(e){return!n.includes(e.attrcode)})),columnCodeSection:i}}(p,C,R,v),K=T.columnCodeSection,D=T.columnObjSection;if(console.log(K,D,"已经选中的单元格"),j&&E)return f=D,console.log(j,E,f),{activeSpecialCells:f,activeCells:s};if((j||E)&&(f=D,console.log(j,E,f)),!k||!P)return{};var M=!1;d.some((function(e){var t=e[y];if(t===k||t===P){if(s[t]=K,M||k===P)return!0;M=!0}else M&&(s[t]=K)}))}if("ctrl"===t)for(var V in e){var A=Rr(V),N=A.rowKeyValue,F=A.attrcode;if(!N)return{};v.includes(F)||"__tableHeader__"===N||(s[N]=s[N]||[],s[N].push(F))}if("down"===t&&n){var q=Rr(n),H=q.rowKeyValue,U=q.attrcode;if(!H)return{};v.includes(U)||g.includes(U)||"__tableHeader__"===H||(s[H]=s[H]||[],s[H].push(U))}if("drag"===t&&a){var B=Rr(o);if(!B.rowKeyValue)return{};B.direction=l,!g.includes(B.attrcode)&&Object(i.isFunction)(h)&&h(B,s,l)}return{activeSpecialCells:f,activeCells:s}}},{key:"render",value:function(){var t=this,r=this.props,n=r.high_selectable,o=void 0===n?{}:n,i=kr(r,["high_selectable"]),l="selectable-".concat(this.uuid),c=(o.langJson,o.selector),u=void 0===c?" tbody tr .table-cell-wrapper, thead tr .column-title-wrapper, thead tr .column-title-wrapper-bg, tbody tr .table-cell-wrapper-bg, tbody tr .table-cell-drag-icon":c,f=o.canvas,d=void 0===f?"."+l:f,p=o.disabled,y=void 0!==p&&p,h=o.userSelect,b=void 0!==h&&h,v=o.enable,m=void 0!==v&&v,g=o.single,w=void 0===g||g,O=o.selectCell,S=void 0===O||O,j=o.startItem,k=void 0===j?"":j,C=o.onSelect,x=o.onDeSelect,_=o.onClearData,I=o.getPrevSelector,E=(o.store,o.disabledBatchColumn),P=void 0===E?["numberindex","opr","checkbox"]:E;return a.a.createElement("div",{className:s()(l,"selectable-canvas",{"selectable-canvas-enabled":m,"table-cell-wrapper-ie":Pr})},m&&a.a.createElement(wr,{canvas:d,hasSelectorItem:function(e,t){if("ctrl"===e){var r=I&&I(t,e),n=Rr(t),o=n.rowKeyValue,a=n.attrcode;if(!S&&r){var i=!1;for(var l in r)o===Rr(l).rowKeyValue&&r[l]&&(i=!0,x&&x(jr({},o,[a]),e));return i}return r[t]?(x&&x(jr({},o,[a]),e),!0):(r[t]=!0,!1)}},single:w,selector:u,disabled:y,userSelect:b,startItem:k,onSelect:function(e,r,n){var o=n.currentKey,a=n.startKey,i=n.dragEnd,l=n.direction,c=t.getSelectorData(e,r,{currentKey:o,startKey:a,dragEnd:i,direction:l}),u=c.activeCells,s=c.activeSpecialCells;if("shift"!==r&&"ctrl&shift"!==r||(t.prevActiveCells&&t.prevStartKey&&a===t.prevStartKey&&o!==t.prevCurrentKey&&x&&x(t.prevActiveCells,r),t.prevActiveCells=u,t.prevStartKey=a,t.prevCurrentKey=o),u){var f={};if(o){if(!(f=Rr(o)).rowKeyValue)return;("__tableHeader__"===f.rowKeyValue||P.includes(f.attrcode))&&(f={})}C&&C(u,s,r,{current:f,isBatch:"ctrl"===r||"shift"===r||"ctrl&shift"===r||"slide"===r||"drag"===r})}},clearData:function(e,t){_&&_(e.isSelect,t)}}),a.a.createElement(e,Sr({headerEventNoStop:!0},i)))}}])&&Cr(r.prototype,n),o&&Cr(r,o),c}(o.Component)}r(1858);function Dr(e){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mr(){return(Mr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ar(e,t){return(Ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=qr(e);if(t){var o=qr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Fr(this,r)}}function Fr(e,t){return!t||"object"!==Dr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qr(e){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hr(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ar(e,t)}(u,t);var r,n,o,l=Nr(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).getPasteData=function(){return new Promise((function(e){if(window.clipboardData){var t=window.clipboardData.getData("Text");e(t)}else navigator.clipboard&&navigator.clipboard.readText().then((function(t){e(t)}))}))},t.formatPasteData=function(e){var r=t.props.excelConfig.langJson;e.length>2&&("\n"===e.substr(e.length-1,e.length)&&(e=e.substr(0,e.length-1)));var n=[];if(/\t/.test(e)){var o=e.split("\n")||[];Object(c.toast)({color:"danger",title:r.table_tips,content:"只能粘贴一列数据"}),o.forEach((function(e){var t=(e.split("\t")||[])[0];n.push(t)}))}else n=e.split("\n");return n},t.listenCrtlV=function(){var e=t.props,r=e.store,n=e.excelConfig,o=n.onBatchChange,a=n.langJson,l=t.tableDom.querySelector(".u-table-body table");l.addEventListener("paste",(function(e){var c=r.getActiveCell,u=n.tableId,s=c(),f=t.formatPasteData(e.clipboardData.getData("text/plain"));if(console.log(f.length,f.length<=1),l.contains(e.target)&&s&&f.length>1){document.body.focus();var d=r.getData(),p={pasteContent:f,activeCell:s,langJson:a,rows:d,getRowOldValue:r.getRowOldValue,tableId:u},y=Object(i.excelPackageData)(p);if(!y)return;Object(i.isFunction)(o)&&o(y),e.preventDefault()}})),document.addEventListener("keydown",(function(e){(e.metaKey||e.ctrlKey)&&86===e.keyCode&&t.getPasteData().then((function(l){var c=(0,r.getActiveCell)();if(l&&c){var u=n.tableId,s=c.column.itemtype,f=t.formatPasteData(l);if(c&&f.length>1&&["switch","checkbox_switch"].includes(s)){document.body.focus();var d=r.getData(),p={pasteContent:f,activeCell:c,langJson:a,rows:d,getRowOldValue:r.getRowOldValue,tableId:u},y=Object(i.excelPackageData)(p);if(!y)return;Object(i.isFunction)(o)&&o(y),e.preventDefault()}}}))}))},t.state={json:{}},t}return r=u,(n=[{key:"componentDidMount",value:function(){this.props.excelConfig.onBatchChange&&this.listenCrtlV()}},{key:"render",value:function(){var t=this;return a.a.createElement(e,Mr({},this.props,{ref:function(e){t.tableDom=oe.a.findDOMNode(e)}}))}}])&&Vr(r.prototype,n),o&&Vr(r,o),u}(o.Component)}var Ur=r(167),Br=r.n(Ur);function Lr(e){var t=e.attrcode,r=e.itemtype,n=e.isSort,o=void 0===n||n,a=e.sorter;if(o&&!Object(i.isFunction)(a))switch(!0){case"number"===r:e.sorter=function(e,r){var n=e.values||e,o=r.values||r,a=String(n[t]&&n[t].value||"0"),i=String(o[t]&&o[t].value||"0");return Object(c.Subtr)(Number(a.replace(/,/g,"")),Number(i.replace(/,/g,"")))};break;case I.a.timeTypes.includes(r):e.sorter=function(e,r){var n=e.values||e,o=r.values||r,a=n[t]&&n[t].value||"",i=o[t]&&o[t].value||"";return a.localeCompare(i)};break;case I.a.displayTypes.includes(r):e.sorter=function(e,r){var n=e.values||e,o=r.values||r,a=String(n[t]&&n[t].display||""),i=String(o[t]&&o[t].display||"");return a.localeCompare(i)};break;case"label"===r:e.sorter=function(e,r){var n=e.values||e,o=r.values||r,a=n[t]&&n[t].value||"",i=n[t]?n[t].display:"",l=o[t]&&o[t].value||"",u=o[t]?o[t].display:"",s=String(Object(c.isNullOrVoid)(i)?a:i),f=String(Object(c.isNullOrVoid)(u)?l:u);return s.localeCompare(f)};break;case"numberindex"!==t&&"opr"!==t&&"checkbox"!==t&&"blankrow"!==t:e.sorter=function(e,r){var n=e.values||e,o=r.values||r,a=String(n[t]&&n[t].value||""),i=String(o[t]&&o[t].value||"");return a.localeCompare(i)}}}function Wr(e){var t=e.columns,r=e.sortObj;t.forEach((function(e){var n=e.children;Object(i.isUndefined)(n)?t.forEach((function(e){r[e.attrcode]?(e.order=r[e.attrcode].order,e.orderNum=r[e.attrcode].orderNum):(e.order="flatscend",e.orderNum="")})):Wr({columns:n,sortObj:r})}))}r(1859);function Jr(e){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zr(){return(zr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Yr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $r(e,t){return($r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Xr(e);if(t){var o=Xr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Gr(this,r)}}function Gr(e,t){return!t||"object"!==Jr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xr(e){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qr(e){var t=Br()(e,_.Icon);return function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$r(e,t)}(c,r);var n,o,i,l=Zr(c);function c(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),l.call(this,e)}return n=c,(o=[{key:"render",value:function(){var r=this.props,n=r.columns,o=r.backSort,i=r.sortChange,l=r.isSort;if(void 0!==l&&!l)return a.a.createElement(e,this.props);var c=o||{mode:"single",backSource:!1,sortFun:function(e,t){i(e,t)}};return n.forEach((function(e){!function e(t){if(!t.children)return Lr(t);t.children.map((function(t){return t.children?e(t):Lr(t)}))}(e)})),a.a.createElement(t,zr({},this.props,{sort:c}))}}])&&Yr(n.prototype,o),i&&Yr(n,i),c}(o.Component)}r(1861);function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(){return(tn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function rn(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function nn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function on(e){return function(e){if(Array.isArray(e))return an(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return an(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return an(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ln(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cn(e,t){return(cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=fn(e);if(t){var o=fn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return sn(this,r)}}function sn(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fn(e){return(fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dn(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cn(e,t)}(u,t);var r,n,l,c=un(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e)).execCommandCopy=function(e,r,n,o,a,i){var l=t.getTableContent(e,r,n,o,a,i);if(t.wrapper){var c=oe.a.findDOMNode(t.wrapper).querySelector("#table-copy-element");c.value=l,c.select(),document.execCommand("copy")}},t.getTableContent=function(e,r,n,o,a,i){var l="";if(r&&r.length&&(l+=t.getHeadContent(r,n,e,i)),o){var c=Object.keys(o);c&&c.length&&(l+=t.getBodyContent(a,o,e,i))}return l},t.getHeadContent=function(e,t,r){var n="",o=[],a=0,l=0,c={},u=[];!function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(i.isArray)(t)&&t.map((function(t){t.parentNode=r,(t.visible&&!Object(i.isArray)(t.children)||Object(i.isArray)(t.children)&&t.children.length<1)&&u.push(t),e(t.children,[].concat(on(r),[t]))}))}(t,[]);for(var s=function(t){var n=u[t],i=n.parentNode;if(!n.visible)return"continue";var s=!1;if("copy"===r||"copy-column"===r){if(-1!==e.findIndex((function(e){return e.attrcode===n.attrcode}))){if(o[a]=[n],s=!0,i&&i.length)if("copy"===r)for(var f=function(t){var r=e.findIndex((function(e){return e.attrcode===i[t].attrcode}));-1!==r&&(o[a]||(o[a]=[]),c[e[r].attrcode]?o[a].push(" "):(c[e[r].attrcode]=!0,o[a].push(e[r])),s=!0)},d=i.length-1;d>=0;d--)f(d);else if("copy-column"===r){o[a]||(o[a]=[]);for(var p=i.length-1;p>=0;p--)c[i[p].attrcode]?o[a].push(""):(c[i[p].attrcode]=!0,o[a].push(i[p]));s=!0}}else if(i&&i.length){for(var y=-1,h=function(t){var n,l=e.findIndex((function(e){return e.attrcode===i[t].attrcode}));-1!==l&&(s=!0,"copy"===r&&(o[a]||(o[a]=[]),c[e[l].attrcode]?o[a].push(""):(c[e[l].attrcode]=!0,o[a].push(e[l])),t<i.length-1&&-1!==y&&(y=i.length-1-t,(n=o[a]).unshift.apply(n,on(Array(y).fill(""))))))},b=i.length-1;b>=0;b--)h(b);if(s&&"copy-column"===r){o[a]=[n];for(var v=i.length-1;v>=0;v--)c[i[v].attrcode]?o[a].push(""):(c[i[v].attrcode]=!0,o[a].push(i[v]))}}}else if("copy-row"===r&&(s=!0,o[a]=[n],i&&i.length))for(var m=i.length-1;m>=0;m--)c[i[m].attrcode]?o[a].push(""):(c[i[m].attrcode]=!0,o[a].push(i[m]));s&&(o[a]=o[a].reverse(),l=Math.max(o[a].length,l),a++)},f=0;f<u.length;f++)s(f);for(var d=0;d<o[0].length;d++){for(var p=0;p<o.length;p++){var y;if(o[p].length<l)(y=o[p]).push.apply(y,on(Array(l-o[p].length).fill("")));n=n+("string"==typeof o[p][d]?o[p][d]:o[p][d].label)+"\t"}n+="\n"}return n},t.sortActiveColumn=function(e,t){var r={};for(var n in t){t[n].forEach((function(e){r[e]||(r[e]=!0)}))}var o=[];return e.forEach((function(e){var t=e.attrcode;r[t]&&o.push(e)})),o},t.getBodyContent=function(e,r,n,o){var a=o.filter((function(e){return!0===e.visible})),i=t.sortActiveColumn(a,r),l="";return"copy-row"===n&&e.forEach((function(r,n){var o=r.values;a.forEach((function(e,r){var n=o[e.attrcode]||{};l+=t.getDisplay(e,n,o)||"",r<a.length-1&&(l+="\t")})),n<e.length-1&&(l+="\n")})),"copy-column"===n&&e.forEach((function(r,n){var o=r.values;i.forEach((function(e,r){var n=e.attrcode,a=o[n]||{};l+=t.getDisplay(e,a,o)||"",r<i.length-1&&(l+="\t")})),n<e.length-1&&(l+="\n")})),"copy"===n&&e.forEach((function(n,o){var a=n.rowid||n.rowId,c=r[a],u=n.values;i.forEach((function(e,r){var n=e.attrcode;if(c.includes(n)){var o=u[n]||{};l+=t.getDisplay(e,o,u)||""}r<i.length-1&&(l+="\t")})),o<e.length-1&&(l+="\n")})),l},t.getDisplay=function(e,r,n){var o=t.props.contextMenuConfig.langJson,a=void 0===o?{}:o;return Object(i.handleBrowseData)(e.itemtype,r.display,r.value,r.scale,e.attrcode,e.languageMeta,n,e.datatype,e.options,e.multiple,a)},t.getPasteData=function(){return new Promise((function(e){if(window.clipboardData){var r=t.handlePasteContent(window.clipboardData.getData("Text"));e(r)}else navigator.clipboard&&navigator.clipboard.readText().then((function(r){var n=t.handlePasteContent(r);e(n)}))}))},t.handlePasteContent=function(e){e.length>2&&("\n"===e.substr(e.length-1,e.length)&&(e=e.substr(0,e.length-1)));return e=e.split("\n")},t.createContextMenu=function(){var e=t.props.contextMenuConfig,r=e.contextMenuClick,n=e.showBusinessBtn,l=e.status,c=e.langJson,u=void 0===c?{}:c,f=(e.showPasteBtn,e.extendRightMenu);return a.a.createElement(o.Fragment,null,a.a.createElement("li",{className:"table-extend-right-menu copy",onClick:function(){r("copy",(function(e,r,n,o,a){t.execCommandCopy("copy",e,r,n,o,a)}))}},u.table_copy),t.copyMenu.map((function(e){var n;return a.a.createElement("li",{className:s()((n={"table-extend-right-menu":!0},nn(n,e,!0),nn(n,"table-menus-sep","copy-column"===e),n)),onClick:function(){r(e,(function(r,n,o,a,i){t.execCommandCopy(e,r,n,o,a,i)}))}},u["table_"+e])})),"edit"===l&&n&&t.editBussMenu.map((function(e){var n;return a.a.createElement("li",{className:s()((n={"table-extend-right-menu insert":!0},nn(n,e,!0),nn(n,"table-menus-sep","insert_down"===e||"delete"===e),n)),onClick:function(){r(e,null,null,t[e],t.pasteCell.rowIndex)}},u["table_"+e],("insert_up"===e||"insert_down"===e)&&a.a.createElement(_.NumberInput,{className:"insert_number",onClick:function(e){e.stopPropagation()},onChange:function(r){t[e]=r}}))})),Object(i.isFunction)(f)&&f())},t.onCellMouseDown=function(e,r,n,o,a){t.pasteCell.rowIndex=r,t.pasteCell.attrcode=n,t.pasteCell.column=o;var l=t.props,c=l.onCellMouseDown,u=l.store,s=l.rowKey;if(a&&2===a.button){var f=u.getCache("activedCells"),d=e[s].value||e[s];if(f){var p=f[d];if(Array.isArray(p)&&p.includes(n))return;var y=function(e){(f[e]||[]).forEach((function(t){u.setCellProps(e,t,{actived:!1,leftLine:!1,rightLine:!1,topLine:!1,bottomLine:!1},!1)}))};for(var h in f)y(h)}u.setCellProps(d,n,{actived:!0,leftLine:!0,rightLine:!0,topLine:!0,bottomLine:!0},!0),f=nn({},d,[n]),u.setCache("activedCells",f)}Object(i.isFunction)(c)&&c(e,r,n,o,a)},t.pasteCell={rowIndex:-1,attrcode:"",column:{}},t.editBussMenu=["insert_up","insert_down","delete"],t.copyMenu=["copy-row","copy-column"],t.insert_up=0,t.insert_down=0,t.wrapper=null,t}return r=u,(n=[{key:"render",value:function(){var t=this,r=this.props,n=r.contextMenuConfig,o=(r.onCellMouseDown,rn(r,["contextMenuConfig","onCellMouseDown"])),l=n.enable,c=n.extendRightMenu,u=n.contextMenuClick;return a.a.createElement("div",{ref:function(e){t.wrapper=e}},a.a.createElement(_.HotKeys,{keyMap:{copyHandler:["ctrl+c"]},handlers:{copyHandler:function(){u("copy",(function(e,r,n,o,a){t.execCommandCopy("copy",e,r,n,o,a)}),void 0,void 0,void 0,!0)}},className:"copy-hotkeys-wrapper",focused:!0,attach:!1},a.a.createElement("textarea",{id:"table-copy-element"}),a.a.createElement(e,tn({},o,{onCellMouseDown:this.onCellMouseDown,extendRightMenu:l?this.createContextMenu():Object(i.isFunction)(c)?c():null}))))}}])&&ln(r.prototype,n),l&&ln(r,l),u}(o.Component)}var pn=r(722),yn=r(723),hn=r(721);r(1860);function bn(e){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(){return(vn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function mn(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function gn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function On(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=jn(e);if(t){var o=jn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Sn(this,r)}}function Sn(e,t){return!t||"object"!==bn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jn(e){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kn(e,t){e||console.error("缺少Table组件");var r=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(l,t);var r,n,o,i=On(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e)}return r=l,(n=[{key:"handleTableCellClick",value:function(e,t,r,n,o){this.mousedown=!1}},{key:"handleCellMouseDown",value:function(e,t,r,n,o){this.mousedown=!0}},{key:"render",value:function(){var t=this,r=this.props,n=r.rowKey,o=r.onCellMouseDown,i=r.onCellFocus,l=r.onCellKeyDown,u=r.onTableCellClick,s=(r.onEnter,r.hotKeyWithArrow),f=r.hotKeyWithEnter,d=r.high_hotkey,p=mn(r,["rowKey","onCellMouseDown","onCellFocus","onCellKeyDown","onTableCellClick","onEnter","hotKeyWithArrow","hotKeyWithEnter","high_hotkey"]);return a.a.createElement(e,vn({onCellMouseDown:function(e,r,n,a,i){return!1!==(!o||o(e,r,n,a,i))&&t.handleCellMouseDown(e,r,n,a,i)},onCellFocus:function(e,t,r,n,o){!i||i(e,t,r,n,o)},onCellKeyDown:function(e,t,r,n,o){!l||l(e,t,r,n,o)},onTableCellClick:function(e,r,n,o,a){return!1!==(!u||u(e,r,n,o,a))&&t.handleTableCellClick(e,r,n,o,a)},onEnter:function(e){var t=e.e,r=e.target,n=void 0===r?void 0:r,o=e.itemType,a=d.tableId;f({e:t,ViewModel:c.ViewModel,moduleId:a,target:n,itemType:o})},hotKeyWithArrow:function(e){var t=e.e,r=e.target,n=void 0===r?void 0:r,o=e.itemType,a=d.tableId;s({e:t,ViewModel:c.ViewModel,moduleId:a,target:n,itemType:o})},rowKey:n},p))}}])&&gn(r.prototype,n),o&&gn(r,o),l}(o.Component),n=t.name;t.type,t.user;return Object(hn.a)("editTable"===n?Object(pn.a)(r):Object(yn.a)(r))}function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(r),!0).forEach((function(t){In(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function In(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function En(e){return function(e){if(Array.isArray(e))return Pn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Pn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tn(e,t,r){return(Tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=An(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function Kn(e,t){return(Kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=An(e);if(t){var o=An(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Mn(this,r)}}function Mn(e,t){return!t||"object"!==Cn(t)&&"function"!=typeof t?Vn(e):t}function Vn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nn=I.a.ROW_STATUS;function Fn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rowid";return new l.ArrayData(e,t)}function qn(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"attrcode",r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];Object(i.isObject)(e[o])&&Object(i.isArray)(e[o].items)&&"table"===e[o].moduletype&&(e[o].items.isArrayData=!1,e[o].items=new l.TreeData(e[o].items,t))}return e}var Hn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kn(e,t)}(a,e);var t,r,n,o=Dn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).store={data:new Fn([],"rowid"),meta:{},props:{rowKey:"rowid",status:"browse",focusIndex:-1,currentIndex:-1,currentInfo:{}},selectedIndex:new Set,allpks:[],checkInfo:{checkedAll:!1,indeterminate:!1,selectIndex:[],disabledAll:!1,crossPageSelectIndex:new Set},config:{},sortParam:void 0,key:1},t.cache={base:null,beforeEdit:null,all:null,afterDel:null,oldRows:[],colInitialValue:{},langJson:{},oldBatchData:null},t.getMeta=function(){for(var e=t.getStore("meta"),r={},n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];r[a]=e[a],Object(i.isObject)(e[a])&&e[a].items&&("table"===e[a].moduletype?r[a].items=e[a].items.get?e[a].items.get():e[a].items:"form"===e[a].moduletype&&(r[a].items=e[a].items))}return r},t.generateRowKey=function(){return String((new Date).getTime()).slice(-5)+Object(c.getSafeRandom)().toString(12)},t.setCrossPage=function(e,r,n){var o=t.getCheckInfo().crossPageSelectIndex,a=t.getStore(["allpks"])||[];(Object(i.isArray)(e)?e:[e]).forEach((function(e){var t=e.values[r].value,a=e.values||e,i=!a.saga_status||"1"!==a.saga_status.value,l=e.disabled;n&&i&&!l?o.add(t):o.delete(t)}));var l=a.length===o.size;t.setStore(["checkInfo","checkedAllpage"],l,!1)},t._setSelect=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"set",n=arguments.length>2?arguments[2]:void 0,o=t.getStore(["selectedIndex"]),a=!1,i=!1;"set"===r&&(o.clear(),e.forEach((function(e){o.add(e)}))),"clear"===r&&o.clear(),"all"===r||"allpage"===r?t.setRowsSelected({},!0,!1):"reverse"===r?t.reverseRowsSelected(!1):"clear"===r?t.setRowsSelected({},!1,!1):t.setRowsSelected({rowKeyValues:En(o)},!0,!1);var l=t.getData(),c=l.length,u=o.size;0===u?(a=!1,i=!1):u>0&&u<c?(a=!0,i=!1):u===c&&(a=!1,i=!0);var s=t.getStore("checkInfo");s.indeterminate=a,s.checkedAll=i,s.selectIndex=o,s.checkedAllpage="allpage"===r,t.setStore(["checkInfo"],s,n)},t.getConfig=function(){return t.getStore(["config"])},t.setConfig=function(e){t.setStore(["config"],e,!1)},t._updateAndAddRows=function(e){var r=e.rows,n=void 0===r?[]:r,o=e.shouldForceUpdate,a=void 0===o||o;console.log("_updateAndAddRows",n);var l=t.getTableProps("rowKey"),c=t.getStore("data"),u=c.length,s=[],f=[];return n.forEach((function(e){var t=e[l],r=c.query(e[l]);Object(i.isObject)(r)?c.update(t,(function(t){var r=Object.assign({},t.values,e.values||{});(t=Object.assign({},t,e||{})).values=r;var n=JSON.parse(JSON.stringify(t));return s.push(n),n})):f.push(e)})),t._insertRows({rows:f,rowIndex:u,isGenerateRowKey:!1,shouldForceUpdate:!1}),a&&t.forceUpdate(),s},t.getExcelReferAjaxData=function(e,t,r,n,o,a,l,c){var u={};return Object(i.isFunction)(n)?u=Object.assign({},n(t.props),r):Object(i.isObject)(n)?u=Object.assign({},n,r):Object(i.isUndefined)(n)&&(u=Object.assign({},r)),Object(i.isString)(u.TreeRefActionExt)&&u.TreeRefActionExt&&(o=u.TreeRefActionExt+","+o),Object(i.isString)(u.GridRefActionExt)&&u.GridRefActionExt&&(a=u.GridRefActionExt+","+a),delete u.TreeRefActionExt,delete u.GridRefActionExt,_n({pageInfo:{pageSize:50,pageIndex:-1},keyword:"",pid:"",defineItems:[],queryCondition:_n(_n({batchQueryByName:JSON.stringify({names:e}),TreeRefActionExt:o,GridRefActionExt:a},l),u)},c)},t.sendExcelReferMergeAjax=function(e,r){return new Promise((function(n,o){Object(c.ajax)({url:"/nccloud/platform/pub/mergerequest.do",data:e,success:function(e){var o=_n({res:e},r),a=t.excelReferMergeAjaxSuccess(o);n(a)},error:function(e){console.error(e),o(e)}})}))},t.sendExcelReferNomalAjax=function(e,r,n){return new Promise((function(o,a){Object(c.ajax)({url:r,async:!1,data:_n({},e),success:function(e){var r=_n({res:e},n),a=t.excelReferNomalAjaxSuccess(r);o(a)},error:function(e){console.error(e),a(e)}})}))},t.excelReferMergeAjaxSuccess=function(e){var r=e.res,n=e.queryValue,o=e.attrcode,a=e.fieldValued,l=e.fieldDisplayed,c=e.indexs;if(r.data){var u=[],s=[];return Object.keys(r.data).forEach((function(e){var c,f=r.data[e],d=n[e];if(f.rows.length){for(var p=d.values[o].value,y="",h="",b=!1,v=0;v<f.rows.length;v++){var m=f.rows[v],g=m.values&&m.values.materialmnecode&&m.values.materialmnecode.value;if(p==m.refcode||p==m.refname||p==g){y+=m[a],h+=m[l],b=!0;break}}var w=t.getRowOldValue(d.rowid,o),O=(c=w,Object(i.isObject)(c)?c.refpk:c);if(b){var S={display:h,value:y};u.push({rowid:d.rowid,newvalue:{value:S.value||""},oldvalue:{value:O||""}}),d.values[o].value=y,d.values[o].display=h,s.push(d)}else{var j=function(e){return Object(i.isObject)(e)?e.refpk:e}(t.getRowOldValue(d.rowid,o));u.push({rowid:d.rowid,newvalue:{value:""},oldvalue:{value:j||""}}),d.values[o].value="",d.values[o].display="",s.push(d)}}else{var k=function(e){return Object(i.isObject)(e)?e.refpk:e}(t.getRowOldValue(d.rowid,o));u.push({rowid:d.rowid,newvalue:{value:""},oldvalue:{value:k||""}}),d.values[o].value="",d.values[o].display="",s.push(d)}})),console.log(123,"excelReferMergeAjaxSuccess",r,s),{indexs:c,finalValues:s,changedrows:u}}},t.excelReferNomalAjaxSuccess=function(e){var r=e.res,n=e.queryValue,o=e.attrcode,a=e.fieldValued,l=e.fieldDisplayed,c=e.indexs;if(r.data.rows.length){var u=[],s=[];return n.map((function(e){for(var n=e.values[o].value,c="",f="",d=!1,p=0;p<r.data.rows.length;p++){var y=r.data.rows[p],h=y.values&&y.values.materialmnecode&&y.values.materialmnecode.value;if(n==y.refcode||n==y.refname||n==h){c+=y[a],f+=y[l],d=!0;break}}var b,v=t.getRowOldValue(e.rowid,o),m=(b=v,Object(i.isObject)(b)?b.refpk:b);if(d){var g={display:f,value:c};u.push({rowid:e.rowid,newvalue:{value:g.value||""},oldvalue:{value:m||""}}),e.values[o].value=c,e.values[o].display=f,s.push(e)}else u.push({rowid:e.rowid,newvalue:{value:""},oldvalue:{value:m||""}}),e.values[o].value="",e.values[o].display="",s.push(e),console.error(n,"参照过滤没有匹配数据")})),console.log(4561,"excelReferNomalAjaxSuccess",r,s,u),{indexs:c,finalValues:s,changedrows:u}}var f=[],d=[];return n.map((function(e){var r,n=t.getRowOldValue(e.rowid,o),a=(r=n,Object(i.isObject)(r)?r.refpk:r);f.push({rowid:e.rowid,newvalue:{value:""},oldvalue:{value:a||""}}),e.values[o].value="",e.values[o].display="",d.push(e)})),console.error("参照过滤后返回的数组是空数组，没有查询到"),console.log(4562,"excelReferNomalAjaxSuccess",r,d,f),{indexs:c,finalValues:d,changedrows:f}},t.updateAfterBatchChange=function(e,r){var n=r.areaCode,o=r.column,a=r.indexs,l=r.queryValue,c=r.changedrows,u=r.pasteData,s=r.queryCondition,f=r.isManyCondition,d=r.extraAjaxParam,p=void 0===d?{}:d,y=o.attrcode,h=o.itemtype,b=o.editAfterFlag,v=o.refcode,m=o.fieldDisplayed,g=void 0===m?"refname":m,w=o.fieldValued,O=void 0===w?"refpk":w,S=o.queryCondition,j=o.pk_defdoclist,k=o.dataPowerOperationCode,C=o.isDataPowerEnable,x=o.loadSelectedData;if("refer"===h){/.js/.test(v)&&(v=v.replace(".js","")),v&&window[v]||console.error("window中没有refcode:".concat(v));var _=window[v].default(),I=_.props.queryGridUrl||_.props.queryTreeUrl;if(!1===_.props.checkStrictly)return new Promise((function(r){console.error("非严格参照，比如摘要");var n=[];l.forEach((function(e){var r,o=t.getRowOldValue(e.rowid,y),a=(r=o,Object(i.isObject)(r)?r.refpk:r),l={display:e.values[y].value,value:e.values[y].value};e.values[y].display=e.values[y].value,n.push({rowid:e.rowid,newvalue:{value:l.value||""},oldvalue:{value:a||""}})})),t._updateAndAddRows({rows:l}),r({props:e,indexs:a,key:y,changedrows:n})}));var E,P={};void 0!==j&&(P.pk_defdoclist=j),void 0!==k&&(P.DataPowerOperationCode=k),void 0!==C&&(P.isDataPowerEnable=C),x&&(P.loadSelectedData=!0);var R={queryValue:l,attrcode:y,fieldValued:O,fieldDisplayed:g,indexs:a};if(f){console.warn("manycondition");var T=[];l.forEach((function(e,r){var n=[e.values[y].value],o=e.queryCondition,a=t.getExcelReferAjaxData(n,_,o,S,"nccloud.web.uap.refer.BatchQueryByNameSqlBuilder","nccloud.web.uap.refer.BatchQueryByNameSqlBuilder",P,p),i={rqUrl:I,rqJson:JSON.stringify(a),rqCode:String(r)};T.push(i)})),E=t.sendExcelReferMergeAjax(T,R)}else{var K=u,D=s,M=t.getExcelReferAjaxData(K,_,D,S,"nccloud.web.uap.refer.BatchQueryByNameSqlBuilder","nccloud.web.uap.refer.BatchQueryByNameSqlBuilder",P,p);E=t.sendExcelReferNomalAjax(M,I,R)}return E.then((function(r){var o=r.changedrows,a=r.finalValues,i=r.indexs;return b?(console.log("参照关联项"),e.handleRelationItems({type:"table",areaCode:n,key:y,changedrows:o,rows:a})):(console.log("无关联项"),t._updateAndAddRows({rows:a})),{props:e,key:y,changedrows:o,indexs:i}}))}return new Promise(b?function(t){e.handleRelationItems({type:"table",areaCode:n,key:y,changedrows:c,isMul:!0,rows:l}),t({props:e,changedrows:c,key:y,indexs:a})}:function(r){console.log(123),console.log(l),t._updateAndAddRows({rows:l}),r({props:e,changedrows:c,key:y,indexs:a})})},t.anoterTable=function(){var e=t.getStore(["key"]);t.setStore("key",e+1)},t.getTableHooks=function(){return t.getMeta=t.getMeta.bind(Vn(t)),t.setMeta=t.setMeta.bind(Vn(t)),{setRef:t.setRef,getRef:t.getRef,removeRef:t.removeRef,refresh:t.refresh,anoterTable:t.anoterTable,getStore:t.getStore.bind(Vn(t)),setStore:t.setStore.bind(Vn(t)),getMeta:t.getMeta.bind(Vn(t)),setMeta:t.setMeta.bind(Vn(t)),getViewMeta:t.getViewMeta.bind(Vn(t)),getArrayMeta:t.getArrayMeta.bind(Vn(t)),getColumn:t.getColumn.bind(Vn(t)),setColumn:t.setColumn.bind(Vn(t)),getCache:t.getCache.bind(Vn(t)),setCache:t.setCache.bind(Vn(t)),getTrueRowIndex:t.getTrueRowIndex.bind(Vn(t)),getRows:t.getRows.bind(Vn(t)),setRows:t.setRows.bind(Vn(t)),setRowProps:t.setRowProps.bind(Vn(t)),getRowProps:t.getRowProps.bind(Vn(t)),setRowsProps:t.setRowsProps.bind(Vn(t)),setRowsCellPropsByKey:t.setRowsCellPropsByKey.bind(Vn(t)),setRowsCellPropsByIndex:t.setRowsCellPropsByIndex.bind(Vn(t)),insertRowsAfterIndex:t.insertRowsAfterIndex.bind(Vn(t)),moveRow:t.moveRow.bind(Vn(t)),removeEmptyRows:t.removeEmptyRows.bind(Vn(t)),hasSelected:t.hasSelected.bind(Vn(t)),setSelectedIndex:t.setSelectedIndex.bind(Vn(t)),getCellProps:t.getCellProps.bind(Vn(t)),setCellProps:t.setCellProps.bind(Vn(t)),setCellValue:t.setCellValue.bind(Vn(t)),getCellValue:t.getCellValue.bind(Vn(t)),setCellsProps:t.setCellsProps.bind(Vn(t)),formatData:t.formatData.bind(Vn(t)),getTableProps:t.getTableProps.bind(Vn(t)),setTableProps:t.setTableProps.bind(Vn(t)),setData:t.setData.bind(Vn(t)),getData:t.getData.bind(Vn(t)),getViewData:t.getViewData.bind(Vn(t)),setRowPosition:t.setRowPosition.bind(Vn(t)),saveRowOldValue:t.saveRowOldValue.bind(Vn(t)),getRowOldValue:t.getRowOldValue.bind(Vn(t)),deleteRowOldValue:t.deleteRowOldValue.bind(Vn(t)),saveRowsOldValue:t.saveRowsOldValue.bind(Vn(t)),clearRowsOldValue:t._clearRowsOldValue.bind(Vn(t)),getAllRows:t.getAllRows.bind(Vn(t)),getVisibleRows:t.getVisibleRows.bind(Vn(t)),getChangedRows:t.getChangedRows.bind(Vn(t)),addTableRow:t.addTableRow.bind(Vn(t)),deleteTableRows:t.deleteTableRows.bind(Vn(t)),setValByKeyAndIndex:t.setValByKeyAndIndex.bind(Vn(t)),setValByKeyAndRowId:t.setValByKeyAndRowId.bind(Vn(t)),updateTableData:t.updateTableData.bind(Vn(t)),updateTableDataByIndexs:t.updateTableDataByIndexs.bind(Vn(t)),updateTableDataByRowId:t.updateTableDataByRowId.bind(Vn(t)),setTableData:t.setTableData.bind(Vn(t)),setTableStatus:t.setTableStatus.bind(Vn(t)),getValByKeyAndIndex:t.getValByKeyAndIndex.bind(Vn(t)),getValByKeyAndRowKey:t.getValByKeyAndRowKey.bind(Vn(t)),pasteRow:t.pasteRow.bind(Vn(t)),getSelectedRows:t.getSelectedRows.bind(Vn(t)),setRowsSelected:t.setRowsSelected.bind(Vn(t)),setRowsSelectedByIndexs:t.setRowsSelectedByIndexs.bind(Vn(t)),setRowsSelectedByRowKey:t.setRowsSelectedByRowKey.bind(Vn(t)),setAllRowsSelected:t.setAllRowsSelected.bind(Vn(t)),reverseRowsSelected:t.reverseRowsSelected.bind(Vn(t)),getAllRowsRemoveKeys:t.getAllRowsRemoveKeys.bind(Vn(t)),getFilterRows:t.getFilterRows.bind(Vn(t)),setFiltrateTableData:t.setFiltrateTableData.bind(Vn(t)),batchChangeTableData:t.batchChangeTableData.bind(Vn(t)),insertDataByIndexs:t.insertDataByIndexs.bind(Vn(t)),setRowStatusByIndexs:t.setRowStatusByIndexs.bind(Vn(t)),setRowsCellValue:t.setRowsCellValue.bind(Vn(t)),updateRows:t.updateRows.bind(Vn(t)),updateRowsProps:t.updateRowsProps.bind(Vn(t)),resetTableCaches:t.resetTableCaches.bind(Vn(t)),getCheckInfo:t.getCheckInfo.bind(Vn(t)),setCheckInfo:t.setCheckInfo.bind(Vn(t)),focusItem:t.focusItem.bind(Vn(t)),generateRowKey:t.generateRowKey,setCrossPage:t.setCrossPage,getConfig:t.getConfig,setConfig:t.setConfig,_setSelect:t._setSelect,_updateAndAddRows:t._updateAndAddRows,updateAfterBatchChange:t.updateAfterBatchChange}},t.name="PublicStore",t.refresh=t.refresh.bind(Vn(t)),t}return t=a,(r=[{key:"getStore",value:function(e){return Tn(An(a.prototype),"get",this).call(this,e)}},{key:"setStore",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,o=Tn(An(a.prototype),"set",this).call(this,e,t);return r&&this.forceUpdate(n),o}},{key:"setCache",value:function(e,t){if(e){Object(i.isArray)(e)||(e=[e]);var r=this.cache,n=e.length;e.forEach((function(e,o){r[e]||(r[e]={}),o===n-1?r[e]=t:r=r[e]}))}else console.warn("invalid params <path> to setting")}},{key:"getCache",value:function(e){if(!Object(i.isUndefined)(e)){Object(i.isArray)(e)||(e=[e]);var t=this.cache;return e.some((function(r){return Object(i.isUndefined)(r)||Object(i.isNullOrVoid)(t)?(Object(i.isUndefined)(r)&&console.warn("paths has empty item[%s]",e),!0):t[r]?(t=t[r],!1):(t=null,!0)})),t}console.warn("invalid params <paths> to setting")}},{key:"setMeta",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getStore("name");t&&this.setStore("name",t||n,!1),this.setStore(["meta"],new qn(e),r),this._setColInitialValue()}},{key:"_hasMeta",value:function(e){var t=this.getStore("meta")||{};return e&&Object(i.isObject)(t[e])&&t[e].items?t[e].items:null}},{key:"getViewMeta",value:function(e){var t=this._hasMeta(e);return t=t&&Object(i.isFunction)(t.get)?t.get():[]}},{key:"getArrayMeta",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(i.isUndefined)(e)&&!(e=this.getStore("name"))&&console.warn("not find current meta name");var r=this._hasMeta(e);return r&&!r.getArrayData&&console.warn("viewMeta not init, please setMeta"),(r=r?r.getArrayData?r.getArrayData():r:[]).filter((function(e){var r=e.children;return!r||!(t&&Object(i.isArray)(r)&&r.length>=0)}))}},{key:"getColumn",value:function(e,t){var r=this._hasMeta(e);if(!r)return console.warn("can't find meta id, please check meta & id",e),{};var n=r.query(t);return!n&&console.warn("can't find code, please check meta & id",r,t),n||{}}},{key:"setColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"merge";for(var o in t){var a=this.getColumn(e,o),i=t[o];if("merge"===n)for(var l in i)a[l]=i[l];else a=i}r&&this.forceUpdate()}},{key:"_generateColInitialValue",value:function(){var e=this,t={},r=this.getStore("name"),n=this.getMeta(),o=n.gridrelation&&n.gridrelation[r]&&n.gridrelation[r].tabRelation;return Object(i.isArray)(o)?o.forEach((function(r){e._generateItemValue(r,t)})):this._generateItemValue(r,t),JSON.parse(JSON.stringify(t))}},{key:"_generateItemValue",value:function(e,t){var r=this.getArrayMeta(e);r.length||console.warn("meta is empty array"),r.forEach((function(e){if(!e.children){var r=Object(l.itemCreator)({itemtype:e.itemtype})||{};t[e.attrcode]=_n(_n({scale:null,display:"",value:""},r.defaultValue||{}),e.initialvalue||{})}}))}},{key:"_setColInitialValue",value:function(){var e=this._generateColInitialValue();this.setCache("colInitialValue",e)}},{key:"_getColInitialValue",value:function(){var e=this.getCache("colInitialValue");return e&&Object.keys(e).length||(e=this._generateColInitialValue(),this.setCache("colInitialValue",e)),JSON.parse(JSON.stringify(e))}},{key:"_getCellValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(e.values||{})[t]||{}}},{key:"_setCellValue",value:function(e,t,r){return e.values=e.values||{},e.values[t]=r}},{key:"setCellValue",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.rowIndex,n=t.rowKeyValue,o=t.attrcode,a=t.value,l=void 0===a?{}:a,c=t.pattern,u=void 0===c?"merge":c,s=t.shouldForceUpdate,f=void 0===s||s,d=t.callback;if(n||-1!==r){!n&&(n=this._getRowKeyValue({rowIndex:r}));var p=this.getStore("data");if(!p.query(n||r))return console.warn("not find row data!");var y=p.update(n||r,(function(t){var r=e._getCellValue(t,o);return"merge"==u&&(l=_n(_n({},r),l)),d&&d(r,l,n,o),!d&&r&&!1===l.validated&&(Object(i.isWrong)(r.value)&&!Object(i.isWrong)(l.value)||Object(i.isWrong)(r.display)&&!Object(i.isWrong)(r.display))&&delete l.validated,e._setCellValue(t,o,l),t}));return f&&this.updateItem([n,o]),f&&this.updateItem([n,"sp_col_customer__"]),y}console.warn("rowIndex is -1")}},{key:"getCellValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowIndex,r=e.rowKeyValue,n=e.attrcode;if(r||-1!==t){!r&&(r=this._getRowKeyValue({rowIndex:t}));var o=this.getStore("data").query(r||t);return this._getCellValue(o,n)}console.warn("rowIndex is -1")}},{key:"setCellProps",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"merge";if(!Object(i.isUndefined)(e)){var l=this.getStore("data");if(!l.query(e))return console.warn("not find row data!");var c=l.update(e,(function(e){var o=r._getCellValue(e,t);return"merge"==a&&(n=_n(_n({},o),n)),r._setCellValue(e,t,n),e}));return o&&this.forceUpdate(),c}console.warn("invalid params")}},{key:"getCellProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowIndex,r=e.attrcode,n=e.rowKeyValue;if(n||-1!==t){!n&&(n=this._getRowKeyValue({rowIndex:t}));var o=this.getStore("data").query(n||t);return this._getCellValue(o,r)}console.warn("rowIndex is -1")}},{key:"getTrueRowIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowKeyValue,r=e.rowIndex,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if(Object(i.isUndefined)(t)&&Object(i.isUndefined)(r))return console.warn("invalid params"),-1;var o=this.getTableProps("rowKey"),a=this.getStore("data"),l=a.length;if(Object(i.isUndefined)(t)){var c=this.getViewData(n)[r];if(!c)return console.warn("not find row, maybe row overflow"),-1;t=c[o]}return a.some((function(e,n){return e[o]===t&&(r=n),e[o]===t})),-1===(r=r>=0&&r<l?r:-1)&&console.warn("rowIndex 为 -1，可能会导致后面报错"),r}},{key:"_getRowKeyValue",value:function(e){var t=e.rowKeyValue,r=e.rowIndex;if(!Object(i.isUndefined)(t)||!Object(i.isUndefined)(r)){if(t)return t;var n=this.getTableProps("rowKey"),o=this.getViewData(),a=o.length,l=o[r];return l&&l[n]?t=l[n]:console.warn("rowIndex overflow rowIndex: %s, len: %s",t,a),t}console.warn("invalid params _getRowKeyValue")}},{key:"_getRowKeyValues",value:function(e){var t=e.rowKeyValues,r=e.rowIndexs,n=e.defaultAll,o=void 0!==n&&n;if(Object(i.isUndefined)(t)&&Object(i.isUndefined)(r)){if(!o&&console.warn("invalid params ".concat(t)),o){var a=this.getStore("data"),l=this.getTableProps("rowKey");return a.order||a.map((function(e){return e[l]}))}return[]}if(t)return t=Object(i.isArray)(t)?t:[t];r=Object(i.isArray)(r)?r:[r];var c=this.getViewData(),u=this.getTableProps("rowKey"),s=c.length,f=[];return r.forEach((function(e){var t=c[e];t&&t[u]?f.push(t[u]):console.warn("rowIndex overflow rowIndex: %d, len: %d",e,s)})),f||[]}},{key:"getRowProps",value:function(e,t){var r=e.rowKeyValue,n=e.rowIndex;return r=this._getRowKeyValue({rowKeyValue:r,rowIndex:n}),this.getStore("data").query(r)[t]}},{key:"setRowProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowKeyValue,r=e.rowIndex,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=this._getRowKeyValue({rowKeyValue:t,rowIndex:r});var a=this.getStore("data");a.update(t,(function(e){return e=Object.assign({},e,n)})),o&&this.forceUpdate()}},{key:"setRowsProps",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.rowKeyValues,n=t.rowIndexs,o=t.defaultAll,a=void 0===o||o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(r=this._getRowKeyValues({rowKeyValues:r,rowIndexs:n,defaultAll:a})).forEach((function(t){e.setRowProps({rowKeyValue:t},i,!1)})),l&&this.forceUpdate()}},{key:"setRowsCellPropsByKey",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0;(e=this._getRowKeyValues({rowKeyValues:e,defaultAll:o})).forEach((function(e){var n=t.getStore("data").query(e);if(Object(i.isObject)(n))for(var o in n.values)t.setCellProps(e,o,r,!1);else console.warn("can't find row data",e)})),n&&this.forceUpdate()}},{key:"setRowsCellPropsByIndex",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0,a=this._getRowKeyValues({rowIndexs:e,defaultAll:o});a.forEach((function(e){var n=t.getStore("data").query(e);if(Object(i.isObject)(n))for(var o in n.values)t.setCellProps(e,o,r,!1);else console.warn("can't find row data",e)})),n&&this.forceUpdate()}},{key:"_getDataByRules",value:function(e){return e}},{key:"getRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowIndexs,r=e.rowKeyValues,n=e.filter,o=this.getStore("data"),a=[];return n?this._getDataByRules(o,n):(((r=this._getRowKeyValues({rowKeyValues:r,rowIndexs:t}))||t||[]).forEach((function(e){var t=o.query(e);!t&&console.warn("not find row data"),a.push(t)})),a)}},{key:"setRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rows,r=void 0===t?[]:t,n=e.shouldForceUpdate,o=void 0===n||n,a=this.getTableProps("rowKey"),l=this.getStore("data"),c=[];return r.forEach((function(e){var t=e[a],r=l.query(e[a]);Object(i.isObject)(r)?l.update(t,(function(t){var r=Object.assign({},t.values||{},e.values||{});for(var n in r)r[n]=r[n]||{},r[n]=Object.assign({},(t.values||{})[n],{display:Object(i.isUndefined)(r[n].display)?null:r[n].display,value:Object(i.isUndefined)(r[n].value)?null:r[n].value,scale:Object(i.isUndefined)(r[n].scale)?-1:r[n].scale}),!1!==r[n].validated||Object(i.isWrong)(r[n].value||r[n].display)||(delete r[n].validated,delete t.values[n].validated);(t=Object.assign({},t,e||{})).values=r;var o=JSON.parse(JSON.stringify(t));return c.push(o),o})):console.warn("can't find row data",a)})),o&&this.forceUpdate(),c}},{key:"moveRow",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getStore("data");if(Object(i.isUndefined)(e)||Object(i.isUndefined)(t)||e===t||e<0||t>n.length)return console.warn("invalid index");var o=this.getViewData("filter"),a=this.getTableProps("rowKey"),l=o[e],c=o[t];n.forEach((function(r,n){l&&l[a]===r[a]&&(e=n),c&&c[a]===r[a]&&(t=n)})),n[t]=l,n[e]=c,this.setData({data:n,shouldForceUpdate:r})}},{key:"setRowPosition",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getViewData("filter");if(e<0||Object(i.isUndefined)(e)||e>n.length)return console.warn("invalid index");e=this.getTrueRowIndex({rowIndex:e},"filter");var o=this.getStore("data");if("up"===t){var a=o.splice(e,1);o.unshift(a[0])}else if("down"===t){var l=o.splice(e,1);o.push(l[0])}this.setData({data:o,shouldForceUpdate:r})}},{key:"hasSelected",value:function(e){return e=this._getRowKeyValue({rowKeyValue:e}),this.getStore(["selectedIndex"]).has(e)}},{key:"setSelectedIndex",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.getStore(["selectedIndex"]);"clear"===r&&(o.clear(),this.setTableProps("focusIndex",-1,!1)),(e=Object(i.isArray)(e)?e:[Object(i.isObject)(e)?e:{rowKeyValue:e}]).forEach((function(e){var r=e.rowKeyValue,n=e.rowIndex,a=e.pattern,i=void 0===a?"add":a;r=t._getRowKeyValue({rowKeyValue:r,rowIndex:n}),"add"===i&&o.add(r),"reverse"===i&&(o.has(r)?o.delete(r):o.add(r)),"delete"===i&&o.delete(r)})),this.setStore(["selectedIndex"],o,n)}},{key:"_deleteRow",value:function(e,t,r){var n=this.getStore("data");if(!(e>n.length||e<0)){var o=n[e],a=o.status;return r||a!=Nn.delete&&a!=Nn.origin&&a!=Nn.edit?o=n.splice(e,1):this.setRowProps({rowKeyValue:t},{status:Nn.delete},!1),o}console.warn("rowIndex overflow")}},{key:"_insertRow",value:function(e){var t,r=e.rowValues,n=void 0===r?{}:r,o=e.rowIndex,a=e.shouldForceUpdate,l=void 0===a||a,c=e.type,u=void 0===c?"insert":c,s=e.isMergeInitValue,f=void 0===s||s,d=e.callback;!Object(i.isUndefined)(o)&&(o=this.getTrueRowIndex({rowIndex:o}));var p=this.getStore("data"),y=p.length,h=f?this._getColInitialValue():{},b=this.getTableProps("rowKey");Object.keys(n).forEach((function(e){var t=Object(i.isObject)(n[e])?n[e]:{},r={};!Object(i.isUndefined)(t.display)&&(r.display=t.display),!Object(i.isUndefined)(t.value)&&(r.value=t.value),!Object(i.isUndefined)(t.scale)&&(r.scale=t.scale),!Object(i.isUndefined)(t.isEdit)&&(r.isEdit=t.isEdit),h[e]=_n(_n({},h[e]),r)})),"insert"!==u||!Object(i.isUndefined)(o)&&-1!=o||(o=y),"add"!==u||!Object(i.isUndefined)(o)&&-1!=o||(o=y);var v=(In(t={},b,this.generateRowKey()),In(t,"status",Nn.add),In(t,"values",h),t);return p.splice(o,0,v),l&&this.forceUpdate(d),v}},{key:"_insertRows",value:function(e){var t=this,r=e.rows,n=void 0===r?[]:r,o=e.rowIndex,a=e.isGenerateRowKey,l=e.shouldForceUpdate,c=void 0===l||l;Object(i.isArray)(n)||(console.warn("rows params not array"),n=[n]),o&&(o=this.getTrueRowIndex({rowIndex:o}));var u=this.getStore("data"),s=u.length,f=this._getColInitialValue();if((Object(i.isUndefined)(o)||-1===o)&&(o=s),!(o>s||o<0)){var d=this.getTableProps("rowKey");return n=n.map((function(e){var r,n=e.values;Object.keys(n).forEach((function(e){n[e]=_n(_n({},f[e]),Object(i.isObject)(n[e])?n[e]:{})})),n=_n(_n({},f),n);var o=t.generateRowKey();return In(r={},d,a?o:e[d]||o),In(r,"status",Nn.add),In(r,"values",JSON.parse(JSON.stringify(n))),r})),this.setTableProps("status","edit",!1),u.splice.apply(u,[o,0].concat(En(n))),this.saveRowsOldValue({rows:n}),c&&this.forceUpdate(),n}console.warn("rowIndex overflow")}},{key:"formatData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,n=this.getTableProps("rowKey");return t=(t=Object(i.isArray)(t)?t:[t]).map((function(t){return t[n]=t[n]||e.generateRowKey(),t.status=t.status||Nn.origin,"clearSelect"===r&&delete t.selected,t}))}},{key:"setData",value:function(e){var t=e.data,r=void 0===t?[]:t,n=e.shouldForceUpdate,o=void 0===n||n,a=e.callback,l=this.getTableProps("rowKey"),c=Object(i.isArray)(r)?new Fn(r,l):this.getData();this.setStore(["data"],c,o,a)}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getStore("data");return(t=t.filter((function(t){return Object(i.isFunction)(e)?e(t,Nn):e.includes(Nn.filter)?!e.includes(t.status)&&!t.filter:!e.includes(t.status)})))||[]}},{key:"getViewData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=e;"normal"===e&&(t=[Nn.filter,Nn.delete]),"filter"===e&&(t=[Nn.delete]),"all"===e&&(t=[]),"invisible"==e&&(t=[Nn.filter,Nn.origin,Nn.edit,Nn.add]);var r=this.getData(t);return r}},{key:"getTableProps",value:function(e){return this.getStore(["props",e])}},{key:"setTableProps",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0;this.setStore(["props",e],t,r,n)}},{key:"getPageInfo",value:function(){return this.getStore(["pageInfo"])}},{key:"setPageInfo",value:function(e){e.shouldForceUpdate;var t=e.pageInfo,r=void 0===t?{}:t,n=this.getStore(["pageInfo"])||{};return n=_n(_n({},n),r),this.setStore(["pageInfo"],n)}},{key:"getCheckInfo",value:function(){return this.getStore(["checkInfo"])||{}}},{key:"setCheckInfo",value:function(e){var t=e.checkInfo,r=e.shouldForceUpdate,n=void 0===r||r;this.setStore(["checkInfo"],t,n)}},{key:"setRowsSelected",value:function(e,t){var r=this,n=e.rowKeyValues,o=e.rowIndexs,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=i.pattern,c=i.defaultAll,u=void 0===c||c,s=i.callback;n=this._getRowKeyValues({rowKeyValues:n,rowIndexs:o,defaultAll:u});var f=this.getViewData("filter");l=l||(t?"add":"delete");var d=n.map((function(e){var n=r.getRows({rowKeyValues:[e]})[0]||{},o=n.values||n,a=!o.saga_status||"1"!==o.saga_status.value,i="add"==l&&n.disabled;return a&&!i&&r.setRowProps({rowKeyValue:e},{selected:t},!1),{rowKeyValue:e,pattern:l}})),p=this.getCheckInfo();f&&f.length?(p.indeterminate=f.some((function(e){var t=e.values||e,r=!t.saga_status||"1"!==t.saga_status.value,n="add"==l&&e.disabled;return r&&!n&&e.selected})),p.checkedAll=f.every((function(e){var t=e.values||e,r=!t.saga_status||"1"!==t.saga_status.value,n="add"==l&&e.disabled;return!r||n||e.selected}))):(p.indeterminate=!1,p.checkedAll=!1),this.setSelectedIndex(d||[],"",!1),this.setStore(["checkInfo"],p,a,s)}},{key:"setAllRowsSelected",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;this.setRowsSelected({},e,t,{defaultAll:!0,callback:r})}},{key:"setRowsSelectedByIndexs",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.pattern,a=n.defaultAll,i=void 0===a||a;this.setRowsSelected({rowIndexs:e},t,r,{pattern:o,defaultAll:i})}},{key:"setRowsSelectedByRowKey",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.pattern,a=n.defaultAll,i=void 0===a||a;this.setRowsSelected({rowKeyValues:e},t,r,{pattern:o,defaultAll:i})}},{key:"reverseRowsSelected",value:function(e){var t=this,r=this.getStore("data"),n=this.getTableProps("rowKey"),o=[];r.forEach((function(e){var r=e.selected;t.setRowProps({rowKeyValue:e[n]},{selected:!r},!1),!r&&o.push({rowKeyValue:e[n],pattern:"add"})}));var a=this.getCheckInfo();a.indeterminate=r.some((function(e){return e.selected&&e.status!==Nn.delete})),a.checkedAll=r.every((function(e){return!!e.selected})),this.setSelectedIndex([],"clear",!1),this.setSelectedIndex(o||[],"",e)}},{key:"saveRowOldValue",value:function(e,t,r){this.setCache(["oldRows",e,t],r)}},{key:"getRowOldValue",value:function(e,t){return this.getCache(["oldRows",e,t])}},{key:"deleteRowOldValue",value:function(e,t){this.setCache(["oldRows",e,t],null)}},{key:"removeEmptyRows",value:function(e){var t=this,r=e.data,n=e.keys,o=e.rule,a=void 0===o?"except":o,l=e.shouldForceUpdate,c=void 0===l||l;r=r||this.getStore("data");var u=this.getTableProps("rowKey"),s=[];r.forEach((function(e,r){var o=e.values,l=Object.keys(o).filter((function(e){return"numberindex"!=e}));if(!Object(i.isArray)(n)||"except"!=a&&"include"!=a?console.warn("Invalid params ",a,n):l=l.filter((function(e){return"except"==a?n.every((function(t){return e!==t})):n.includes(e)})),l.every((function(e){return Object(i.isWrongFalse)(o[e].value)}))){if(-1===t.getTrueRowIndex({rowKeyValue:e[u]}))return void s.push(e)}else s.push(e)})),this.setData({data:s,shouldForceUpdate:c})}},{key:"saveRowsOldValue",value:function(e){var t=this,r=e.rows,n=this.getTableProps("rowKey");r.filter((function(e){return e.status!=Nn.delete})).map((function(e){var r=e.values,o=e[n];for(var a in r){var i=r[a]?r[a].value:null;t.saveRowOldValue(o,a,i)}}))}},{key:"_clearRowsOldValue",value:function(e){var t=this,r=e.rows,n=this.getTableProps("rowKey");r.map((function(e){var r=e.values,o=e[n];for(var a in r)t.saveRowOldValue(o,a,null)}))}},{key:"clearSortStatus",value:function(e){var t=this,r=e.columns;r.forEach((function(e){var n=e.children;Object(i.isUndefined)(n)?r.forEach((function(e){e.order="flatscend",e.orderNum=""})):t.clearSortStatus({columns:n})}))}},{key:"setTableData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.isCache,o=void 0===n||n,a=r.isTop,i=void 0!==a&&a,l=r.shouldForceUpdate,c=void 0===l||l;if(!t.rows)return console.warn("invalid data rows");t.rows=this.formatData(t.rows,"clearSelect");var u=this.getArrayMeta();u&&this.clearSortStatus({columns:u}),o&&(this.setCache(["base"],JSON.parse(JSON.stringify(t))),this.setCache(["all"],null),this.setCache(["afterDel"],null)),this.setStore("filterReset",!0,!1,(function(){e.setStore("filterReset",!1,!1)})),this.resetFilter(void 0);var s=this.getStore(["checkInfo","crossPageSelectIndex"]),f=this.getStore(["checkInfo","checkedAllpage"]);0===s.size&&(f=!1);var d=this.getStore("allpks")||[];t.allpks?d=t.allpks:t.rows&&0==t.rows.length&&(f=!1,s=new Set,d=[]),this.setStore("allpks",d,!1);var p={checkedAll:!1,indeterminate:!1,selectIndex:[],disabledAll:!1,checkedAllpage:f,crossPageSelectIndex:s};this.setCheckInfo({checkInfo:p,shouldForceUpdate:!1}),this.setTableProps("currentInfo",null,!1),this.setTableProps("currentIndex",-1,!1),this.setSelectedIndex([],"clear",!1),this.setTableProps("focusIndex",i?0:-1,!1);var y=this.getData();this._clearRowsOldValue({rows:y}),this.setData({data:t.rows,shouldForceUpdate:c,callback:function(){e.setStore("filterReset",!1,!1),e.setTableProps("focusIndex",-1,!1)}});var h=this.getData();this.saveRowsOldValue({rows:h});var b=this.getConfig(),v=b.crossPageSelect,m=b.pkname;if(v&&m){var g=this.getCheckInfo(),w=g.crossPageSelectIndex;if(t.allpks&&t.allpks.length&&(t.allpks.length===d.length&&t.allpks[0]===d[0]||(f=!1,w.clear(),p.checkedAllpage=!1,p.crossPageSelectIndex=w,this.setCheckInfo({checkInfo:p,shouldForceUpdate:!1}))),f)this._setSelect(void 0,"allpage");else{var O=this.getData(),S=this.getTableProps("rowKey"),j=[];O.forEach((function(e){if(!e.values[m])return console.error("行数据中没有pkname为".concat(m,"的value")),void console.log(e);var t=e.values[m].value;w.has(t)&&j.push(e[S])})),this._setSelect(j,"set",!0)}}return t}},{key:"updateTableData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e.rows)return console.warn("invalid data rows");e.rows=this.formatData(e.rows)||[];var n=this.setRows({rows:e.rows,shouldForceUpdate:r});if(t){var o=this.getData();this.setCache(["base"],{rows:JSON.parse(JSON.stringify(o))}),this.setCache(["afterDel"],null),this.setCache(["all"],null)}this.saveRowsOldValue({rows:n})}},{key:"updateRows",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return console.warn("invalid data params");var n=this.getTableProps("rowKey");e.rows&&e.rows.map((function(e){var r=e,o=(r.values,r.status),a=e[n];(e=(t.formatData([e])||[e])[0])[n]=a,e.status=Object(i.isUndefined)(o)||o==Nn.origin?Nn.edit:o,t.setRows({rows:[e],shouldForceUpdate:!1})})),Object(i.isArray)(e)&&e.map((function(e){var r=e.index,o=e.data,a=t._getRowKeyValue({rowIndex:r});(o=(t.formatData([o])||[o])[0]).status=Object(i.isUndefined)(o.status)||o.status==Nn.origin?Nn.edit:o.status,o[n]=a,t.setRows({rows:[o],shouldForceUpdate:!1})})),r&&this.forceUpdate()}},{key:"updateRowsProps",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return console.warn("invalid data params");e.rows&&e.rows.map((function(e){e=_n(_n({},e),r),t.setRows({rows:[e],shouldForceUpdate:!1})})),Object(i.isArray)(e)&&e.map((function(e){var n=e.data;n=_n(_n({},n),r),t.setRows({rows:[n],shouldForceUpdate:!1})})),n&&this.forceUpdate()}},{key:"resetTableCaches",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getData();this.setCache(["base"],{rows:JSON.parse(JSON.stringify(t))}),this.setCache(["afterDel"],null),this.setCache(["all"],null),this.saveRowsOldValue({rows:t}),e&&this.forceUpdate()}},{key:"updateTableDataByIndexs",value:function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!Object(i.isArray)(e))return console.warn("invalid data params");var o=this.getTableProps("rowKey"),a=this.getData();e.map((function(e){var t=e.index,n=e.data,a=r._getRowKeyValue({rowIndex:t});(n=(r.formatData([n])||[n])[0]).status=Object(i.isUndefined)(n.status)||n.status==Nn.origin?Nn.edit:n.status,n[o]=a,r.setRows({rows:[n],shouldForceUpdate:!1})})),t&&(this.setCache(["base"],{rows:JSON.parse(JSON.stringify(a))}),this.setCache(["afterDel"],null),this.setCache(["all"],null)),this.saveRowsOldValue({rows:a}),n&&this.forceUpdate()}},{key:"updateTableDataByRowId",value:function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e||!Object(i.isArray)(e.rows))return console.warn("invalid data params");var a=this.getTableProps("rowKey");e.rows.map((function(e){var t=e,n=(t.values,t.status),o=e[a];(e=(r.formatData([e])||[e])[0])[a]=o,e.status=Object(i.isUndefined)(n)||n==Nn.origin?Nn.edit:n,r.setRows({rows:[e],shouldForceUpdate:!1})}));var l=this.getData(o?[Nn.delete]:[]);t&&(this.setCache(["base"],{rows:JSON.parse(JSON.stringify(l))}),this.setCache(["afterDel"],null),this.setCache(["all"],null)),this.saveRowsOldValue({rows:l}),this.setData({data:l,shouldForceUpdate:n})}},{key:"setTableStatus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.shouldForceUpdate,n=void 0===r||r;if(!["edit","browse"].includes(e))return console.warn("unknown status: ".concat(e,", status should be 'edit' or 'browse'"));this.getTableProps("status"),"browse"===e&&this.setCache("oldBatchData",null),this.setTableProps("status",e,n)}},{key:"getAllRows",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getData()||[],r=e?JSON.parse(JSON.stringify(t)):t,n=[],o=[];return r.forEach((function(e){e.status===Nn.delete?o.push(e):n.push(e)})),r=n.concat(o)}},{key:"getVisibleRows",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getData(t?[Nn.delete,Nn.filter]:[Nn.delete]);return e?JSON.parse(JSON.stringify(r)):r}},{key:"getChangedRows",value:function(){var e=this.getData([Nn.origin]);return JSON.parse(JSON.stringify(e))}},{key:"focusItem",value:function(e,t){for(var r=this.getArrayMeta(),n=0;n<r.length;n++)if(!r[n].children&&"numberindex"!=r[n].attrcode&&(void 0===r[n].disabled||0==r[n].disabled)&&void 0!==r[n].visible&&1==r[n].visible){var o=r[n].attrcode;this.setCellProps(e,o,{isEdit:!0,autoFocus:!0},t);break}}},{key:"addTableRow",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=o.autoFocus,l=void 0!==a&&a,c=o.isAutoAddRow,u=o.callback;if(!this.__addRowLock||c){this.__addRowLock=!0;var s=this.getTableProps("rowKey"),f=this.getViewData(),d=f.length,p=Object(i.isUndefined)(e)?d:this.getTrueRowIndex({rowIndex:e}),y=-1===p?d:p;if(this.setTableProps("focusIndex",0===y?y:y+1,!1),this.setTableProps("status","edit",!1),"Promise"!==Object(i.isPromise)(r)){Object(i.isFunction)(r)&&(r=r()||{});var h=this._insertRow({rowValues:r,rowIndex:e,shouldForceUpdate:!1,type:"add",callback:null});return this.saveRowsOldValue({rows:[h]}),l&&this.focusItem(h[s],!1),n&&this.forceUpdate((function(){t.setTableProps("focusIndex",-1,!1),u&&u(h)})),this.__addRowLock=!1,h}r.then((function(r){var o=t._insertRow({rowValues:r,rowIndex:e,shouldForceUpdate:!1,type:"add",callback:null});return t.saveRowsOldValue({rows:[o]}),l&&t.focusItem(o[s],!1),n&&t.forceUpdate((function(){t.setTableProps("focusIndex",-1,!1),u&&u(o)})),t.__addRowLock=!1,o}))}}},{key:"deleteTableRows",value:function(e,t){var r=this,n=e.rowKeyValues,o=e.rowIndexs,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;n=this._getRowKeyValues({rowKeyValues:n,rowIndexs:o});var l=[],c=this.getTableProps("rowKey"),u=this.getData(),s=this.getTableProps("currentInfo")||{},f=this.getTableProps("currentIndex"),d=this.getViewData("filter")[f],p=!1;return n.forEach((function(e){var n=r.getTrueRowIndex({rowKeyValue:e});if(-1!==n){p||(p=u[n][c]===s[c]||u[n][c]===d),r.deleteRowOldValue(u[n][c],{}),r.setRowsSelected({rowKeyValues:[e],rowIndexs:o},!1,!1);var a=r._deleteRow(n,e,t);l.push(a)}})),t&&this.setCache(["afterDel"],_n(_n({},this.getStore([])||{}),{},{data:u})),p&&(this.setTableProps("currentInfo",null,!1),this.setTableProps("focusIndex",-1,!1),this.setTableProps("currentIndex",-1,!1)),a&&this.forceUpdate(i),l}},{key:"setValByKeyAndIndex",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.isSetEdit,a=void 0===o||o,l=n.isUpdateBatch,c=void 0!==l&&l,u=n.shouldForceUpdate,s=void 0===u||u,f=r.value,d=r.display,p=this.getRows({rowIndexs:[e]})[0],y=this.getTableProps("rowKey");if(!p)return console.warn("unknown row data");p.status==Nn.origin&&a&&this.setRowProps({rowIndex:e},{status:Nn.edit},!1),Object(i.isUndefined)(f)||this.saveRowOldValue(p[y],t,f),!c||Object(i.isUndefined)(f)&&Object(i.isUndefined)(d)||this.setCache("oldBatchData",{batchChangeIndex:Number(e),batchChangeKey:t,batchChangeValue:Object(i.isUndefined)(f)?null:f,batchChangeDisplay:Object(i.isUndefined)(d)?null:d}),this.setCellValue({rowIndex:e,attrcode:t,value:r,shouldForceUpdate:s})}},{key:"setValByKeyAndRowId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.isSetEdit,a=void 0===o||o,l=n.isUpdateBatch,c=void 0!==l&&l,u=n.shouldForceUpdate,s=void 0===u||u,f=r.value,d=r.display,p=this.getRows({rowKeyValues:[e]})[0],y=this.getTableProps("rowKey");if(a&&p.status==Nn.origin&&this.setRowProps({rowKeyValue:e},{status:Nn.edit},!1),Object(i.isUndefined)(f)||this.saveRowOldValue(p[y],t,f),c&&(!Object(i.isUndefined)(f)||!Object(i.isUndefined)(d))){var h=this.getViewData("filter"),b=-1;h.forEach((function(t,r){t[y]==e&&(b=r)})),-1!==b&&this.setCache("oldBatchData",{batchChangeIndex:Number(b),batchChangeKey:t,batchChangeValue:Object(i.isUndefined)(f)?null:f,batchChangeDisplay:Object(i.isUndefined)(d)?null:d})}this.setCellValue({rowKeyValue:e,attrcode:t,value:r,shouldForceUpdate:s})}},{key:"getValByKeyAndIndex",value:function(e,t){var r=this.getCellValue({rowIndex:e,attrcode:t});return(!r||Object(i.isUndefined)(r.value))&&console.warn("empty cell value "),JSON.parse(JSON.stringify(r||{}))}},{key:"getValByKeyAndRowKey",value:function(e,t){var r=this.getCellValue({rowKeyValue:e,attrcode:t});return(!r||Object(i.isUndefined)(r.value))&&console.warn("empty cell value "),JSON.parse(JSON.stringify(r||{}))}},{key:"setCellsProps",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.rowIndexs,n=t.rowKeyValues,o=t.attrcodes,a=t.value,l=void 0===a?{}:a,c=t.shouldForceUpdate,u=void 0===c||c;if(!n&&(n=this._getRowKeyValues({rowKeyValues:n,rowIndexs:r})),n=Object(i.isArray)(n)?n:[n],l.disabled=Object(i.isBoolean)(l.disabled)?l.disabled:"on"===l.disabled,o)o=Object(i.isArray)(o)?o:[o],n.forEach((function(t){o.forEach((function(r){e.setCellProps(t,r,l,!1)}))}));else{var s=this.getStore("data");n.forEach((function(t){var r=s.query(t);if(Object(i.isObject)(r))for(var n in r.values)e.setCellProps(t,n,l,!1)}))}u&&this.forceUpdate()}},{key:"pasteRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.copyRow,r=void 0===t?{}:t,n=e.index,o=e.excludeKeys,a=e.shouldForceUpdate,l=void 0===a||a,c=JSON.parse(JSON.stringify(r)),u=c.values||{};return Object(i.isArray)(o)&&o.map((function(e){u[e]&&delete u[e]})),c.values=u,this._insertRows({rows:[c],rowIndex:n,isGenerateRowKey:!0,shouldForceUpdate:l})}},{key:"getSelectedRows",value:function(e){var t=this.getStore("data"),r=[],n=this.getConfig(),o=n.crossPageSelect,a=n.pkname;if(o&&a){var i=this.getStore(["checkInfo"]).crossPageSelectIndex,l=this.getStore(["allpks"]),c=this.getStore(["alltss"]),u=this.getPageInfo().pageSize;u=Number(u);var s=[];return t.forEach((function(e){var t=e.values[a].value;s.push(t)})),i.forEach((function(e){var n,o=s.indexOf(e);if(-1!==o){var a=l.indexOf(e);n={data:t[o],index:a%u,pageIndex:Math.floor(a/u)}}else{var i=l.indexOf(e);-1!==i&&(n={data:{pk:l[i],ts:c[i]},index:i%u,pageIndex:Math.floor(i/u)})}n&&r.push(n)})),e?JSON.parse(JSON.stringify(r)):r}return this.getViewData("normal").map((function(e,t){e.selected&&r.push({data:e,index:t})})),e?JSON.parse(JSON.stringify(r)):r}},{key:"getAllRowsRemoveKeys",value:function(e){var t=this.getStore("data"),r=["string"==typeof e,Array.isArray(e)],n=r[0],o=r[1];if(null==e||n||o)return t.map((function(t){var r=t.values;for(var a in r)(n&&a===e||o&&e.includes(a))&&delete r[a]})),t.filter((function(e){return e.status!=Nn.delete}))}},{key:"getMixinMetaOfData",value:function(){var e=this._getColInitialValue(),t=this.getTableProps("rowKey");return this.getStore("data").map((function(r){return r.values=_n(_n({},r.values),e[r[t]]),r}))}},{key:"_getFilterRows",value:function(e,t,r){var n=JSON.parse(JSON.stringify(this.getStore("data")||[]));if(Object(i.isString)(e)&&(e=[e]),this.getViewData("filter"),n=n.map((function(e){return e.filter&&(delete e.filter,delete e.filterIndex),e})),Object(i.isUndefined)(t)||""===t)return{filterRows:n=n.map((function(e,t){return e.filter=!1,e.filterIndex=t,e})),allRows:n};var o=this.getArrayMeta();return o&&o.forEach((function(t){"residtxt"===t.itemtype&&(e=e.map((function(e){return e==t.attrcode&&t.languageMeta.forEach((function(t){t.languageCode==r&&(e+=t.index)})),e})))})),n.filter((function(r,n){var o=r.values;r.status!=Nn.delete&&(e.length&&(r.filter=!0,delete r.filterIndex),e.forEach((function(e){o[e]&&(o[e].display&&o[e].display.includes(t)||o[e].value&&o[e].value.includes(t))&&(r.filter=!1,r.filterIndex=n);var a=e.slice(0,e.length-1);o[a]&&(o[a].display&&o[a].display.includes(t)||o[a].value&&o[a].value.includes(t))&&(r.filter=!1,r.filterIndex=n)})))})),{filterRows:[],allRows:n}}},{key:"getFilterRows",value:function(e,t,r){var n=this._getFilterRows(e,t,r),o=n.filterRows;return n.allRows,{areaType:"table",rows:o,areacode:null}}},{key:"resetFilter",value:function(e){if(!(e=e||this.getStore("name")))return console.warn("invalid resetFilter tableId note find");var t=this.getArrayMeta(e,!0),r={};t.forEach((function(e){r[e.attrcode]={filterStatus:""}}));var n=this.getData()||[];n.forEach((function(e){e.filter=!1,delete e.filterIndex}));var o=this.getCheckInfo(),a=this.getViewData();a&&a.length&&(o.indeterminate=a.some((function(e){var t=e.values||e;return(!t.saga_status||"1"!==t.saga_status.value)&&e.selected})),o.checkedAll=a.every((function(e){var t=e.values||e;return!(!t.saga_status||"1"!==t.saga_status.value)||e.selected}))),this.setStore(["checkInfo"],o,!1),this.setData({data:n,shouldForceUpdate:!1}),this.setColumn(e,r,!1)}},{key:"setFiltrateTableData",value:function(e,t,r,n,o){var a=this;this.setStore("filterReset",!0,!1),this.resetFilter(o);var i=this._getFilterRows(e,t,n),l=i.filterRows,c=i.allRows;if(r&&0===l.rows.length){c=c.map((function(e){return e.filter&&(delete e.filter,delete e.filterIndex),e}));var u=this.getCheckInfo(),s=this.getViewData();s&&s.length&&(u.indeterminate=s.some((function(e){var t=e.values||e,r=!t.saga_status||"1"!==t.saga_status.value,n=e.disabled;return r&&!n&&e.selected})),u.checkedAll=s.every((function(e){var t=e.values||e,r=!t.saga_status||"1"!==t.saga_status.value,n=e.disabled;return!r||n||e.selected}))),this.setStore(["checkInfo"],u,!1)}this.setData({data:c,callback:function(){a.setStore("filterReset",!1,!1)}})}},{key:"batchChangeTableData",value:function(){var e=this.getCache("oldBatchData"),t=this.getData();return!Object(i.isArray)(t)||t.length<=0||!e||!e.batchChangeKey?null:(t.forEach((function(t){var r=t.values;if(t.status!=Nn.delete)if(t.status==Nn.origin&&(t.status=Nn.edit),Object(i.isObject)(e.batchChangeValue)){var n=e.batchChangeValue;Object.keys(n).forEach((function(e){r[e]?r[e]=_n(_n({},r[e]),n[e]):r[e]=n[e]}))}else r[e.batchChangeKey]=r[e.batchChangeKey]||{},r[e.batchChangeKey].value=e.batchChangeValue,r[e.batchChangeKey].display=e.batchChangeDisplay})),this.saveRowsOldValue({rows:t}),this.setData({data:t}),{code:e.batchChangeKey,value:e.batchChangeValue,display:e.batchChangeDisplay})}},{key:"insertDataByIndexs",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!Object(i.isArray)(e))return console.warn("invalid data params");this.setTableProps("status","edit",!1),e.map((function(e){var n=e.index,o=e.data;t._insertRow({rowValues:o.values,rowIndex:n,type:"add",shouldForceUpdate:!1,isMergeInitValue:r})}));var o=this.getData();this.saveRowsOldValue({rows:o}),n&&this.forceUpdate()}},{key:"setRowStatusByIndexs",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getData(),o=this.getTableProps("rowKey");e.map((function(e){var r=e.index,a=e.status,i=t.getTrueRowIndex({rowIndex:r});if(!Object.values(Nn).includes(String(a)))return console.warn("status必须是0到3的数字或者字符串");t.setRowProps({rowIndex:r},{status:a},!1),n[i][o]=t.generateRowKey()})),this.setData({data:n,shouldForceUpdate:r})}},{key:"insertRowsAfterIndex",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=Object(i.isUndefined)(t)?0:++t,this._insertRows({rows:e,rowIndex:t,isGenerateRowKey:!0,shouldForceUpdate:r})}},{key:"setRowsCellValue",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.rows,n=(t.pattern,t.shouldForceUpdate),o=void 0===n||n;if(r){r=Object(i.isArray)(r)?r:[r];var a=this.getTableProps("rowKey"),l=this.getStore("data");return r.forEach((function(t){var r=t[a],n=l.query(r);if(Object(i.isObject)(n)){for(var o in t.values)e.setCellValue({rowKeyValue:r,attrcode:o,value:t.values[o],shouldForceUpdate:!1});n.status==Nn.origin&&(n.status=Nn.edit)}else console.warn("can't find row data",a)})),o&&this.forceUpdate(),r}}},{key:"refresh",value:function(){this.forceUpdate&&this.forceUpdate()}}])&&Rn(t.prototype,r),n&&Rn(t,n),a}(l.BaseStore)},19:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r(1),r(6),r(9);var n={refer:function(e){var t=e&&document.querySelector(e),r=t&&t.querySelector("input[tabindex='0']"),n=t&&t.querySelector("span[tabindex='0']");r?(r.focus(),t=null):n?(n.focus(),t=null):t&&t.addEventListener("DOMSubtreeModified",(function e(r){!function(e,t,r){var n=r.target.querySelector("input[tabindex='0']");n&&setTimeout((function(){n.focus(),e&&e.removeEventListener("DOMSubtreeModified",t),n=null,e=null}))}(t,e,r)}));r=null,n=null},input:o,textarea:function(e){var t=e&&document.querySelector(e),r=t&&t.querySelector("textarea");r&&r.focus(),t=null,r=null},select:function(e){var t=e&&document.querySelector(e),r=t&&t.querySelector(".u-select-selection[tabindex]")||t.querySelector("input");r&&r.focus(),t=null,r=null},switch:a,switch_browse:a,normal:o};function o(e){var t=e&&document.querySelector(e),r=t&&t.querySelector("input");r&&r.focus(),t=null,r=null}function a(e){var t=e&&document.querySelector(e),r=t&&t.querySelector("span[tabindex]");r&&r.focus(),t=null,r=null}},2:function(e,t,r){e.exports=r(69)()},20:function(e,t,r){(function(e,r){var n="[object Arguments]",o="[object Map]",a="[object Object]",i="[object Set]",l=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u[n]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u[o]=u["[object Number]"]=u[a]=u["[object RegExp]"]=u[i]=u["[object String]"]=u["[object WeakMap]"]=!1;var s="object"==typeof e&&e&&e.Object===Object&&e,f="object"==typeof self&&self&&self.Object===Object&&self,d=s||f||Function("return this")(),p=t&&!t.nodeType&&t,y=p&&"object"==typeof r&&r&&!r.nodeType&&r,h=y&&y.exports===p,b=h&&s.process,v=function(){try{return b&&b.binding&&b.binding("util")}catch(e){}}(),m=v&&v.isTypedArray;function g(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function w(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function O(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var S,j,k,C=Array.prototype,x=Function.prototype,_=Object.prototype,I=d["__core-js_shared__"],E=x.toString,P=_.hasOwnProperty,R=(S=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",T=_.toString,K=RegExp("^"+E.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=h?d.Buffer:void 0,M=d.Symbol,V=d.Uint8Array,A=_.propertyIsEnumerable,N=C.splice,F=M?M.toStringTag:void 0,q=Object.getOwnPropertySymbols,H=D?D.isBuffer:void 0,U=(j=Object.keys,k=Object,function(e){return j(k(e))}),B=ve(d,"DataView"),L=ve(d,"Map"),W=ve(d,"Promise"),J=ve(d,"Set"),z=ve(d,"WeakMap"),Y=ve(Object,"create"),$=Oe(B),Z=Oe(L),G=Oe(W),X=Oe(J),Q=Oe(z),ee=M?M.prototype:void 0,te=ee?ee.valueOf:void 0;function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function oe(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ae(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new oe;++t<r;)this.add(e[t])}function ie(e){var t=this.__data__=new ne(e);this.size=t.size}function le(e,t){var r=ke(e),n=!r&&je(e),o=!r&&!n&&Ce(e),a=!r&&!n&&!o&&Pe(e),i=r||n||o||a,l=i?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=l.length;for(var u in e)!t&&!P.call(e,u)||i&&("length"==u||o&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||we(u,c))||l.push(u);return l}function ce(e,t){for(var r=e.length;r--;)if(Se(e[r][0],t))return r;return-1}function ue(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":F&&F in Object(e)?function(e){var t=P.call(e,F),r=e[F];try{e[F]=void 0;var n=!0}catch(e){}var o=T.call(e);n&&(t?e[F]=r:delete e[F]);return o}(e):function(e){return T.call(e)}(e)}function se(e){return Ee(e)&&ue(e)==n}function fe(e,t,r,l,c){return e===t||(null==e||null==t||!Ee(e)&&!Ee(t)?e!=e&&t!=t:function(e,t,r,l,c,u){var s=ke(e),f=ke(t),d=s?"[object Array]":ge(e),p=f?"[object Array]":ge(t),y=(d=d==n?a:d)==a,h=(p=p==n?a:p)==a,b=d==p;if(b&&Ce(e)){if(!Ce(t))return!1;s=!0,y=!1}if(b&&!y)return u||(u=new ie),s||Pe(e)?ye(e,t,r,l,c,u):function(e,t,r,n,a,l,c){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new V(e),new V(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Se(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case o:var u=w;case i:var s=1&n;if(u||(u=O),e.size!=t.size&&!s)return!1;var f=c.get(e);if(f)return f==t;n|=2,c.set(e,t);var d=ye(u(e),u(t),n,a,l,c);return c.delete(e),d;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,d,r,l,c,u);if(!(1&r)){var v=y&&P.call(e,"__wrapped__"),m=h&&P.call(t,"__wrapped__");if(v||m){var g=v?e.value():e,S=m?t.value():t;return u||(u=new ie),c(g,S,r,l,u)}}if(!b)return!1;return u||(u=new ie),function(e,t,r,n,o,a){var i=1&r,l=he(e),c=l.length,u=he(t).length;if(c!=u&&!i)return!1;var s=c;for(;s--;){var f=l[s];if(!(i?f in t:P.call(t,f)))return!1}var d=a.get(e);if(d&&a.get(t))return d==t;var p=!0;a.set(e,t),a.set(t,e);var y=i;for(;++s<c;){f=l[s];var h=e[f],b=t[f];if(n)var v=i?n(b,h,f,t,e,a):n(h,b,f,e,t,a);if(!(void 0===v?h===b||o(h,b,r,n,a):v)){p=!1;break}y||(y="constructor"==f)}if(p&&!y){var m=e.constructor,g=t.constructor;m==g||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof g&&g instanceof g||(p=!1)}return a.delete(e),a.delete(t),p}(e,t,r,l,c,u)}(e,t,r,l,fe,c))}function de(e){return!(!Ie(e)||function(e){return!!R&&R in e}(e))&&(xe(e)?K:l).test(Oe(e))}function pe(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||_,t!==n)return U(e);var t,r,n,o=[];for(var a in Object(e))P.call(e,a)&&"constructor"!=a&&o.push(a);return o}function ye(e,t,r,n,o,a){var i=1&r,l=e.length,c=t.length;if(l!=c&&!(i&&c>l))return!1;var u=a.get(e);if(u&&a.get(t))return u==t;var s=-1,f=!0,d=2&r?new ae:void 0;for(a.set(e,t),a.set(t,e);++s<l;){var p=e[s],y=t[s];if(n)var h=i?n(y,p,s,t,e,a):n(p,y,s,e,t,a);if(void 0!==h){if(h)continue;f=!1;break}if(d){if(!g(t,(function(e,t){if(i=t,!d.has(i)&&(p===e||o(p,e,r,n,a)))return d.push(t);var i}))){f=!1;break}}else if(p!==y&&!o(p,y,r,n,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function he(e){return function(e,t,r){var n=t(e);return ke(e)?n:function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}(n,r(e))}(e,Re,me)}function be(e,t){var r,n,o=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof t?"string":"hash"]:o.map}function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return de(r)?r:void 0}re.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},re.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},re.prototype.get=function(e){var t=this.__data__;if(Y){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return P.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return Y?void 0!==t[e]:P.call(t,e)},re.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Y&&void 0===t?"__lodash_hash_undefined__":t,this},ne.prototype.clear=function(){this.__data__=[],this.size=0},ne.prototype.delete=function(e){var t=this.__data__,r=ce(t,e);return!(r<0)&&(r==t.length-1?t.pop():N.call(t,r,1),--this.size,!0)},ne.prototype.get=function(e){var t=this.__data__,r=ce(t,e);return r<0?void 0:t[r][1]},ne.prototype.has=function(e){return ce(this.__data__,e)>-1},ne.prototype.set=function(e,t){var r=this.__data__,n=ce(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},oe.prototype.clear=function(){this.size=0,this.__data__={hash:new re,map:new(L||ne),string:new re}},oe.prototype.delete=function(e){var t=be(this,e).delete(e);return this.size-=t?1:0,t},oe.prototype.get=function(e){return be(this,e).get(e)},oe.prototype.has=function(e){return be(this,e).has(e)},oe.prototype.set=function(e,t){var r=be(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},ae.prototype.add=ae.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ae.prototype.has=function(e){return this.__data__.has(e)},ie.prototype.clear=function(){this.__data__=new ne,this.size=0},ie.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ie.prototype.get=function(e){return this.__data__.get(e)},ie.prototype.has=function(e){return this.__data__.has(e)},ie.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ne){var n=r.__data__;if(!L||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new oe(n)}return r.set(e,t),this.size=r.size,this};var me=q?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var i=e[r];t(i,r,e)&&(a[o++]=i)}return a}(q(e),(function(t){return A.call(e,t)})))}:function(){return[]},ge=ue;function we(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}function Oe(e){if(null!=e){try{return E.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Se(e,t){return e===t||e!=e&&t!=t}(B&&"[object DataView]"!=ge(new B(new ArrayBuffer(1)))||L&&ge(new L)!=o||W&&"[object Promise]"!=ge(W.resolve())||J&&ge(new J)!=i||z&&"[object WeakMap]"!=ge(new z))&&(ge=function(e){var t=ue(e),r=t==a?e.constructor:void 0,n=r?Oe(r):"";if(n)switch(n){case $:return"[object DataView]";case Z:return o;case G:return"[object Promise]";case X:return i;case Q:return"[object WeakMap]"}return t});var je=se(function(){return arguments}())?se:function(e){return Ee(e)&&P.call(e,"callee")&&!A.call(e,"callee")},ke=Array.isArray;var Ce=H||function(){return!1};function xe(e){if(!Ie(e))return!1;var t=ue(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function _e(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ie(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ee(e){return null!=e&&"object"==typeof e}var Pe=m?function(e){return function(t){return e(t)}}(m):function(e){return Ee(e)&&_e(e.length)&&!!u[ue(e)]};function Re(e){return null!=(t=e)&&_e(t.length)&&!xe(t)?le(e):pe(e);var t}r.exports=function(e,t){return fe(e,t)}}).call(this,r(31),r(47)(e))},21:function(e,t,r){"use strict";e.exports=r(106)},23:function(e,t,r){"use strict";e.exports=function(){}},3:function(e,t){e.exports=r},31:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},33:function(e,t,r){"use strict";function n(e){return"INPUT"===e.tagName&&(!(!e||!0!==e.disabled)||void 0)}r.d(t,"a",(function(){return n}))},34:function(e,t,r){"use strict";r.d(t,"b",(function(){return g})),r.d(t,"a",(function(){return S}));var n=r(9),o=r(13),a=r(1),i=r(17),l=r(16),c=r(33),u=r(49);function s(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey,u="TD"===t.tagName?t:Object(a.findParentTd)(t);if(u){var s=u.previousElementSibling,h=u.parentElement,b=f(h),v=s&&s.querySelector('[tabindex="0"]');if(b!==u)if(null===v||Object(c.a)(v))p({td:s,ViewModel:r,moduleId:n,orderOfHotKey:o});else{var m=Object(l.a)(s);m&&(r.enterTriggerCellId=m),Object(i.a)({div:v,ViewModel:r})}else h===h.parentElement.lastElementChild?function(e){var t=e.currentModuleId,r=e.ViewModel,n=e.orderOfHotKey;n&&0===n.length?function(e){var t=e.currentModuleId,r=e.ViewModel,n="".concat(a.config.hotKeyModuleIdPrefix,"-").concat(t),o=document.querySelectorAll("#".concat(n," table tbody tr.u-table-row")),c=o[o.length-1],u=function(e){for(var t=e.length;t>-1;t--)if(null!==e[t].querySelector('[tabindex="0"]'))return e[t]}(o[c].querySelectorAll("td")),s=Object(l.a)(u);s&&(r.enterTriggerCellId=s);var f=u.querySelector('[tabindex="0"]');f&&Object(i.a)({div:f,ViewModel:r})}({currentModuleId:t,ViewModel:r}):n&&d({currentModuleId:t,ViewModel:r,orderOfHotKey:n})}({currentModuleId:n,ViewModel:r,orderOfHotKey:o}):y({tr:h,ViewModel:r,moduleId:n,orderOfHotKey:o})}else console.warn("not find parentTd, prev hotkey invalid")}function f(e){var t=e.querySelectorAll("td");return Array.prototype.find.call(t,(function(e){return!e.className.includes("fixed")}))}function d(e){var t=e.currentModuleId,r=e.ViewModel,c=e.orderOfHotKey,s=function(e,t){var r=t.length,n=t.indexOf(e),o=n-1<-1?t[r-1]:n-1;return t[o]}(t,c),f=n.d[s];if(void 0!==f){var d=f.type;if(d===o.a.cardTable||d===o.a.editTable){var y=n.d[f.activeTable],h=document.querySelector("div[".concat(y.lastItem,"]")),b=h.querySelector('[tabindex="0"]');if(null===b){p({td:h.parentElement,ViewModel:r,moduleId:y.moduleId,orderOfHotKey:c})}else{var v=Object(a.findParentTd)(b),m=Object(l.a)(v);m&&(r.enterTriggerCellId=m),Object(i.a)({div:b,ViewModel:r})}}else Object(u.a)(f,s)}}function p(e){var t=e.td,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey,a=t.previousElementSibling,u=a&&a.parentElement,s=u&&f(u),d=t.querySelector('[tabindex="0"]'),h=a&&a.querySelector('[tabindex="0"]');if(s===a&&null===h||s===t&&null===d)y({tr:u,ViewModel:r,moduleId:n,orderOfHotKey:o});else if(null===h||Object(c.a)(h))p({td:a,ViewModel:r,moduleId:n,orderOfHotKey:o});else{var b=Object(l.a)(a);b&&(r.enterTriggerCellId=b),Object(i.a)({div:h,ViewModel:r})}}function y(e){var t=e.tr,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey,c=t&&t.previousElementSibling;if(null!==c)if("-1"!==c.getAttribute("tabindex")){var u=c.querySelectorAll('td [tabindex="0"]'),s=u[u.length-1],f=Object(a.findParentTd)(s),p=Object(l.a)(f);p&&(r.enterTriggerCellId=p),Object(i.a)({div:s,ViewModel:r})}else y({tr:c,ViewModel:r,moduleId:n,orderOfHotKey:o});else o&&d({currentModuleId:n,ViewModel:r,orderOfHotKey:o})}var h=r(50);function b(e){var t=e.eventTarget,r=e.ViewModel,n=(e.moduleId,e.orderOfHotKey,"TD"===t.tagName?t:Object(a.findParentTd)(t)),o=n.parentElement.previousElementSibling,c=1;if(null!==o){"-1"===o.getAttribute("tabindex")&&(c=Object(h.a)(o,c,"up"));var u=Object(l.a)(n);if(!u)return console.warn("not find cell identity!");var s=u&&u.split("-"),f=Number(s.pop())-c;if(f>-1){s.push(f);var d=s.join("-");r.upStairsCellIdentity=s;var p=document.querySelector("div[".concat(d,'="').concat(d,'"] [tabindex="0"], div[').concat(d,'="').concat(d,'"][tabindex="0"]'));Object(i.a)({div:p,ViewModel:r})}}}function v(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o="TD"===t.tagName?t:Object(a.findParentTd)(t),c=o.parentElement.nextElementSibling,u=1;if(null!==c){"-1"===c.getAttribute("tabindex")&&(u=Object(h.a)(c,u,"down"));var s=Object(l.a)(o);if(!s)return console.warn("not find cell identity!");var f=s&&s.split("-"),d=Number(f.pop())+u;"".concat(a.config.hotKeyModuleIdPrefix,"-").concat(n);f.push(d);var p=f.join("-");r.upStairsCellIdentity=p;var y=document.querySelector("div[".concat(p,'="').concat(p,'"] [tabindex="0"], div[').concat(p,'="').concat(p,'"][tabindex="0"]'));Object(i.a)({div:y,ViewModel:r})}}var m={37:function(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey;if(e.itemType===a.config.hotKeyDatePicker)return void s({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o});var i=setTimeout((function(){s({eventTarget:t,ViewModel:r,moduleId:n}),clearTimeout(i)}))},38:function(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey;if(e.itemType===a.config.hotKeyDatePicker)return void b({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o});var i=setTimeout((function(){b({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o}),clearTimeout(i)}))},39:function(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey;if(e.itemType===a.config.hotKeyDatePicker)return void Object(i.b)({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o});var l=setTimeout((function(){Object(i.b)({eventTarget:t,ViewModel:r,moduleId:n}),clearTimeout(l)}))},40:function(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey;if(e.itemType===a.config.hotKeyDatePicker)return void v({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o});var i=setTimeout((function(){v({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o}),clearTimeout(i)}))}};function g(e,t,r){var i="shift+down"===r?1:-1,l=n.e.indexOf(e)+i,c=n.e[l];if(t.target){var u=null;!w(c)&&n.d[c].firstItem&&(u=n.d[c].firstItem);var s=document.querySelector("div[field=".concat(u,"]"));s&&s&&s.contains(t.target)||t.target.blur()}w(c)?function(e){var t=e.key,r=e.moduleId,o="shift+down"===t?"lastItem":"firstItem";if(function(e){var t=n.d[e];return t&&(t.parent||t.children)}(r))return void function(e,t){var r=a.ViewModel.tableActiveKey||e;a.PubSub.publish("autoFocus",{data:n.d[r][t],moduleId:e})}(r,o);a.PubSub.publish("autoFocus",{data:n.d[r][o],moduleId:r})}({key:r,moduleId:e}):!function(e,t,r){var a=n.d[t].type,i=n.d[r].type,l=[];a===o.a.form?l=function(e,t,r){var n,a=e._this.myTable;n=t===o.a.cardTable?a[r].state.table.rows:t===o.a.editTable?a.myEditTable[r].state.table.rows:e._this.state.meta[r].items;return n}(e,i,r):(a===o.a.cardTable||a===o.a.editTable)&&(l=O(e,i,r));return 0===l.length}(this.props,e,c)?a.PubSub.publish("autoFocus",{data:n.d[c].firstItem,moduleId:e}):g.call(this,c,t,r)}function w(e){return void 0===n.d[e]}function O(e,t,r){var n=e.pageScope.myTable;return t===o.a.cardTable?n[r].state.table.rows:t===o.a.editTable?n.myEditTable[r].state.table.rows:e.pageScope.state.meta[r].items}function S(e){var t=e.eventTarget,r=e.ViewModel,n=e.moduleId,o=e.orderOfHotKey,a=e.itemType,i=e.keyCode;m[i]({eventTarget:t,ViewModel:r,moduleId:n,orderOfHotKey:o,itemType:a})}},38:function(e,t,r){"use strict";t.a={allTypes:["input","number","textarea","datepicker","rangepicker","switch","select","checkbox","radio","refer","customer","label","NCTZDatePickerStart","NCTZDatePickerEnd","checkbox_switch","switch_browse"],displayTypes:["select","radio","checkbox","refer"],string:["input","textarea","datepicker","select","checkbox","radio","refer","label"],boolean:["switch","checkbox_switch","switch_browse"],number:["number"],valueTypesExceptNumber:["input","textarea"],changeTypes:["datepicker","rangepicker","switch","select","checkbox","radio","refer","NCTZDatePickerStart","NCTZDatePickerEnd","checkbox_switch","switch_browse","datePickerNoTimeZone"],blurTypes:["input","number","textarea"],afterBlurTypes:["input","number","textarea","residtxt","datetimepicker","timepicker"],valueTypes:["input","number","textarea"],noEditType:["label","customer"],getDisplay:["select","radio","checkbox"],ROW_STATUS:{origin:"0",edit:"1",add:"2",delete:"3",filter:"9"},timeTypes:["datepicker","NCTZDatePickerStart","NCTZDatePickerEnd","timepicker","datetimepicker","rangepicker","datePickerNoTimeZone"],beforeFocusTypes:["residtxt","input","select","number","textarea","password","switch_browse","refer"],beforeChangeTypes:["radio"],beforeClickTypes:["datepicker","timepicker","datetimepicker","NCTZDatePickerStart","NCTZDatePickerEnd","rangepicker","datePickerNoTimeZone","checkbox_switch","checkbox"],hotKeyModuleIdPrefix:"hot-key",defaultColor:["#111111","#555555","#111","#555"],complete:"areaChangeComplete",hotKeyDatePicker:"datePicker",stopEnterHotKey:"stopEnterHotKey"}},44:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));function n(e){var t=e.props,r=e.autoFocusDeferred,n=e.status,o=t.name,a=t.getHotKeyConfig?t.getHotKeyConfig():{},i=a.withHotKeyChange,l=a.meta;if(!t.getHotKeyConfig)return console.warn("some form hotkey invalid");var c,u=l[o]&&l[o].moduletype;return c=n||(l[o]&&l[o].status||"browse"),!(void 0!==o&&!1!==i&&void 0!==u&&!r&&"browse"!==c)}function o(e){var t=e.name,r=e.high_hotkey,n=(e.getHotKeyConfig,e.getHotKeyConfig?e.getHotKeyConfig():{}),o=n.withHotKeyChange,a=n.meta;if(!e.getHotKeyConfig)return console.warn("some form hotkey invalid");var i=r.store;r.tableId;if(!i)return!0;var l="edit"!==i.getTableProps("status"),c=i.getData(),u=a[t]&&a[t].items;return c=void 0===c?[]:c,l||0===c.length||!o||void 0===u}function a(e,t){var r=e.name,n=e.high_hotkey,o=(e.getHotKeyConfig,e.getHotKeyConfig?e.getHotKeyConfig():{}),a=o.withHotKeyChange,i=o.meta;if(!e.getHotKeyConfig)return console.warn("some form hotkey invalid");var l=n.store;n.tableId;if(!l)return!0;var c="edit"!==l.getTableProps("status"),u=l.getData(),s=i[r]&&i[r].items;return u=void 0===u?[]:u,t||c||0===u.length||!a||void 0===s}},47:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},49:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r(1),o=r(19);function a(e,t){var r=document.querySelector("#".concat(n.config.hotKeyModuleIdPrefix,"-").concat(t)),a=function(e){return Array.prototype.find.call(e.classList,(function(e){return e.startsWith("js-type")})).split("-").pop()}(r.querySelector(".".concat(e.firstItem)));void 0===o.a[a]?o.a.normal(r):o.a[a](r)}function i(e,t){}},5:function(e,t,r){var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)&&n.length){var i=o.apply(null,n);i&&e.push(i)}else if("object"===a)for(var l in n)r.call(n,l)&&n[l]&&e.push(l)}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},50:function(e,t,r){"use strict";function n(e,t,r){for(var n=e,o=t;null!==n&&"-1"===n.getAttribute("tabindex");)o+=1,n="up"===r?n.previousElementSibling:n.nextElementSibling;return o}r.d(t,"a",(function(){return n}))},6:function(e,t){e.exports=n},63:function(e,t){var r=Object.prototype.toString;e.exports=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==r.call(e)}},64:function(e,t){e.exports=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}},66:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={shiftUp:{sequence:"shift+up",action:"keydown"},shiftDown:{sequence:"shift+down",action:"keydown"},tab:{sequence:"tab",action:"keydown"}}},69:function(e,t,r){"use strict";var n=r(70);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,a,i){if(i!==n){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return r.PropTypes=r,r}},7:function(e,t,r){"use strict";r.r(t),r.d(t,"warningOnce",(function(){return f})),r.d(t,"isObject",(function(){return p})),r.d(t,"isArray",(function(){return y})),r.d(t,"isString",(function(){return h})),r.d(t,"isFunction",(function(){return b})),r.d(t,"isPromise",(function(){return v})),r.d(t,"isNumber",(function(){return m})),r.d(t,"isBoolean",(function(){return g})),r.d(t,"isUndefined",(function(){return w})),r.d(t,"isWrong",(function(){return O})),r.d(t,"isNullOrVoid",(function(){return S})),r.d(t,"isWrongFalse",(function(){return j})),r.d(t,"isEmptyValue",(function(){return k})),r.d(t,"debounds",(function(){return C})),r.d(t,"throttle",(function(){return x})),r.d(t,"setElementFocusInIE",(function(){return _})),r.d(t,"isArrowKeyDown",(function(){return I})),r.d(t,"ctrlKeyWithUpDown",(function(){return E})),r.d(t,"isEnterKeyDown",(function(){return P})),r.d(t,"uuidv4",(function(){return R})),r.d(t,"polymerizeComponents",(function(){return T})),r.d(t,"getRandom",(function(){return K})),r.d(t,"changeTime",(function(){return D})),r.d(t,"getRandomPassword",(function(){return M})),r.d(t,"formatAcuracy",(function(){return V})),r.d(t,"ncRounding",(function(){return A})),r.d(t,"filterColumns",(function(){return U})),r.d(t,"getMetaIsTotal",(function(){return B})),r.d(t,"excelPackageData",(function(){return L})),r.d(t,"setPageSizeStorage",(function(){return W})),r.d(t,"getPageSizeStorage",(function(){return J})),r.d(t,"handleBrowseData",(function(){return Y})),r.d(t,"isIE",(function(){return $}));var n=r(23),o=r.n(n),a=r(1),i=r(38);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s={};function f(e,t,r){s[t]||(o()(e,t,r),s[t]=!0)}var d=function(e){return Object.prototype.toString.call(e).slice(8,-1)};function p(e){return"Object"===d(e)}function y(e){return"Array"===d(e)||Array.isArray(e)}function h(e){return"String"===d(e)}function b(e){return"Function"===d(e)}function v(e){return"Promise"===d(e)}function m(e){return"Number"===d(e)&&!Number.isNaN(e)}function g(e){return"Boolean"===d(e)}function w(e){return void 0===e||void 0===e}function O(e){return null==e||""===e}function S(e){return null==e}function j(e){return null==e||""===e||!1===e}function k(e,t){return"residtxt"===t?!Object.keys(e).some((function(t){return!O(e[t].value)})):"refer"===t?Array.isArray(e)?!(e.length>1)&&(0===e.length||O(e[0].refpk)):O(e.refpk):O(e)}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=null;return function(){var n=this,o=arguments;r&&clearTimeout(r),r=setTimeout((function(){"function"==typeof e&&e.apply(n,o)}),t)}}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;return function(){var n=arguments,o=this,a=+new Date;a-r>=t&&(r=a,"function"==typeof e&&e.apply(o,n))}}function _(e){var t=setTimeout((function(){e&&e.focus(),clearTimeout(t)}),100)}function I(e,t){return!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)&&(t||[37,38,39,40]).includes(e.keyCode)}function E(e){return(e.ctrlKey||e.metaKey)&&[38,40].includes(e.keyCode)}function P(e){return"Enter"===e.key&&229!==e.keyCode&&!1===e.ctrlKey&&!1===e.altKey&&!1===e.metaKey}function R(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Object(a.getSafeRandom)()|0;return("x"==e?t:3&t|8).toString(16)}))}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=e;return t.forEach((function(e){n=e(n,r)})),n}function K(){return String((new Date).getTime()).slice(-5)+Object(a.getSafeRandom)().toString(12)}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";if(e){var r=Object(a.DongbaToLocalTime)(Object(a.moment)(e));return r.format(t)}}function M(){var e=6,t=12;e=Math.ceil(e),t=Math.floor(t);var r=Math.floor(Object(a.getSafeRandom)()*(t-e+1))+e;return Array(r).fill("*").join("")}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e||String(e).endsWith("必输项")?e:F(H(q(e=N(e),t),t))}function A(e,t){if(!t)return e;var r=e,n=t;"[object Number]"===!Object.prototype.toString.call(t)||isNaN(Number(t))||(n=Number(t)),"[object String]"!==Object.prototype.toString.call(e)&&(r=String(e));if(r.length<500&&!/^(\-|\+)?(\d+)?\.?(\d+)?$/.test(r))return e;var o=c(r.split("."),2)[1];return o&&""!==o&&o.length>n&&(r=Number(r),r=Number(r.toFixed(n+1)),r*=Math.pow(10,n),r=Math.round(r),r/=Math.pow(10,n)),r}function N(e){var t,r="",n="",o=null,a=[],i="",l=String(e);if(!/e/i.test(l))return l;"-"==l[0]&&(l=l.substr(1),i="-");var c=new RegExp("^(((\\d+.?\\d+)|(\\d+))[Ee]{1}((-(\\d+))|(\\d+)))$","ig");if(l.length<500&&(o=c.exec(l)),null!=o&&(r=o[2],n=o[5],o=null),!r&&!n)return!1;if(t=r.indexOf("."),a=(r=r.replace(".","")).split(""),Number(n)>=0){var u=r.substr(t);n=Number(n);for(var s=0;s<n-u.length;s++)a.push("0");n-u.length<0&&a.splice(t+n,0,".")}else{n=n.replace("-",""),n=Number(n);for(var f=0;f<=n-1;f++)a.unshift("0");var d=n-t>=0?1:-(n-t);a.splice(d,0,".")}return i+(r=a.join(""))}function F(e){var t,r,n;if("-"===e)return"-";if(Number.isNaN(+(e+"").split(",").join("")))return"";if((e+="").length<500&&/^.*\..*$/.test(e)){t=e.lastIndexOf("."),r=e.substring(0,t),n=e.substring(t+1,e.length),r+="";for(var o=/(-?\d+)(\d{3})/;r.length<500&&o.test(r);)r=r.replace(o,"$1,$2");e=r+"."+n}else{e+="";for(var a=/(-?\d+)(\d{3})/;e.length<500&&a.test(e);)e=e.replace(a,"$1,$2")}return e}function q(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return(t=(r=(e||0).toString()).split(".")).length>2||!e?e:r.indexOf(".")>-1?0==n?t[0]:r.substring(0,r.indexOf(".")+n+1):r}function H(e,t){if(""===e||null==e)return"";if(t>0){var r=String(e).split(".")[0],n=String(e).split(".")[1];return n||(n=""),n.length<t&&(n=n.padEnd(t,"0")),r+"."+n}return e}function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t?e.filter((function(e){var r=t(e);return e.children&&r?(e.children=U(e.children,t),e.children.length):r})):e}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!1;return Array.isArray(e)&&e.forEach((function(e){e.istotal&&(t=!0)})),t}var L=function(e){for(var t=e.pasteContent,r=e.activeCell,n=e.langJson,o=e.rows,c=e.getRowOldValue,u=e.tableId,s=r.rowIndex,f=r.attrcode,d=r.column,p=r.direction,y=void 0===p?"down":p,b=d.itemtype,v=d.options,m=d.languageMeta,g=d.maxlength,O=d.scale,S=[],j=[],k=[],C=t.length,x=function(e){var r=t[e];if(h(r)&&(r=r.trim()),w(r)&&(r=""),g&&r.length>g)return Object(a.toast)({color:"danger",title:n.table_tips,content:"".concat(n.table_tips_content).concat(g)}),{v:void 0};var l=o["up"===y?s-e:s+e];l||(l={rowid:String((new Date).getTime()).slice(-5)+Object(a.getSafeRandom)().toString(12),status:2,values:{}});var u=JSON.parse(JSON.stringify(l)),d=r;u.values[f]||(u.values[f]={});var p=u.values[f];switch(!0){case i.a.boolean.includes(b):"Y"===r||!0===r?(d=!0,p.value=!0):(d=!1,p.value=!1);break;case"timepicker"===b:d&&d.format&&(d=d.format("hh:mm:ss"),p.value=d);break;case"number"===b:h(r)&&(r=r.replace(/,/g,"")),"-"===r&&(d=0,r=0),p.value=r;if(h(r)&&h(r).length<500&&!/^(-?\d+)(\.\d+)?$/.test(r))return Object(a.toast)({color:"danger",title:n.table_tips,content:"格式错误，请输入正确数字"}),{v:void 0};break;case["datepicker","NCTZDatePickerStart","NCTZDatePickerEnd"].includes(b):if(!Object(a.moment)(d,"YYYY-MM-DD").isValid()&&!Object(a.moment)(d,"YYYY-MM-DD HH:mm:ss").isValid())return Object(a.toast)({color:"danger",title:n.table_tips,content:" 粘贴值 ".concat(d," 日期格式不合法")}),{v:void 0};var C=null;switch(b){case"datepicker":C=Object(a.moment)(d,"YYYY-MM-DD HH:mm:ss",!0).isValid()?d:"".concat(d," ").concat(Object(a.moment)().format("HH:mm:ss"));break;case"NCTZDatePickerStart":C=Object(a.moment)(d,"YYYY-MM-DD HH:mm:ss",!0).isValid()?d:"".concat(d," 00:00:00");break;case"NCTZDatePickerEnd":C=Object(a.moment)(d,"YYYY-MM-DD HH:mm:ss",!0).isValid()?d:"".concat(d," 23:59:59")}r=d=Object(a.isDongba)()?C:Object(a.LocalToDongbaTime)(C),p.value=r;break;case"select"===b:v.map((function(e){e.display==r&&(p.value=e.value,p.display=r,d=e.value)}));break;case"residtxt"===b:var x=Object(a.getLangCode)(),_=m.filter((function(e){return e.languageCode==x})),I="1"===_[0].index?"":_[0].index;u.values[f+I]||(u.values[f+I]={}),u.values[f+I].value=r,u.values[f+I].index=I;break;case"refer"===b:p.value=d,p.display="";break;default:p.value=r}"0"==u.status&&(u.status="1"),k.push(d);var E=c?c(u.rowid,f):null,P=p.scale||O||-1;S.push({rowid:u.rowid,newvalue:{value:d},oldvalue:{value:E?"number"===b?V(E,P):E:""}}),j.push(u)},_=0;_<C;_++){var I=x(_);if("object"===l(I))return I.v}return{areaCode:u,column:d,changedrows:S,newValue:j,pasteData:k,currentIndex:s,allData:o}};function W(e,t,r){var n=Object(a.getGlobalStorage)("localStorage","_ncc_pagesize_store");n=n?JSON.parse(n):{};var o=z(e,t);o&&(n[o]=r,Object(a.setGlobalStorage)("localStorage","_ncc_pagesize_store",JSON.stringify(n)))}function J(e,t){var r=z(e,t);if(r){var n=Object(a.getGlobalStorage)("localStorage","_ncc_pagesize_store");if(n)return(n=JSON.parse(n))[r]||"100"}return"100"}function z(e,t){var r="";if(e&&e[t]){var n=e[t].appcode||a.pageTo.getAppCode(),o=e[t].pagecode||a.pageTo.getPageCode(),i=e[t].pageid||e.pageid,l=Object(a.getGlobalStorage)("localStorage","STOREFORINFODATA"),c=l&&JSON.parse(l),u=c&&c.userId;n&&o&&i&&u&&(r=n+"-"+o+"-"+i+"-"+u)}return r}function Y(e,t,r,n,o,l,c,u,s,f,d){if("32"===u&&["select","checkbox","radio"].includes(e)&&y(s)&&!t&&null!=r)return"checkbox"===e||f?s.filter((function(e){return r.includes(e.value)})).map((function(e){return e.display})).join(","):(s.filter((function(e){return e.value==r}))[0]||{}).display;switch(!0){case i.a.displayTypes.includes(e):return t||r;case i.a.boolean.includes(e):return"Y"==r||1==r?d.table_yes:d.table_no;case i.a.timeTypes.includes(e):return"datetimepicker"===e?Object(a.formatDatetime)(D(r,"YYYY-MM-DD HH:mm:ss"),"datetime"):"timepicker"===e?Object(a.formatDatetime)(r,"time"):"datePickerNoTimeZone"===e?Object(a.formatDatetime)(r,"date"):Object(a.formatDatetime)(D(r),"date");case"label"===e:return S(t)?r:t||r;case"number"===e:return Object(a.formatNumber)(V(r,n),!0);case"password"===e:return r&&M();case"residtxt"===e:var p=Object(a.getLangCode)(),h=l.filter((function(e){return e.languageCode==p}));return h.length>0?("1"===h[0].index&&(h[0].index=""),c[o+h[0].index]&&c[o+h[0].index].value?r=c[o+h[0].index].value:r):r;default:return S(t)?r:t||r}}function $(){return!(!window.ActiveXObject&&!("ActiveXObject"in window))}},70:function(e,t,r){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},721:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(1);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=d(e);if(t){var o=d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(d,t);var r,n,i,f=s(d);function d(){return l(this,d),f.apply(this,arguments)}return r=d,i=[{key:"judgeFocus",value:function(e,t,r,n){var o=document.getElementById(r);if(e)return-1!==t.tabIndex&&o&&!o.contains(t)||n}}],(n=[{key:"componentDidMount",value:function(){var e=this.props.store;this.autoFocusToken=a.PubSub.subscribe("autoFocus",(function(t,r){var n=r.data,o=r.moduleId,i=r.force,l=document.querySelector("div[".concat(n,'="').concat(n,'"] [tabindex="0"]')),c=document.activeElement,u="".concat(a.config.hotKeyModuleIdPrefix,"-").concat(o);if(console.log(u,c,e),d.judgeFocus(l,c,u,i)){a.ViewModel.shouldAutoFocus=!0,l.ncExecuteFocus=!0;var s=l.getAttribute("cellselectorkey")||"";s=s.split("@")||[],e&&s[0]&&s[1]&&e.setCellProps(s[0],s[1],{autoFocus:!0},!1),!l.contains(c)&&l.focus(),delete l.ncExecuteFocus,setTimeout((function(){a.ViewModel.shouldAutoFocus=!1}),100)}}))}},{key:"componentWillUnmount",value:function(){this.autoFocusToken&&a.PubSub.subscribe(this.autoFocusToken)}},{key:"render",value:function(){return o.a.createElement("div",{id:"".concat(a.config.hotKeyModuleIdPrefix,"-").concat(this.props.tableId||this.props.name)},o.a.createElement(e,this.props))}}])&&c(r.prototype,n),i&&c(r,i),d}(n.Component)}},722:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(1),i=r(21),l=r(66),c=r(9),u=r(34),s=r(44),f=r(17);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g(e);if(t){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(g,t);var r,n,d,v=b(g);function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=v.call(this,e)).hotKeyWithArrow=function(e){var r=e.e,n=e.ViewModel,o=e.moduleId,a=e.itemType,i=e.target||r.target,l=(t.props.getHotKeyConfig?t.props.getHotKeyConfig():{}).orderOfHotKey;l?Object(u.a)({eventTarget:i,ViewModel:n,moduleId:o,orderOfHotKey:l,itemType:a,keyCode:r.keyCode}):console.warn("not find orderOfHotKey in getHotKeyConfig")},t.hotKeyWithEnter=t.hotKeyWithEnter.bind(m(t)),t}return r=g,(n=[{key:"componentDidUpdate",value:function(){var e=(this.props.getHotKeyConfig?this.props.getHotKeyConfig():{}).autoFocusDeferred;Object(s.b)(this.props,e)||c.a.editTable(this.props)}},{key:"componentDidMount",value:function(){var e=this;this.autoFocusToken=a.PubSub.subscribe("autoFocus-IoC",(function(){Object(s.b)(e.props,!1)||c.a.editTable(e.props,!0)}))}},{key:"componentWillUnmount",value:function(){this.autoFocusToken&&a.PubSub.subscribe(this.autoFocusToken)}},{key:"hotKeyWithEnter",value:function(e){var t=e.e,r=e.ViewModel,n=e.moduleId,o=e.target||t.target,a=(this.props.getHotKeyConfig?this.props.getHotKeyConfig():{}).orderOfHotKey;if(a)var i=setTimeout((function(){Object(f.b)({eventTarget:o,ViewModel:r,moduleId:n,orderOfHotKey:a}),clearTimeout(i)}));else console.warn("not find orderOfHotKey in getHotKeyConfig")}},{key:"render",value:function(){return o.a.createElement(i.HotKeys,{keyMap:l.a,handlers:{shiftUp:u.b.bind(this,this.props.moduleId),shiftDown:u.b.bind(this,this.props.moduleId)}},o.a.createElement(e,p({tableStatusChanged:g.tableStatusChanged,hotKeyWithEnter:this.hotKeyWithEnter,hotKeyWithArrow:this.hotKeyWithArrow},this.props)))}}])&&y(r.prototype,n),d&&y(r,d),g}(n.Component)}},723:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(21),i=r(66),l=r(9),c=r(34),u=r(44),s=r(17);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.a=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(v,t);var r,n,f,b=h(v);function v(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(t=b.call(this,e)).hotKeyWithEnter=function(e){var r=e.e,n=e.ViewModel,o=e.moduleId,a=e.target,i=e.itemType,l=a||r.target,c=(t.props.getHotKeyConfig?t.props.getHotKeyConfig():{}).orderOfHotKey;if(c)if("datePicker"!==i)var u=setTimeout((function(){Object(s.b)({eventTarget:l,ViewModel:n,moduleId:o,orderOfHotKey:c}),clearTimeout(u)}));else Object(s.b)({eventTarget:l,ViewModel:n,moduleId:o,orderOfHotKey:c});else console.warn("not find orderOfHotKey in getHotKeyConfig")},t.hotKeyWithArrow=function(e){var r=e.e,n=e.ViewModel,o=e.moduleId,a=e.itemType,i=e.target||r.target,l=(t.props.getHotKeyConfig?t.props.getHotKeyConfig():{}).orderOfHotKey;l?Object(c.a)({eventTarget:i,ViewModel:n,moduleId:o,orderOfHotKey:l,itemType:a,keyCode:r.keyCode}):console.warn("not find orderOfHotKey in getHotKeyConfig")},t}return r=v,f=[{key:"tableStatusChanged",value:function(e){var t=e.props;"edit"!==e.status||Object(u.a)(t)?Object(l.b)(t.moduleId):l.a.table(t)}}],(n=[{key:"componentDidUpdate",value:function(){Object(u.a)(this.props)||l.a.table(this.props)}},{key:"componentWillUnmount",value:function(){Object(l.b)(this.props.moduleId||this.props.name)}},{key:"render",value:function(){return o.a.createElement(a.HotKeys,{keyMap:i.a,handlers:{shiftUp:c.b.bind(this,this.props.moduleId),shiftDown:c.b.bind(this,this.props.moduleId)}},o.a.createElement(e,d({},this.props,{tableStatusChanged:v.tableStatusChanged,hotKeyWithEnter:this.hotKeyWithEnter,hotKeyWithArrow:this.hotKeyWithArrow})))}}])&&p(r.prototype,n),f&&p(r,f),v}(n.Component)}},9:function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return s})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return g})),r.d(t,"f",(function(){return w}));var n=["input","textarea","number","refer","datepicker","datetimepicker","timepicker","select","switch","residtxt","checkbox_switch"],o=["refer","datepicker","input","datetimepicker","timepicker","select","number","residtxt","checkbox_switch","rangepicker","datePickerNoTimeZone","TZDatePickerStart","TZDatePickerStart","switch"],a=r(13),i=r(1);var l={},c={},u={},s=[],f=i.config.hotKeyModuleIdPrefix;function d(e,t){return void 0===l[e]&&s[0]===e||t}function p(e,t){var r=n.includes(e.itemtype)&&!0!==e.disabled&&!1!==e.visible,o=!(!c[t]||!0!==c[t][e.attrcode]);return r&&!o}function y(e,t,r){return t.reduce((function(t,r){return r.children?y(e,r.children,t):!function(e,t){if(u[e]){if(!1===u[e][t.attrcode])return!1;if(!0===u[e][t.attrcode])return!0}return o.includes(t.itemtype)&&!1!==t.visible&&!0!==t.disabled&&void 0!==t.attrcode}(e,r)||t.push(r.attrcode),t}),r)}function h(e){var t=e.moduleId,r=e.availableItems,n=e.lastRowIndex,o=e.moduleType,a=e.force,c="".concat(f,"-").concat(t,"-").concat(r[0],"-0"),u=r.length-1,d="".concat(f,"-").concat(t,"-").concat(r[u],"-").concat(n);!function(e){var t=e.orderOfHotKey,r=e.moduleId,n=e.firstItem,o=e.force;(function(e){var t=e.orderOfHotKey,r=void 0===t?[]:t,n=e.moduleId,o=e.force;return r[0]===n&&void 0===l[n]||o})({orderOfHotKey:t,moduleId:r,force:o})&&i.PubSub.publish("autoFocus",{data:n,moduleId:r})}({orderOfHotKey:s,moduleId:t,firstItem:c,force:a}),l[t]={firstItem:c,lastItem:d,type:o,activeTable:t}}function b(e,t){var r=(e.getHotKeyConfig?e.getHotKeyConfig():{}).meta;if(!e.getHotKeyConfig)return console.warn("some form hotkey invalid");var n=r.gridrelation&&r.gridrelation[t].tabRelation;return!!(n&&n.length>1)}function v(e,t,r){var n=(e.getHotKeyConfig?e.getHotKeyConfig():{}).meta;if(!e.getHotKeyConfig)return console.warn("some form hotkey invalid");n.gridrelation[t].tabRelation.forEach((function(e){if(e!==t){var o=n[e]&&n[e].items,i=o&&y(t,o,[]),c=n[e].code,u="".concat(f,"-").concat(t,"-").concat(i[0],"-0"),s=i[i.length-1],d="".concat(f,"-").concat(t,"-").concat(s,"-").concat(r);l[c]={firstItem:u,lastItem:d,type:a.a.cardTable,parent:t}}}))}function m(e){delete l[e]}function g(e){return l[e]&&l[e].firstItem}function w(e){var t=e.moduleId,r=e.activeKey,n=l[t];n&&(n.activeTable=r)}var O={form:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.name,n=e.getHotKeyConfig?e.getHotKeyConfig():{},o=n.meta,c=n.orderOfHotKey;if(!e.getHotKeyConfig)return console.warn("some form hotkey invalid");var u=o[r].items;s=c;var f=u.filter((function(e){return p(e,r)})).map((function(e){return e.attrcode}));if(d(r,t)){l[r]={firstItem:f[0],type:a.a.form};var y=f[0];i.PubSub.publish("autoFocus",{data:y})}},table:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(e.name,e.high_hotkey),n=(e.getHotKeyConfig,e.getHotKeyConfig?e.getHotKeyConfig():{}),o=(n.withHotKeyChange,n.meta),i=n.orderOfHotKey;if(!e.getHotKeyConfig||!i)return console.warn("some form hotkey invalid");s=i;var c=r.store,u=r.tableId,f=o[u]&&o[u].items,d=c.getData(),p=d.length-1,m=f&&y(u,f,[]);d&&0===d.length||(h({tableId:u,availableItems:m,lastRowIndex:p,moduleType:a.a.cardTable,force:t}),b(e,u)&&l[u]&&(v(e,u,p),l[u].children=o.gridrelation[u].tabRelation))},editTable:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(e.name,e.high_hotkey),n=(e.getHotKeyConfig,e.getHotKeyConfig?e.getHotKeyConfig():{}),o=(n.withHotKeyChange,n.meta),i=n.orderOfHotKey;if(!e.getHotKeyConfig||!i)return console.warn("some form hotkey invalid");s=i;var l=r.store,c=r.tableId,u=o[c]&&o[c].items,f=l.getData(),d=f.length-1,p=u&&y(c,u,[]);f&&0===f.length||h({tableId:c,availableItems:p,lastRowIndex:d,moduleType:a.a.editTable,force:t})}}},903:function(e,t,r){}})}));
//# sourceMappingURL=index.js.map